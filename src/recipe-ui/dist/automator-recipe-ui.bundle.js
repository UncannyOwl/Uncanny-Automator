!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=17)}([function(module,exports,__webpack_require__){"use strict";(function($,jQuery){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function createDataOnLoad(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";consoleLogLabel("Start creating the main object"),e=isEmpty(e)?function(){}:e;var t=function(){filterAutomatorItemsByRecipeType(),groupItemsByIntegration(),recipeObject("create",{allRecipes:UncannyAutomator.recipes_object}),delete UncannyAutomator.recipes_object,delete UncannyAutomator.triggers,delete UncannyAutomator.actions,consoleLogLabel("Ended creating the main object"),e()};isDefined(UncannyAutomator.wp)&&UncannyAutomator.wp?isEmpty(UncannyAutomator.recipe.type)?new _RecipeTypeSelector2.default(function(){t()}):t():(UncannyAutomator.recipe.type="user",t())}function recipeObject(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,i=["create","validate"];if(isDefined(e)&&inArray(e,i))switch(e){case"create":var a=["allRecipes"];if(inArray(a,Object.keys(t))){var o=void 0,r=t.allRecipes;$.each(r,function(e,t){t.ID==UncannyAutomator.recipe.id&&(o=t)}),$.each(o.triggers,function(e,t){return t.itemType="trigger"}),$.each(o.actions,function(e,t){return t.itemType="action"}),$.each(o.closures,function(e,t){return t.itemType="closure"});var s=[].concat.apply([],[o.triggers,o.actions,o.closures]);itemsObject("reset");var l="anonymous"==UncannyAutomator.recipe.type;if($.each(s,function(e,t){var n=void 0,i=getGlobalItem(t.meta.integration,t.itemType,t.meta.code),a=t.meta.code;if(isDefined(i)){var o={};isDefined(i.options)&&$.each(i.options,function(e,t){o[t.option_code]=[t]}),isDefined(i.options_group)&&$.extend(!0,o,i.options_group);var r={};$.each(o,function(e,n){var a=[],o=n.length>1;$.each(n,function(n,r){var s=function(n){var a={isGroup:o,itemId:t.ID,itemType:t.itemType,isRequired:!!isDefined(n.required)&&n.required,isReadOnly:!!isDefined(n.read_only)&&n.read_only,supportsTinyMCE:!!isDefined(n.supports_tinymce)&&n.supports_tinymce,supportsCopyToClipboard:!!isDefined(n.copy_to_clipboard)&&n.copy_to_clipboard,isAjax:!!isDefined(n.is_ajax)&&n.is_ajax,groupId:e,optionCode:n.option_code,fieldType:n.input_type,label:n.label,description:n.description,placeholder:n.placeholder,isHidden:!!isDefined(n.is_hidden)&&n.is_hidden,tokenName:isDefined(n.token_name)?n.token_name:n.label,defaultValue:n.default_value,currentValue:isDefined(t.meta[n.option_code])?t.meta[n.option_code]:n.default_value,relevant_tokens:!!isDefined(n.relevant_tokens)&&n.relevant_tokens,maxLength:isDefined(n.max_length)?n.max_length:null};return["text","textarea","int","float","email","url","select"].includes(a.fieldType)&&["action","closure"].includes(a.itemType)&&!a.isReadOnly?a.supportsTokens=!isDefined(n.supports_tokens)||n.supports_tokens:a.supportsTokens=!1,"select"==a.fieldType&&(a.supportsCustomValue=isDefined(n.supports_custom_value)?n.supports_custom_value:!!["action","closure"].includes(a.itemType),a.supportsCustomValue&&(a.customValue=isDefined(t.meta[a.optionCode+"_custom"])?t.meta[a.optionCode+"_custom"]:""),isDefined(n.custom_value_description)&&(a.customValueDescription=n.custom_value_description),isDefined(n.supports_multiple_values)&&(a.supportsMultipleValues=n.supports_multiple_values)),a.isAjax&&(a.targetField=isDefined(n.fill_values_in)?n.fill_values_in:"",a.endpoint=isDefined(n.endpoint)?n.endpoint:"",a.integrationId=i.integration,isEmpty(a.targetField)&&(a.targetField=n.option_code)),["select","radio"].includes(a.fieldType)&&(a.options=isDefined(n.options)?n.options:[]),a},l=void 0,c=void 0;if("group"==r.input_type)l={groupId:e,optionCode:r.option_code,fieldType:r.input_type,isGroup:o,itemId:t.ID,itemType:t.itemType,label:r.label,description:r.description,tokenName:isDefined(r.token_name)?r.token_name:r.label,isRequired:!!isDefined(r.required)&&r.required,fields:r.fields.map(function(e){return s(e)})},c=new _FieldsGroup2.default(l);else if("repeater"==r.input_type){try{t.meta[r.option_code]=JSON.parse(t.meta[r.option_code])}catch(e){}l={groupId:e,optionCode:r.option_code,fieldType:r.input_type,isGroup:o,itemId:t.ID,itemType:t.itemType,label:r.label,description:r.description,tokenName:isDefined(r.token_name)?r.token_name:r.label,defaultValue:r.default_value,currentValue:isDefined(t.meta[r.option_code])?t.meta[r.option_code]:r.default_value,isRequired:!!isDefined(r.required)&&r.required,hideActions:!!isDefined(r.hide_actions)&&r.hide_actions,fields:r.fields.map(function(e){return s(e)})},isDefined(r.add_row_button)&&(l.addRowButtonLabel=r.add_row_button),isDefined(r.remove_row_button)&&(l.removeRowButtonLabel=r.remove_row_button),c=new _FieldsRepeater2.default(l)}else l=s(r),c=new _Field2.default(l.fieldType,l,!1);a.push(c)});var s=[];isDefined(i.buttons)&&$.each(i.buttons,function(t,n){n.show_in==e&&s.push(n)}),r[e]={fields:a,isValid:!1,buttons:s}}),n={id:t.ID,itemType:t.itemType,itemCode:a,integrationCode:i.integration,isLive:"publish"==t.post_status,options:r,meta:t.meta,isMissing:!1,tokens:isDefined(t.tokens)?t.tokens:[],inlineCss:isDefined(i.inline_css)?i.inline_css:"",filterTokens:isDefined(i.filter_tokens)?i.filter_tokens:""},isDefined(i.support)&&(n.support=i.support);var s={};$.each(r,function(e,t){$.each(t.fields,function(e,t){s[t.getAttributes().optionCode]=t})}),$.each(s,function(e,t){var i=t.getAttributes();isDefined(n.meta[i.optionCode])&&!isEmpty(n.meta[i.optionCode])||isEmpty(i.currentValue)||(n.meta[i.optionCode]=i.currentValue)}),l&&(n.canLogNewUserIn=!isDefined(i.can_log_in_new_user)||i.can_log_in_new_user)}else n={id:t.ID,itemType:t.itemType,itemCode:t.meta.code,integrationCode:t.meta.integration,integrationName:t.meta.integration_name,sentence:t.meta.sentence,isLive:"publish"==t.post_status,tokens:[],options:{},meta:t.meta,isMissing:!0},l&&(n.canLogNewUserIn=!isDefined(t.meta.can_log_in_new_user)||"true"==t.meta.can_log_in_new_user);itemsObject("add",n)}),l){UncannyAutomator.recipe.canLogNewUserIn=!1;var c=itemsObject("get",{filter:{itemType:"trigger"}});Object.keys(c)>0&&(UncannyAutomator.recipe.canLogNewUserIn=!0,$.each(c,function(e,t){UncannyAutomator.recipe.canLogNewUserIn=UncannyAutomator.recipe.canLogNewUserIn&&t.canLogNewUserIn}))}(!isDefined(t.validate)||isDefined(t.validate)&&t.validate)&&recipeObject("validate")}else{var u=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["recipeObject",u]))}break;case"validate":var d=!0;$.each(UncannyAutomator.recipe.hasLive,function(e,t){UncannyAutomator.recipe.hasLive[e]=!1}),$.each(UncannyAutomator.recipe.items,function(e,t){t.isLive&&(UncannyAutomator.recipe.hasLive[t.itemType]=!0)}),$.each(UncannyAutomator.recipe.items,function(e,t){var n=!0;$.each(t.options,function(t,i){var a=!0;$.each(i.fields,function(e,t){t.validate(!1).isValid||(a=!1)}),UncannyAutomator.recipe.items[e].options[t].isValid=a,a||(n=!1)}),UncannyAutomator.recipe.items[e].isValid=n,t.isLive&&!n&&(d=!1)}),UncannyAutomator.recipe.hasLive.trigger?"anonymous"!=UncannyAutomator.recipe.type||UncannyAutomator.recipe.userSelector.isValid?UncannyAutomator.recipe.hasLive.action||UncannyAutomator.recipe.hasLive.closure?UncannyAutomator.recipe.hasLive.trigger||UncannyAutomator.recipe.hasLive.action||UncannyAutomator.recipe.hasLive.closure||(UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.liveItems):(d=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.oneAction):(d=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.userSelector):(d=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.oneTrigger),UncannyAutomator.recipe.isValid=d,d&&(UncannyAutomator.recipe.message.error=""),n=!0}else console.error(vsprintf('%s: The action "%s" isn\'t defined',["recipeObject",e]));return n}function itemsObject(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,i=["add","delete","clean","reset","update","get"];if(isDefined(e)&&inArray(e,i))switch(e){case"add":t=$.extend({isValid:!1,isLive:!1},t);var a=["id","itemType"];if(inArray(a,Object.keys(t)))isDefined(UncannyAutomator.recipe.items[t.id])||(UncannyAutomator.recipe.items[t.id]=t,itemsObject("clean",{}),n=!0);else{var o=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",o]))}break;case"delete":t=$.extend({isValid:!1},t),isEmpty(t.id)?console.error(vsprintf("%s: Invalid item ID",["itemsObject"])):isDefined(UncannyAutomator.recipe.items[t.id])?(delete UncannyAutomator.recipe.items[t.id],n=!0):console.error(vsprintf("%s: We didn't find an item with this the ID %s",["itemsObject",t.id]));break;case"clean":var r={};$.each(UncannyAutomator.recipe.items,function(e,t){isDefined(t)&&(r[e]=t)}),UncannyAutomator.recipe.items=r,n=!0;break;case"update":isEmpty(t.id)?console.error(vsprintf("%s: Invalid item ID",["itemsObject"])):isDefined(UncannyAutomator.recipe.items[t.id])?(UncannyAutomator.recipe.items[t.id]=$.extend({},UncannyAutomator.recipe.items[t.id],t),n=!0):console.error(vsprintf("%s: We didn't find an item with this the ID %s",["itemsObject",t.id]));break;case"reset":UncannyAutomator.recipe.items={},n=!0;break;case"get":if(isEmpty(t.filter))n=UncannyAutomator.recipe.items;else{var s={};$.each(UncannyAutomator.recipe.items,function(e,n){var i=!0;$.each(t.filter,function(e,t){n[e]!=t&&(i=!1)}),i&&(s[e]=n)}),n=s}}else console.error(vsprintf('%s: The action "%s" isn\'t defined',["itemsObject",e]));return n}function groupItemsByIntegration(){Object.entries(UncannyAutomator.integrations).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],i=(t[1],{available:sortArrayOfObjectsAlphabetically(UncannyAutomator.triggers.filter(function(e){return e.integration==n}),"select_option_name",function(e){return replaceCurlyBraces(e)}),unavailable:[]}),a={available:sortArrayOfObjectsAlphabetically(UncannyAutomator.actions.filter(function(e){return e.integration==n}),"select_option_name",function(e){return replaceCurlyBraces(e)}),unavailable:[]};isDefined(UncannyAutomator.wp)&&UncannyAutomator.wp||isDefined(UncannyAutomator.proFeatures)&&isDefined(UncannyAutomator.proFeatures[n])&&(i.unavailable=sortArrayOfObjectsAlphabetically(UncannyAutomator.proFeatures[n].triggers.filter(function(e){return"logged-in"==e.type}),"name",function(e){return replaceCurlyBraces(e)}),a.unavailable=sortArrayOfObjectsAlphabetically(UncannyAutomator.proFeatures[n].actions,"name",function(e){return replaceCurlyBraces(e)})),i.allItemsArePro=i.available.every(function(e){return!!isDefined(e.is_pro)&&e.is_pro}),a.allItemsArePro=a.available.every(function(e){return!!isDefined(e.is_pro)&&e.is_pro}),i.hasAvailableItems=i.available.length>0,a.hasAvailableItems=a.available.length>0,i.hasUnavailableItems=i.unavailable.length>0,a.hasUnavailableItems=a.unavailable.length>0,i.hasTriggers=i.hasAvailableItems||i.unavailable.length>0,a.hasActions=a.hasAvailableItems||a.unavailable.length>0,UncannyAutomator.integrations[n].items={triggers:i,actions:a}})}function sortArrayOfObjectsAlphabetically(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2];return isDefined(n)||(n=function(e){return e}),Array.isArray(e)&&!isEmpty(e)&&(e=e.sort(function(e,i){var a=0;if(isDefined(e[t])&&isDefined(i[t])){var o=n(e[t]),r=n(i[t]);a=o.localeCompare(r),a=a>0?1:a,a=a<0?-1:a}return a})),e}function getItemsByIntegration(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"triggers",n=arguments[2];n=Object.assign({addDeprecatedItems:!1},n);var i={available:{},unavailable:{}};return t="trigger"==t?"triggers":t,t="action"==t?"actions":t,["triggers","actions"].includes(t)&&(isEmpty(e)||isDefined(UncannyAutomator.integrations[e])&&(i=$.extend(!0,{},UncannyAutomator.integrations[e].items[t]),n.addDeprecatedItems||(i=filterDeprecatedItems(i)))),i}function filterDeprecatedItems(e){return e.available=e.available.filter(function(e){return!e.is_deprecated}),e.hasAvailableItems=e.available.length>0,isDefined(e.hasTriggers)?e.hasTriggers=e.hasAvailableItems||e.unavailable.length>0:isDefined(e.hasActions)&&(e.hasActions=e.hasAvailableItems||e.unavailable.length>0),e.allItemsArePro=e.available.every(function(e){return!!isDefined(e.is_pro)&&e.is_pro}),e}function userSelectorObject(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,i=["set-step","get-step","set-source","update-fields","reset-fields"];UncannyAutomator.recipe.userSelector;if(isDefined(e)&&inArray(e,i)){var a=[];switch(e){case"set-step":if(a=["step"],inArray(a,Object.keys(t)))UncannyAutomator.recipe.userSelector.step=t.step;else{var o=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["userSelectorObject",o]))}break;case"get-step":var r="select-source";isDefined(UncannyAutomator.recipe.userSelector.step)?r=UncannyAutomator.recipe.userSelector.step:isEmpty(UncannyAutomator.recipe.userSelector.fields[UncannyAutomator.recipe.userSelector.source])||(r="show-sentence",UncannyAutomator.recipe.userSelector.isValid=!0),n=r;break;case"set-source":if(a=["source"],inArray(a,Object.keys(t)))UncannyAutomator.recipe.userSelector.source=t.source;else{var s=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["userSelectorObject",s]))}break;case"update-fields":if(a=["source","fields"],inArray(a,Object.keys(t)))["existingUser","newUser"].includes(t.source)?(isEmpty(UncannyAutomator.recipe.userSelector.fields)&&(UncannyAutomator.recipe.userSelector.fields={existingUser:{},newUser:{}}),UncannyAutomator.recipe.userSelector.fields[t.source]=$.extend({},UncannyAutomator.recipe.userSelector.fields[t.source],t.fields)):console.error(vsprintf("%s: The source parameter is invalid. Valid values are: %s",["userSelectorObject",["existingUser","newUser"]]));else{var l=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["userSelectorObject",l]))}break;case"reset-fields":UncannyAutomator.recipe.userSelector.fields={existingUser:{},newUser:{}}}}else console.error(vsprintf('%s: The action "%s" isn\'t defined',["userSelectorObject",e]));return n}function filterAutomatorItemsByRecipeType(){["user","anonymous"].includes(UncannyAutomator.recipe.type)&&(UncannyAutomator.dev.debugMode&&(consoleLogLabel("Filter Automator items",!0,{collapseGroup:!0}),console.log(vsprintf("Current recipe type: %s",[UncannyAutomator.recipe.type]))),UncannyAutomator.triggers=UncannyAutomator.triggers.filter(function(e){return UncannyAutomator.dev.debugMode&&(console.log(e),e.type==UncannyAutomator.recipe.type?consoleLogResult("success","Keep"):consoleLogResult("error","Remove")),e.type==UncannyAutomator.recipe.type}),UncannyAutomator.dev.debugMode&&console.groupEnd())}function restCall(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=["add","delete","update","change_post_status","recipe_completions_allowed","change_post_title","change_post_recipe_type","user-selector","set_recipe_terms"];a=$.extend({},{requiresRecipesObject:!0,renderUI:!0},a),inArray(e,o)?$.ajax({method:"POST",url:UncannyAutomator.restURL+"/"+e+"/",data:$.param(t)+"&"+$.param({doing_rest:1}),dataType:"json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",UncannyAutomator.nonce)},success:function(o){UncannyAutomator.dev.debugMode&&(consoleLogLabel("REST call ✅",!0,{collapseGroup:!0}),console.log("Endpoint: "+e),console.log("Data:"),console.log(t),console.log("Response:"),console.log(o),console.groupEnd()),o.success?isDefined(o.recipes_object)||!a.requiresRecipesObject?isDefined(n)&&(a.renderUI&&recipeObject("create",{allRecipes:o.recipes_object}),n(o)):(console.error("The call was successful, but the new recipes_object is missing."),isDefined(i)&&i(o)):(console.error("The call was successful, but there were errors."),isDefined(i)&&i(o))},statusCode:{403:function(e){UncannyAutomator.dev.debugMode&&(consoleLogLabel("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%c403: Access denied","color: red"),console.groupEnd()),isDefined(i)&&i(e)}},error:function(e,n,a){UncannyAutomator.dev.debugMode&&(consoleLogLabel("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),isDefined(i)&&i({success:!1})},fail:function(e){UncannyAutomator.dev.debugMode&&(consoleLogLabel("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),isDefined(i)&&i(e)}}):console.error(vsprintf("The %s endPoint does not exists. The valid endpoints are %s",[e,o.join(", ")]))}function AJAXRequest(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;isDefined(e)?(t=$.extend(!0,t,{action:e,nonce:UncannyAutomator.nonce}),$.ajax({method:"POST",dataType:"json",url:ajaxurl,data:t,success:function(e){UncannyAutomator.dev.debugMode&&(consoleLogLabel("AJAX call ✅",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log(e),console.groupEnd()),isDefined(e.status)&&"auth-failed"==e.status?location.reload():isDefined(n)&&n(e,t)},statusCode:{403:function(){UncannyAutomator.dev.debugMode&&(consoleLogLabel("AJAX call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),consoleLogLabel("403: Access denied",!1,{bgColor:"#ff0000"}),console.groupEnd()),isDefined(i)&&i(response),isDefined(i)&&i(response)}},fail:function(e){UncannyAutomator.dev.debugMode&&(consoleLogLabel("AJAX call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),isDefined(i)&&i(e)}})):console.error("We cannot do this AJAX request. {action} is not defined.")}function getCurrentFieldsValues(e){var t={};return $.each(UncannyAutomator.recipe.items[e].options,function(e,n){$.each(n.fields,function(e,n){var i=n.getFieldID(),a=n.getValue();isDefined(a)||(a=n.getAttributes().currentValue),"select"==n.getAttributes().fieldType&&"automator_custom_value"==a&&(t[i+"_custom"]=n.getSelectCustomValue()),t[i]=a,isEmpty(a)||"select"!=n.getAttributes().fieldType||(t[i+"_readable"]=n.getReadableValue())})}),t}function getField(e,t){var n=void 0;return $.each(UncannyAutomator.recipe.items[e].options,function(e,i){$.each(i.fields,function(e,i){t==i.getFieldID()&&(n=i)})}),n}function getGlobalItem(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=void 0;if(!isEmpty(e)&&!isEmpty(t)&&!isEmpty(n)){var a={};if("trigger"==t||"action"==t){if(isDefined(UncannyAutomator.integrations[e])){var o=UncannyAutomator.integrations[e];isDefined(o.items)?a="trigger"==t?o.items.triggers.available:o.items.actions.available:console.log("%cNot ready, who is calling this?","background: red; color: #fff; font-weight: 500; padding: 2px 6px;")}}else"closure"==t&&(a=UncannyAutomator.closures);$.each(a,function(e,t){if(t.code==n)return i=t,!1})}return i}function getDOMElements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=["metabox","items","item","optionGroup","lastItem","user-selector"];if(isDefined(e)&&inArray(e,i)){var a=[];switch(e){case"metabox":if(t=$.extend({},t),a=["type"],inArray(a,Object.keys(t))){t.cssSelector__metabox,"trigger"==t.type?t.cssSelector__metabox="#recipe-triggers-ui":"action"==t.type&&(t.cssSelector__metabox="#recipe-actions-ui");n=$(t.cssSelector__metabox)}else{var o=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",o]))}break;case"items":if(t=$.extend({},t),a=["type"],inArray(a,Object.keys(t))){n=getDOMElements("metabox",{type:t.type}).find(".item:not(.item--user-selector):not(.item--start):not(.item--closure)")}else{var r=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",r]))}break;case"item":if(t=$.extend({},t),a=["id"],inArray(a,Object.keys(t))){t.cssSelector='.uap .item[data-id="'+t.id+'"]';var s=$(t.cssSelector),l=s.find(".item__content");n.item=s,n.contentContainer=l}else{var c=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",c]))}break;case"optionGroup":if(t=$.extend({},t),a=["itemID","groupID"],inArray(a,Object.keys(t))){var u=getDOMElements("item",{id:t.itemID}).item;t.cssSelector__tokenInSentence='.item-title__token[data-token-id="'+t.groupID+'"]',t.cssSelector__fieldsContainer='.item-options__group[data-optiongroup="'+t.groupID+'"]';var d=u.find(t.cssSelector__tokenInSentence),p=u.find(t.cssSelector__fieldsContainer),m=u.find(".item-options");n.tokenInSentence=d,n.fieldsContainer=p,n.optionsContainer=m}else{var f=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",f]))}break;case"lastItem":if(t=$.extend({},t),a=["type"],inArray(a,Object.keys(t))){n=getDOMElements("metabox",{type:t.type}).find(".item:not(.item--user-selector):not(.item--start):not(.item--closure)").last()}else{var v=JSON.stringify(arrayDifference(t,a));console.error(vsprintf("%s: Some attributes are missing: %s",["itemsObject",v]))}break;case"user-selector":n=$(".user-selector")}}else console.error(vsprintf('%s: The element "%s" isn\'t defined',["getDOMElements",e]));return n}function getTokens(itemType,dataType){var tokensList=[],commonTokens={id:"common",name:UncannyAutomator.i18n.tokens.global.common,icon:"uo-icon--bolt",tokens:[{id:"site_name",type:"text",name:UncannyAutomator.i18n.tokens.global.siteName}]};("anonymous"!=UncannyAutomator.recipe.type||"trigger"!=itemType&&"user-selector"!=itemType)&&commonTokens.tokens.push({id:"user_id",type:"int",name:UncannyAutomator.i18n.tokens.global.userID},{id:"user_username",type:"text",name:UncannyAutomator.i18n.tokens.global.userUsername},{id:"user_firstname",type:"text",name:UncannyAutomator.i18n.tokens.global.userFirstName},{id:"user_lastname",type:"text",name:UncannyAutomator.i18n.tokens.global.userLastName},{id:"user_email",type:"email",name:UncannyAutomator.i18n.tokens.global.userEmail},{id:"user_displayname",type:"text",name:UncannyAutomator.i18n.tokens.global.userDisplay},{id:"reset_pass_link",type:"url",name:UncannyAutomator.i18n.tokens.global.userResetPassLink}),commonTokens.tokens.push({id:"admin_email",type:"email",name:UncannyAutomator.i18n.tokens.global.adminEmail},{id:"site_url",type:"url",name:UncannyAutomator.i18n.tokens.global.siteUrl},{id:"recipe_name",type:"text",name:UncannyAutomator.i18n.tokens.global.recipeName},{id:"current_date",type:"text",name:UncannyAutomator.i18n.tokens.global.currentDate},{id:"current_time",type:"text",name:UncannyAutomator.i18n.tokens.global.currentTime}),tokensList.push(commonTokens);var tokens=[];if(("anonymous"!=UncannyAutomator.recipe.type||"trigger"!=itemType&&"user-selector"!=itemType)&&(tokens.push({id:"USERMETA:KEY",type:"text",name:UncannyAutomator.i18n.tokens.global.userMetaKey}),isDefined(UncannyAutomator.wp)&&"1"===UncannyAutomator.wp&&tokens.push({id:"AUTOLOGINLINK",type:"text",name:UncannyAutomator.i18n.tokens.global.autoLoginLink})),tokens.length){var tokensGroupAdvanced={id:"advanced",name:UncannyAutomator.i18n.tokens.global.advanced,icon:"uo-icon--bolt",tokens:tokens};tokensList.push(tokensGroupAdvanced)}var items={};if(isDefined(itemType)?("action"!=itemType&&"closure"!=itemType&&"user-selector"!=itemType||(items=$.extend({},items,itemsObject("get",{filter:{itemType:"trigger"}}))),"closure"==itemType&&(items=$.extend({},items,itemsObject("get",{filter:{itemType:"action"}})))):items=jQuery.extend(!0,{},UncannyAutomator.recipe.items),$.each(items,function(itemId,item){var itemTokens=[];$.each(item.options,function(e,t){$.each(t.fields,function(e,t){var n=t.getAttributes();"repeater"==n.fieldType?t.fieldRows.forEach(function(e,t){var i=t;e.forEach(function(e){itemTokens.push({id:item.id+":"+item.itemCode+":"+n.optionCode+":"+i+":"+e.getAttributes().optionCode,name:n.tokenName+" - "+vsprintf(UncannyAutomator.i18n.rowNumber,[i+1])+" - "+e.getAttributes().tokenName,type:"select"==e.getAttributes().fieldType||"textarea"==e.getAttributes().fieldType?"text":e.getAttributes().fieldType,value:e.getValue(),fieldId:e.getAttributes().optionCode})})}):"group"==n.fieldType||(n.relevant_tokens?$.each(n.relevant_tokens,function(e,i){itemTokens.push({id:item.id+":"+item.itemCode+":"+e,name:i,type:"select"==n.fieldType||"textarea"==n.fieldType?"text":n.fieldType,value:t.getValue(),fieldId:n.optionCode})}):itemTokens.push({id:item.id+":"+item.itemCode+":"+n.optionCode,name:n.tokenName,type:"select"==n.fieldType||"textarea"==n.fieldType?"text":n.fieldType,value:t.getValue(),fieldId:n.optionCode}))})}),$.each(item.tokens,function(e,t){itemTokens.push({id:item.id+":"+t.tokenIdentifier+":"+t.tokenId,name:t.tokenName,type:isDefined(t.tokenType)?t.tokenType:"text"})});var itemSentence=void 0;itemSentence=item.isMissing?item.sentence:getGlobalItem(item.integrationCode,item.itemType,item.itemCode).sentence;var tokensGroup={id:item.itemCode,name:parseStringWithTokens(item,itemSentence,UncannyAutomator.recipe.items[item.id].meta).html,integrationId:item.integrationCode,tokens:itemTokens},filterTokens=function(e,t){return e};if(!isEmpty(item.filterTokens))try{filterTokens=eval("("+item.filterTokens.replace("<script>","").replace("<\/script>","").trim()+")")}catch(e){console.log(e),console.log(item.filterTokens)}tokensGroup=filterTokens(tokensGroup,item),tokensList.push(tokensGroup)}),isDefined(dataType)&&!inArray(dataType,["text","textarea","url"])){var filteredTokensList=[];$.each(tokensList,function(e,t){var n=[];$.each(t.tokens,function(e,t){t.type="float"!=dataType?t.type:"int"==t.type?"float":t.type,dataType==t.type&&n.push(t)}),n.length>0&&(t.tokens=n,filteredTokensList.push(t))}),tokensList=filteredTokensList}return tokensList}function getFieldTypes(){return["select","textarea","text","url","email","int","float","checkbox","radio","group","repeater"]}function parseStringWithTokens(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={plain:"",brackets:"",html:$("<div/>"),elements:{normal:[],token:[]},parts:[]};if(t=t.trim(),!isEmpty(t)){var a=new RegExp(/\{\{(.*?)\}\}/gm),o=[],r=[],s=t,l=0;t=t.replace(a,function(t,i){var a=i.split(":"),o=a[0],c=a[1],u=isDefined(a[2])?a[2]:c;if(i={type:"token",id:c,text:o,optionsID:u,hasFields:isDefined(e.options[u])},isDefined(n[i.id])){var d=void 0;"automator_custom_value"==n[i.id]&&isDefined(n[vsprintf("%s_custom",[i.id])])?d=n[vsprintf("%s_custom",[i.id])]:isDefined(n[vsprintf("%s_readable",[i.id])])&&(d=n[vsprintf("%s_readable",[i.id])]),i.originalText=i.text,i.text=isDefined(d)?d:n[i.id]}return r.push(i),s=s.replace(t,"{{token:"+l+"}}"),l++,"{{v}}"});var c=t.split("{{v}}"),u=0;$.each(c,function(e,t){if(""!=t){var n={type:"normal",text:t};o.push(n),s=s.replace(t,"{{normal:"+u+"}}"),u++}});for(var d=void 0;null!==(d=a.exec(s));){var p=d[1].split(":");p={type:p[0],index:p[1]},"normal"==p.type?i.parts.push(o[p.index]):i.parts.push(r[p.index])}$.each(i.parts,function(t,n){if(i.plain+=n.text," "!=n.text){var a=void 0,o=n.text,r=" "==o[0];r&&(o=o.slice(1));var s=" "==o[o.length-1];if(s&&(o=o.slice(0,-1)),"normal"==n.type||"token"==n.type&&!n.hasFields&&!e.isMissing)a={class:"item-title__normal"},i.brackets+=n.text;else{if(a={class:"item-title__token","data-token-id":n.id,"data-options-id":n.optionsID},isDefined(e.options[n.optionsID])&&e.options[n.optionsID].isValid&&(a.class+=" item-title__token--filled"),isDefined(n.originalText)){var l=abbreviateText(o,30);l.isAbbreviated&&(a["uap-tooltip"]=o,o=l.text)}i.brackets+="{{"+decodeEntities(o)+"}}"}var c=$("<span/>",a).text(decodeEntities(o));i.elements[n.type].push(c),i.html.append(c)}else i.brackets+=n.text}),i.elements.normal=$(i.elements.normal).map(function(){return this.get()}),i.elements.token=$(i.elements.token).map(function(){return this.get()}).filter(":not(.item-title__normal)")}return i}function isDefined(e){return void 0!==e&&null!==e}function isEmpty(e){var t=!0;return isDefined(e)&&(t=$.isArray(e)?0==e.length:isObject(e)?$.isEmptyObject(e):""==e),t}function compareStrings(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{caseSensitive:!0};return n.caseSensitive?e.toString()==t.toString():e.toString().toLowerCase()==t.toString().toLowerCase()}function inArray(e,t){return Array.isArray(e)?0==arrayDifference(e,t).length:-1!==$.inArray(e,t)}function arrayDifference(e,t){return $(e).not(t).get()}function vsprintf(e,t){return(0,__webpack_require__(26).vsprintf)(e,t)}function isString(e){return"string"==typeof e}function isObject(e){return null!==e&&"object"===(void 0===e?"undefined":_typeof(e))}function removeSpaces(e){return e.replace(/\s/g,"")}function replaceCurlyBraces(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e=e.replace(/{{/g,t),e=e.replace(/}}/g,n)}function consoleLogLabel(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};isDefined(n.bgColor)||(n.bgColor="#0790e8");var i="background: "+n.bgColor+'; color: #fff; font-weight: 500; padding: 2px 6px; font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;';t?isDefined(n.collapseGroup)&&n.collapseGroup?console.groupCollapsed("%c🤖Automator",i,e):console.group("%c🤖Automator",i,e):console.log("%c🤖Automator",i,e)}function consoleLogResult(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n='color: #fff; padding: 2px 7px; font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; font-weight: normal';"error"==e&&(n="background: #f13c3c; "+n),"success"==e&&(n="background: #40b528; "+n),console.log("%c"+t,n)}function escapeHTML(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={"&":"&amp;","<":"&lt;",">":"&gt;"},n=function(e){return t[e]||e};return e.replace(/[&<>]/g,n)}function abbreviateText(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n={isAbbreviated:!1,text:e};if(e.length>t){var i=Math.floor(t/2),a={start:e.substring(0,i),end:e.slice(-i)};n.text=a.start+" ... "+a.end,n.isAbbreviated=!0}return n}function getUniqueId(){return"_"+Math.random().toString(36).substr(2,9)}function addParametersToURL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};isEmpty(e)&&(e=window.location.href);try{e=new URL(e)}catch(t){return e}var i=e.search.substr(1).split("&"),a=!0,o=!1,r=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=_slicedToArray(s.value,2),u=c[0],d=c[1];u=encodeURI(u),d=encodeURI(d);for(var p=i.length,m=void 0;p--;)if(m=i[p].split("="),m[0]==u){m[1]=d,i[p]=m.join("=");break}p<0&&(i[i.length]=[u,d].join("="))}}catch(e){o=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw r}}if(i=i.filter(function(e){return!isEmpty(e)}),e.search=i.join("&"),n=$.extend({},{setAsURL:!1,refresh:!1},n),n.setAsURL)if(n.refresh)window.location.href=e.href;else{var f=document.title;window.history.pushState({},f,e.href)}return e.href}function decodeEntities(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("textarea");return t.innerHTML=e,t.value}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var n=[],i=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.createDataOnLoad=createDataOnLoad,exports.recipeObject=recipeObject,exports.itemsObject=itemsObject,exports.groupItemsByIntegration=groupItemsByIntegration,exports.sortArrayOfObjectsAlphabetically=sortArrayOfObjectsAlphabetically,exports.getItemsByIntegration=getItemsByIntegration,exports.filterDeprecatedItems=filterDeprecatedItems,exports.userSelectorObject=userSelectorObject,exports.filterAutomatorItemsByRecipeType=filterAutomatorItemsByRecipeType,exports.restCall=restCall,exports.AJAXRequest=AJAXRequest,exports.getCurrentFieldsValues=getCurrentFieldsValues,exports.getField=getField,exports.getGlobalItem=getGlobalItem,exports.getDOMElements=getDOMElements,exports.getTokens=getTokens,exports.getFieldTypes=getFieldTypes,exports.parseStringWithTokens=parseStringWithTokens,exports.isDefined=isDefined,exports.isEmpty=isEmpty,exports.compareStrings=compareStrings,exports.inArray=inArray,exports.arrayDifference=arrayDifference,exports.vsprintf=vsprintf,exports.isString=isString,exports.isObject=isObject,exports.removeSpaces=removeSpaces,exports.replaceCurlyBraces=replaceCurlyBraces,exports.consoleLogLabel=consoleLogLabel,exports.consoleLogResult=consoleLogResult,exports.escapeHTML=escapeHTML,exports.abbreviateText=abbreviateText,exports.getUniqueId=getUniqueId,exports.addParametersToURL=addParametersToURL,exports.decodeEntities=decodeEntities;var _Validation=__webpack_require__(5),_RecipeTypeSelector=__webpack_require__(14),_RecipeTypeSelector2=_interopRequireDefault(_RecipeTypeSelector),_Field=__webpack_require__(3),_Field2=_interopRequireDefault(_Field),_FieldsGroup=__webpack_require__(23),_FieldsGroup2=_interopRequireDefault(_FieldsGroup),_FieldsRepeater=__webpack_require__(24),_FieldsRepeater2=_interopRequireDefault(_FieldsRepeater)}).call(exports,__webpack_require__(1),__webpack_require__(1))},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(27),s=i(r),l=n(10),c=i(l),u=n(16),d=i(u),p=n(30),m=i(p),f=n(31),v=i(f),h=function e(){a(this,e),(0,o.getDOMElements)("metabox",{type:"action"}).empty(),"anonymous"==UncannyAutomator.recipe.type&&(0,o.isDefined)(UncannyAutomator.wp)&&UncannyAutomator.wp&&new s.default;var t=(0,o.itemsObject)("get",{filter:{itemType:"action"}});(0,o.isEmpty)(t)?new m.default("action"):new c.default("action"),new d.default("action"),new v.default};t.default=h},function(e,t,n){"use strict";(function(e,i){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(5),l=function(){function t(e,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;a(this,t),this.type=e,this.attributes=this.setAttributes(n),this.customValidationFunction=o,i&&this.createFormElement()}return o(t,[{key:"createFormElement",value:function(){var n=null,i=this.type,a=this.attributes;if((0,r.inArray)(i,(0,r.getFieldTypes)())){var o=e("<div/>",{class:"form-element"});(0,r.isDefined)(a.formElementClass)&&o.addClass(a.formElementClass);var s={name:a.optionCode,id:a.uniqueFieldID,"data-isajax":a.isAjax,"data-targetfield":a.targetField,"data-integrationid":a.integrationID,"data-endPoint":a.endPoint,"data-supportsTokens":a.supportsTokens,"data-supportsTinymce":a.supportsTinyMCE,"data-required":a.isRequired,"data-item_type":a.itemType,"data-item-id":a.itemId,"data-option-group":a.groupId,"data-is-hidden":a.isHidden,"data-is-child-field":a.isChildField},l=void 0,c=void 0;switch(i){case"select":l=e("<div/>",{class:"form-select"}),this.fieldContainer=l,c=e("<select/>",e.extend({},s,{"data-type":"select",class:"form-element__select","data-supports-custom-value":a.supportsCustomValue})),a.supportsMultipleValues&&c.prop("multiple","multiple"),this.field=c;var u=!1,d=0,p=void 0,m=void 0;a.hasDefaultValue&&(p=(0,r.isEmpty)(a.defaultValue.option_value)||(0,r.isEmpty)(a.defaultValue.option_name)?a.defaultValue:a.defaultValue.option_value);var f=e('<optgroup\n\t\t\t\t\t\t\ttitle="form-element__select-normal-options"\n\t\t\t\t\t\t\tclass="form-element__select-normal-options">\n\t\t\t\t\t\t</optgroup>');if(a.options=a.options.filter(function(e){return"automator_custom_value"!==e.value}),e.each(a.options,function(t,n){var i=e("<option/>",{value:n.value,text:n.text});a.hasDefaultValue&&(0,r.compareStrings)(p,t)&&(i.prop("selected",!0),m=!0,u=!0),a.hasValue&&(0,r.compareStrings)(a.currentValue,n.value)&&(i.prop("selected",!0),u=!0),i.appendTo(f),d++}),f.appendTo(c),a.supportsMultipleValues){if(!(0,r.isEmpty)(a.currentValue))try{c.val(a.currentValue)}catch(e){}(0,r.isEmpty)(c.val())||(u=!0)}if(a.hasDefaultValue&&!m&&!(0,r.isEmpty)(a.defaultValue.option_value)&&!(0,r.isEmpty)(a.defaultValue.option_name)){var v=e("<option/>",{value:a.defaultValue.option_value,text:a.defaultValue.option_name});a.hasValue||(0,r.compareStrings)(a.defaultValue.option_value,a.currentValue)||(v.prop("selected",!0),u=!0),v.prependTo(c),d++}if(a.hasPlaceholder&&(c.prepend("<option></option>"),a.hasDefaultValue||a.hasValue||c.find("option:selected").prop("selected",!1)),a.supportsCustomValue){var h=a.customValue,g=e('\n\t\t\t\t\t\t\t<optgroup label="'+UncannyAutomator.i18n.validation.field.select.otherOptions+'">\n\t\t\t\t\t\t\t\t<option value="automator_custom_value">'+UncannyAutomator.i18n.validation.field.select.customValue+"</option>\n\t\t\t\t\t\t\t</optgroup>\n\t\t\t\t\t\t");c.append(g),a.hasValue&&(0,r.compareStrings)(a.currentValue,"automator_custom_value")&&(g.find("option").attr("selected",!0),u=!0),a.hasValue&&!u&&(g.find("option").attr("selected",!0),u=!0,h=a.currentValue),this.customValueField=new t("text",{itemId:a.itemId,itemType:a.itemType,isRequired:a.isRequired,isReadOnly:!1,supportsTinyMCE:!1,supportsCopyToClipboard:!1,supportsTokens:a.supportsTokens,isAjax:!1,fieldType:"text",optionCode:a.optionCode+"_custom",label:"",description:a.hasCustomValueDescription?a.customValueDescription:void 0,placeholder:"",isHidden:!1,tokenName:(0,r.vsprintf)(UncannyAutomator.i18n.validation.field.select.customValueToken,[a.label]),defaultValue:null,currentValue:h,isChildField:!0,parentOptionCode:a.optionCode})}if(this.selectHasSelectedOption=u,0==d){var y=e(new Option(UncannyAutomator.i18n.noResults,"",!0,!0));y.prop("disabled",!0),this.field.find(".form-element__select-normal-options").append(y),this.attributes.supportsCustomValue||this.field.prop("disabled",!0)}c.on("change",function(e,t){o.trigger("automator:field:change",t)});break;case"text":case"url":case"email":case"int":case"float":l=e("<div/>",{class:"form-input form-input--"+i}),this.fieldContainer=l,c=e("<input/>",e.extend({},s,{class:"form-element__input",type:"text","data-type":i})),(0,r.isDefined)(a.maxLength)&&c.prop("maxlength",a.maxLength),this.field=c,a.supportsTokens&&l.addClass("form-input--token"),a.hasPlaceholder&&c.prop("placeholder",a.placeholder),a.hasValue?c.prop("value",a.currentValue):a.hasDefaultValue&&c.prop("value",a.defaultValue),c.on("input",function(){o.trigger("automator:field:change")});break;case"textarea":l=e("<div/>",{class:"form-textarea"}),this.fieldContainer=l,c=e("<textarea/>",e.extend(!0,s,{"data-type":"text",class:"form-element__textarea","data-item_type":a.itemType})),(0,r.isDefined)(a.maxLength)&&c.prop("maxlength",a.maxLength),this.field=c,a.supportsTokens&&l.addClass("form-textarea--token"),a.hasPlaceholder&&c.prop("placeholder",a.placeholder),a.hasValue?c.text(a.currentValue):a.hasDefaultValue&&c.text(a.defaultValue),c.on("input",function(){o.trigger("automator:field:change")});break;case"checkbox":l=e("<div/>",{class:"form-checkbox"}),this.fieldContainer=l;var b=e("<label/>",{class:"form-checkbox__container"}),_=e("<div/>",{class:"checkbox--show"});if(c=e("<input/>",e.extend({},s,{type:"checkbox","data-type":"checkbox",class:"checkbox--hidden checkbox--primary"})),a.hasValue&&a.currentValue&&c.prop("checked",!0),this.field=c,a.hasLabel&&b.text(a.label),l.append(b),b.append(c),b.append(_),(0,r.isDefined)(a.isToggle)&&a.isToggle&&(l.addClass("form-checkbox--toggle"),(0,r.isDefined)(a.toggle))){if((0,r.isDefined)(a.toggle.on)){var k=e("<span/>",{class:"checkbox-label checkbox-label--on"}).text(a.toggle.on);b.append(k)}if((0,r.isDefined)(a.toggle.off)){var w=e("<span/>",{class:"checkbox-label checkbox-label--off"}).text(a.toggle.off);b.append(w)}}if((0,r.isDefined)(a.color))if((0,r.inArray)(a.color,["gutenberg","green"]))switch(a.color){case"gutenberg":l.addClass("form-checkbox--toggle-gutenberg");break;case"green":l.addClass("form-checkbox--toggle-green")}else console.error((0,r.vsprintf)("The color %s does not exists. Default color will be used instead.",[a.color]));(0,r.isDefined)(a.align)&&((0,r.inArray)(a.align,["left","right"])?"right"==a.align&&l.addClass("form-checkbox--toggle-right"):console.error((0,r.vsprintf)("The alignment %s does not exists. %s will be used instead.",[a.align,'"left"']))),c.on("change",function(e,t){o.trigger("automator:field:change",t)}),c=b;break;case"radio":l=e("<div/>",{class:"form-radio"}),this.fieldContainer=l;var A=e(),U=e();e.each(a.options,function(t,n){var i=e("<label/>",{class:"form-radio__container"});i.text(n.text);var o=e("<input/>",e.extend({},s,{type:"radio","data-type":"radio",class:"radio--hidden radio--primary",value:n.value,name:s.id}));A=A.add(o);var r=e("<div/>",{class:"radio--show"});i.append(o),i.append(r),a.hasValue&&a.currentValue==n.value?o.prop("checked",!0):!a.hasValue&&a.hasDefaultValue&&a.defaultValue==n.value&&o.prop("checked",!0),U=U.add(i)}),this.field=U,c=U,A.on("change",function(e,t){o.trigger("automator:field:change",t)})}if(a.supportsTokens&&"select"!=a.fieldType){var T=e("<div/>",{class:"form-variable"}),x=e("<div/>",{class:"form-variable__element"}),C=e("<div/>",{class:"form-variable__render-container"}),D=e("<div/>",{class:"form-variable__toggle"}),E=e("<span/>",{class:"uo-icon uo-icon--asterisk"});C.append(c),x.append(C),D.append(E),x.append(D),T.append(x);var S=e("<div/>",{class:"form-variable__dropdown"});T.append(S),c=T}l.append(c);var V=void 0;if("checkbox"!=i&&(a.hasLabel||a.isRequired)&&(V=e("<label/>",{class:"form-element__label",for:a.optionCode}),a.hasLabel&&V.text(a.label)),a.isRequired)if(l.addClass("form-element--required"),"checkbox"==a.fieldType){if(c.find("input").prop("required",!0),a.hasLabel){var O=e("<span/>",{class:"form-element-label__required"});c.append(O)}}else if(c.prop("required",!0),a.hasLabel){var I=e("<span/>",{class:"form-element-label__required"});V.append(I)}(0,r.isDefined)(a.isReadOnly)&&a.isReadOnly&&("select"==a.fieldType?c.prop("disabled",!0):["checkbox","radio"].includes(a.fieldType)?c.find("input").prop("disabled",!0):c.prop("readonly",!0)),(a.hasLabel||a.isRequired)&&l.prepend(V);var R=e("<div/>",{class:"form-element__error"});if(l.append(R),this.fieldContainer=l,a.hasDescription){var L=e("<div/>",{class:"description"});L.html(a.description),l.append(L)}a.isHidden&&l.addClass("form-element--hidden"),o.append(l),"select"==a.fieldType&&(0,r.isDefined)(this.customValueField)&&(this.customValueFieldContainer=e('<div class="form-select-custom">\n\t\t\t\t\t\t<div class="form-element-children"></div>\n\t\t\t\t\t</div>'),this.customValueFieldContainer.find(".form-element-children").append(this.customValueField.createFormElement()),o.append(this.customValueFieldContainer),"automator_custom_value"==this.getValue()?this.customValueFieldContainer.addClass("form-select-custom--visible"):this.customValueFieldContainer.removeClass("form-select-custom--visible")),n=o,this.formElement=o,this.initLibraries(),this.onChange(),this.onFocus()}else console.error((0,r.vsprintf)("The field type %s is invalid. The valid ones are %s",[i,(0,r.getFieldTypes)().join(", ")]));return n}},{key:"setAttributes",value:function(e){if(e.uniqueFieldID=e.optionCode+"__"+(0,r.getUniqueId)(),"checkbox"!=e.fieldType||(0,r.isEmpty)(e.currentValue)||["true","false"].includes(e.currentValue)&&(e.currentValue="true"==e.currentValue,e.currentValue?e.hasValue=!0:e.hasValue=!1),(0,r.isDefined)(e.hasValue)||((0,r.isEmpty)(e.currentValue)?e.hasValue=!1:e.hasValue=!0),(0,r.isDefined)(e.hasPlaceholder)||((0,r.isEmpty)(e.placeholder)?e.hasPlaceholder=!1:e.hasPlaceholder=!0),(0,r.isDefined)(e.hasDefaultValue)||((0,r.isEmpty)(e.defaultValue)?e.hasDefaultValue=!1:e.hasDefaultValue=!0),(0,r.isDefined)(e.hasLabel)||((0,r.isEmpty)(e.label)?e.hasLabel=!1:e.hasLabel=!0),(0,r.isDefined)(e.hasDescription)||((0,r.isEmpty)(e.description)?e.hasDescription=!1:e.hasDescription=!0),(0,r.isDefined)(e.isRequired)||(e.isRequired=!1),(0,r.isDefined)(e.isChildField)||(e.isChildField=!1),(0,r.isDefined)(e.supportsTokens)||(e.supportsTokens=!1),e.supportsTokens&&"select"==e.fieldType&&!["action","closure"].includes(e.itemType)&&(e.supportsTokens=!1),"select"==e.fieldType){if((0,r.isDefined)(e.supportsMultipleValues)||(e.supportsMultipleValues=!1),e.supportsMultipleValues&&(e.supportsCustomValue=!1),e.supportsMultipleValues)try{e.currentValue=JSON.parse(e.currentValue)}catch(e){}(0,r.isDefined)(e.supportsCustomValue)||(e.supportsCustomValue=!1),e.hasCustomValueDescription=!(0,r.isEmpty)(e.customValueDescription)}return(0,r.isDefined)(e.supportsTinyMCE)||(e.supportsTinyMCE=!1),!(0,r.isDefined)(e.isToggle)&&(0,r.isDefined)(e.toggle)&&(e.isToggle=!0),(0,r.isDefined)(e.isAjax)||(e.isAjax=!1),(0,r.isDefined)(e.isHidden)||(e.isHidden=!1),e}},{key:"validate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=null,n=void 0;e?(t=this.getFieldContainer(),n=this.getValue()):n=this.attributes.currentValue;var i=(this.type,{supportsTokens:this.attributes.supportsTokens,required:this.attributes.isRequired});return(0,s.validateField)(t,this.type,n,i,this.customValidationFunction)}},{key:"onChange",value:function(){var e=this;this.formElement.on("automator:field:change",function(t,n){"select"==e.attributes.fieldType&&e.attributes.supportsCustomValue&&("automator_custom_value"==e.getValue()?e.customValueFieldContainer.addClass("form-select-custom--visible"):e.customValueFieldContainer.removeClass("form-select-custom--visible"));var i=function(){if(e.attributes.isAjax&&e.attributes.targetField!==e.attributes.optionCode&&e.doAJAX(),(0,r.isDefined)(e.attributes.isChildField)&&e.attributes.isChildField&&(0,r.isDefined)(e.attributes.parentOptionCode)){var t=(0,r.getField)(e.attributes.itemId,e.attributes.parentOptionCode);(0,r.isDefined)(t)&&t.doAJAX()}};if(e.attributes.isAjax&&(0,r.isDefined)(e.attributes.targetField)&&e.attributes.targetField!==e.attributes.optionCode&&(e.attributes.completedFirstLoad||(0,r.isEmpty)(e.attributes.currentValue)&&!e.attributes.hasDefaultValue&&!e.attributes.completedFirstLoad)){var a=(0,r.getField)(e.attributes.itemId,e.attributes.targetField);a.setValue(null,!1),a.setCustomValue(null,!1)}return["select","radio","checkbox"].includes(e.attributes.fieldType)?i():((0,r.isDefined)(e.onChangeTimeout)&&clearTimeout(e.onChangeTimeout),e.onChangeTimeout=setTimeout(function(){i()},1500)),!1})}},{key:"onFocus",value:function(){var t=this;this.field.on("focusin",function(n){t.attributes.isReadOnly&&e(n.currentTarget).select()}),this.field.on("focusout",function(){})}},{key:"isReady",value:function(){var e=!1;return(0,r.isDefined)(UncannyAutomator.recipe.items[this.attributes.itemId])&&(e=!0),e}},{key:"doAJAX",value:function(){var t=this;(0,r.isDefined)(this.getValue())?this.getValue():this.getMetaValue();if(this.attributes.isAjax){var n=this;if(this.attributes.optionCode!=this.attributes.targetField&&(n=(0,r.getField)(this.attributes.itemId,this.attributes.targetField)),!(0,r.isEmpty)(this.attributes.integrationId)&&!(0,r.isEmpty)(this.attributes.endpoint)){this.startLoadingAnimation(),n.startLoadingAnimation();var i=this.getValue(),a=(0,r.isDefined)(n.getValue())?n.getValue():n.getMetaValue();(0,r.AJAXRequest)(this.attributes.endpoint,{recipe_id:UncannyAutomator.recipe.id,integration_id:this.attributes.integrationId,item_id:this.attributes.itemId,group_id:this.attributes.groupId,field_id:this.attributes.optionCode,target_field:this.attributes.targetField,value:i,values:(0,r.getCurrentFieldsValues)(this.attributes.itemId)},function(i){if(t.stopLoadingAnimation(),n.stopLoadingAnimation(),"select"==n.getAttributes().fieldType&&e.isArray(i)){if(t.attributes.isAjax&&(0,r.isDefined)(t.attributes.targetField)&&t.attributes.targetField!==t.attributes.optionCode&&(t.attributes.completedFirstLoad||(0,r.isEmpty)(t.attributes.currentValue)&&!t.attributes.hasDefaultValue&&!t.attributes.completedFirstLoad)&&(a=null),"automator_custom_value"==a){var o=n.getSelectCustomValue();a=(0,r.isEmpty)(o)?null:o}n.setSelectOptions(i,!1),n.setValue(a)}else n.setValue(i);t.attributes.completedFirstLoad=!0})}}}},{key:"getFormElement",value:function(){var e=this;if(this.isReady()){this.attributes.completedFirstLoad=!1;var t=!1;try{t=UncannyAutomator.recipe.items[this.attributes.itemId].options[this.attributes.groupId].fields.reduce(function(t,n){return t||n.attributes.targetField==e.attributes.optionCode&&n.attributes.optionCode!=e.attributes.optionCode&&n.attributes.isAjax},!1)}catch(e){}t||(this.attributes.targetField==this.attributes.optionCode&&this.attributes.isAjax&&this.doAJAX(),this.field.trigger("automator:field:change",{manuallySet:!1}))}return this.formElement}},{key:"getFieldContainer",value:function(){return this.fieldContainer}},{key:"getFieldID",value:function(){return this.attributes.optionCode}},{key:"getField",value:function(){return this.field}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getValue",value:function(){var e=null;if((0,r.isDefined)(this.field))switch(this.type){case"select":case"text":case"url":case"email":case"int":case"float":case"textarea":e=this.field.val();break;case"checkbox":e=this.field.is(":checked");break;case"radio":e=this.field.find("input:checked").val()}return(0,r.isDefined)(this.field)&&(0,r.isDefined)(e)||(this.attributes.hasValue?e=this.attributes.currentValue:this.attributes.hasDefaultValue&&(e=this.attributes.defaultValue)),e}},{key:"getReadableValue",value:function(){var t=this,n=null,i=this.getValue();switch(this.type){case"select":if((0,r.isDefined)(this.field))if(this.attributes.supportsMultipleValues&&e.isArray(i)){n=i.map(function(e){return t.field.find((0,r.vsprintf)('option[value="%s"]',[e])).text()}).join(UncannyAutomator.i18n.itemSeparator+" ")}else n=this.field.find((0,r.vsprintf)('option[value="%s"]',[i])).text();else if(this.attributes.supportsMultipleValues&&e.isArray(i))try{n=i.map(function(e){return t.getSelectOptionByValue(e).text}).join(UncannyAutomator.i18n.itemSeparator+" ")}catch(e){}else try{n=this.getSelectOptionByValue(i).text}catch(e){}break;case"text":case"url":case"email":case"int":case"float":case"textarea":i=e("<p/>").html(i).text();break;case"checkbox":n=i?UncannyAutomator.i18n.trueLabel:UncannyAutomator.i18n.falseLabel;break;case"radio":if((0,r.isDefined)(this.field)){var a=this.field.find("input:checked");if(1==a.length){n=a.closest(".form-radio__container").text().trim()}}else try{n=this.getSelectOptionByValue(i).text}catch(e){}}return n}},{key:"getSelectCustomValue",value:function(){var e=null;if("select"==this.attributes.fieldType&&this.attributes.supportsCustomValue&&"automator_custom_value"==this.getValue())if((0,r.isDefined)(this.customValueField))e=this.customValueField.getValue();else try{e=UncannyAutomator.recipe.items[this.attributes.itemId].meta[this.attributes.optionCode+"_custom"]}catch(e){}return e}},{key:"getSelectOptionByValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null,n=this.attributes.options;return this.attributes.supportsCustomValue&&n.push({value:"automator_custom_value",text:UncannyAutomator.i18n.validation.field.select.customValue}),(0,r.isEmpty)(n)||n.forEach(function(n){e==n.value&&(t=n)}),t}},{key:"getMetaValue",value:function(){var e=void 0;if((0,r.isDefined)(UncannyAutomator.recipe.items[this.attributes.itemId])){var t=UncannyAutomator.recipe.items[this.attributes.itemId].meta[this.attributes.optionCode];(0,r.isDefined)(t)&&(e=t)}return e}},{key:"setValue",value:function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((0,r.isDefined)(this.field))switch(this.type){case"select":(0,r.isDefined)(t)||(t=this.attributes.supportsMultipleValues?[]:"");var a=this.field.find("option");if(this.attributes.supportsMultipleValues)a.prop("selected",!1),e.isArray(t)&&!(0,r.isEmpty)(t)&&(t.forEach(function(e){var t=n.field.find('option[value="'+e+'"]');t.length>0&&t.prop("selected",!0)}),i&&this.field.trigger("change",{manuallySet:!1}));else{var o=this.field.find('option[value="'+t+'"]');o.length>0?(a.prop("selected",!1),o.prop("selected",!0),i&&this.field.trigger("change",{manuallySet:!1})):(a.prop("selected",!1),this.attributes.supportsCustomValue&&!(0,r.isEmpty)(t)&&this.setCustomValue(t,!1),i&&this.field.trigger("change",{manuallySet:!1}))}break;case"text":case"url":case"email":case"int":case"float":case"textarea":this.field.val(t),i&&this.field.trigger("automator:field:change");break;case"checkbox":var s=t,l=this.getValue();s&&!l&&this.field.prop("checked",!0),!s&&l&&this.field.prop("checked",!1),i&&(s&&!l||!s&&l)&&this.field.trigger("automator:field:change");break;case"radio":this.field.filter('[name="'+t+'"]').prop("checked",!0),i&&this.field.trigger("automator:field:change")}}},{key:"setCustomValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"select"==this.attributes.fieldType&&(0,r.isDefined)(this.customValueField)&&(this.field.val("automator_custom_value"),this.customValueField.setValue(e,t),t&&this.field.trigger("change",{manuallySet:!1}))}},{key:"hasSelectedOption",value:function(){return this.selectHasSelectedOption}},{key:"setSelectOptions",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removeSelectOptions();try{t=t.filter(function(e){return(0,r.isDefined)(e.value)&&(0,r.isDefined)(e.text)})}catch(e){}if((0,r.isDefined)(this.field)){var i=this.field.find(".form-element__select-normal-options");if(t.length>0){this.field.prop("disabled",!1);var a=(0,r.isDefined)(this.getValue())?this.getValue():this.getMetaValue(),o=[];e.each(t,function(e,t){var n=new Option(t.text,t.value,!1,!1);i.append(n),o.push(n)}),(0,r.isEmpty)(a)||e.each(this.field.find("option"),function(t,n){n.value==a&&e(n).prop("selected",!0)})}else{var s=e(new Option(UncannyAutomator.i18n.noResults,"",!this.attributes.supportsCustomValue,!this.attributes.supportsCustomValue));s.prop("disabled",!0),i.append(s),this.attributes.supportsCustomValue||this.field.prop("disabled",!0)}n&&this.field.trigger("change"),this.rerenderSelect2()}}},{key:"removeSelectOptions",value:function(){(0,r.isDefined)(this.field)&&this.field.find(".form-element__select-normal-options").empty()}},{key:"isLoading",value:function(){return this.formElement.hasClass("form-element--loading")}},{key:"startLoadingAnimation",value:function(){(0,r.isDefined)(this.formElement)&&!this.formElement.hasClass("form-element--loading")&&(this.formElement.addClass("form-element--loading"),"checkbox"!=this.type||(0,r.isDefined)(this.attributes.isToggle)||this.fieldContainer.addClass("form-checkbox--loading-inline"),this.formElement.trigger("automator:field:loading"))}},{key:"stopLoadingAnimation",value:function(){(0,r.isDefined)(this.formElement)&&this.formElement.hasClass("form-element--loading")&&(this.formElement.removeClass("form-element--loading"),this.fieldContainer.removeClass("form-checkbox--loading-inline"),this.formElement.trigger("automator:field:loading"))}},{key:"initLibraries",value:function(){switch(this.type){case"select":this.initSelect2(this.field);break;case"text":case"url":case"email":case"int":case"float":case"textarea":this.attributes.supportsTokens&&this.initTokenSelector(this.fieldContainer),"url"==this.attributes.fieldType&&(0,s.initURLChecker)(this.fieldContainer)}}},{key:"getSelect2Settings",value:function(){var e={theme:"uap-select2",searchInputPlaceholder:UncannyAutomator.i18n.search,language:{noResults:function(){return UncannyAutomator.i18n.noResults}},templateResult:function(e){var t=e.text;return(0,r.isDefined)(e.id)&&Number.isInteger(parseInt(e.id))&&parseInt(e.id)>0&&(t='<span class="uap-select2-item__meta">('+(0,r.vsprintf)(UncannyAutomator.i18n.postIDPlaceholder,[e.id.replace("-objectkey","")])+")</span> "+e.text),t},templateSelection:function(e){var t=e.text;return(0,r.isDefined)(e.id)&&Number.isInteger(parseInt(e.id))&&parseInt(e.id)>0&&(t='<span class="uap-select2-item__meta">('+(0,r.vsprintf)(UncannyAutomator.i18n.postIDPlaceholder,[e.id.replace("-objectkey","")])+")</span> "+t),t},escapeMarkup:function(e){return e}};return this.attributes.hasPlaceholder&&(e.placeholder=this.attributes.placeholder),e}},{key:"initSelect2",value:function(e){var t=this.getSelect2Settings();e.hasClass("select2-hidden-accessible")||e.select2(t)}},{key:"rerenderSelect2",value:function(){var e=this.getSelect2Settings();!(0,r.isEmpty)(this.field)&&this.field.hasClass("select2-hidden-accessible")&&this.field.select2("destroy").select2(e)}},{key:"initTokenSelector",value:function(e){var t=(0,r.getTokens)(this.attributes.itemType,this.attributes.fieldType);e.TokenSelector(t)}},{key:"initTinyMCE",value:function(){var e=this;this.field;if((0,r.isDefined)(this.field)&&"textarea"==this.attributes.fieldType&&this.attributes.supportsTinyMCE){var t=this.field.prop("id"),n=tinymce.get(t);(0,r.isDefined)(n)&&wp.editor.remove(t),wp.editor.initialize(t,{mediaButtons:!0,tinymce:{wpautop:!0,toolbar1:"formatselect bold italic bullist numlist blockquote alignleft aligncenter alignright link unlink wp_more",toolbar2:"strikethrough hr forecolor pastetext removeformat visualchars outdent indent undo redo"},quicktags:!0}),n=tinymce.get(t),n.on("input change paste",function(){e.field.text(n.getContent())})}}}]),t}();t.default=l,function(e){var t=e.fn.select2.amd.require("select2/defaults");e.extend(t.defaults,{searchInputPlaceholder:""});var n=e.fn.select2.amd.require("select2/dropdown/search"),i=n.prototype.render;n.prototype.render=function(e){var t=i.apply(this,Array.prototype.slice.apply(arguments));return this.$search.attr("placeholder",this.options.get("searchInputPlaceholder")),t}}(window.jQuery),function(e){e.fn.TokenSelector=function(t){return this.each(function(){var n=e(this),i={noResults:UncannyAutomator.i18n.noResults,responsive:{margin:30}},a=n.hasClass("form-input")?"input":"textarea";switch(i.classes={},a){case"input":i.classes.tokenReady="form-input--token-ready",i.classes.field="form-element__input",i.classes.hiddenField="form-element__input--hidden";break;case"textarea":i.classes.tokenReady="form-textarea--token-ready",i.classes.field="form-element__textarea",i.classes.hiddenField="form-element__textarea--hidden";var o=n.find("textarea");i.isTinyMCEinstance=o.data("supportstinymce"),i.TinyMCEinstanceID=o.prop("id")}if(!n.hasClass(i.classes.tokenReady)){var s=(n.find("."+i.classes.field).data("item_type"),{list:t,getTokenList:function(){return this.list},hasTokens:function(){var t=this.list;return!e.isEmptyObject(t)}}),l=s.getTokenList();if(s.hasTokens()){var c={config:{inputHeight:35},init:function(){this.createElement()},createElement:function(){var t=n,a=t.find("."+i.classes.field),o=(a.data("type"),t.find(".form-variable__dropdown")),s=e("<div/>",{class:"form-variable__dropdown-container"}),c=e("<div/>",{class:"form-variable__search"}),u=e("<input/>",{class:"form-variable__search-input",placeholder:UncannyAutomator.i18n.tokens.search});c.append(u);var d=e("<div/>",{class:"form-variable__groups"});e.each(l,function(t,n){var i=e("<div/>",{class:"form-variable__group"}),a=e("<div/>",{class:"form-variable__group-source"}),o=e("<div/>",{class:"form-variable-group-source__icon"}),s=e("<div/>",{class:"form-variable-group-source__description"}),l=e("<div/>",{class:"form-variable-group-source__toggle"}),c=e("<span/>",{class:"form-variable-group-source__toggle-icon"}),u=void 0;if((0,r.isDefined)(UncannyAutomator.integrations[n.integrationId])){var p=UncannyAutomator.integrations[n.integrationId];(0,r.isDefined)(p.icon_svg)?u=e('<img src="'+p.icon_svg+'" alt="'+p.name+'">'):(0,r.isDefined)(p.icon_16)&&(0,r.isDefined)(p.icon_32)&&(u=e('<img src="'+p.icon_16+'" srcset="'+(0,r.vsprintf)("%s 1x, %s 2x",[p.icon_16,p.icon_32])+'" alt="'+p.name+'">'))}else u=e("<i/>",{class:"uo-icon "+n.icon});o.append(u),s.append(n.name),l.append(c),a.append(o),a.append(s),a.append(l);var m=e("<span/>",{class:"form-variable__group-children"});e.each(n.tokens,function(t,n){var i=e("<div/>",{class:"form-variable__group-item","data-token":"{{"+n.id+"}}","data-type":n.type});i.html(n.name),m.append(i)}),i.append(a),i.append(m),d.append(i)});var p=e("<div/>",{class:"form-variable__group-item-no-results form-variable__group-item-no-results--hide"});p.text(i.noResults),d.append(p),s.append(c),s.append(d),o.append(s),t.addClass(i.classes.tokenReady)},getPosition:function(){var t={window:e(window)},n={above:p.container.offset().top-t.window.scrollTop(),below:t.window.height()-(p.container.offset().top-t.window.scrollTop())-this.config.inputHeight};p.dropdown.container_relative.addClass("uo-realsize");var i=p.dropdown.container_relative.height()+75;return p.dropdown.container_relative.removeClass("uo-realsize"),n.hasSpaceBelow="textarea"==a||n.below>=i,n},setDirection:function(){var e=this.getPosition();p.container.removeClass("form-variable--above form-variable--below"),e.below>e.above||e.hasSpaceBelow?(p.container.addClass("form-variable--below"),u.position="below"):(p.container.addClass("form-variable--above"),u.position="above")},setScroll:function(){if(u.open){var e=this.getPosition()[u.position]-this.config.inputHeight-i.responsive.margin;p.dropdown.options.container.css({"max-height":e+"px"})}},addToken:function(e){var t=p.input.get(0).selectionStart,n=t+e.length;if(i.isTinyMCEinstance){var a=tinymce.get(i.TinyMCEinstanceID);if((0,r.isDefined)(a))if(e=(0,r.removeSpaces)(e),p.input.is(":visible")){var o=p.input.val(),s=o.substr(0,t)+e+o.substr(t);p.input.val(s).focus(),p.input.trigger("input"),p.input.get(0).setSelectionRange(n,n)}else a.execCommand("mceInsertContent",!1,e)}else{var l=p.input.val(),c=l.substr(0,t)+e+l.substr(t);p.input.val(c).focus(),p.input.trigger("input"),p.input.get(0).setSelectionRange(n,n)}this.hideDropdown(),this.focusInput()},resetDropdown:function(){p.dropdown.options.groups.removeClass("form-variable__group--hide form-variable__group--open"),p.dropdown.options.groups.removeClass("form-variable__group--open"),p.dropdown.options.items.removeClass("form-variable__group-item--hide"),p.dropdown.options.no_results.addClass("form-variable__group-item-no-results--hide")},hideDropdown:function(){p.container.removeClass("form-variable--open"),u.open=!1,p.dropdown.search_input.val("").trigger("input")},focusInput:function(){p.input.focus()}},u={open:!1,position:null},d={init:function(){this.toggles(),this.insert_tokens(),this.search(),this.resize(),this.mirrorContent()},toggles:function(){var t=this;p.dropdown.button.on("click",function(){p.container.toggleClass("form-variable--open"),u.open=p.container.hasClass("form-variable--open"),u.open?t.bindClicksOutside():e(document).off("mouseup.uap-token-selector-click-outside"),p.dropdown.search_input.val("").trigger("input"),p.dropdown.search_input.focus(),c.setDirection(),c.setScroll()}),p.dropdown.options.groups_title.on("click",function(){e(this).closest(".form-variable__group").toggleClass("form-variable__group--open")})},bindClicksOutside:function(){e(document).on("mouseup.uap-token-selector-click-outside",function(e){var t=p.container;t.is(e.target)||0!==t.has(e.target).length||(p.container.removeClass("form-variable--open"),u.open=!1,p.dropdown.search_input.val("").trigger("input"))})},resize:function(){e(window).resize(function(){c.setScroll()})},insert_tokens:function(){p.dropdown.options.items.on("click",function(){var t=e(this),n=t.data("token");c.addToken(n)})},search:function(){p.dropdown.search_input.on("input",function(){var t=e(this),n=t.val();if(""!=n){n=n.toLowerCase().replace(/\s/g,""),p.dropdown.options.groups.addClass("form-variable__group--open"),p.dropdown.options.groups.addClass("form-variable__group--hide"),p.dropdown.options.items.addClass("form-variable__group-item--hide"),p.dropdown.options.no_results.addClass("form-variable__group-item-no-results--hide");var i=!1;p.dropdown.options.items.each(function(){var t=e(this);-1!==t.text().toLowerCase().replace(/\s/g,"").search(n)&&(t.closest(".form-variable__group").removeClass("form-variable__group--hide"),t.removeClass("form-variable__group-item--hide"),i=!0)}),i||p.dropdown.options.no_results.removeClass("form-variable__group-item-no-results--hide")}else c.resetDropdown()})},mirrorContent:function(){}};c.init();var p={container:n.find(".form-variable"),input_area:n.find(".form-variable__element"),input:n.find("."+i.classes.field),dropdown:{container:n.find(".form-variable__dropdown"),container_relative:n.find(".form-variable__dropdown-container"),button:n.find(".form-variable__toggle"),search_input:n.find(".form-variable__search-input"),options:{container:n.find(".form-variable__groups"),groups:n.find(".form-variable__group"),groups_title:n.find(".form-variable__group-source"),items:n.find(".form-variable__group-item"),no_results:n.find(".form-variable__group-item-no-results")}}};d.init()}else n.find(".form-variable__element").addClass("form-variable__element--empty")}return this})}}(i)}).call(t,n(1),n(1))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(6),s=i(r),l=n(33),c=(i(l),n(10)),u=i(c),d=n(16),p=i(d),m=function e(){a(this,e),(0,o.getDOMElements)("metabox",{type:"trigger"}).empty();var t=(0,o.itemsObject)("get",{filter:{itemType:"trigger"}});(0,o.isEmpty)(t)?new s.default("trigger"):new u.default("trigger"),new p.default("trigger")};t.default=m},function(e,t,n){"use strict";(function(e,i){function a(){var t={canSubmit:UncannyAutomator.recipe.isValid};return UncannyAutomator.recipe.isValid||e.each(UncannyAutomator.recipe.items,function(e,t){o(e)}),t}function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={isValid:!1};if((0,m.isDefined)(t)){var a=UncannyAutomator.recipe.items[t];if(!a.isMissing&&!(0,m.isEmpty)(a)&&(i.isValid=a.isValid,!a.isValid)){(0,m.getDOMElements)("item",{id:t}).item.addClass("item--error"),e.each(a.options,function(e,n){if(!n.isValid){var i=(0,m.getDOMElements)("optionGroup",{itemID:t,groupID:e});i.tokenInSentence.addClass("item-title__token--error item-title__token--error-shake"),i.fieldsContainer.addClass("item-options__group--error"),i.optionsContainer.addClass("item-options--error"),setTimeout(function(){i.tokenInSentence.removeClass("item-title__variable--error-shake")},1e3),(0,m.isDefined)(i.optionsContainer)&&r(i.optionsContainer)}})}}else i.isValid=!1,(0,m.isEmpty)(n)&&console.error("Neither itemID nor the $item are defined. One of them must be defined.");return i}function r(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={isValid:!1},a=t.find('\n\t\tinput.form-element__input[data-is-child-field="'+(n?"true":"false")+'"],\n\t\ttextarea.form-element__textarea[data-is-child-field="'+(n?"true":"false")+'"],\n\t\tselect.form-element__select[data-is-child-field="'+(n?"true":"false")+'"],\n\t\t.form-checkbox input,\n\t\t.form-radio'),o=!0;return a.each(function(){var n=e(this),i=(n.data("type"),{});if(n.hasClass("form-radio")){"radio";var a=n.find("input").first(),r=n.find("input:checked");i={field_type:"radio",value:r.length>0?r.val():"",attributes:{supportsTokens:a.data("supportstokens"),required:a.data("required")}}}else i=n.hasClass("form-element__select")?{field_type:"select",value:n.val(),attributes:{supportsTokens:n.data("supportstokens"),required:n.data("required"),supportsCustomValue:n.data("supports-custom-value")}}:{field_type:n.data("type"),value:n.val(),attributes:{supportsTokens:n.data("supportstokens"),required:n.data("required")}};"checkbox"==i.field_type&&(i.value=n.is(":checked")),s(n,i.field_type,i.value,i.attributes).isValid||(o=!1,t.addClass("item-options--error"))}),i.isValid=o,i}function s(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{supportsTokens:!1,required:!1},o=arguments[4],s={isValid:!1,message:""},u=(0,m.getFieldTypes)(),p={select:{empty:UncannyAutomator.i18n.validation.field.select.empty,invalid:UncannyAutomator.i18n.validation.field.select.invalid},text:{empty:UncannyAutomator.i18n.validation.field.text.empty,invalid:UncannyAutomator.i18n.validation.field.text.invalid},textarea:{empty:UncannyAutomator.i18n.validation.field.textarea.empty,invalid:UncannyAutomator.i18n.validation.field.textarea.invalid},int:{empty:UncannyAutomator.i18n.validation.field.int.empty,invalid:UncannyAutomator.i18n.validation.field.int.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.int.multipleTokens},float:{empty:UncannyAutomator.i18n.validation.field.float.empty,invalid:UncannyAutomator.i18n.validation.field.float.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.float.multipleTokens},email:{empty:UncannyAutomator.i18n.validation.field.email.empty,single:{invalid:UncannyAutomator.i18n.validation.field.email.single.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.email.single.multipleTokens},multiple:{invalid:UncannyAutomator.i18n.validation.field.email.multiple.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.email.multiple.multipleTokens}},url:{empty:UncannyAutomator.i18n.validation.field.url.empty,invalid:UncannyAutomator.i18n.validation.field.url.invalid},checkbox:{empty:UncannyAutomator.i18n.validation.field.checkbox.empty,invalid:UncannyAutomator.i18n.validation.field.checkbox.invalid},radio:{empty:UncannyAutomator.i18n.validation.field.radio.empty,invalid:UncannyAutomator.i18n.validation.field.radio.invalid},invalidType:UncannyAutomator.i18n.validation.field.invalidType};if((0,m.inArray)(n,u)){if("checkbox"!=n||(0,m.isEmpty)(i)||["true","false"].includes(i)&&(i="true"==i),a.required&&((0,m.isEmpty)(i)||"checkbox"==n&&!1===i))s.message=p[n].empty;else if(!a.required&&(0,m.isEmpty)(i))s.isValid=!0;else if(""!=i){var f=void 0;switch(n){case"select":if(s.isValid=!0,a.supportsCustomValue&&"automator_custom_value"==i){var v=t.closest(".form-element").find(".form-element-children");1==v.length&&(s.isValid=r(v,!0).isValid)}if(s.isValid&&(0,m.isDefined)(o)){var h=o(i);s.isValid=h.isValid,h.isValid||(s.message=h.message)}break;case"text":case"textarea":if(s.isValid=!0,(0,m.isDefined)(o)){var g=o(i);s.isValid=g.isValid,g.isValid||(s.message=g.message)}break;case"int":var y=new RegExp(/^([+-]?[1-9]\d*|0)$/gm);f=l(i);var b=void 0;if(a.supportsTokens&&f.hasTokens?1==f.tokens.length?(b=c(i),y.test(b)?s.isValid=!0:s.message=p.int.invalid):s.message=p.int.multipleTokens:y.test(i)?s.isValid=!0:s.message=p.int.invalid,s.isValid&&(0,m.isDefined)(o)){var _=o(i,b);s.isValid=_.isValid,_.isValid||(s.message=_.message)}break;case"float":var k=new RegExp(/^[+-]?((\d+(\.|\,)?\d*)|(\.\d+))$/gm);f=l(i);var w=void 0;if(a.supportsTokens&&f.hasTokens?1==f.tokens.length?(w=c(i),k.test(w)?s.isValid=!0:s.message=p.float.invalid):s.message=p.float.multipleTokens:k.test(i)?s.isValid=!0:s.message=p.float.invalid,s.isValid&&(0,m.isDefined)(o)){var A=o(i,w);s.isValid=A.isValid,A.isValid||(s.message=A.message)}break;case"email":var U=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),T=[];i.includes(",")?(T=i.split(","),e.each(T,function(e,t){T[e]=t.trim()})):T.push(i.trim()),f=l(i);var x=void 0,C=!0,D=T.length>1;if(a.supportsTokens&&f.hasTokens){var E=!1;e.each(T,function(e,t){return f=l(t),f.tokens.length<=1?(x=c(t),U.test(x)?void 0:(C=!1,!1)):(E=!0,!1)}),C&&!E?s.isValid=!0:s.message=E?D?p.email.multiple.multipleTokens:p.email.single.multipleTokens:D?p.email.multiple.invalid:p.email.single.invalid}else e.each(T,function(e,t){U.test(t)||(C=!1)}),C?s.isValid=!0:s.message=D?p.email.multiple.invalid:p.email.single.invalid;if(s.isValid&&(0,m.isDefined)(o)){var S=o(i,x);s.isValid=S.isValid,S.isValid||(s.message=S.message)}break;case"url":var V=d(i,a);if(V.isValid?s.isValid=!0:s.message=p.invalidType,s.isValid&&(0,m.isDefined)(o)){var O=o(i,V.simulatedURL);s.isValid=O.isValid,O.isValid||(s.message=O.message)}break;case"checkbox":if(s.isValid=!0,(0,m.isDefined)(o)){var I=o(i);s.isValid=I.isValid,I.isValid||(s.message=I.message)}break;case"radio":if(s.isValid=!0,(0,m.isDefined)(o)){var R=o(i);s.isValid=R.isValid,R.isValid||(s.message=R.message)}break;default:s.isValid=!1,s.message=""}}}else s.message=p.invalidType;if(!(0,m.isEmpty)(t)){var L=t.closest(".form-element"),j=L.find(".form-element__error").filter(function(){return e(this).closest(".form-element").is(L)});s.isValid?(L.removeClass("form-element--error"),L.addClass("form-element--success")):(L.removeClass("form-element--success"),L.addClass("form-element--error")),""!=s.message?(j.addClass("form-element__error--show"),j.text(s.message)):(j.removeClass("form-element__error--show"),j.text(""))}return s}function l(t){var n={hasTokens:!1,tokens:[]},i=new RegExp(/\{\{(.*?)\}\}/gm),a=(0,m.getTokens)();return(0,m.isDefined)(t)?(0,m.isEmpty)(t)||function(){(0,m.isString)(t)||(t=t.toString());for(var o=[],r=void 0;null!==(r=i.exec(t));)!function(){var t=r[1];e.each(a,function(n,i){e.each(i.tokens,function(e,n){t==n.id&&o.push(n)})})}();n.tokens=o,n.tokens.length>0&&(n.hasTokens=!0)}():console.error("Undefined string attribute"),n}function c(t){var n=t,i=l(t);return i.hasTokens&&e.each(i.tokens,function(e,t){var i=t.id.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");i=(0,m.vsprintf)("{{%s}}",[i]);var a=new RegExp(i,"g");n=n.replace(a,function(e,n){return u(t.type)})}),n}function u(e){var t="";switch(e){case"select":t="option";break;case"text":t="lorem-ipsum";break;case"textarea":t="<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum finibus eros nunc, et posuere libero posuere a. Nam viverra mattis finibus. Aenean purus lorem, mollis vel ullamcorper ac</p>";break;case"int":t=1;break;case"float":t=1.1;break;case"url":t="https://example.com";break;case"email":t="example@example.com";break;case"checkbox":t=!0;break;case"radio":t="option"}return t}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{supportsTokens:!1},n={changed:!1,isValid:!1,newURL:null,simulatedURL:null};e=e.replace(/ /g,"%20");var i=new RegExp("^(?:(?:https?|ftp)://)(?:S+(?::S*)?@)?(?:(?!(?:10|127)(?:.d{1,3}){3})(?!(?:169.254|192.168)(?:.d{1,3}){2})(?!172.(?:1[6-9]|2d|3[0-1])(?:.d{1,3}){2})(?:[1-9]d?|1dd|2[01]d|22[0-3])(?:.(?:1?d{1,2}|2[0-4]d|25[0-5])){2}(?:.(?:[1-9]d?|1dd|2[0-4]d|25[0-4]))|(?:(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)(?:.(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)*(?:.(?:[a-z¡-￿]{2,})).?)(?::d{2,5})?(?:[/?#]S*)?"),a=l(e),o=e;if(t.supportsTokens&&a.hasTokens){var r=c(e);n.simulatedURL=r,i.test(r)?n.isValid=!0:(o="/"==e[0]?UncannyAutomator.siteURL+e:UncannyAutomator.siteURL+"/"+e,i.test(o)&&(n.isValid=!0))}else i.test(e)?n.isValid=!0:(o="/"==e[0]?UncannyAutomator.siteURL+e:UncannyAutomator.siteURL+"/"+e,i.test(o)&&(n.isValid=!0));return n.newURL=o,n.newURL!=e&&(n.changed=!0),n}function p(e){e.checkURL()}Object.defineProperty(t,"__esModule",{value:!0}),t.validateRecipe=a,t.validateItem=o,t.validateItemFields=r,t.validateField=s,t.getTokensFromString=l,t.replaceTokensInString=c,t.getExampleValueByFieldType=u,t.parseURL=d,t.initURLChecker=p;var m=n(0),f=n(13);!function(e){e&&e.__esModule}(f);!function(e){e.fn.checkURL=function(t){return this.each(function(){function n(e){var t=d(e,r);""!=e&&t.isValid&&t.changed?(s.addClass("form-input-url-notice--show"),c.text(t.newURL)):s.removeClass("form-input-url-notice--show")}var i=e(this),a=e.extend({preURL:"Final URL: "},t),o={container:i,input:i.find(".form-element__input")},r={required:o.input.data("required"),supportsTokens:o.input.data("supportstokens")},s=e("<div/>",{class:"form-input-url-notice"}),l=e("<div/>",{class:"form-input-url-notice__header"}),c=e("<div/>",{class:"form-input-url-notice__url"});return l.text(a.preURL),l.appendTo(s),c.appendTo(s),s.appendTo(o.container),""!=o.input.val()&&n(o.input.val()),o.input.on("input",function(){n(o.input.val())}),this})}}(i)}).call(t,n(1),n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],i=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(7),c=i(l),u=n(32),d=i(u),p=function(){function t(e,n){a(this,t),this.itemType=e,this.$currentItem=n,this.integrations=[],this.render()}return r(t,[{key:"render",value:function(){var t=e("<div/>",{class:"item"});this.$item=t;var n=this.createHeader(),i=e("<div/>",{class:"item__content"}),a=this.createIntegrations(),o=this.createDiscoverMoreIntegrations();if(t.append(n),i.append(a),i.append(o),t.append(i),(0,s.isDefined)(this.$currentItem))this.$currentItem.replaceWith(t);else{var r=(0,s.getDOMElements)("lastItem",{type:this.itemType});if("trigger"==this.itemType)if(r.length>0)t.insertAfter(r);else{var l=(0,s.getDOMElements)("metabox",{type:this.itemType});l.append(t)}if("action"==this.itemType){if((0,s.getDOMElements)("items",{type:this.itemType}).length>0)t.insertAfter(r);else{(0,s.getDOMElements)("metabox",{type:this.itemType}).find(".item.item--start").replaceWith(t)}}}}},{key:"createHeader",value:function(){var t=e("<div/>"),n=e("<div/>",{class:"item-icon"}),i=e("<div/>",{class:"item-title uap-clear"}),a=e("<div/>",{class:"item-title__describe"}),o=e("<div/>",{class:"item-title__non-editable"}).text(UncannyAutomator.i18n.integration.select),r=new c.default(this.itemType);return t.append(r),t.append(n),a.append(o),i.append(a),t.append(i),t}},{key:"createIntegrations",value:function(){var t=this,n=e("<div/>",{class:"item-integrations"});return this.filterByNonEmptyIntegrations(this.itemType),this.sortIntegrationsAlphabetically(),this.integrations.forEach(function(e){var i=e.id,a=t.createIntegration(i,e);a.on("click",function(){new d.default(t.itemType,i,t.$item)}),n.append(a)}),n}},{key:"createIntegration",value:function(t,n){var i=e("<div/>",{class:"item-integration"}),a=e("<div/>",{class:"item-integration__logo"}),o=e("<div/>",{class:"item-integration__name"});n.isProOnly&&(i.addClass("item-integration--pro"),i.append(e('\n                <div class="item-integration__badge">'+UncannyAutomator.i18n.proOnly.pro+"</div>\n            "))),n.isAvailable?i.addClass("item-integration--available"):(i.addClass("item-integration--unavailable"),i.attr("uap-tooltip",(0,s.vsprintf)(UncannyAutomator.i18n.proOnly.requiresPro,[UncannyAutomator.i18n.uncannyAutomatorPro])));var r=void 0;return(0,s.isDefined)(n.icon_svg)?r=e('<img src="'+n.icon_svg+'" alt="'+n.name+'">'):(0,s.isDefined)(n.icon_32)&&(0,s.isDefined)(n.icon_64)&&(r=e('<img src="'+n.icon_32+'" srcset="'+(0,s.vsprintf)("%s 1x, %s 2x",[n.icon_32,n.icon_64])+'" alt="'+n.name+'">')),o.text(n.name),a.append(r),i.append(a),i.append(o),i}},{key:"createDiscoverMoreIntegrations",value:function(){return e('\n            <div class="item-content__description">\n                '+UncannyAutomator.i18n.integration.discoverMore+' <a href="'+(0,s.addParametersToURL)("https://automatorplugin.com/integrations/",{utm_source:"uncanny_automator",utm_medium:"select_an_integration",utm_content:"discover_more_integrations"})+'" target="_blank">'+UncannyAutomator.i18n.learnMore+' <span class="uo-icon uo-icon--external-link-alt"></span></a>\n            </div>\n        ')}},{key:"filterByNonEmptyIntegrations",value:function(t){var n=this;if(["trigger","action"].includes(t)){var i=e.extend(!0,{},UncannyAutomator.integrations);Object.entries(i).forEach(function(i){var a=o(i,2),r=a[0],l=a[1],c=!1,u=!1,d=!1,p=void 0;"trigger"==t?(p=(0,s.filterDeprecatedItems)(l.items.triggers),c=p.hasTriggers,d=p.hasAvailableItems,u=p.allItemsArePro):"action"==t&&(p=(0,s.filterDeprecatedItems)(l.items.actions),c=p.hasActions,d=p.hasAvailableItems,u=p.allItemsArePro),c&&n.integrations.push(e.extend({},l,{id:r,isAvailable:d,isProOnly:u}))})}}},{key:"sortIntegrationsAlphabetically",value:function(){this.integrations=(0,s.sortArrayOfObjectsAlphabetically)(this.integrations,"name")}}]),t}();t.default=p}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(9),l=i(s),c=n(4),u=i(c),d=n(2),p=i(d),m=function(){function t(e,n,i,o){return a(this,t),this.itemType=e,this.integrationID=n,this.itemCode=i,this.itemId=o,this.item=UncannyAutomator.recipe.items[o],this.createItemActions()}return o(t,[{key:"createItemActions",value:function(){var t=this,n=e("<div/>",{class:"item-actions"}),i=e("<div/>",{class:"item-actions__btn"}),a=e("<i/>",{class:"uo-icon uo-icon--ellipsis-h-alt"}),o=e("<div/>",{class:"item-actions__dropdown"}),s=e("<ul/>",{class:"item-actions-dropdown__ul"});i.append(a),n.append(i);var c=e("<li/>",{class:"item-actions-dropdown__action"}),d=e("<span/>").text(UncannyAutomator.i18n.delete);if(c.append(d),s.append(c),(0,r.isDefined)(this.itemType)&&(0,r.isDefined)(this.itemCode)&&(!(0,r.isDefined)(this.item)||(0,r.isDefined)(this.item)&&!this.item.isMissing)){var m=(0,r.getGlobalItem)(this.integrationID,this.itemType,this.itemCode);if((0,r.isDefined)(m.support_link)){var f=e("<a/>",{href:(0,r.addParametersToURL)(m.support_link,{utm_source:"uncanny_automator",utm_medium:"action_menu",utm_content:"support_menu_link"}),class:"item-actions-dropdown__action",target:"_blank"}),v=e("<span/>").text(UncannyAutomator.i18n.support);f.append(v),s.append(f)}}return o.append(s),n.append(o),i.on("click",function(){n.hasClass("item-actions--open")?(n.removeClass("item-actions--open"),e(document).off("mouseup.uap-actions-click-outside")):(n.addClass("item-actions--open"),e(document).on("mouseup.uap-actions-click-outside",function(t){n.is(t.target)||0!==n.has(t.target).length||(n.removeClass("item-actions--open"),e(document).off("mouseup.uap-actions-click-outside"))}))}),c.on("click",function(){if((0,r.isDefined)(t.itemId)&&UncannyAutomator.recipe.isLive&&UncannyAutomator.recipe.items[t.itemId].isLive){n.removeClass("item-actions--open");var e=new l.default({title:UncannyAutomator.i18n.confirmationModal.title,warning:(0,r.replaceCurlyBraces)(UncannyAutomator.i18n.confirmationModal.deleteWarning,"<strong>","</strong>"),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.confirm}});e.setEvents({afterSetEvents:function(){e.show()},onConfirm:function(){e.getElements().modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),(0,r.restCall)("delete",{ID:t.itemId},function(){e.destroy(),"trigger"==t.itemType&&(new u.default,"anonymous"==UncannyAutomator.recipe.type&&new p.default),"action"!=t.itemType&&"closure"!=t.itemType||new p.default,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)},function(){e.destroy(),console.log("‼️ ERROR-TODO. Couldn't delete the item"),"trigger"==t.itemType&&new u.default,"action"!=t.itemType&&"closure"!=t.itemType||new p.default})},afterHide:function(){e.destroy()}})}else(0,r.isDefined)(t.itemId)?(c.addClass("item-actions-dropdown__action--loading"),(0,r.restCall)("delete",{ID:t.itemId},function(){"trigger"==t.itemType&&(new u.default,"anonymous"==UncannyAutomator.recipe.type&&new p.default),"action"!=t.itemType&&"closure"!=t.itemType||new p.default},function(){console.log("‼️ ERROR-TODO. Couldn't delete the item"),"trigger"==t.itemType&&new u.default,"action"!=t.itemType&&"closure"!=t.itemType||new p.default})):("trigger"==t.itemType&&new u.default,"action"==t.itemType&&new p.default)}),n}}]),t}();t.default=m}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(){i(this,t),this.elements={container:e("#uo-uap-notices")},0==this.elements.container.length&&(this.createContainer(),this.elements.container=e("#uo-uap-notices")),this.emptyContainer(),this.createWarning(),UncannyAutomator.recipe.errorMode&&this.createError()}return a(t,[{key:"emptyContainer",value:function(){this.elements.container.empty()}},{key:"createContainer",value:function(){var t=e("<div/>",{id:"uo-uap-notices",class:"uap"});e("#uap-publish-metabox").prepend(t)}},{key:"createError",value:function(){if(!(0,o.isEmpty)(UncannyAutomator.recipe.message.error)){var t=e("<div/>",{class:"uo-notice uo-notice--error"}).text(UncannyAutomator.recipe.message.error);this.elements.container.append(t)}}},{key:"createWarning",value:function(){if(!(0,o.isEmpty)(UncannyAutomator.recipe.message.warning)){var t=e("<div/>",{class:"uo-notice uo-notice--warning"}).text(UncannyAutomator.recipe.message.warning);this.elements.container.append(t)}}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(this,t),this.elements={container:null,automatorContainer:null,modal:{container:null,box:{container:null,title:null,warning:null,buttons:{container:null,cancel:null,confirm:null}}}},this.elements.container=e("body"),this.isVisible=!1,this.config=e.extend(!0,{fadeDuration:150},a),this.content=e.extend({},{buttons:{cancel:UncannyAutomator.i18n.cancel}},n),this.create(),this}return a(t,[{key:"create",value:function(){var t=e("<div/>",{class:"uap"}),n=e("<div/>",{class:"modal"}),i=e("<div/>",{class:"modal__box"});if((0,o.isDefined)(this.config.size)&&["small","medium","large"].includes(this.config.size)&&n.addClass("modal--"+this.config.size),this.elements.automatorContainer=t,this.elements.modal.container=n,this.elements.modal.box.container=i,(0,o.isDefined)(this.content.title)){var a=e("<div/>",{class:"modal__title"}).html(this.content.title);i.append(a),this.elements.modal.box.title=a}if((0,o.isDefined)(this.content.content)){var r=e("<div/>",{class:"modal__content"}).html(this.content.content);i.append(r),this.elements.modal.box.content=r}if((0,o.isDefined)(this.content.warning)){var s=e("<div/>",{class:"modal__warning"}).html(this.content.warning);i.append(s),this.elements.modal.box.warning=s}var l=e("<div/>",{class:"modal__buttons"}),c=e("<button/>",{class:"uap-btn uap-btn--secondary"}).html(this.content.buttons.cancel);if(l.append(c),this.elements.modal.box.buttons.container=l,this.elements.modal.box.buttons.cancel=c,(0,o.isDefined)(this.content.buttons.confirm)){var u=e("<button/>",{class:"uap-btn uap-btn--primary"}).html(this.content.buttons.confirm);l.append(u),this.elements.modal.box.buttons.confirm=u}i.append(l),n.append(i),t.append(n),this.elements.container.append(t),e("html").addClass("automator-modal-open"),this.bind()}},{key:"setEvents",value:function(e){var t=this,n=function(){};this.events={afterSetEvents:(0,o.isDefined)(e.afterSetEvents)?e.afterSetEvents:n,afterShow:(0,o.isDefined)(e.afterShow)?e.afterShow:n,afterHide:(0,o.isDefined)(e.afterHide)?e.afterHide:n,onConfirm:(0,o.isDefined)(e.onConfirm)?e.onConfirm:n,onCancel:(0,o.isDefined)(e.onCancel)?e.onCancel:n},(0,o.isDefined)(e.onCancel)||(this.events.onCancel=function(){t.hide()}),this.events.afterSetEvents()}},{key:"destroy",value:function(){var t=this;this.unbind(),this.isVisible?this.hide(function(){t.elements.automatorContainer.remove()}):t.elements.automatorContainer.remove(),e("html").removeClass("automator-modal-open")}},{key:"bind",value:function(){var e=this;this.elements.modal.box.buttons.cancel.on("click",function(){e.events.onCancel()}),this.elements.modal.box.buttons.confirm.on("click",function(){e.events.onConfirm()})}},{key:"unbind",value:function(){this.elements.modal.box.buttons.cancel.unbind("click"),this.elements.modal.box.buttons.confirm.unbind("click")}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=function(){};n=(0,o.isDefined)(e)?e:this.events.afterShow,e=n,this.isVisible=!0,this.elements.modal.container.fadeIn(t.config.fadeDuration,e)}},{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this,i=function(){};i=(0,o.isDefined)(t)?t:this.events.afterHide,t=i,this.isVisible=!1,this.elements.modal.container.fadeOut(n.config.fadeDuration,t),e("html").removeClass("automator-modal-open")}},{key:"getElements",value:function(){return this.elements}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(7),l=i(s),c=n(11),u=i(c),d=n(12),p=i(d),m=n(15),f=i(m),v=function(){function t(n){var i=this;a(this,t),e.each(UncannyAutomator.recipe.items,function(e,t){if(n==t.itemType){var a=i.createItem(e);(0,r.getDOMElements)("metabox",{type:n}).append(a)}})}return o(t,[{key:"createItem",value:function(t){var n=UncannyAutomator.recipe.items[t],i=e("<div/>",{class:"item","data-id":t});n.isMissing&&i.addClass("item--missing"),(0,r.isEmpty)(n.inlineCss)||(n.inlineCss=n.inlineCss.replace(/{{item_id}}/g,t),i.prepend(n.inlineCss));var a=this.createHeader(n.integrationCode,n.itemType,n.itemCode,t),o=this.createNotice(n);return i.append(a),i.append(o),i}},{key:"createHeader",value:function(t,n,i,a){var o=e("<div/>"),r=e("<div/>",{class:"item-title uap-clear"}),s=UncannyAutomator.recipe.items[a];s.isMissing&&(t=null);var c=new l.default(n,t,i,a);o.append(c);var d=new u.default(t);o.append(d);var m=s.integrationName,v=new p.default(t,m);r.append(v);var h=new f.default(n,t,i,a);r.append(h),o.append(r);var g=e("<div/>",{class:"item__content"});return o.append(g),o}},{key:"createNotice",value:function(t){var n=void 0;return t.isMissing&&(n=e("<div/>",{class:"item-notice"}),n.text(UncannyAutomator.i18n.itemMissing)),n}}]),t}();t.default=v}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(e){return i(this,t),this.integrationCode=e,this.createItemIcon()}return a(t,[{key:"createItemIcon",value:function(){var t=e("<div/>",{class:"item-icon"});if((0,o.isDefined)(UncannyAutomator.integrations[this.integrationCode])){var n=UncannyAutomator.integrations[this.integrationCode],i=void 0;(0,o.isDefined)(n.icon_svg)?i=e('<img src="'+n.icon_svg+'" alt="'+n.name+'">'):(0,o.isDefined)(n.icon_32)&&(0,o.isDefined)(n.icon_64)&&(i=e('<img src="'+n.icon_32+'" srcset="'+(0,o.vsprintf)("%s 1x, %s 2x",[n.icon_32,n.icon_64])+'" alt="'+n.name+'">')),t.append(i)}return t}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,t),this.integrationId=e,this.integrationName=n,this.createItemTag()}return a(t,[{key:"createItemTag",value:function(){var t=UncannyAutomator.integrations[this.integrationId],n=e("<div/>",{class:"item-title__integration uap-clear"}),i=e("<div/>",{class:"item-title__tag"});return(0,o.isDefined)(t)?i.text(t.name):i.text(this.integrationName),n.append(i),n}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(8),l=i(s),c=n(3),u=i(c),d=function(){function t(){a(this,t),this.elements={metabox:e("#uo-automator-publish-metabox"),timesPerUser:{editLink:null,hiddenBox:null,saveButton:null,cancelButton:null},toggle:null},this.createMetabox()}return o(t,[{key:"createMetabox",value:function(){var t=e("<div/>",{id:"uap-publish-metabox"}),n=e("<div/>",{class:"metabox__content"}),i=e("<div/>",{class:"metabox__footer"});if("anonymous"!=UncannyAutomator.recipe.type){var a=e("<div/>",{class:"publish-row"}),o=e("<div/>",{class:"publish-row__visible"}),s=e("<span/>",{class:"publish-row__icon"}),c=e("<i/>",{class:"uo-icon uo-icon--sync-alt"}),d=e("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.timesPerUser);UncannyAutomator.recipe.publish.timesPerUser=-1==UncannyAutomator.recipe.publish.timesPerUser?"":UncannyAutomator.recipe.publish.timesPerUser;var p=(0,r.isEmpty)(UncannyAutomator.recipe.publish.timesPerUser)?UncannyAutomator.i18n.publish.unlimited:UncannyAutomator.recipe.publish.timesPerUser,m=e("<span/>",{class:"publish-row__value"}).text(p),f=e("<span/>",{class:"publish-row__edit"}).text(UncannyAutomator.i18n.edit),v=e("<div/>",{class:"publish-row__hidden"}),h=e("<div/>",{class:"publish-row__settings"});this.elements.timesPerUser.editLink=f,this.elements.timesPerUser.hiddenBox=v;var g=new u.default("int",{currentValue:UncannyAutomator.recipe.publish.timesPerUser,description:UncannyAutomator.i18n.publish.leaveEmpty,placeholder:UncannyAutomator.i18n.publish.unlimited},!0,function(e,t){var n={isValid:!1,message:""};return e>=1?n.isValid=!0:n.message=UncannyAutomator.i18n.publish.oneOrBigger,n});this.timesField=g;var y=e("<div/>",{class:"publish-row__buttons"}),b=e("<div/>",{class:"uap-btn uap-btn--primary"}).text(UncannyAutomator.i18n.save),_=e("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);this.elements.timesPerUser.saveButton=b,this.elements.timesPerUser.cancelButton=_,y.append(b),y.append(_),h.append(g.getFormElement()),h.append(y),v.append(h),s.append(c),o.append(s),o.append(d),o.append(m),o.append(f),a.append(o),a.append(v),n.append(a)}var k=e("<div/>",{class:"publish-row"}),w=e("<div/>",{class:"publish-row__visible"}),A=e("<span/>",{class:"publish-row__icon"}),U=e("<i/>",{class:"uo-icon uo-icon--utensils"}),T=e("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.recipeType),x=e("<span/>",{class:"publish-row__value"}),C=e('\n\t\t\t\t<a href="'+(0,r.addParametersToURL)("https://automatorplugin.com/knowledge-base/creating-a-recipe/",{utm_source:"uncanny_automator",utm_medium:"publish_metabox",utm_content:"question_icon"})+'" class="publish-row__learn-more" target="_blank"><span class="uo-icon uo-icon--question-circle"></span></a>\n\t\t\t');"user"==UncannyAutomator.recipe.type&&x.text(UncannyAutomator.i18n.recipeType.userRecipeName),"anonymous"==UncannyAutomator.recipe.type&&x.text(UncannyAutomator.i18n.recipeType.anonymousRecipeName),A.append(U),w.append(A),w.append(T),w.append(x),w.append(C),k.append(w),n.append(k);var D=e("<div/>",{class:"publish-row"}),E=e("<div/>",{class:"publish-row__visible"}),S=e("<span/>",{class:"publish-row__icon"}),V=e("<i/>",{class:"uo-icon uo-icon--calendar-alt"}),O=e("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.createdOn),I=e("<span/>",{class:"publish-row__value"}).text(UncannyAutomator.recipe.publish.createdOn);S.append(V),E.append(S),E.append(O),E.append(I),D.append(E),n.append(D);var R=e("<div/>",{class:"publish-footer__row uap-clear"}),L=e("<div/>",{class:"publish-footer__left"}),j=e("<a/>",{class:"publish-footer__move-to-draft",href:UncannyAutomator.recipe.publish.moveToTrash.replace(/&amp;/g,"&")}).text(UncannyAutomator.i18n.proOnly.moveToTrash),F=e("<div/>",{class:"publish-footer__right"}),M=new u.default("checkbox",{color:"gutenberg",align:"right",toggle:{on:UncannyAutomator.i18n.status.liveRecipe,off:UncannyAutomator.i18n.status.draftRecipe},currentValue:UncannyAutomator.recipe.isLive});UncannyAutomator.recipe.publish.statusToggle=M;var $=M.getFormElement();this.recipeStatusToggle=M,this.elements.toggle=$,L.append(j),F.append($),R.append(L),R.append(F),i.append(R),t.append(n),t.append(i),this.elements.metabox.html(t),new l.default,this.bind(),this.validateStatus()}},{key:"validateStatus",value:function(){UncannyAutomator.recipe.isLive&&!UncannyAutomator.recipe.isValid&&UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}},{key:"bind",value:function(){var e=this;"anonymous"!=UncannyAutomator.recipe.type&&(this.elements.timesPerUser.editLink.on("click",function(){e.elements.timesPerUser.hiddenBox.slideToggle(300)}),this.elements.timesPerUser.cancelButton.on("click",function(){e.elements.timesPerUser.hiddenBox.slideToggle(300,function(){new t})}),this.elements.timesPerUser.saveButton.on("click",function(){if(e.timesField.validate().isValid){e.elements.timesPerUser.saveButton.addClass("uap-btn--loading uap-btn--disabled");var n=e.timesField.getValue();(0,r.isEmpty)(n)&&(n=-1),(0,r.restCall)("recipe_completions_allowed",{post_ID:UncannyAutomator.recipe.id,recipe_completions_allowed:n},function(){UncannyAutomator.recipe.publish.timesPerUser=n,e.elements.timesPerUser.hiddenBox.slideToggle(300,function(){new t})},function(){console.log("‼️ ERROR-TODO. Couldn't save times per user"),e.timesField.setValue(UncannyAutomator.recipe.publish.timesPerUser),e.elements.timesPerUser.saveButton.removeClass("uap-btn--loading uap-btn--disabled")})}}),this.timesField.getField().on("keyup",function(t){13==t.keyCode&&e.elements.timesPerUser.saveButton.trigger("click")})),this.elements.toggle.on("automator:field:change",function(){e.recipeStatusToggle.startLoadingAnimation();var n=e.recipeStatusToggle.getValue(),i=n?"publish":"draft";(0,r.itemsObject)("get",{filter:{itemType:"trigger"}});!n||n&&UncannyAutomator.recipe.isValid?(0,r.restCall)("change_post_status",{post_ID:UncannyAutomator.recipe.id,post_status:i},function(){UncannyAutomator.recipe.isLive=n,new t},function(){console.log("‼️ ERROR-TODO. Couldn't set the recipe status"),setTimeout(function(){e.recipeStatusToggle.stopLoadingAnimation(),e.recipeStatusToggle.setValue(!1,!1)},1e3)}):(UncannyAutomator.recipe.errorMode=!0,new l.default,setTimeout(function(){e.recipeStatusToggle.stopLoadingAnimation(),e.recipeStatusToggle.setValue(!1,!1)},1e3))})}}]),t}();t.default=d}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(e){i(this,t),this.doWhenReady=e,this.render(),this.getElements(),this.listenSubmission()}return a(t,[{key:"render",value:function(){var t=e('\n\t\t\t<div class="uap">\n\t\t\t\t<div id="uap-type-selector" class="uap-type-selector">\n\t\t\t\t\t<div class="uap-type-selector__box">\n\t\t\t\t\t\t<form id="uap-type-selector-form" class="uap-type-selector__form">\n\t\t\t\t\t\t\t<div class="uap-type-selector__title">\n\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.title+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__content">\n\t\t\t\t\t\t\t\t<div class="uap-type-selector__types">\n\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type uap-type-selector-type--user">\n\t\t\t\t\t\t\t\t\t\t<input class="uap-type-selector-type__hidden-field" type="radio" name="uap-recipe-type" value="user" id="uap-recipe-type-user">\n\t\t\t\t\t\t\t\t\t\t<label class="uap-type-selector-type__label" for="uap-recipe-type-user">\n\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__container">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon-img uap-type-selector-type__icon-img--user"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__title">\n\t\t\t\t\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.userRecipeName+'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__description">\n\t\t\t\t\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.userRecipeDescription+'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type uap-type-selector-type--anonymous">\n\t\t\t\t\t\t\t\t\t\t<input class="uap-type-selector-type__hidden-field" type="radio" name="uap-recipe-type" value="anonymous" id="uap-recipe-type-anonymous">\n\t\t\t\t\t\t\t\t\t\t<label class="uap-type-selector-type__label" for="uap-recipe-type-anonymous">\n\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__container">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon-img uap-type-selector-type__icon-img--anonymous"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__title">\n\t\t\t\t\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.anonymousRecipeName+'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__description">\n\t\t\t\t\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.anonymousRecipeDescription+'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__warning">\n\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.recipeType.cantChangeLaterNotice+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__buttons">\n\t\t\t\t\t\t\t\t<button type="submit" id="uap-type-selector-submit-button" class="uap-btn uap-btn--primary">'+UncannyAutomator.i18n.confirm+"</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t");e("body").append(t)}},{key:"getElements",value:function(){this.$elements={container:e("#uap-type-selector"),form:e("#uap-type-selector-form"),warning:e("#uap-type-selector .uap-type-selector__warning"),submitButton:e("#uap-type-selector-submit-button")}}},{key:"listenSubmission",value:function(){var e=this;this.$elements.form.on("submit",function(t){t.preventDefault();var n=e.$elements.form.find('input[name="uap-recipe-type"]:checked').val();(0,o.isEmpty)(n)?e.showError(UncannyAutomator.i18n.recipeType.errorDidNotSelectType):["user","anonymous"].includes(n)?e.saveRecipeType(n):e.showError(UncannyAutomator.i18n.recipeType.errorTryingToSaveOtherValue)})}},{key:"saveRecipeType",value:function(t){var n=this,i={post_ID:UncannyAutomator.recipe.id,recipe_type:t};this.$elements.submitButton.addClass("uap-btn--loading uap-btn--disabled"),(0,o.restCall)("change_post_recipe_type",i,function(i){if(i.success){n.$elements.container.remove(),UncannyAutomator.recipe.type=t;var a=e("#uo-recipe-triggers-meta-box-ui h2.hndle.ui-sortable-handle"),o=UncannyAutomator.i18n.trigger.userTriggers;"anonymous"==UncannyAutomator.recipe.type&&(o=UncannyAutomator.i18n.trigger.anonymousTrigger),a.text(o),n.doWhenReady(t)}else n.showError(UncannyAutomator.i18n.recipeType.errorSomethingWentWrong)},function(e){console.log("‼️ ERROR-TODO. Couldn't save the recipe type"),n.$elements.submitButton.removeClass("uap-btn--loading uap-btn--disabled"),n.showError(UncannyAutomator.i18n.recipeType.errorSomethingWentWrong)})}},{key:"showError",value:function(t){var n=e('\n\t\t\t<div class="uap-type-selector__error">\n\t\t\t\t'+t+"\n\t\t\t</div>\n\t\t"),i=this.$elements.container.find(".uap-type-selector__error");i.length>0&&i.remove(),n.insertAfter(this.$elements.warning),setTimeout(function(){n.addClass("uap-type-selector__error--shake")},10)}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(9),l=i(s),c=n(28),u=i(c),d=n(3),p=i(d),m=n(4),f=i(m),v=n(2),h=i(v),g=n(5),y=n(8),b=i(y),_=function(){function t(e,n,i,o){return a(this,t),this.itemType=e,this.integrationID=n,this.itemCode=i,this.itemId=o,this.item=UncannyAutomator.recipe.items[o],this.createItemSentence(e,i,o)}return o(t,[{key:"createItemSentence",value:function(t,n,i){var a=(0,r.getGlobalItem)(this.integrationID,t,n);this.globalItem=a;var o=void 0;o=this.item.isMissing?this.item.sentence:(0,r.getGlobalItem)(this.integrationID,this.item.itemType,this.item.itemCode).sentence,o=(0,r.parseStringWithTokens)(this.item,o,UncannyAutomator.recipe.items[this.itemId].meta),this.item.isMissing||o.elements.token.on("click",function(t){var n=e(t.currentTarget);o.elements.token.removeClass("item-title__token--open"),n.addClass("item-title__token--open");var a=n.data("options-id");(0,r.getDOMElements)("optionGroup",{itemID:i,groupID:a});new u.default(i,a)});var s=e("<div/>",{class:"item-title__describe-container"}),c=e("<div/>",{class:"item-status"});s.append(o.html.addClass("item-title__describe"));var d=new p.default("checkbox",{color:"green",align:"right",toggle:{on:UncannyAutomator.i18n.status.liveRecipeItem,off:UncannyAutomator.i18n.status.draftRecipeItem},currentValue:UncannyAutomator.recipe.items[i].isLive}),m=d.getFormElement();return c.append(m),s.append(c),this.item.isMissing||m.on("automator:field:change",function(){var e=d.getValue(),t=!0;if(e){t=(0,g.validateItem)(i).isValid}if(d.startLoadingAnimation(),t){var n=e?"publish":"draft";if(!e&&UncannyAutomator.recipe.isLive){var a=new l.default({title:UncannyAutomator.i18n.confirmationModal.title,warning:(0,r.replaceCurlyBraces)(UncannyAutomator.i18n.confirmationModal.statusWarning,"<strong>","</strong>"),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.confirm}});a.setEvents({afterSetEvents:function(){a.show()},onConfirm:function(){a.getElements().modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),d.startLoadingAnimation(),(0,r.restCall)("change_post_status",{post_ID:i,post_status:n,sentence_human_readable:o.brackets},function(){a.destroy(),new f.default,new h.default,new b.default,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)},function(){console.log("‼️ ERROR-TODO. Couldn't set the item status"),a.destroy(),d.stopLoadingAnimation(),d.setValue(!e,!1)})},onCancel:function(){a.destroy(),d.setValue(!e,!1),d.stopLoadingAnimation()},afterHide:function(){a.destroy()}})}else(0,r.restCall)("change_post_status",{post_ID:i,post_status:n,sentence_human_readable:o.brackets},function(){d.stopLoadingAnimation(),new b.default},function(){console.log("‼️ ERROR-TODO. Couldn't set the item status"),d.stopLoadingAnimation(),d.setValue(!e,!1)})}else setTimeout(function(){d.stopLoadingAnimation(),d.setValue(!1,!1)},1e3)}),s}}]),t}();t.default=_}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(6),l=i(s),c=n(4),u=(i(c),n(2)),d=(i(u),n(10)),p=(i(d),function(){function t(e){a(this,t),this.itemType=e,this.shouldCreateMetaboxFooter()&&this.createFooter()}return o(t,[{key:"shouldCreateMetaboxFooter",value:function(){var e=!1;if("trigger"==this.itemType){var t=(0,r.itemsObject)("get",{filter:{itemType:"trigger"}});!!(0,r.isEmpty)(t)&&(0,r.isDefined)(UncannyAutomator.wp)&&UncannyAutomator.wp&&"anonymous"!=UncannyAutomator.recipe.type||(e=!0)}if("action"==this.itemType){var n=(0,r.itemsObject)("get",{filter:{itemType:"action"}});!(0,r.isEmpty)(n)&&(e=!0)}return e}},{key:"createFooter",value:function(){var t=this,n=e("<div/>",{class:"metabox__footer"}),i=e("<div/>",{class:"uap-btn uap-btn--secondary"});if(("action"==this.itemType||"trigger"==this.itemType&&"user"==UncannyAutomator.recipe.type)&&n.append(i),"trigger"==this.itemType&&("user"==UncannyAutomator.recipe.type&&i.text(UncannyAutomator.i18n.trigger.addAnother),"anonymous"==UncannyAutomator.recipe.type)){var a=this.createAnonymousNotice();n.append(a)}"action"==this.itemType&&i.text(UncannyAutomator.i18n.action.addAnother),"trigger"!=this.itemType&&"action"!=this.itemType||i.on("click",function(){new l.default(t.itemType)}),(0,r.getDOMElements)("metabox",{type:this.itemType}).append(n)}},{key:"createAnonymousNotice",value:function(){return e('\n            <div class="description">\n                '+UncannyAutomator.i18n.recipeType.anonymousOnlyOneTrigger+' <a href="'+(0,r.addParametersToURL)("https://automatorplugin.com/knowledge-base/managing-triggers/",{utm_source:"uncanny_automator",utm_medium:"anonymous_recipe_one_trigger",utm_content:"learn_more"})+'" target="_blank">'+UncannyAutomator.i18n.learnMore+' <span class="uo-icon uo-icon--external-link-alt"></span></a>\n            </div>\n        ')}}]),t}());t.default=p}).call(t,n(1))},function(e,t,n){e.exports=n(18)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}n(19),n(20),n(21),n(22);var a=n(0),o=n(13),r=i(o),s=n(4),l=i(s),c=n(2),u=i(c),d=n(34),p=i(d),m=n(14),f=(i(m),n(35)),v=i(f),h=n(36),g=i(h);(0,a.createDataOnLoad)(function(){(0,a.consoleLogLabel)("Render the UI",!1,{bgColor:"#579f49"}),new l.default,new u.default,new r.default,new p.default,new v.default,new g.default})},function(e,t){e.exports="uncannyowl-automator.svg"},function(e,t){e.exports="uncannyowl-automator.ttf"},function(e,t){e.exports="uncannyowl-automator.woff"},function(e,t){},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=function(){function t(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];i(this,t),this.setAttributes(e),this.createFields()}return a(t,[{key:"setAttributes",value:function(e){(0,o.isDefined)(e.hasLabel)||((0,o.isEmpty)(e.label)?e.hasLabel=!1:e.hasLabel=!0),(0,o.isDefined)(e.hasDescription)||((0,o.isEmpty)(e.description)?e.hasDescription=!1:e.hasDescription=!0),this.attributes=e}},{key:"createFields",value:function(){this.fields=this.attributes.fields.map(function(e){return new s.default(e.fieldType,e)})}},{key:"createFormElement",value:function(){var t=e('<div class="form-group"></div>');if(this.attributes.hasLabel){var n=e('<div class="form-group__label">'+this.attributes.label+"</div>");t.append(n)}var i=e('<div class="form-group__fields"></div>');if(this.fields.forEach(function(e){var t=e.createFormElement();i.append(t)}),t.append(i),this.attributes.hasLabel){var a=e('<div class="form-group__description">'+this.attributes.description+"</div>");t.append(a)}return this.formElement=t,t}},{key:"getValue",value:function(){var e={};return this.fields.forEach(function(t){e[t.getFieldID()]=t.getValue()}),e}},{key:"getFormElement",value:function(){return this.formElement}},{key:"getAttributes",value:function(){return this.attributes}},{key:"validate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={isValid:!0,message:""};return this.fields.forEach(function(n){t[n.getFieldID()]=n.validate(e),t.isValid=t.isValid&&t[n.getFieldID()].isValid}),t}}]),t}();t.default=l}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=n(3),s=function(e){return e&&e.__esModule?e:{default:e}}(r),l=n(25),c=function(){function t(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];i(this,t),this.setAttributes(e),this.createFields()}return a(t,[{key:"setAttributes",value:function(e){(0,o.isDefined)(e.hasLabel)||((0,o.isEmpty)(e.label)?e.hasLabel=!1:e.hasLabel=!0),(0,o.isDefined)(e.hasDescription)||((0,o.isEmpty)(e.description)?e.hasDescription=!1:e.hasDescription=!0),this.attributes=e}},{key:"createFields",value:function(){var e=this.attributes.fields,t=[];if(Array.isArray(this.attributes.currentValue)&&this.attributes.currentValue.length>0)this.attributes.currentValue.forEach(function(n,i){var a=JSON.parse(JSON.stringify(e));a=a.map(function(e,t){return(0,o.isDefined)(n[e.optionCode])?e.currentValue=n[e.optionCode]:e.currentValue="",e}),t.push(a)});else if(this.attributes.isRequired){var n=JSON.parse(JSON.stringify(e));n.currentValue="",t.push(n)}t=t.map(function(e,t){return e=e.map(function(e,t){return e.label="",e.description="",new s.default(e.fieldType,e)})}),this.fieldRows=t}},{key:"createFormElement",value:function(){var t=null,n=e('<div class="form-repeater"></div>');if(this.attributes.hasLabel){var i=e('\n\t\t\t\t<div class="form-repeater__label">\n\t\t\t\t\t'+this.attributes.label+"\n\t\t\t\t\t"+(this.attributes.isRequired?'<span class="form-repeater__label-required"></span>':"")+"\n\t\t\t\t</div>\n\t\t\t");n.append(i)}var a=this.getFieldsTable();if(n.append(a),a.append(e('<div class="form-element__error"></div>')),this.attributes.hasDescription){var o=e('<div class="form-repeater__description">'+this.attributes.description+"</div>");n.append(o)}return this.formElement=n,t=n,this.fieldRows.length>1&&this.makeRowsSortable(),this.listenSave(),t}},{key:"listenSave",value:function(){var e=this;this.formElement.on("saved",function(t){e.updateAttributesFieldsFromRow()})}},{key:"updateAttributesFieldsFromRow",value:function(){var e=[];this.fieldRows.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.attributes)}),e.push(n)}),this.attributes.fields=e}},{key:"makeRowsSortable",value:function(){var t=this;l(this.formElement.find(".form-repeater-fields__table-rows"),{forcePlaceholderSize:!0,handle:".form-repeater-fields__table-rows-cell--number",placeholder:'<tr><td colspan="'+(this.fieldRows[0].length+2)+'">&nbsp;</td></tr>',itemSerializer:function(e,t){return{position:e.index,html:e.html}}}),this.formElement.find(".form-repeater-fields__table-rows").on("sortupdate",function(n){var i=[];e.each(n.detail.destination.items,function(t,n){i.push(e(n).data("order"))});var a=[];i.forEach(function(e){a.push(t.fieldRows[e])}),t.fieldRows=a,t.reRender()})}},{key:"getFieldsTable",value:function(){var t=this,n=e('\n\t\t\t<div class="form-repeater-fields">\n\t\t\t\t<table class="form-repeater-fields__table">\n\t\t\t\t\t<thead class="form-repeater-fields__table-heading"></thead>\n\t\t\t\t\t<tbody class="form-repeater-fields__table-rows"></tbody>\n\t\t\t\t</table>\n\t\t\t\t<div class="form-repeater-fields__actions"></div>\n\t\t\t</div>\n\t\t'),i=[];this.attributes.fields.forEach(function(e,t){var n=(0,o.isDefined)(e.label)?e.label:"",a=!!(0,o.isDefined)(e.isRequired)&&e.isRequired,r=(0,o.isDefined)(e.description)?e.description:"";i.push({title:n,description:r,isRequired:a})});var a=e("<tr></tr>");a.append(e('<th class="form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--number">#</th>')),i.forEach(function(t,n){var i=e('<th class="form-repeater-fields__table-heading-cell"></th>');(0,o.isEmpty)(t.title)||i.append(e('\n\t\t\t\t\t<div class="form-repeater-fields__table-heading-cell-title">\n\t\t\t\t\t\t'+t.title+"\n\t\t\t\t\t\t"+(t.isRequired?'<span class="form-repeater-fields__table-heading-cell-required"></span>':"")+"\n\t\t\t\t\t</div>\n\t\t\t\t")),(0,o.isEmpty)(t.description)||i.append(e('\n\t\t\t\t\t<div class="form-repeater-fields__table-heading-cell-description">\n\t\t\t\t\t\t'+t.description+"\n\t\t\t\t\t</div>\n\t\t\t\t")),a.append(i)}),a.append(e('<th class="form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--actions"></th>')),n.find(".form-repeater-fields__table-heading").append(a);var r=n.find(".form-repeater-fields__table-rows"),s=this.fieldRows.length;if(this.fieldRows.forEach(function(n,i){var a=e('<tr data-order="'+i+'"></tr>');a.append(e('<td class="form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--number">'+(i+1)+"</td>")),n.forEach(function(t,n){var i=e('<td class="form-repeater-fields__table-rows-cell"></td>'),o=t.getFormElement();t.initLibraries(),i.append(o),a.append(i)});var l=e('<td class="form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--actions"></td>');a.append(l);var c=t.getAttributes();if(0!=i||0==i&&(!t.attributes.isRequired||s>1)){var u=(0,o.isDefined)(t.attributes.removeRowButtonLabel)?t.attributes.removeRowButtonLabel:UncannyAutomator.i18n.removeRow,d=e('<div class="form-repeater-fields__table-rows-cell-remove" uap-tooltip="'+u+'"><span></span></div>');d.on("click",function(){t.deleteRow(i)}),c.hideActions||l.append(d)}r.append(a)}),!this.getAttributes().hideActions){var l=e('\n\t\t\t\t<div class="uap-btn uap-btn--primary uap-btn--small">\n\t\t\t\t\t'+UncannyAutomator.i18n.addRow+"\n\t\t\t\t</div>\n\t\t\t");(0,o.isDefined)(this.attributes.addRowButtonLabel)&&l.text(this.attributes.addRowButtonLabel),l.on("click",function(){t.addRow()}),n.find(".form-repeater-fields__actions").append(l)}return n}},{key:"getValue",value:function(){var e=[];return this.fieldRows.forEach(function(t,n){var i={};t.forEach(function(e,t){i[e.getFieldID()]=e.getValue()}),e.push(i)}),e}},{key:"addRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=JSON.parse(JSON.stringify(this.attributes.fields));n.currentValue="",n=n.map(function(t,n){return t.label="",t.description="",(0,o.isDefined)(e[t.optionCode])&&(t.currentValue=e[t.optionCode]),new s.default(t.fieldType,t)}),this.fieldRows.push(n),t&&this.reRender()}},{key:"reRender",value:function(){this.formElement.replaceWith(this.createFormElement())}},{key:"deleteRow",value:function(e){(0,o.isDefined)(this.fieldRows[e])&&this.fieldRows.splice(e,1),this.formElement.replaceWith(this.createFormElement())}},{key:"getFormElement",value:function(){return this.formElement}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getFieldID",value:function(){return this.attributes.optionCode}},{key:"validate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={isValid:!0,message:""},n=[];return this.fieldRows.forEach(function(i,a){var o={};i.forEach(function(n,i){o[n.getFieldID()]=n.validate(e),t.isValid=t.isValid&&o[n.getFieldID()].isValid}),n.push(o)}),t}}]),t}();t.default=c}).call(t,n(1))},function(e,t,n){"use strict";function i(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}function a(e){e.h5s&&delete e.h5s.data}function o(e,t,n){if(e instanceof Array)for(var i=0;i<e.length;++i)o(e[i],t,n);else e.addEventListener(t,n),T(e).setData("event"+t,n)}function r(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)r(e[n],t);else e.removeEventListener(t,T(e).getData("event"+t)),T(e).deleteData("event"+t)}function s(e,t,n){if(e instanceof Array)for(var i=0;i<e.length;++i)s(e[i],t,n);else e.setAttribute(t,n)}function l(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)l(e[n],t);else e.removeAttribute(t)}function c(e,t){var n=this;if(void 0===t&&(t=250),"function"!=typeof e)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var i=null;return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var r=Date.now();(null===i||r-i>=t)&&(i=r,e.apply(n,a))}}function u(e,t){if(t.composedPath)return t.composedPath().find(function(e){return e.isSortable});for(;!0!==e.isSortable;)e=e.parentElement;return e}function d(e,t){var n=i(e,"opts"),a=w(e.children,n.items),o=a.filter(function(e){return e.contains(t)||e.shadowRoot&&e.shadowRoot.contains(t)});return o.length>0?o[0]:t}function p(e,t){var n=String(t);return t=t||{},"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLElement&&(e=[e]),e=Array.prototype.slice.call(e),/serialize/.test(n)?e.map(function(e){var t=i(e,"opts");return I(e,t.itemSerializer,t.containerSerializer)}):(e.forEach(function(e){if(/enable|disable|destroy/.test(n))return p[n](e);["connectWith","disableIEFix"].forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&null!==t[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')}),t=Object.assign({},N,T(e).config,t),T(e).config=t,i(e,"opts",t),e.isSortable=!0,Q(e);var a,r=w(e.children,t.items);if(null!==t.placeholder&&void 0!==t.placeholder){var l=document.createElement(e.tagName);t.placeholder instanceof HTMLElement?l.appendChild(t.placeholder):l.innerHTML=t.placeholder,a=l.children[0]}T(e).placeholder=R(e,a,t.placeholderClass),i(e,"items",t.items),t.acceptFrom?i(e,"acceptFrom",t.acceptFrom):t.connectWith&&i(e,"connectWith",t.connectWith),Y(e),s(r,"role","option"),s(r,"aria-grabbed","false"),B(e,!0),o(e,"dragstart",function(e){var n=M(e);if(!0!==n.isSortable&&(e.stopImmediatePropagation(),(!t.handle||n.matches(t.handle))&&"false"!==n.getAttribute("draggable"))){var i=u(n,e),a=d(i,n);b=w(i.children,t.items),g=b.indexOf(a),y=D(a,i.children),h=i,P(e,a,t.customDragImage),f=L(a),v=j(a),a.classList.add(t.draggingClass),m=W(a,i),s(m,"aria-grabbed","true"),i.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:y,index:g,container:h},item:m,originalTarget:n}}))}}),o(e,"dragenter",function(n){var a=M(n),r=u(a,n);r&&r!==_&&(k=w(r.children,i(r,"items")).filter(function(t){return t!==T(e).placeholder}),t.dropTargetContainerClass&&r.classList.add(t.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:y,index:g,container:h},destination:{container:r,itemsBeforeUpdate:k},item:m,originalTarget:a}})),o(r,"dragleave",function(e){var n=e.relatedTarget||e.fromElement;e.currentTarget.contains(n)||(t.dropTargetContainerClass&&r.classList.remove(t.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:y,index:g,container:r},item:m,originalTarget:a}})))})),_=r}),o(e,"dragend",function(n){if(m){m.classList.remove(t.draggingClass),s(m,"aria-grabbed","false"),"true"===m.getAttribute("aria-copied")&&"true"!==i(m,"dropped")&&m.remove(),m.style.display=m.oldDisplay,delete m.oldDisplay;var a=Array.from(A.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(E)[0];a&&a.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:y,index:g,container:h},item:m}})),_=null,m=null,f=null,v=null}}),o(e,"drop",function(n){if(q(e,m.parentElement)){n.preventDefault(),n.stopPropagation(),i(m,"dropped","true");var a=Array.from(A.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(E)[0];O(a,m),a.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:y,index:g,container:h},item:m}}));var o=T(e).placeholder,r=w(h.children,t.items).filter(function(e){return e!==o}),s=!0===this.isSortable?this:this.parentElement,l=w(s.children,i(s,"items")).filter(function(e){return e!==o}),c=D(m,Array.from(m.parentElement.children).filter(function(e){return e!==o})),u=D(m,l);t.dropTargetContainerClass&&s.classList.remove(t.dropTargetContainerClass),y===c&&h===s||e.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:y,index:g,container:h,itemsBeforeUpdate:b,items:r},destination:{index:u,elementIndex:c,container:s,itemsBeforeUpdate:k,items:l},item:m}}))}});var c=C(function(e,n,i,a){if(m)if(t.forcePlaceholderSize&&(T(e).placeholder.style.height=f+"px",T(e).placeholder.style.width=v+"px"),Array.from(e.children).indexOf(n)>-1){var o=L(n),r=j(n),s=D(T(e).placeholder,n.parentElement.children),l=D(n,n.parentElement.children);if(o>f||r>v){var c=o-f,u=r-v,d=x(n).top,p=x(n).left;if(s<l&&("vertical"===t.orientation&&a<d||"horizontal"===t.orientation&&i<p))return;if(s>l&&("vertical"===t.orientation&&a>d+o-c||"horizontal"===t.orientation&&i>p+r-u))return}void 0===m.oldDisplay&&(m.oldDisplay=m.style.display),"none"!==m.style.display&&(m.style.display="none");var h=!1;try{var g=x(n).top+n.offsetHeight/2,y=x(n).left+n.offsetWidth/2;h="vertical"===t.orientation&&a>=g||"horizontal"===t.orientation&&i>=y}catch(e){h=s<l}h?O(n,T(e).placeholder):V(n,T(e).placeholder),Array.from(A.values()).filter(function(e){return void 0!==e.placeholder}).forEach(function(t){t.placeholder!==T(e).placeholder&&t.placeholder.remove()})}else{var b=Array.from(A.values()).filter(function(e){return void 0!==e.placeholder}).map(function(e){return e.placeholder});-1!==b.indexOf(n)||e!==n||w(n.children,t.items).length||(b.forEach(function(e){return e.remove()}),n.appendChild(T(e).placeholder))}},t.debounce),U=function(e){var t=e.target,n=!0===t.isSortable?t:u(t,e);if(t=d(n,t),m&&q(n,m.parentElement)&&"true"!==i(n,"_disabled")){var a=i(n,"opts");parseInt(a.maxItems)&&w(n.children,i(n,"items")).length>=parseInt(a.maxItems)&&m.parentElement!==n||(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=!0===T(n).getConfig("copy")?"copy":"move",c(n,t,e.pageX,e.pageY))}};o(r.concat(e),"dragover",U),o(r.concat(e),"dragenter",U)}),e)}var m,f,v,h,g,y,b,_,k,w=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter(function(e){return 1===e.nodeType&&e.matches(t)})},A=new Map,U=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach(function(t,n){e[n]=t}),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),T=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return A.has(e)||A.set(e,new U),A.get(e)},x=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},C=function(e,t){void 0===t&&(t=0);var n;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];clearTimeout(n),n=setTimeout(function(){e.apply(void 0,i)},t)}},D=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},E=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},S=function(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},V=function(e,t){return S(e,t,"before")},O=function(e,t){return S(e,t,"after")},I=function(e,t,n){if(void 0===t&&(t=function(e,t){return e}),void 0===n&&(n=function(e){return e}),!(e instanceof HTMLElement)||!0==!e.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof t||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var a=i(e,"opts"),o=a.items,r=w(e.children,o),s=r.map(function(t){return{parent:e,node:t,html:t.outerHTML,index:D(t,r)}});return{container:n({node:e,itemCount:s.length}),items:s.map(function(n){return t(n,e)})}},R=function(e,t,n){var i;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr"),t.innerHTML='<td colspan="100"></td>'):t=document.createElement("div")),"string"==typeof n&&(i=t.classList).add.apply(i,n.split(" ")),t},L=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map(function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n}).reduce(function(e,t){return e+t})},j=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map(function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n}).reduce(function(e,t){return e+t})},F=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter(function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement}).map(function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)})},M=function(e){return e.composedPath&&e.composedPath()[0]||e.target},$=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},P=function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=$),e.dataTransfer&&e.dataTransfer.setDragImage){var i=x(t),a=n(t,i,e);if(!(a.element instanceof HTMLElement)||"number"!=typeof a.posX||"number"!=typeof a.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",M(e).id),e.dataTransfer.setDragImage(a.element,a.posX,a.posY)}},q=function(e,t){if(!0===e.isSortable){var n=T(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter(function(e){return e.length>0&&t.matches(e)}).length>0;if(e===t)return!0;if(void 0!==T(e).getConfig("connectWith")&&null!==T(e).getConfig("connectWith"))return T(e).getConfig("connectWith")===T(t).getConfig("connectWith")}return!1},N={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"},B=function(e,t){if("string"==typeof T(e).getConfig("hoverClass")){var n=T(e).getConfig("hoverClass").split(" ");!0===t?(o(e,"mousemove",c(function(t){0===t.buttons&&w(e.children,T(e).getConfig("items")).forEach(function(e){var i,a;e!==t.target?(i=e.classList).remove.apply(i,n):(a=e.classList).add.apply(a,n)})},T(e).getConfig("throttleTime"))),o(e,"mouseleave",function(){w(e.children,T(e).getConfig("items")).forEach(function(e){var t;(t=e.classList).remove.apply(t,n)})})):(r(e,"mousemove"),r(e,"mouseleave"))}},H=function(e){r(e,"dragstart"),r(e,"dragend"),r(e,"dragover"),r(e,"dragenter"),r(e,"drop"),r(e,"mouseenter"),r(e,"mouseleave")},z=function(e,t){e&&r(e,"dragleave"),t&&t!==e&&r(t,"dragleave")},W=function(e,t){var n=e;return!0===T(t).getConfig("copy")&&(n=e.cloneNode(!0),s(n,"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n},G=function(e){a(e),l(e,"aria-dropeffect")},J=function(e){l(e,"aria-grabbed"),l(e,"aria-copied"),l(e,"draggable"),l(e,"role")},X=function(e){var t=i(e,"opts")||{},n=w(e.children,t.items),a=F(n,t.handle);r(e,"dragover"),r(e,"dragenter"),r(e,"dragstart"),r(e,"dragend"),r(e,"drop"),G(e),r(a,"mousedown"),H(n),J(n),z(h,_),e.isSortable=!1},Y=function(e){var t=i(e,"opts"),n=w(e.children,t.items),a=F(n,t.handle);if(s(e,"aria-dropeffect","move"),i(e,"_disabled","false"),s(a,"draggable","true"),!1===t.disableIEFix){"function"==typeof(document||window.document).createElement("span").dragDrop&&o(a,"mousedown",function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===n.indexOf(e);)e=e.parentElement;e.dragDrop()}})}},K=function(e){var t=i(e,"opts"),n=w(e.children,t.items),a=F(n,t.handle);s(e,"aria-dropeffect","none"),i(e,"_disabled","true"),s(a,"draggable","false"),r(a,"mousedown")},Q=function(e){var t=i(e,"opts"),n=w(e.children,t.items),a=F(n,t.handle);i(e,"_disabled","false"),H(n),z(h,_),r(a,"mousedown"),r(e,"dragover"),r(e,"dragenter"),r(e,"drop")};p.destroy=function(e){X(e)},p.enable=function(e){Y(e)},p.disable=function(e){K(e)},p.__testing={_data:i,_removeItemEvents:H,_removeItemData:J,_removeSortableData:G,_removeContainerEvents:z},e.exports=p},function(e,t,n){var i;!function(){"use strict";function a(e){return r(s(e),arguments)}function o(e,t){return a.apply(null,[e].concat(t||[]))}function r(e,t){var n,i,o,r,s,c,u,d,p,m=1,f=e.length,v="";for(i=0;i<f;i++)if("string"==typeof e[i])v+=e[i];else if("object"==typeof e[i]){if(r=e[i],r.keys)for(n=t[m],o=0;o<r.keys.length;o++){if(void 0==n)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',r.keys[o],r.keys[o-1]));n=n[r.keys[o]]}else n=r.param_no?t[r.param_no]:t[m++];if(l.not_type.test(r.type)&&l.not_primitive.test(r.type)&&n instanceof Function&&(n=n()),l.numeric_arg.test(r.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(a("[sprintf] expecting number but found %T",n));switch(l.number.test(r.type)&&(d=n>=0),r.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,r.width?parseInt(r.width):0);break;case"e":n=r.precision?parseFloat(n).toExponential(r.precision):parseFloat(n).toExponential();break;case"f":n=r.precision?parseFloat(n).toFixed(r.precision):parseFloat(n);break;case"g":n=r.precision?String(Number(n.toPrecision(r.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=r.precision?n.substring(0,r.precision):n;break;case"t":n=String(!!n),n=r.precision?n.substring(0,r.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=r.precision?n.substring(0,r.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=r.precision?n.substring(0,r.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}l.json.test(r.type)?v+=n:(!l.number.test(r.type)||d&&!r.sign?p="":(p=d?"+":"-",n=n.toString().replace(l.sign,"")),c=r.pad_char?"0"===r.pad_char?"0":r.pad_char.charAt(1):" ",u=r.width-(p+n).length,s=r.width&&u>0?c.repeat(u):"",v+=r.align?p+n+s:"0"===c?p+s+n:s+p+n)}return v}function s(e){if(c[e])return c[e];for(var t,n=e,i=[],a=0;n;){if(null!==(t=l.text.exec(n)))i.push(t[0]);else if(null!==(t=l.modulo.exec(n)))i.push("%");else{if(null===(t=l.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){a|=1;var o=[],r=t[2],s=[];if(null===(s=l.key.exec(r)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(s[1]);""!==(r=r.substring(s[0].length));)if(null!==(s=l.key_access.exec(r)))o.push(s[1]);else{if(null===(s=l.index_access.exec(r)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(s[1])}t[2]=o}else a|=2;if(3===a)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=i}var l={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},c=Object.create(null);t.sprintf=a,t.vsprintf=o,"undefined"!=typeof window&&(window.sprintf=a,window.vsprintf=o,void 0!==(i=function(){return{sprintf:a,vsprintf:o}}.call(t,n,t,e))&&(e.exports=i))}()},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(3),l=i(s),c=n(2),u=i(c),d=n(8),p=i(d),m=function(){function t(){a(this,t),UncannyAutomator.recipe.userSelector.step=(0,r.userSelectorObject)("get-step"),this.render()}return o(t,[{key:"render",value:function(){var e="";switch(UncannyAutomator.recipe.userSelector.step){case"select-source":UncannyAutomator.recipe.userSelector.isValid=!1,(0,r.recipeObject)("validate"),e=this.getSelectSourceNodes();break;case"set-options":e=this.getOptionsNodes();break;case"show-sentence":(0,r.recipeObject)("validate"),UncannyAutomator.recipe.errorMode=!1,new p.default,e=this.getSentenceNodes()}var t=(0,r.getDOMElements)("metabox",{type:"action"});console.log("%cRender User Selector","background: red; color: #fff; padding: 2px 10px;"),t.prepend(e)}},{key:"getSelectSourceNodes",value:function(){var t=e('\n\t\t\t<div class="user-selector">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-integrations">\n\t\t\t\t\t\t\t<div class="item-integration user-selector-option user-selector-option--existing-user" data-source="existingUser">\n\t\t\t\t\t\t\t\t<div class="item-integration__logo"></div>\n\t\t\t\t\t\t\t\t<div class="item-integration__name">\n\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.userSelector.userType.existing+'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-integration user-selector-option user-selector-option--new-user" data-source="newUser">\n\t\t\t\t\t\t\t\t<div class="item-integration__logo"></div>\n\t\t\t\t\t\t\t\t<div class="item-integration__name">\n\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.userSelector.userType.new+"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t");return t.find(".item").prepend(this.getHeaderNodes()),t.find(".user-selector-option").on("click",function(t){var n=e(t.currentTarget),i=n.data("source");(0,r.userSelectorObject)("set-source",{source:i}),UncannyAutomator.recipe.userSelector.step="set-options",new u.default}),t}},{key:"getOptionsNodes",value:function(){var t=e('\n\t\t\t<div class="user-selector">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-options"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t');return t.find(".item").prepend(this.getHeaderNodes()),t.find(".item-options").append(this.getOptionsFields()),t}},{key:"getOptionsFields",value:function(){var t=e("<div></div>"),n=e('<div class="item-options__group"></div>'),i=[];(0,r.userSelectorObject)("update-fields",{source:"existingUser",fields:{}}),(0,r.userSelectorObject)("update-fields",{source:"newUser",fields:{}});var a=UncannyAutomator.recipe.userSelector.resources.roles;switch(delete a.administrator,UncannyAutomator.recipe.userSelector.source){case"existingUser":var o=e('<div class="user-selector__field-group user-selector__field-group--two-columns"></div>'),s=new l.default("select",{itemType:"user-selector",optionCode:"uniqueField",label:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldLabel,currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.uniqueField,isRequired:!0,options:[{value:"email",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionEmail},{value:"id",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionId},{value:"username",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionUsername}]});i.push(s);var c=new l.default("text",{itemType:"user-selector",optionCode:"uniqueFieldValue",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.uniqueFieldValue,label:UncannyAutomator.i18n.userSelector.existingUser.valueFieldLabel,placeholder:UncannyAutomator.i18n.userSelector.existingUser.valueFieldPlaceholder,isRequired:!0,supportsTokens:!0});i.push(c);var d=s.getFormElement();o.append(d);var p=c.getFormElement();o.append(p),n.append(o);var m=new l.default("radio",{itemType:"user-selector",optionCode:"fallback",name:"user-selector-existing-user-fallback",label:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldLabel,isRequired:!0,currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.fallback,options:[{value:"create-new-user",text:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionCreateUser},{value:"do-nothing",text:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionDoNothing}]});i.push(m);var f=m.getFormElement();if(n.append(f),d.on("automator:field:change",function(){(0,r.userSelectorObject)("update-fields",{source:"existingUser",fields:{uniqueField:s.getValue()}})}),p.on("automator:field:change",function(){(0,r.userSelectorObject)("update-fields",{source:"existingUser",fields:{uniqueFieldValue:c.getValue()}})}),f.on("automator:field:change",function(){(0,r.userSelectorObject)("update-fields",{source:"existingUser",fields:{fallback:m.getValue()}}),new u.default}),"do-nothing"==UncannyAutomator.recipe.userSelector.fields.existingUser.fallback){var v=e('\n\t\t\t\t\t\t<div class="user-selector__warning">\n\t\t\t\t\t\t\t'+UncannyAutomator.i18n.userSelector.existingUser.doNothingMessage+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t");n.append(v)}else if("create-new-user"==UncannyAutomator.recipe.userSelector.fields.existingUser.fallback){var h=e("<div/>",{class:"item-options"}),g=[{itemType:"user-selector",fieldType:"text",optionCode:"firstName",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.firstName,label:UncannyAutomator.i18n.userSelector.newUser.firstName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"lastName",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.lastName,label:UncannyAutomator.i18n.userSelector.newUser.lastName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"email",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.email,label:UncannyAutomator.i18n.userSelector.newUser.email,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"username",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.username,label:UncannyAutomator.i18n.userSelector.newUser.username,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"displayName",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.displayName,label:UncannyAutomator.i18n.userSelector.newUser.displayName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"password",currentValue:UncannyAutomator.recipe.userSelector.fields.existingUser.password,label:UncannyAutomator.i18n.userSelector.newUser.password,description:UncannyAutomator.i18n.userSelector.newUser.passwordDescription,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"select",optionCode:"role",currentValue:(0,r.isEmpty)(UncannyAutomator.recipe.userSelector.fields.existingUser.role)?"subscriber":UncannyAutomator.recipe.userSelector.fields.existingUser.role,label:UncannyAutomator.i18n.userSelector.newUser.role,isRequired:!0,supportsTokens:!1,options:Object.keys(a).map(function(e,t){return{value:e,text:a[e]}})},{itemType:"user-selector",fieldType:"radio",optionCode:"logUserIn",name:"logUserIn",currentValue:UncannyAutomator.recipe.canLogNewUserIn?(0,r.isEmpty)(UncannyAutomator.recipe.userSelector.fields.existingUser.logUserIn)?"no":UncannyAutomator.recipe.userSelector.fields.existingUser.logUserIn:"no",isHidden:!UncannyAutomator.recipe.canLogNewUserIn,label:UncannyAutomator.i18n.userSelector.logUserIn,supportsTokens:!1,options:[{value:"yes",text:UncannyAutomator.i18n.yes},{value:"no",text:UncannyAutomator.i18n.no}]}];g.forEach(function(e){var t=new l.default(e.fieldType,e),n=t.getFormElement();h.append(n),i.push(t)}),n.append(h)}break;case"newUser":[{itemType:"user-selector",fieldType:"text",optionCode:"firstName",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.firstName,label:UncannyAutomator.i18n.userSelector.newUser.firstName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"lastName",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.lastName,label:UncannyAutomator.i18n.userSelector.newUser.lastName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"email",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.email,label:UncannyAutomator.i18n.userSelector.newUser.email,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"username",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.username,label:UncannyAutomator.i18n.userSelector.newUser.username,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"displayName",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.displayName,label:UncannyAutomator.i18n.userSelector.newUser.displayName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"password",currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.password,label:UncannyAutomator.i18n.userSelector.newUser.password,description:UncannyAutomator.i18n.userSelector.newUser.passwordDescription,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"select",optionCode:"role",currentValue:(0,r.isEmpty)(UncannyAutomator.recipe.userSelector.fields.newUser.role)?"subscriber":UncannyAutomator.recipe.userSelector.fields.newUser.role,label:UncannyAutomator.i18n.userSelector.newUser.role,isRequired:!0,supportsTokens:!1,options:Object.keys(a).map(function(e,t){return{value:e,text:a[e]}})},{itemType:"user-selector",fieldType:"radio",optionCode:"logUserIn",name:"logUserIn",currentValue:UncannyAutomator.recipe.canLogNewUserIn?(0,r.isEmpty)(UncannyAutomator.recipe.userSelector.fields.newUser.logUserIn)?"no":UncannyAutomator.recipe.userSelector.fields.newUser.logUserIn:"no",isHidden:!UncannyAutomator.recipe.canLogNewUserIn,label:UncannyAutomator.i18n.userSelector.logUserIn,supportsTokens:!1,options:[{value:"yes",text:UncannyAutomator.i18n.yes},{value:"no",text:UncannyAutomator.i18n.no}]}].forEach(function(e){var t=new l.default(e.fieldType,e),a=t.getFormElement();n.append(a),i.push(t)});var y=new l.default("radio",{itemType:"user-selector",optionCode:"fallback",name:"user-selector-new-user-fallback",label:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldLabel,isRequired:!0,currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.fallback,options:[{value:"select-existing-user",text:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionExisting},{value:"do-nothing",text:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionDoNothing}]});i.push(y);var b=y.getFormElement();if(n.append(b),b.on("automator:field:change",function(){var e={};i.forEach(function(t){e[t.getAttributes().optionCode]=t.getValue()}),(0,r.userSelectorObject)("update-fields",{source:"newUser",fields:e}),new u.default}),"do-nothing"==UncannyAutomator.recipe.userSelector.fields.newUser.fallback){var _=e('\n\t\t\t\t\t\t<div class="user-selector__warning">\n\t\t\t\t\t\t\t'+UncannyAutomator.i18n.userSelector.newUser.doNothingMessage+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t");n.append(_)}else if("select-existing-user"==UncannyAutomator.recipe.userSelector.fields.newUser.fallback){var k=e("<div/>",{class:"item-options"}),w=new l.default("select",{itemType:"user-selector",optionCode:"prioritizedField",label:UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldLabel,currentValue:UncannyAutomator.recipe.userSelector.fields.newUser.prioritizedField,defaultValue:"email",description:UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldDescription,isRequired:!0,options:[{value:"email",text:UncannyAutomator.i18n.userSelector.newUser.email},{value:"username",text:UncannyAutomator.i18n.userSelector.newUser.username}]});i.push(w);var A=w.getFormElement();k.append(A),n.append(k)}}t.append(n);var U=e('<div class="item-options__buttons"></div>'),T=e('<div class="uap-btn uap-btn--primary">'+UncannyAutomator.i18n.save+"</div>"),x=e('<div class="uap-btn uap-btn--secondary">'+UncannyAutomator.i18n.cancel+"</div>");return T.on("click",function(){var e=!0,t={};i.forEach(function(n){var i=n.validate().isValid;e=e&&i,i&&(t[n.getAttributes().optionCode]=n.getValue())}),(0,r.userSelectorObject)("update-fields",{source:UncannyAutomator.recipe.userSelector.source,fields:t}),e&&(T.addClass("uap-btn--primary uap-btn--loading uap-btn--disabled"),(0,r.restCall)("user-selector",{recipeId:UncannyAutomator.recipe.id,source:UncannyAutomator.recipe.userSelector.source,fields:UncannyAutomator.recipe.userSelector.fields[UncannyAutomator.recipe.userSelector.source]},function(e){UncannyAutomator.recipe.userSelector.isValid=!0,(0,r.userSelectorObject)("set-step",{step:"show-sentence"}),new u.default},function(e){}))}),x.on("click",function(){(0,r.userSelectorObject)("set-step",{step:"select-source"}),new u.default}),U.append(T),U.append(x),t.append(U),t}},{key:"getSentenceNodes",value:function(){var t=e('\n\t\t\t<div class="user-selector user-selector--summary">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-options">\n\t\t\t\t\t\t\t<div class="user-selector-summary"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t');t.find(".item").prepend(this.getHeaderNodes());var n=t.find(".user-selector-summary"),i=e('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--atom"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t'),a=e('\n\t\t\t<div class="user-selector-summary-row__token"></div>\n\t\t');i.find(".user-selector-summary-row__content").append(a),"existingUser"==UncannyAutomator.recipe.userSelector.source?a.text(UncannyAutomator.i18n.userSelector.userType.existing):"newUser"==UncannyAutomator.recipe.userSelector.source&&a.text(UncannyAutomator.i18n.userSelector.userType.new),a.on("click",function(){(0,r.userSelectorObject)("set-step",{step:"select-source"}),new u.default}),n.append(i);var o=e('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--fingerprint"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t'),s=void 0;"existingUser"==UncannyAutomator.recipe.userSelector.source?s=e("\n\t\t\t\t<div>\n\t\t\t\t"+(0,r.vsprintf)(UncannyAutomator.i18n.userSelector.summary.matches,['<div class="user-selector-summary-row__token">'+UncannyAutomator.i18n.userSelector.summary[UncannyAutomator.recipe.userSelector.fields.existingUser.uniqueField]+"</div>",'<div class="user-selector-summary-row__token">'+UncannyAutomator.recipe.userSelector.fields.existingUser.uniqueFieldValue+"</div>"])+"\n\t\t\t\t</div>"):"newUser"==UncannyAutomator.recipe.userSelector.source&&(s=e("\n\t\t\t\t<div>\n\t\t\t\t"+(0,r.vsprintf)(UncannyAutomator.i18n.userSelector.summary.withEmail,['<div class="user-selector-summary-row__token">'+UncannyAutomator.recipe.userSelector.fields.newUser.email+"</div>"])+"\n\t\t\t\t</div>\n\t\t\t\t")),o.find(".user-selector-summary-row__content").append(s),s.find(".user-selector-summary-row__token").on("click",function(){(0,r.userSelectorObject)("set-step",{step:"set-options"}),new u.default}),n.append(o);var l=e('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--directions"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t'),c="";"existingUser"==UncannyAutomator.recipe.userSelector.source?"create-new-user"==UncannyAutomator.recipe.userSelector.fields.existingUser.fallback?c=UncannyAutomator.i18n.userSelector.summary.createNewUser:"do-nothing"==UncannyAutomator.recipe.userSelector.fields.existingUser.fallback&&(c=UncannyAutomator.i18n.userSelector.summary.doNothing):"newUser"==UncannyAutomator.recipe.userSelector.source&&("select-existing-user"==UncannyAutomator.recipe.userSelector.fields.newUser.fallback?c=UncannyAutomator.i18n.userSelector.summary.selectExistingUser:"do-nothing"==UncannyAutomator.recipe.userSelector.fields.newUser.fallback&&(c=UncannyAutomator.i18n.userSelector.summary.doNothing));var d=e("\n\t\t\t<div>\n\t\t\t"+(0,r.vsprintf)(UncannyAutomator.i18n.userSelector.summary.otherwise,['<div class="user-selector-summary-row__token">'+c+"</div>"])+"\n\t\t\t</div>");return l.find(".user-selector-summary-row__content").append(d),l.find(".user-selector-summary-row__token").on("click",function(){(0,r.userSelectorObject)("set-step",{step:"set-options"}),new u.default}),n.append(l),t}},{key:"getHeaderNodes",value:function(){var t=void 0;switch(UncannyAutomator.recipe.userSelector.step){case"select-source":case"show-sentence":t=UncannyAutomator.i18n.userSelector.sentenceTitle;break;case"set-options":t=UncannyAutomator.i18n.userSelector.setOptions}var n=e('\n\t\t\t<div>\n\t\t\t\t<div class="item-actions">\n\t\t\t\t\t<div class="item-actions__btn">\n\t\t\t\t\t\t<i class="uo-icon uo-icon--ellipsis-h-alt"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="item-actions__dropdown">\n\t\t\t\t\t\t<ul class="item-actions-dropdown__ul">\n\t\t\t\t\t\t\t<a href="#" target="_blank" class="item-actions-dropdown__action">\n\t\t\t\t\t\t\t\t<span>'+UncannyAutomator.i18n.support+'</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="item-icon"></div>\n\t\t\t\t<div class="item-title uap-clear">\n\t\t\t\t\t<div class="item-title__describe">\n\t\t\t\t\t\t<div class="item-title__non-editable">\n\t\t\t\t\t\t\t'+t+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t");return n.find(".item-actions__btn").on("click",function(){n.find(".item-actions").toggleClass("item-actions--open")}),n}}]),t}();t.default=m}).call(t,n(1))},function(module,exports,__webpack_require__){"use strict";(function($){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_Utilities=__webpack_require__(0),_Validation=__webpack_require__(5),_Triggers=__webpack_require__(4),_Triggers2=_interopRequireDefault(_Triggers),_Actions=__webpack_require__(2),_Actions2=_interopRequireDefault(_Actions),_Modal=__webpack_require__(9),_Modal2=_interopRequireDefault(_Modal),_Markdown=__webpack_require__(29),_Markdown2=_interopRequireDefault(_Markdown),ItemOptions=function(){function ItemOptions(e,t){_classCallCheck(this,ItemOptions),this.itemId=e,this.optionId=t,this.item=UncannyAutomator.recipe.items[e],this.fields=this.item.options[this.optionId].fields,this.buttons=this.item.options[this.optionId].buttons,this.create(),this.initTinyMCE()}return _createClass(ItemOptions,[{key:"create",value:function(){var e=(0,_Utilities.getDOMElements)("item",{id:this.itemId}).contentContainer,t=$("<div/>",{class:"item-options"}),n=this.createButtons(),i=this.createFields();this.fieldsContainer=i,t.append(i);var a=$("<div/>",{class:"item-options__notices"});this.noticeContainer=a,t.append(a),t.append(n),e.html(t)}},{key:"createFields",value:function(){var e=this,t=$("<div/>",{class:"item-options__group"});return $.each(this.fields,function(n,i){var a=i.getAttributes().fieldType;"repeater"==a&&i.createFields(),i.createFormElement(),t.append(i.getFormElement()),["textarea","group","repeater"].includes(a)?"group"==a?i.fields.forEach(function(t){"textarea"!==t.getAttributes().fieldType&&t.getField().on("keyup",function(t){13==t.keyCode&&e.saveButton.trigger("click")})}):"repeater"==a&&i.fieldRows.forEach(function(t,n){t.forEach(function(t,n){t.getField().on("keyup",function(t){13==t.keyCode&&e.saveButton.trigger("click")})})}):i.getField().on("keyup",function(t){13==t.keyCode&&e.saveButton.trigger("click")})}),t}},{key:"createButtons",value:function createButtons(){var _this2=this,container=$("<div/>",{class:"item-options__buttons"}),automatorButtons=$("<div/>",{class:"item-options__automator-buttons"}),developerButtons=$("<div/>",{class:"item-options__developer-buttons"}),saveButton=$("<div/>",{class:"uap-btn uap-btn--primary"}),cancelButton=$("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);return"trigger"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),"action"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),"closure"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),this.saveButton=saveButton,automatorButtons.append(saveButton),automatorButtons.append(cancelButton),$.each(this.buttons,function(index,button){var $buttonElement=$("<div/>",{class:"uap-btn"}).text(button.text);(0,_Utilities.isDefined)(button.css_classes)&&$buttonElement.addClass(button.css_classes);var doOnClick=function(){};if((0,_Utilities.isDefined)(button.on_click))try{doOnClick=eval("("+button.on_click.replace("<script>","").replace("<\/script>","").trim()+")")}catch(e){console.log(e),console.log(button.on_click)}$buttonElement.on("click",function(){doOnClick($buttonElement,{item:_this2.item,values:(0,_Utilities.getCurrentFieldsValues)(_this2.itemId)},function(){var e={};return(0,_Utilities.isDefined)(button.modules)&&(button.modules.includes("modal")&&(e.Modal=_Modal2.default),button.modules.includes("markdown")&&(e.Markdown=_Markdown2.default)),e}())}),developerButtons.append($buttonElement)}),container.append(automatorButtons),container.append(developerButtons),saveButton.on("click",function(){if((0,_Validation.validateItemFields)(_this2.fieldsContainer).isValid){saveButton.addClass("uap-btn--loading uap-btn--disabled");var e=_this2.itemId,t=_this2.optionId,n=_this2.getOptionValue(),i=(0,_Utilities.parseStringWithTokens)(_this2.item,_this2.item.meta.sentence,$.extend({},_this2.item.meta,(0,_Utilities.getCurrentFieldsValues)(_this2.itemId)));(0,_Utilities.restCall)("update",{itemId:e,optionCode:t,optionValue:n,sentence_human_readable:i.brackets},function(e){_this2.fields.forEach(function(e){e.getFormElement().trigger("saved")}),"trigger"==_this2.item.itemType&&new _Triggers2.default,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions2.default;var t=UncannyAutomator.recipe.items[_this2.item.id].isValid,n=(0,_Utilities.getDOMElements)("item",{id:_this2.item.id});t?UncannyAutomator.recipe.isLive||_this2.item.isLive||n.item.find('.item-status input[type="checkbox"]').prop("checked",!0).trigger("change"):n.item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")},function(e){console.log("‼️ ERROR-TODO. Couldn't save the options of the item"),"trigger"==_this2.item.itemType&&new _Triggers2.default,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions2.default;try{(0,_Utilities.getDOMElements)("item",{id:_this2.itemId}).item.find('.item-title__token[data-options-id="'+t+'"]').trigger("click")}catch(e){}})}}),cancelButton.on("click",function(){"trigger"==_this2.item.itemType&&new _Triggers2.default,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions2.default}),container}},{key:"initTinyMCE",value:function(){$.each(this.fields,function(e,t){"textarea"==t.getAttributes().fieldType&&t.initTinyMCE()})}},{key:"getOptionValue",value:function(){var e={},t=!1,n=!1;return $.each(this.fields,function(i,a){var o=a.getAttributes().optionCode,r=a.getValue();if(["select","radio"].includes(a.getAttributes().fieldType)){if(t=!0,a.getAttributes().supportsMultipleValues)try{r=JSON.stringify(r)}catch(e){console.log(e)}e[(0,_Utilities.vsprintf)("%s_readable",[o])]=a.getReadableValue();var s=a.getSelectCustomValue();"automator_custom_value"==r&&(e[(0,_Utilities.vsprintf)("%s_custom",[o])]=s)}else"repeater"==a.getAttributes().fieldType&&(n=!0,r=JSON.stringify(r));e[o]=r}),n||t||1!=Object.keys(e).length||(e=e[Object.keys(e)[0]]),e}}]),ItemOptions}();exports.default=ItemOptions}).call(exports,__webpack_require__(1))},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";i(this,e),this.content=t}return a(e,[{key:"getHTML",value:function(){var e=(0,o.escapeHTML)(this.content);return e=this.parseItalicsAndBold(e),e=this.parseAnchors(e)}},{key:"parseItalicsAndBold",value:function(e){return e=e.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm,"$1<strong>$2</strong>"),e=e.replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm,"$1<em>$2</em>"),e=e.replace(/(\*\*)(?=\S)([^\r]*?\S[*]*)\1/g,"<strong>$2</strong>"),e=e.replace(/(\*)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")}},{key:"parseAnchors",value:function(e){return e=e.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,function(e,t,n,i,a,r,s,l){(0,o.isDefined)(l)||(l=""),e=t;var c=n,u=i.toLowerCase(),d=a,p=l;if(!d){if(u||(u=c.toLowerCase().replace(/ ?\n/g," ")),d="#"+u,!(e.search(/\(\s*\)$/m)>-1))return e;d=""}d=encodeURI(d,"*_",!1);var m='<a href="'+d+'" target="_blank"';return""!==p&&null!==p&&(p=p.replace(/"/g,"&quot;"),p=encodeURI(p,"*_",!1),m+=' title="'+p+'"'),m+=">"+c+"</a>"})}}]),e}();t.default=r},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=n(6),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function t(n){i(this,t);var o=e("<div/>",{class:"item item--start"}),s=e("<div/>",{class:"item-icon"}),l=e("<div/>",{class:"item-title uap-clear"}),c=e("<div/>",{class:"uap-btn uap-btn--secondary uap-btn--small"});l.append(c),o.append(s),o.append(l),(0,a.getDOMElements)("metabox",{type:n}).append(o),"trigger"==n&&c.text(UncannyAutomator.i18n.trigger.add),"action"==n&&c.text(UncannyAutomator.i18n.action.add),c.on("click",function(){return new r.default(n)})};t.default=s}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(7),l=i(s),c=n(11),u=i(c),d=n(12),p=i(d),m=n(15),f=i(m),v=n(2),h=i(v),g=n(3),y=i(g),b=function(){function t(){var n=this;a(this,t),this.elements={$metabox:(0,r.getDOMElements)("metabox",{type:"action"})},e.each(UncannyAutomator.closures,function(e,t){return n.createClosure(t)})}return o(t,[{key:"createClosure",value:function(t){var n=!1,i=e("<div/>",{class:"metabox__footer"}),a={label:t.select_option_name,formElementClass:"form-element--nomargin"},o=this.getClosureByCodeFromItemsObject(t.code);(0,r.isDefined)(o)&&(n=!0,a.currentValue=!0,a.itemid=o.id);var s=new y.default("checkbox",a),l=s.getFormElement();l.on("change",function(){var e=s.getValue();s.startLoadingAnimation(),e?(0,r.restCall)("add",{recipePostID:UncannyAutomator.recipe.id,action:"add-new-closure",item_code:t.code,default_meta:{integration_name:UncannyAutomator.integrations[t.integration].name,sentence:t.sentence}},function(e){if(new h.default,(0,r.isDefined)(e.post_ID)){(0,r.getDOMElements)("item",{id:e.post_ID}).item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")}},function(e){console.log("‼️ ERROR-TODO. Couldn't add the closure"),s.stopLoadingAnimation(),s.setValue(!1,!1)}):(0,r.restCall)("delete",{ID:o.id},function(){new h.default},function(){console.log("‼️ ERROR-TODO. Couldn't delete the closure"),new h.default})}),i.append(l);var c=e("<div/>",{class:"uo-toggle uo-toggle--show"});if(n){c.addClass("uo-toggle--show");var u=e("<div/>",{class:"item item--closure item--margintop","data-id":o.id}),d=this.createHeader(UncannyAutomator.recipe.items[o.id].integrationCode,"closure",t.code,o.id);u.append(d);var p=e("<div/>",{class:"item__content"});u.append(p),c.append(u)}i.append(c),this.elements.$metabox.append(i)}},{key:"createHeader",value:function(t,n,i,a){var o=e("<div/>"),r=e("<div/>",{class:"item-title uap-clear"}),s=new l.default(n,t,i,a);o.append(s);var c=new u.default(t);o.append(c);var d=new p.default(t);r.append(d);var m=new f.default(n,t,i,a);return r.append(m),o.append(r),o}},{key:"getClosureByCodeFromItemsObject",value:function(t){var n=void 0;return e.each(UncannyAutomator.recipe.items,function(e,i){i.itemCode==t&&(n=i)}),n}}]),t}();t.default=b}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=n(6),l=i(s),c=n(7),u=i(c),d=n(11),p=i(d),m=n(12),f=i(m),v=n(4),h=i(v),g=n(2),y=i(g),b=function(){function t(e,n,i){a(this,t),this.itemType=e,this.integrationID=n,this.$currentItem=i,this.render()}return o(t,[{key:"render",value:function(){this.$container=e('<div class="item"></div>'),this.$item=this.$container,this.createHeader(),this.createItemsList(),this.$currentItem.replaceWith(this.$container)}},{key:"createHeader",value:function(){var t=e('\n\t\t\t<div>\n\t\t\t\t<div class="item-title uap-clear">\n\t\t\t\t\t<div class="item-title__describe">\n\t\t\t\t\t\t<div class="item-title__non-editable">\n\t\t\t\t\t\t\t'+("trigger"==this.itemType?UncannyAutomator.i18n.trigger.select:UncannyAutomator.i18n.action.select)+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"),n=new u.default(this.itemType);t.append(n);var i=new p.default(this.integrationID);t.append(i);var a=new f.default(this.integrationID);t.find(".item-title").prepend(a),this.$container.append(t)}},{key:"createItemsList",value:function(){var t=this,n=void 0,i=void 0;"trigger"==this.itemType?(n=(0,r.getItemsByIntegration)(this.integrationID,"triggers"),i=UncannyAutomator.i18n.trigger.search,UncannyAutomator.i18n.proOnly.unlockTriggers):"action"==this.itemType&&(n=(0,r.getItemsByIntegration)(this.integrationID,"actions"),i=UncannyAutomator.i18n.action.search,UncannyAutomator.i18n.proOnly.unlockActions);var a=e('\n\t\t\t<div class="item__content">\n\t\t\t\t<div class="item-options item-options--nopadding item-options--noborder">\n\t\t\t\t\t<div class="form-element">\n\t\t\t\t\t\t<div class="item__task-selector">\n\t\t\t\t\t\t\t<div class="item-task-selector__search">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="item-task-selector__search-input"\n\t\t\t\t\t\t\t\t\tplaceholder="'+i+'"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-task-selector__options">\n\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group item-task-selector-options__group--available"></div>\n\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group item-task-selector-options__group--unavailable">\n\t\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group-items"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="item-task-selector__option item-task-selector__option--no-results item-task-selector__option--hide">\n\t\t\t\t\t\t\t\t\t'+UncannyAutomator.i18n.noResults+"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"),o=a.find(".item-options"),s=a.find(".item__task-selector"),l=a.find(".item-task-selector__search-input"),c={container:a.find(".item-task-selector__options"),available:a.find(".item-task-selector-options__group--available"),unavailable:{container:a.find(".item-task-selector-options__group--unavailable"),list:a.find(".item-task-selector-options__group-items")},noResults:a.find(".item-task-selector__option--no-results")};n.hasAvailableItems?c.available.append(n.available.map(function(n){var i=n.is_pro,a=e('\n\t\t\t\t\t<div class="item-task-selector__option '+(i?"item-task-selector__option--pro":"")+'"\n\t\t\t\t\t\tdata-search="'+n.select_option_name.toLowerCase().replace(/\s+|{|}/g,"")+'">\n\t\t\t\t\t\t'+(0,r.replaceCurlyBraces)(n.select_option_name,'<span class="item-task-selector__option-variable">',"</span>")+"\n\t\t\t\t\t\t"+(i?'<span class="item-task-selector-option__badge">'+UncannyAutomator.i18n.proOnly.pro+"</span>":"")+"\n\t\t\t\t\t</div>\n\t\t\t\t");return a.on("click",function(){s.addClass("item__task-selector--loading"),a.addClass("item-task-selector__option--loading");var i=["trigger","action"].includes(t.itemType)?"add-new-"+t.itemType:"",o={};e.each(n.options,function(e,t){(0,r.isDefined)(t.default_value)&&(o[t.option_code]=t.default_value)}),"anonymous"==n.type&&(o.can_log_in_new_user=!(0,r.isDefined)(n.can_log_in_new_user)||n.can_log_in_new_user),(0,r.restCall)("add",{recipePostID:UncannyAutomator.recipe.id,action:i,item_code:n.code,default_meta:e.extend({},o,{integration_name:UncannyAutomator.integrations[t.integrationID].name,sentence:n.sentence})},function(e){if(new h.default,new y.default,(0,r.isDefined)(e.post_ID)){var t=(0,r.getDOMElements)("item",{id:e.post_ID});UncannyAutomator.recipe.items[e.post_ID].isValid?UncannyAutomator.recipe.isLive||t.item.find('.item-status input[type="checkbox"]').prop("checked",!0).trigger("change"):t.item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")}},function(e){console.log("‼️ ERROR-TODO. Couldn't add the item"),s.removeClass("item__task-selector--loading"),a.removeClass("item-task-selector__option--loading"),0==e.success&&new h.default})}),a})):c.available.remove(),n.hasUnavailableItems?c.unavailable.list.append(n.unavailable.map(function(t){return e('\n\t\t\t\t\t<a  href="'+(0,r.addParametersToURL)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_content:"unavailable_item"})+'"\n\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\tclass="item-task-selector__option item-task-selector__option--pro"\n\t\t\t\t\t\tdata-search="'+t.name.toLowerCase().replace(/\s+|{|}/g,"")+'">\n\t\t\t\t\t\t<span class="uo-icon uo-icon--lock-alt"></span>\n\t\t\t\t\t\t'+(0,r.replaceCurlyBraces)(t.name,'<span class="item-task-selector__option-variable">',"</span>")+'\n\t\t\t\t\t\t<span class="item-task-selector-option__badge">'+UncannyAutomator.i18n.proOnly.pro+"</span>\n\t\t\t\t\t</a>\n\t\t\t\t")})):c.unavailable.container.remove();var u=c.container.find(".item-task-selector__option:not(.item-task-selector__option--no-results)");l.on("input",function(){var t=l.val().toLowerCase().replace(/\s+|{|}/g,"");u.removeClass("item-task-selector__option--show item-task-selector__option--hide");var n=!0;(0,r.isEmpty)(t)||(n=!1,e.each(u,function(i,a){var o=e(a);-1!==o.data("search").search(t)?(o.addClass("item-task-selector__option--show"),n=!0):o.addClass("item-task-selector__option--hide")})),c.noResults.removeClass("item-task-selector__option--hide item-task-selector__option--show"),n?c.noResults.addClass("item-task-selector__option--hide"):c.noResults.addClass("item-task-selector__option--show")}),o.append(this.createCancelButton()),this.$container.append(a)}},{key:"createCancelButton",value:function(){var t=this,n=e("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);return n.on("click",function(){new l.default(t.itemType,t.$item)}),n}}]),t}();t.default=b}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(e,n,a){i(this,t),this.itemType=e,this.noticeType=n,this.noticeMessage=a,this.create()}return a(t,[{key:"create",value:function(){var e=(0,o.getDOMElements)("metabox",{type:this.itemType}),t=this.createNotice();e.append(t)}},{key:"createNotice",value:function(){var t=e("<div/>",{class:"metabox__notice"});return(0,o.isDefined)(this.noticeType)&&t.addClass((0,o.vsprintf)("metabox__notice--%s",[this.noticeType])),t.html(this.noticeMessage),t}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(){i(this,t),this.build()}return a(t,[{key:"build",value:function(){var t=e("<div/>",{class:"uap-report-bug"}),n=void 0,i=void 0;(0,o.isDefined)(UncannyAutomator.wp)&&UncannyAutomator.wp?(n=(0,o.vsprintf)("Uncanny Automator %s %s",["Pro",UncannyAutomator.version]),i=(0,o.vsprintf)("uncanny_automator_%s",["pro"])):(n=(0,o.vsprintf)("Uncanny Automator %s",[UncannyAutomator.version]),i="uncanny_automator");var a=e("<a/>",{class:"uap-report-bug__btn","uap-tooltip":UncannyAutomator.i18n.sendFeedback.title,"uap-flow":"left",href:(0,o.vsprintf)("https://automatorplugin.com/feedback/?version=%s&utm_source=%s&utm_medium=%s",[n,i,"send_feedback"]),target:"_blank"}),r=e("<span/>",{class:"uap-report-bug__icon"});a.append(r),a.appendTo(t),e("body").append(t)}},{key:"bind",value:function(e,t,n,i){e.on("click",function(){t.is(":checked")&&(localStorage.uapSendFeedbackWelcome="hide"),n.fadeOut(150),i.removeClass("uap-report-bug--open")})}},{key:"showAgain",value:function(){return!1}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function(){function t(){i(this,t),this.elements={container:e("#titlediv"),input:e("#titlediv #title"),status:{}},this.publishedTitle=this.elements.input.val(),this.createStatus(),this.bindChanges(),this.notSavedAlert()}return a(t,[{key:"createStatus",value:function(){var t=e("<div/>",{class:"uap-title-status"}),n=e("<div/>",{class:"uap"}),i=e("<div/>",{class:"uo-status uo-status--saving"}),a=e("<span/>",{class:"uo-status-icon uo-icon uo-icon--loading uo-icon--rotate"}),o=e("<span/>",{class:"uo-status__text"}).text(UncannyAutomator.i18n.title.saving);i.append(a),i.append(o),this.elements.status.saving=i;var r=e("<div/>",{class:"uo-status uo-status--saved"}),s=e("<span/>",{class:"uo-status-icon uo-icon uo-icon--check"}),l=e("<span/>",{class:"uo-status__text"}).text(UncannyAutomator.i18n.title.saved);r.append(s),r.append(l),this.elements.status.saved=r,n.append(i),n.append(r),t.append(n),this.elements.container.append(t)}},{key:"setStatusSaving",value:function(){this.elements.status.saving.stop().fadeIn(150)}},{key:"setStatusSaved",value:function(){var e=this;this.elements.status.saving.stop().fadeOut(150),this.elements.status.saved.stop().fadeIn(150,function(){setTimeout(function(){e.elements.status.saved.fadeOut(150)},3e3)})}},{key:"revertChanges",value:function(){this.elements.input.val(this.publishedTitle),this.elements.status.saving.stop().fadeOut(150)}},{key:"bindChanges",value:function(){var e=this,t=void 0;this.elements.input.on("input",function(){clearTimeout(t),t=setTimeout(function(){e.setStatusSaving(),e.updateTitle()},1500)})}},{key:"getTitle",value:function(){return this.elements.input.val()}},{key:"updateTitle",value:function(){var e=this;(0,o.restCall)("change_post_title",{post_ID:UncannyAutomator.recipe.id,post_title:this.getTitle()},function(){e.setStatusSaved(),e.publishedTitle=e.getTitle()},function(){console.log("‼️ ERROR-TODO. Couldn't save the title"),e.revertChanges()})}},{key:"notSavedAlert",value:function(){e(document).ready(function(){e(window).off("beforeunload.edit-post")})}}]),t}();t.default=r}).call(t,n(1))},function(e,t,n){"use strict";(function(e){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),r=function e(){i(this,e),new s,new l},s=function(){function t(){i(this,t),this.getElements(),1==this.$elements.allCategories.length&&this.listenCheckboxes()}return a(t,[{key:"getElements",value:function(){this.$elements={container:e("#recipe_categorydiv"),allCategories:e("#recipe_categorychecklist")}}},{key:"listenCheckboxes",value:function(){var t=this;this.$elements.container.on("change",'input[type="checkbox"][name="tax_input[recipe_category][]"], .popular-category input[type="checkbox"]',function(n){var i=e(n.currentTarget);t.saveCategory(i)}),new MutationObserver(function(n){n.forEach(function(n){n.addedNodes.forEach(function(n){var i=e(n).find('input[type="checkbox"][name="tax_input[recipe_category][]"]');t.saveCategory(i)})})}).observe(this.$elements.allCategories[0],{childList:!0})}},{key:"getCheckboxData",value:function(e){return{id:e.val(),isChecked:e.is(":checked")}}},{key:"saveCategory",value:function(e){var t=this,n=this.getCheckboxData(e);this.setStatus("loading",!0,e),(0,o.restCall)("set_recipe_terms",{term_id:"recipe_category",recipe_id:UncannyAutomator.recipe.id,category_id:n.id,set_category:n.isChecked},function(n){n.success?(t.setStatus("success",!0,e),setTimeout(function(){t.setStatus("success",!1,e)},2e3)):(console.log("‼️ ERROR-TODO. Couldn't change the status of the recipe category"),t.revertCheckboxValue(e),t.setStatus("error",!0,e),setTimeout(function(){t.setStatus("error",!1,e)})),t.setStatus("loading",!1,e)},function(n){t.revertCheckboxValue(e),t.setStatus("loading",!1,e),t.setStatus("error",!0,e),setTimeout(function(){t.setStatus("error",!1,e)})},{requiresRecipesObject:!1,renderUI:!1})}},{key:"revertCheckboxValue",value:function(e){e.prop("checked",!e.is(":checked"))}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments[2],i=n.closest(".selectit");"loading"==e?t?(i.addClass("uap-taxonomy-loading"),n.prop("disabled",!0)):(i.removeClass("uap-taxonomy-loading"),n.prop("disabled",!1)):"success"==e?t?i.addClass("uap-taxonomy-success"):i.removeClass("uap-taxonomy-success"):"error"==e&&(t?i.addClass("uap-taxonomy-error"):i.removeClass("uap-taxonomy-error"))}}]),t}(),l=function(){function t(){i(this,t),this.getElements(),1==this.$elements.tagsTextarea.length&&this.listenModificationsToTags()}return a(t,[{key:"getElements",value:function(){this.$elements={container:e("#tagsdiv-recipe_tag"),tagsTextarea:e("textarea#tax-input-recipe_tag"),tagsList:e("#tagsdiv-recipe_tag .tagchecklist")}}},{key:"listenModificationsToTags",value:function(){var e=this;new MutationObserver(function(t){e.saveTags()}).observe(this.$elements.tagsList[0],{childList:!0})}},{key:"saveTags",value:function(){var e=this,t=this.getTags();this.setStatus("loading",!0),(0,o.restCall)("set_recipe_terms",{term_id:"recipe_tag",recipe_id:UncannyAutomator.recipe.id,tags:t},function(t){t.success&&(e.setStatus("success",!0),setTimeout(function(){e.setStatus("success",!1)},2e3)),e.setStatus("loading",!1)},function(e){location.reload()},{requiresRecipesObject:!1,renderUI:!1})}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"loading"==e?t?this.$elements.container.addClass("uap-tags-loading"):this.$elements.container.removeClass("uap-tags-loading"):"success"==e?t?this.$elements.container.addClass("uap-tags-success"):this.$elements.container.removeClass("uap-tags-success"):"error"==e&&(t?this.$elements.container.addClass("uap-tags-error"):this.$elements.container.removeClass("uap-tags-error"))}},{key:"getTags",value:function(){var e=this.$elements.tagsTextarea.val();return{asArray:e.split(","),commaSeparated:e}}}]),t}();t.default=r}).call(t,n(1))}]);