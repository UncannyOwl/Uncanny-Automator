{"version":3,"file":"bundle.min.js","mappings":"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IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,KACV,IAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,IACV,EAAU,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","sources":["webpack://automator-recipe-ui/./src/js/common/markdown.js","webpack://automator-recipe-ui/./src/js/common/modal.js","webpack://automator-recipe-ui/./src/js/field/group.js","webpack://automator-recipe-ui/./src/js/field/repeater.js","webpack://automator-recipe-ui/./src/js/common/utilities.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/types/options.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/l10n/default.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/utils/index.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/utils/dom.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/utils/formatting.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/utils/dates.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/index.js","webpack://automator-recipe-ui/./src/js/tokens/token-selector.js","webpack://automator-recipe-ui/./src/js/field/field.js","webpack://automator-recipe-ui/./src/js/item/action-menu.js","webpack://automator-recipe-ui/./src/js/user-selector/user-selector.js","webpack://automator-recipe-ui/./src/js/item/button-add-item.js","webpack://automator-recipe-ui/./src/js/item/closures.js","webpack://automator-recipe-ui/./src/js/item/actions.js","webpack://automator-recipe-ui/./src/js/item/integration-icon.js","webpack://automator-recipe-ui/./src/js/item/integration-name.js","webpack://automator-recipe-ui/./src/js/item/items-list.js","webpack://automator-recipe-ui/./src/js/item/integrations-grid.js","webpack://automator-recipe-ui/./src/js/item/options.js","webpack://automator-recipe-ui/./src/js/item/sentence.js","webpack://automator-recipe-ui/./src/js/metabox/notices.js","webpack://automator-recipe-ui/./src/js/item/triggers.js","webpack://automator-recipe-ui/./src/js/metabox/footer.js","webpack://automator-recipe-ui/./src/js/item/button-schedule.js","webpack://automator-recipe-ui/./src/js/metabox/items.js","webpack://automator-recipe-ui/./src/js/publish/publish.js","webpack://automator-recipe-ui/./src/js/recipe/notices.js","webpack://automator-recipe-ui/./src/js/recipe/type-selector.js","webpack://automator-recipe-ui/./src/js/tokens/tokens.js","webpack://automator-recipe-ui/./src/js/validation/validation.js","webpack://automator-recipe-ui/./node_modules/flatpickr/dist/esm/utils/polyfills.js","webpack://automator-recipe-ui/./node_modules/html5sortable/dist/html5sortable.cjs.js","webpack://automator-recipe-ui/./node_modules/select2/dist/js/select2.js","webpack://automator-recipe-ui/./node_modules/sprintf-js/src/sprintf.js","webpack://automator-recipe-ui/external var \"jQuery\"","webpack://automator-recipe-ui/webpack/bootstrap","webpack://automator-recipe-ui/webpack/runtime/compat get default export","webpack://automator-recipe-ui/webpack/runtime/define property getters","webpack://automator-recipe-ui/webpack/runtime/hasOwnProperty shorthand","webpack://automator-recipe-ui/./src/js/send-feedback/send-feedback.js","webpack://automator-recipe-ui/./src/js/recipe/title.js","webpack://automator-recipe-ui/./src/js/taxonomies/categories.js","webpack://automator-recipe-ui/./src/js/taxonomies/tags.js","webpack://automator-recipe-ui/./src/js/taxonomies/taxonomies.js","webpack://automator-recipe-ui/./src/index.js"],"sourcesContent":["import { isEmpty, escapeHTML } from './utilities.js';\n\n/**\n * Parses markdown content\n */\nexport default class Markdown {\n\t/**\n\t * Saves the content as a property\n\t *\n\t * @param {String} content The content\n\t */\n\tconstructor( content = '' ) {\n\t\t// Save content\n\t\tthis.content = content;\n\t}\n\n\t/**\n\t * Parses the markdown content and returns the HTML\n\t *\n\t * @return {String} The content parsed\n\t */\n\tgetHTML() {\n\t\t// Define content and escape HTML\n\t\tlet content = escapeHTML( this.content );\n\n\t\t// Parse italic and bold\n\t\tcontent = this.parseItalicsAndBold( content );\n\n\t\t// Parse anchors\n\t\tcontent = this.parseAnchors( content );\n\n\t\treturn content;\n\t}\n\n\t/**\n\t * Parses bold and italic text on the text\n\t * This method will convert:\n\t * - **text** to <strong>text</strong>\n\t * - __text__ to <strong>text</strong>\n\t * - *text* to <em>text</em>\n\t * - _text_ to <em>text</em>\n\t *\n\t * @param {String} content The content\n\t * @return {String}         The content with the bolds and italics parsed\n\t */\n\tparseItalicsAndBold( content = '' ) {\n\t\tconst regularExpressions = {\n\t\t\tdoubleUnderscores: /(^|\\s|>|\\b)__(?=\\S)([^]+?)__(?=\\b|<|\\s|$)/gm,\n\t\t\tsingleUnderscores: /(^|\\s|>|\\b)_(?=\\S)([^]+?)_(?=\\b|<|\\s|$)/gm,\n\t\t\tdoubleAsterisks: /(\\*\\*)(?=\\S)([^\\r]*?\\S[*]*)\\1/g,\n\t\t\tsingleAsterisks: /(\\*)(?=\\S)([^\\r]*?\\S)\\1/g,\n\t\t};\n\n\t\t// Underscores\n\t\t// Since we are consuming a \\s character, we need to add it\n\t\tcontent = content.replace( regularExpressions.doubleUnderscores, '$1<strong>$2</strong>' );\n\n\t\tcontent = content.replace( regularExpressions.singleUnderscores, '$1<em>$2</em>' );\n\n\t\t// Asterisks\n\t\tcontent = content.replace( regularExpressions.doubleAsterisks, '<strong>$2</strong>' );\n\n\t\tcontent = content.replace( regularExpressions.singleAsterisks, '<em>$2</em>' );\n\n\t\t// Return content\n\t\treturn content;\n\t}\n\n\t/**\n\t * Parses anchors on the text\n\t * This method will convert [link text](url \"optional title\") anchors to <a href=\"url\" title=\"optional title\">link text</a>\n\t *\n\t * @param {String} content The content\n\t * @return {String}         The content with the anchors parsed\n\t */\n\tparseAnchors( content = '' ) {\n\t\t// Create the regex\n\t\t// eslint-disable-next-line max-len\n\t\tconst regExAnchors = /(\\[((?:\\[[^\\]]*]|[^\\[\\]])*)]\\([ \\t]*()<?(.*?(?:\\(.*?\\).*?)?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g;\n\n\t\t// Create the replacer function\n\t\t/**\n\t\t * Function to replace markdown anchor matches with HTML\n\t\t *\n\t\t * @param {String} wholeMatch The whole match\n\t\t * @param {String} m1         The whole match\n\t\t * @param {String} linkText   The link text\n\t\t * @param {String} linkId     The link ID\n\t\t * @param {String} url        The link URL\n\t\t * @param {String} m5         The link title with quotes\n\t\t * @param {String} m6         The link title' quotes\n\t\t * @param {String} title      The link title\n\t\t * @return {String}            The markdown anchor converted to HTML\n\t\t */\n\t\tconst replacerFunction = ( wholeMatch, m1, linkText, linkId, url, m5, m6, title = '' ) => {\n\t\t\t// Update the whole match\n\t\t\twholeMatch = m1;\n\n\t\t\t// Convert the link ID to lowercase\n\t\t\tlinkId = linkId.toLowerCase();\n\n\t\t\t// Check if the URL is defined\n\t\t\tif ( ! url ) {\n\t\t\t\t// Check if there is a link ID\n\t\t\t\tif ( ! linkId ) {\n\t\t\t\t\t// Lower-case and turn embedded newlines into spaces\n\t\t\t\t\tlinkId = linkText.toLowerCase().replace( / ?\\n/g, ' ' );\n\t\t\t\t}\n\n\t\t\t\t// Add the link ID as hash\n\t\t\t\turl = `#${ linkId }`;\n\n\t\t\t\tif ( wholeMatch.search( /\\(\\s*\\)$/m ) > -1 ) {\n\t\t\t\t\t// Special case for explicit empty url\n\t\t\t\t\turl = '';\n\t\t\t\t} else {\n\t\t\t\t\treturn wholeMatch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Encode URL\n\t\t\turl = encodeURI( url, '*_', false );\n\n\t\t\t// Check if we have to add the title\n\t\t\tif ( ! isEmpty( title ) ) {\n\t\t\t\t// Encode content\n\t\t\t\ttitle = title.replace( /\"/g, '&quot;' );\n\t\t\t\ttitle = encodeURI( title, '*_', false );\n\n\t\t\t\t// Add HTML format\n\t\t\t\ttitle = ` title=\"${ title }\"`;\n\t\t\t} else {\n\t\t\t\ttitle = '';\n\t\t\t}\n\n\t\t\tconst result = `\n\t\t\t\t<a href=\"${ url }\" target=\"_blank\" ${ title }>\n\t\t\t\t\t${ linkText }\n\t\t\t\t</a>\n\t\t\t`;\n\n\t\t\treturn result;\n\t\t};\n\n\t\t// Inline-style links: [link text](url \"optional title\")\n\t\tcontent = content.replace( regExAnchors, replacerFunction );\n\n\t\t// Return content\n\t\treturn content;\n\t}\n}\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { isDefined } from './utilities.js';\n\n/**\n * Creates a modal\n */\nexport default class Modal {\n\t/**\n\t * Gets/saves the required data and invokes the methods to\n\t * create the modal\n\t *\n\t * @param {Object}      content                  The content of the modal\n\t * @param {String}      content.title            The title\n\t * @param {String}      content.warning          The warning\n\t * @param {Object}      content.buttons          The buttons\n\t * @param {String}      content.buttons.cancel   The label of the cancel button\n\t * @param {String}      content.buttons.confirm  The label of the confirm button\n\t * @param {String|Node} content.content          The modal body\n\t * @param {Object}      content.events           Object with callbacks\n\t * @param {Function}    content.events.onConfirm Callback invoked when user press the confirm button\n\t * @param {Function}    content.events.onCancel  Callback invoked when user press the cancel button\n\t * @param {Function}    content.events.onShow    Callback invoked when the modal is displayed\n\t * @param {Function}    content.events.onHide    Callback invoked when the modal is hidden\n\t * @param {Object}      config                   Configuration object\n\t * @param {Integer}     config.fadeDuration      Fade animation duration when the modal is displayed or hidden\n\t * @param {String}      config.size              The size of the modal: 'small', 'medium', 'large', 'extra-large'\n\t * @param {Boolean}     config.warningFirst      True if the warning should go above the modal content\n\t * @return {undefined}\n\t */\n\tconstructor( content = {}, config = {} ) {\n\t\t// Create elements object\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\tautomatorContainer: null, // ( .uap ) This DIV is only created to avoid conflicts with other plugins\n\t\t\tmodal: {\n\t\t\t\tcontainer: null,\n\t\t\t\tbox: {\n\t\t\t\t\tcontainer: null,\n\t\t\t\t\ttitle: null,\n\t\t\t\t\twarning: null,\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tcontainer: null,\n\t\t\t\t\t\tcancel: null,\n\t\t\t\t\t\tconfirm: null,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\t// Set container\n\t\tthis.elements.container = $( 'body' );\n\n\t\t// Set isVisible property\n\t\tthis.isVisible = false;\n\n\t\t// Define default configuration\n\t\tthis.config = $.extend(\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tfadeDuration: 150,\n\t\t\t\tsize: 'medium',\n\t\t\t\twarningFirst: false,\n\t\t\t},\n\t\t\tconfig\n\t\t);\n\n\t\t// Save modal box content. Add default values\n\t\tthis.content = $.extend(\n\t\t\t{},\n\t\t\t{\n\t\t\t\tbuttons: {\n\t\t\t\t\tcancel: UncannyAutomator.i18n.cancel,\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent\n\t\t);\n\n\t\t// Create new modal box\n\t\tthis.create();\n\n\t\t// Return object\n\t\treturn this;\n\t}\n\n\t/**\n\t * Creates the modal box DOM elements\n\t *\n\t * @return {undefined}\n\t */\n\tcreate() {\n\t\tconst automatorContainer = $( '<div/>', { class: 'uap' } );\n\t\tconst modal = $( '<div/>', { class: 'modal' } );\n\t\tconst modalBox = $( '<div/>', { class: 'modal__box' } );\n\n\t\t// Check if the user wants a different modal size than the default size\n\t\tif (\n\t\t\tisDefined( this.config.size ) &&\n\t\t\t[ 'small', 'medium', 'large', 'extra-large' ].includes( this.config.size )\n\t\t) {\n\t\t\t// Add the correct size class\n\t\t\tmodal.addClass( `modal--${ this.config.size }` );\n\t\t}\n\n\t\t// Check if the user wants to add a custom class\n\t\tif ( isDefined( this.config.customClass ) ) {\n\t\t\tmodal.addClass( `modal--${ this.config.customClass }` );\n\t\t}\n\n\t\t// Save elements\n\t\tthis.elements.automatorContainer = automatorContainer;\n\t\tthis.elements.modal.container = modal;\n\t\tthis.elements.modal.box.container = modalBox;\n\n\t\t// Set title\n\t\tif ( isDefined( this.content.title ) ) {\n\t\t\tconst modalTitle = $( '<div/>', { class: 'modal__title' } ).html( this.content.title );\n\t\t\tmodalBox.append( modalTitle );\n\n\t\t\t// Save element\n\t\t\tthis.elements.modal.box.title = modalTitle;\n\t\t}\n\n\t\t// Set content\n\t\tlet modalContent;\n\t\tif ( isDefined( this.content.content ) ) {\n\t\t\tmodalContent = $( '<div/>', { class: 'modal__content' } );\n\n\t\t\t// Check if the content is node element\n\t\t\ttry {\n\t\t\t\tmodalContent.append( this.content.content );\n\t\t\t} catch ( e ) {\n\t\t\t\tmodalContent.html( this.content.content );\n\t\t\t}\n\n\t\t\tmodalBox.append( modalContent );\n\n\t\t\t// Save element\n\t\t\tthis.elements.modal.box.content = modalContent;\n\t\t}\n\n\t\t// Set warning\n\t\tlet modalWarning;\n\t\tif ( isDefined( this.content.warning ) ) {\n\t\t\tmodalWarning = $( '<div/>', { class: 'modal__warning' } ).html( this.content.warning );\n\n\t\t\t// Save element\n\t\t\tthis.elements.modal.box.warning = modalWarning;\n\t\t}\n\n\t\t// Check the order of the warning\n\t\tif ( isDefined( this.config.warningFirst ) && this.config.warningFirst ) {\n\t\t\tif ( isDefined( this.content.warning ) ) {\n\t\t\t\tmodalBox.append( modalWarning );\n\t\t\t}\n\n\t\t\tif ( isDefined( this.content.content ) ) {\n\t\t\t\tmodalBox.append( modalContent );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( isDefined( this.content.content ) ) {\n\t\t\t\tmodalBox.append( modalContent );\n\t\t\t}\n\n\t\t\tif ( isDefined( this.content.warning ) ) {\n\t\t\t\tmodalBox.append( modalWarning );\n\t\t\t}\n\t\t}\n\n\t\t// Set buttons\n\t\tconst modalButtons = $( '<div/>', {\n\t\t\tclass: 'modal__buttons',\n\t\t} );\n\t\tconst cancelButton = $( '<button/>', {\n\t\t\tclass: 'uap-btn uap-btn--secondary',\n\t\t} ).html( this.content.buttons.cancel );\n\t\tmodalButtons.append( cancelButton );\n\n\t\t// Save elements\n\t\tthis.elements.modal.box.buttons.container = modalButtons;\n\t\tthis.elements.modal.box.buttons.cancel = cancelButton;\n\n\t\tif ( isDefined( this.content.buttons.confirm ) ) {\n\t\t\tconst confirmButton = $( '<button/>', {\n\t\t\t\tclass: 'uap-btn uap-btn--primary',\n\t\t\t} ).html( this.content.buttons.confirm );\n\t\t\tmodalButtons.append( confirmButton );\n\n\t\t\t// Save element\n\t\t\tthis.elements.modal.box.buttons.confirm = confirmButton;\n\t\t}\n\n\t\tmodalBox.append( modalButtons );\n\n\t\t// Append elements and add to the container\n\t\tmodal.append( modalBox );\n\t\tautomatorContainer.append( modal );\n\t\tthis.elements.container.append( automatorContainer );\n\n\t\t// Add open class to the html tag\n\t\t$( 'html' ).addClass( 'automator-modal-open' );\n\n\t\t// Bind\n\t\tthis.bind();\n\t}\n\n\t/**\n\t * Defines custom events\n\t * This adds the ability to invoke callbacks when:\n\t * - After the events are set\n\t * - After the modal is displayed\n\t * - After the modal is hidden\n\t * - When the user clicks on the confirmation button\n\t * - When the user clicks on the cancel button\n\t *\n\t * @param {Object} events Object with callbacks\n\t * @return {undefined}\n\t */\n\tsetEvents( events ) {\n\t\t// Define events\n\t\tthis.events = {\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tafterSetEvents: isDefined( events.afterSetEvents ) ? events.afterSetEvents : () => {},\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tafterShow: isDefined( events.afterShow ) ? events.afterShow : () => {},\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tafterHide: isDefined( events.afterHide ) ? events.afterHide : () => {},\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tonConfirm: isDefined( events.onConfirm ) ? events.onConfirm : () => {},\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tonCancel: isDefined( events.onCancel ) ? events.onCancel : () => {},\n\t\t};\n\n\t\tif ( ! isDefined( events.onCancel ) ) {\n\t\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\t\tthis.events.onCancel = () => {\n\t\t\t\t// Default onCancel function\n\t\t\t\t// Hide modal box\n\t\t\t\tthis.hide();\n\t\t\t};\n\t\t}\n\n\t\t// Fire afterSetEvents event\n\t\tthis.events.afterSetEvents();\n\t}\n\n\t/**\n\t * Removes the modal from the DOM\n\t *\n\t * @return {undefined}\n\t */\n\tdestroy() {\n\t\tconst thisModal = this;\n\n\t\t// Unbind everything\n\t\tthis.unbind();\n\n\t\t// Check if it's visible\n\t\tif ( this.isVisible ) {\n\t\t\t// We have to hide it first\n\t\t\tthis.hide( () => {\n\t\t\t\tthisModal.elements.automatorContainer.remove();\n\t\t\t} );\n\t\t} else {\n\t\t\tthisModal.elements.automatorContainer.remove();\n\t\t}\n\n\t\t// Remove modal open class from the html tag\n\t\t$( 'html' ).removeClass( 'automator-modal-open' );\n\t}\n\n\t/**\n\t * Listens clicks to the confirm and cancel buttons\n\t *\n\t * @return {undefined}\n\t */\n\tbind() {\n\t\tconst thisModal = this;\n\n\t\t// Bind cancel button\n\t\tif ( isDefined( this.elements.modal.box.buttons.cancel ) ) {\n\t\t\tthis.elements.modal.box.buttons.cancel.on( 'click', () => {\n\t\t\t\tthisModal.events.onCancel();\n\t\t\t} );\n\t\t}\n\n\t\t// Bind confirm button\n\t\tif ( isDefined( this.elements.modal.box.buttons.confirm ) ) {\n\t\t\tthis.elements.modal.box.buttons.confirm.on( 'click', () => {\n\t\t\t\tthisModal.events.onConfirm();\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Stops listening clicks on the confirm and cancel buttons\n\t *\n\t * @return {undefined}\n\t */\n\tunbind() {\n\t\tif ( isDefined( this.elements.modal.box.buttons.cancel ) ) {\n\t\t\tthis.elements.modal.box.buttons.cancel.unbind( 'click' );\n\t\t}\n\n\t\tif ( isDefined( this.elements.modal.box.buttons.confirm ) ) {\n\t\t\tthis.elements.modal.box.buttons.confirm.unbind( 'click' );\n\t\t}\n\t}\n\n\t/**\n\t * Shows the modal\n\t *\n\t * @param {Function} callback Custom function that it's going to be\n\t *                            invoked after we show the modal\n\t * @return {undefined}\n\t */\n\tshow( callback = null ) {\n\t\tconst thisModal = this;\n\n\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\tlet event = () => {};\n\n\t\tif ( isDefined( callback ) ) {\n\t\t\tevent = callback;\n\t\t} else {\n\t\t\tevent = this.events.afterShow;\n\t\t}\n\n\t\tcallback = event;\n\n\t\t// Change is visible status\n\t\tthis.isVisible = true;\n\n\t\t// Fade in\n\t\tthis.elements.modal.container.fadeIn( thisModal.config.fadeDuration, callback );\n\t}\n\n\t/**\n\t * Hides the modal\n\t *\n\t * @param {Function} callback Custom function that it's going to be\n\t *                            invoked after we hide the modal\n\t * @return {undefined}\n\t */\n\thide( callback = null ) {\n\t\t// eslint-disable-next-line no-empty-function, require-jsdoc\n\t\tlet event = () => {};\n\n\t\tif ( isDefined( callback ) ) {\n\t\t\tevent = callback;\n\t\t} else {\n\t\t\tevent = this.events.afterHide;\n\t\t}\n\n\t\tcallback = event;\n\n\t\t// Change is visible status\n\t\tthis.isVisible = false;\n\n\t\t// Fade out\n\t\tthis.elements.modal.container.fadeOut( this.config.fadeDuration, callback );\n\n\t\t// Remove modal open class from the html tag\n\t\t$( 'html' ).removeClass( 'automator-modal-open' );\n\t}\n\n\t/**\n\t * Returns all the DOM elements related to the modal\n\t *\n\t * @return {Object} All the DOM elements created by this class\n\t */\n\tgetElements() {\n\t\treturn this.elements;\n\t}\n}\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { isDefined, isEmpty } from '../common/utilities.js';\n\nimport Field from './field.js';\n\nclass FieldsGroup {\n\t// eslint-disable-next-line no-unused-vars\n\tconstructor( attributes, createDOMelements = true, customValidationFunction = null ) {\n\t\t// Save attributes\n\t\tthis.setAttributes( attributes );\n\n\t\t// Create fields\n\t\tthis.createFields();\n\t}\n\n\t/**\n\t * Sets attributes. It adds properties like hasValue, hasPlaceholder, etc, automatically\n\t *\n\t * @param {Object} attributes The field attributes\n\t * @return {undefined}\n\t */\n\tsetAttributes( attributes ) {\n\t\t// Has label\n\t\tif ( ! isDefined( attributes.hasLabel ) ) {\n\t\t\tif ( ! isEmpty( attributes.label ) ) {\n\t\t\t\tattributes.hasLabel = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasLabel = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has description\n\t\tif ( ! isDefined( attributes.hasDescription ) ) {\n\t\t\tif ( ! isEmpty( attributes.description ) ) {\n\t\t\t\tattributes.hasDescription = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasDescription = false;\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes = attributes;\n\t}\n\n\t/**\n\t * Create instances of Field\n\t *\n\t * @since  2.0\n\t * @return undefined\n\t */\n\n\tcreateFields() {\n\t\t// Replace fields data with Field instances\n\t\tthis.fields = this.attributes.fields.map( ( fieldData ) => {\n\t\t\t// Create Field\n\t\t\treturn new Field( fieldData.fieldType, fieldData );\n\t\t} );\n\t}\n\n\t/**\n\t * Create a jQuery DOM element with the field\n\t *\n\t * @since 0.3\n\t */\n\n\tcreateFormElement() {\n\t\t// Create response object\n\t\tlet response = null;\n\n\t\t// Create container\n\t\tconst $container = $( `<div class=\"form-group\"></div>` );\n\n\t\t// Check if it has a label\n\t\tif ( this.attributes.hasLabel ) {\n\t\t\t// Create label\n\t\t\tconst $label = $( `<div class=\"form-group__label\">${ this.attributes.label }</div>` );\n\n\t\t\t// Append label\n\t\t\t$container.append( $label );\n\t\t}\n\n\t\t// Create form group. We're going to add the fields here\n\t\tconst $formGroup = $( `<div class=\"form-group__fields\"></div>` );\n\t\t// Iterate fields\n\t\tthis.fields.forEach( ( field ) => {\n\t\t\t// Create form element\n\t\t\tconst $fieldElement = field.createFormElement();\n\n\t\t\t// Append form element\n\t\t\t$formGroup.append( $fieldElement );\n\t\t} );\n\t\t// Append fields\n\t\t$container.append( $formGroup );\n\n\t\t// Check if it has a description\n\t\tif ( this.attributes.hasLabel ) {\n\t\t\t// Create description\n\t\t\tconst $description = $( `<div class=\"form-group__description\">${ this.attributes.description }</div>` );\n\n\t\t\t// Append description\n\t\t\t$container.append( $description );\n\t\t}\n\n\t\t// Save form element\n\t\tthis.formElement = $container;\n\t\tresponse = $container;\n\n\t\t// Return form element\n\t\treturn response;\n\t}\n\n\t/**\n\t * Get value\n\t *\n\t * @since  2.0\n\t * @return {object} Object where the key is the field ID and the value is the field's value\n\t */\n\n\tgetValue() {\n\t\t// Create object where we're going to save the values\n\t\tconst fieldsValue = {};\n\n\t\t// Iterate fields\n\t\tthis.fields.forEach( ( field ) => {\n\t\t\t// Add the field value\n\t\t\tfieldsValue[ field.getFieldID() ] = field.getValue();\n\t\t} );\n\n\t\t// Return validation object\n\t\treturn fieldsValue;\n\t}\n\n\t/**\n\t * Get form element\n\t *\n\t * @since 2.0\n\t * @return {object} jQuery object of the field's container\n\t */\n\n\tgetFormElement() {\n\t\treturn this.formElement;\n\t}\n\n\t/**\n\t * Get attributes\n\t *\n\t * @since 2.0\n\t * @return {object} Field attributes\n\t */\n\n\tgetAttributes() {\n\t\treturn this.attributes;\n\t}\n\n\t/**\n\t * Validate the fields\n\t *\n\t * @since 2.0\n\t * @param {boolean} renderError - TRUE if you want to render the field errors, FALSE if you only want to return the response object\n\t * @return {object} Object where the key is the field ID and the value is a validateField object\n\t */\n\n\tvalidate( renderError = true ) {\n\t\t// Create validation object\n\t\tconst validationObject = {\n\t\t\tisValid: true,\n\t\t\tmessage: '',\n\t\t};\n\n\t\t// Iterate fields\n\t\tthis.fields.forEach( ( field ) => {\n\t\t\t// Validate and add response to the validation object\n\t\t\tvalidationObject[ field.getFieldID() ] = field.validate( renderError );\n\n\t\t\t// Update main validation\n\t\t\tvalidationObject.isValid = validationObject.isValid && validationObject[ field.getFieldID() ].isValid;\n\t\t} );\n\n\t\t// Return validation object\n\t\treturn validationObject;\n\t}\n}\n\nexport default FieldsGroup;\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { isDefined, isEmpty } from '../common/utilities.js';\n\nimport Field from './field.js';\n\nconst sortable = require( 'html5sortable' );\n\nclass FieldsRepeater {\n\t// eslint-disable-next-line no-unused-vars\n\tconstructor( attributes, createDOMelements = true, customValidationFunction = null ) {\n\t\t// Save attributes\n\t\tthis.setAttributes( attributes );\n\n\t\t// Create fields\n\t\tthis.createFields();\n\t}\n\n\t/**\n\t * Set attributes. It add properties like hasValue, hasPlaceholder, etc, automatically\n\t *\n\t * @since 0.4\n\t * @param {object} attributes - The field attributes\n\t * @return {object} attributes - The field attributes\n\t */\n\n\tsetAttributes( attributes ) {\n\t\t// Has label\n\t\tif ( ! isDefined( attributes.hasLabel ) ) {\n\t\t\tif ( ! isEmpty( attributes.label ) ) {\n\t\t\t\tattributes.hasLabel = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasLabel = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has description\n\t\tif ( ! isDefined( attributes.hasDescription ) ) {\n\t\t\tif ( ! isEmpty( attributes.description ) ) {\n\t\t\t\tattributes.hasDescription = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasDescription = false;\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes = attributes;\n\t}\n\n\t/**\n\t * Create instances of Field\n\t *\n\t * @since  2.0\n\t * @return undefined\n\t */\n\n\tcreateFields() {\n\t\t// Get fields template\n\t\tconst rowFieldsTemplate = this.attributes.fields;\n\n\t\t// Create array with fields\n\t\tlet fieldsRows = [];\n\n\t\t// Check if there is data and create multiple rows of the repeater field\n\t\tif ( Array.isArray( this.attributes.currentValue ) && this.attributes.currentValue.length > 0 ) {\n\t\t\t// https://regex101.com/r/tLL7S9/1/\n\t\t\t// Get field id and index from strings like FIELD_1\n\n\t\t\t// Iterate default rows\n\t\t\tthis.attributes.currentValue.forEach( ( row ) => {\n\t\t\t\t// Clone template row\n\t\t\t\tlet rowFields = JSON.parse( JSON.stringify( rowFieldsTemplate ) );\n\n\t\t\t\t// Iterate the rows in the template and try to get their\n\t\t\t\t// value from the \"row\" array\n\t\t\t\trowFields = rowFields.map( ( field ) => {\n\t\t\t\t\t// Check if there is a value for this field\n\t\t\t\t\tif ( isDefined( row[ field.optionCode ] ) ) {\n\t\t\t\t\t\t// Save value\n\t\t\t\t\t\tfield.currentValue = row[ field.optionCode ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Set empty value\n\t\t\t\t\t\tfield.currentValue = '';\n\t\t\t\t\t}\n\n\t\t\t\t\t// Return field\n\t\t\t\t\treturn field;\n\t\t\t\t} );\n\n\t\t\t\t// Add row with fields\n\t\t\t\tfieldsRows.push( rowFields );\n\t\t\t} );\n\t\t} else if ( this.attributes.isRequired ) {\n\t\t\t// Otherwise, just create one row\n\t\t\t// Check if the field is required\n\t\t\t//\n\t\t\t// Create an empty row\n\t\t\tconst emptyRow = JSON.parse( JSON.stringify( rowFieldsTemplate ) );\n\n\t\t\t// Remove undefined current value\n\t\t\temptyRow.currentValue = '';\n\n\t\t\t// Add it to the main array\n\t\t\tfieldsRows.push( emptyRow );\n\t\t}\n\n\t\t// Now iterate the row with fields\n\t\tfieldsRows = fieldsRows.map( ( row ) => {\n\t\t\t// Now iterate each group of fields\n\t\t\trow = row.map( ( fieldObject ) => {\n\t\t\t\t// Remove the label\n\t\t\t\tfieldObject.label = '';\n\n\t\t\t\t// Remove the description\n\t\t\t\tfieldObject.description = '';\n\n\t\t\t\t// Create field\n\t\t\t\tconst field = new Field( fieldObject.fieldType, fieldObject );\n\n\t\t\t\t// Return field instance\n\t\t\t\treturn field;\n\t\t\t} );\n\n\t\t\t// Return row\n\t\t\treturn row;\n\t\t} );\n\n\t\t// Update the fields property\n\t\tthis.fieldRows = fieldsRows;\n\t}\n\n\t/**\n\t * Create a jQuery DOM element with the field\n\t *\n\t * @since 0.3\n\t */\n\n\tcreateFormElement() {\n\t\t// Create response object\n\t\tlet response = null;\n\n\t\t// Create container\n\t\tconst $container = $( `<div class=\"form-repeater\"></div>` );\n\n\t\t// Check if it has a label\n\t\tif ( this.attributes.hasLabel ) {\n\t\t\t// Create label\n\t\t\tconst $label = $( `\n\t\t\t\t<div class=\"form-repeater__label\">\n\t\t\t\t\t${ this.attributes.label }\n\t\t\t\t\t${ this.attributes.isRequired ? `<span class=\"form-repeater__label-required\"></span>` : `` }\n\t\t\t\t</div>\n\t\t\t` );\n\n\t\t\t// Append label\n\t\t\t$container.append( $label );\n\t\t}\n\n\t\t// Create table with the fields\n\t\tconst $table = this.getFieldsTable();\n\t\t$container.append( $table );\n\n\t\t// Add error container\n\t\t$table.append( $( `<div class=\"form-element__error\"></div>` ) );\n\n\t\t// Check if it has a description\n\t\tif ( this.attributes.hasDescription ) {\n\t\t\t// Create description\n\t\t\tconst $description = $( `<div class=\"form-repeater__description\">${ this.attributes.description }</div>` );\n\n\t\t\t// Append description\n\t\t\t$container.append( $description );\n\t\t}\n\n\t\t// Save form element\n\t\tthis.formElement = $container;\n\t\tresponse = $container;\n\n\t\t// If there is more than one row, make list sortable\n\t\tif ( this.fieldRows.length > 1 ) {\n\t\t\tthis.makeRowsSortable();\n\t\t}\n\n\t\t// Listen save\n\t\tthis.listenSave();\n\n\t\t// Return form element\n\t\treturn response;\n\t}\n\n\t/**\n\t * Listen save\n\t */\n\n\tlistenSave() {\n\t\t// Get form element\n\t\t// eslint-disable-next-line no-unused-vars\n\t\tthis.formElement.on( 'saved', ( event ) => {\n\t\t\t// Update the fields array\n\t\t\tthis.updateAttributesFieldsFromRow();\n\t\t} );\n\t}\n\n\t/**\n\t * Use fieldRows to update the original attributes.fields\n\t * We will use this to render the container again after it was\n\t * saved\n\t */\n\n\tupdateAttributesFieldsFromRow() {\n\t\t// Create the array where we're going to save the fields data\n\t\tconst fields = [];\n\n\t\t// Iterate fieldRows\n\t\tthis.fieldRows.forEach( ( rowFields ) => {\n\t\t\t// Create array to save the row fields\n\t\t\tconst row = [];\n\n\t\t\t// Iterate row fields\n\t\t\trowFields.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add field\n\t\t\t\trow.push( fieldInstance.attributes );\n\t\t\t} );\n\n\t\t\t// Add row\n\t\t\tfields.push( row );\n\t\t} );\n\n\t\t// Update fields\n\t\tthis.attributes.fields = fields;\n\t}\n\n\t/**\n\t * Make list of rows sortable\n\t */\n\n\tmakeRowsSortable() {\n\t\t// Make rows sortable\n\t\t// Use sortable from the html5sortable library\n\t\tsortable( this.formElement.find( '.form-repeater-fields__table-rows' ), {\n\t\t\tforcePlaceholderSize: true,\n\t\t\thandle: '.form-repeater-fields__table-rows-cell--number',\n\t\t\tplaceholder: `<tr><td colspan=\"${ this.fieldRows[ 0 ].length + 2 }\">&nbsp;</td></tr>`,\n\t\t\t// eslint-disable-next-line no-unused-vars\n\t\t\titemSerializer: ( serializedItem, sortableContainer ) => {\n\t\t\t\treturn {\n\t\t\t\t\tposition: serializedItem.index,\n\t\t\t\t\thtml: serializedItem.html,\n\t\t\t\t};\n\t\t\t},\n\t\t} );\n\n\t\t// Listen modifications to the rows order\n\t\tthis.formElement.find( '.form-repeater-fields__table-rows' ).on( 'sortupdate', ( event ) => {\n\t\t\t// Create an array where each element is the index of the row in the old order\n\t\t\tconst newOrder = [];\n\n\t\t\t// Iterate the rows (in their new order)\n\t\t\t$.each( event.detail.destination.items, ( index, row ) => {\n\t\t\t\tnewOrder.push( $( row ).data( 'order' ) );\n\t\t\t} );\n\n\t\t\t// Change the order of the rows in the FieldRepeater instance\n\t\t\tconst newFieldRowsOrder = [];\n\t\t\tnewOrder.forEach( ( oldIndex ) => {\n\t\t\t\tnewFieldRowsOrder.push( this.fieldRows[ oldIndex ] );\n\t\t\t} );\n\t\t\tthis.fieldRows = newFieldRowsOrder;\n\n\t\t\t// Render the field agian\n\t\t\tthis.reRender();\n\t\t} );\n\t}\n\n\t/**\n\t * Create and return fields table\n\t *\n\t * @since  2.0\n\t */\n\n\tgetFieldsTable() {\n\t\t// Create variable to save the table\n\t\tconst $table = $( `\n\t\t\t<div class=\"form-repeater-fields\">\n\t\t\t\t<table class=\"form-repeater-fields__table\">\n\t\t\t\t\t<thead class=\"form-repeater-fields__table-heading\"></thead>\n\t\t\t\t\t<tbody class=\"form-repeater-fields__table-rows\"></tbody>\n\t\t\t\t</table>\n\t\t\t\t<div class=\"form-repeater-fields__actions\"></div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Create table with the rows\n\t\t// Get table headers\n\t\t// We will create a table where the name of the column will\n\t\t// be the label of the field\n\t\tconst heading = [];\n\n\t\t// Iterate the original fields object inside attributes (not the Field instances)\n\t\tthis.attributes.fields.forEach( ( fieldData ) => {\n\t\t\t// Get column title\n\t\t\tconst title = isDefined( fieldData.label ) ? fieldData.label : '';\n\n\t\t\t// Check if the fields under this column are required\n\t\t\tconst isRequired = isDefined( fieldData.isRequired ) ? fieldData.isRequired : false;\n\n\t\t\t// Get the column description\n\t\t\tconst description = isDefined( fieldData.description ) ? fieldData.description : '';\n\n\t\t\t// Add heading column\n\t\t\theading.push( {\n\t\t\t\ttitle: title,\n\t\t\t\tdescription: description,\n\t\t\t\tisRequired: isRequired,\n\t\t\t} );\n\t\t} );\n\n\t\t// Create HTML of the heading\n\t\tconst $heading = $( `<tr></tr>` );\n\n\t\t// Add the column with for the row number\n\t\t$heading.append(\n\t\t\t$(\n\t\t\t\t`<th class=\"form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--number\">#</th>`\n\t\t\t)\n\t\t);\n\n\t\t// Iterate heading columns\n\t\theading.forEach( ( headingColumn ) => {\n\t\t\t// Create column\n\t\t\tconst $headingColumn = $( `<th class=\"form-repeater-fields__table-heading-cell\"></th>` );\n\n\t\t\t// Add the title\n\t\t\tif ( ! isEmpty( headingColumn.title ) ) {\n\t\t\t\t$headingColumn.append(\n\t\t\t\t\t$( `\n\t\t\t\t\t<div class=\"form-repeater-fields__table-heading-cell-title\">\n\t\t\t\t\t\t${ headingColumn.title }\n\t\t\t\t\t\t${ headingColumn.isRequired ? '<span class=\"form-repeater-fields__table-heading-cell-required\"></span>' : '' }\n\t\t\t\t\t</div>\n\t\t\t\t` )\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Add the description\n\t\t\tif ( ! isEmpty( headingColumn.description ) ) {\n\t\t\t\t$headingColumn.append(\n\t\t\t\t\t$( `\n\t\t\t\t\t<div class=\"form-repeater-fields__table-heading-cell-description\">\n\t\t\t\t\t\t${ headingColumn.description }\n\t\t\t\t\t</div>\n\t\t\t\t` )\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Add heading column\n\t\t\t$heading.append( $headingColumn );\n\t\t} );\n\n\t\t// Add the column with for the actions\n\t\t$heading.append(\n\t\t\t$(\n\t\t\t\t`<th class=\"form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--actions\"></th>`\n\t\t\t)\n\t\t);\n\n\t\t// Append heading\n\t\tconst $headingContainer = $table.find( '.form-repeater-fields__table-heading' );\n\t\t$headingContainer.append( $heading );\n\n\t\t// Create HTML of the rows\n\t\tconst $rows = $table.find( '.form-repeater-fields__table-rows' );\n\n\t\t// Get number of rows\n\t\tconst numberOfRows = this.fieldRows.length;\n\n\t\t// Iterate rows of fields\n\t\tthis.fieldRows.forEach( ( row, index ) => {\n\t\t\t// Create container for the row\n\t\t\tconst $row = $( `<tr data-order=\"${ index }\"></tr>` );\n\n\t\t\t// Add the column with for the row number\n\t\t\t$row.append(\n\t\t\t\t$(\n\t\t\t\t\t`<td class=\"form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--number\">${\n\t\t\t\t\t\tindex + 1\n\t\t\t\t\t}</td>`\n\t\t\t\t)\n\t\t\t);\n\n\t\t\t// Add fields\n\t\t\trow.forEach( ( fieldInstance ) => {\n\t\t\t\t// Create container\n\t\t\t\tconst $fieldCell = $( `<td class=\"form-repeater-fields__table-rows-cell\"></td>` );\n\n\t\t\t\t// Get field's DOM element\n\t\t\t\tconst $field = fieldInstance.getFormElement();\n\t\t\t\t// Make sure all the libraries had been initialized\n\t\t\t\tfieldInstance.initLibraries();\n\n\t\t\t\t// Add field container\n\t\t\t\t$fieldCell.append( $field );\n\n\t\t\t\t// Append field cell to the row\n\t\t\t\t$row.append( $fieldCell );\n\t\t\t} );\n\n\t\t\t// Add the column for the actions, and add the delete button\n\t\t\tconst $actions = $(\n\t\t\t\t`<td class=\"form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--actions\"></td>`\n\t\t\t);\n\t\t\t$row.append( $actions );\n\n\t\t\tconst fieldAtts = this.getAttributes();\n\n\t\t\t// Check if the field requires at least on row and if this is the first row\n\t\t\tif ( index != 0 || ( index == 0 && ( ! this.attributes.isRequired || numberOfRows > 1 ) ) ) {\n\t\t\t\t// Check if there is a custom \"Remove row\" label. If there is one,\n\t\t\t\t// use that, otherwise use the default one\n\t\t\t\tconst removeRowLabel = isDefined( this.attributes.removeRowButtonLabel )\n\t\t\t\t\t? this.attributes.removeRowButtonLabel\n\t\t\t\t\t: UncannyAutomator.i18n.removeRow;\n\n\t\t\t\t// Create delete button\n\t\t\t\tconst $removeRowButton = $(\n\t\t\t\t\t`<div class=\"form-repeater-fields__table-rows-cell-remove\" uap-tooltip=\"${ removeRowLabel }\"><span></span></div>`\n\t\t\t\t);\n\n\t\t\t\t// Listen clicks to the remove button\n\t\t\t\t$removeRowButton.on( 'click', () => {\n\t\t\t\t\t// Remove the row by index\n\t\t\t\t\tthis.deleteRow( index );\n\t\t\t\t} );\n\n\t\t\t\t// if hideActions is false, Add Remove row button\n\t\t\t\tif ( ! fieldAtts.hideActions ) {\n\t\t\t\t\t// Add remove button to the actions cell\n\t\t\t\t\t$actions.append( $removeRowButton );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add $row to the $rows element\n\t\t\t$rows.append( $row );\n\t\t} );\n\n\t\t// Create \"Add row\" button\n\t\tconst fieldAtts = this.getAttributes();\n\t\t// if hideActions is false, Add Pair button\n\t\tif ( ! fieldAtts.hideActions ) {\n\t\t\tconst $addRowButton = $( `\n\t\t\t\t<div class=\"uap-btn uap-btn--primary uap-btn--small\">\n\t\t\t\t\t${ UncannyAutomator.i18n.addRow }\n\t\t\t\t</div>\n\t\t\t` );\n\n\t\t\t// Check if we have to change label of the button\n\t\t\tif ( isDefined( this.attributes.addRowButtonLabel ) ) {\n\t\t\t\t$addRowButton.text( this.attributes.addRowButtonLabel );\n\t\t\t}\n\n\t\t\t// Listen clicks\n\t\t\t$addRowButton.on( 'click', () => {\n\t\t\t\t// Show loading animation\n\t\t\t\t$addRowButton.addClass( 'uap-btn--loading' );\n\n\t\t\t\t// Add another row\n\t\t\t\tthis.addRow();\n\t\t\t} );\n\n\t\t\t// Add actions\n\t\t\tconst $actionsContainer = $table.find( '.form-repeater-fields__actions' );\n\t\t\t$actionsContainer.append( $addRowButton );\n\t\t}\n\t\treturn $table;\n\t}\n\n\t/**\n\t * Get value\n\t *\n\t * @since  2.0\n\t * @return {object} Object where the key is the field ID and the value is the field's value\n\t */\n\n\tgetValue() {\n\t\t// Create object where we're going to save the values\n\t\tconst value = [];\n\n\t\t// Iterate rows\n\t\tthis.fieldRows.forEach( ( row ) => {\n\t\t\t// Get the value of the fields\n\t\t\tconst fieldsValue = {};\n\n\t\t\t// Iterate fields\n\t\t\trow.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add it to the fieldsValue object\n\t\t\t\tfieldsValue[ fieldInstance.getFieldID() ] = fieldInstance.getValue();\n\t\t\t} );\n\n\t\t\t// Add fields value to the main array\n\t\t\tvalue.push( fieldsValue );\n\t\t} );\n\n\t\t// Return value\n\t\treturn value;\n\t}\n\n\t/**\n\t * Add row\n\t *\n\t * @since  2.0\n\t */\n\n\taddRow( fieldsData = {}, reRender = true ) {\n\t\t// Create an empty row\n\t\tlet emptyRow = JSON.parse( JSON.stringify( this.attributes.fields ) );\n\n\t\t// Remove undefined current value\n\t\temptyRow.currentValue = '';\n\n\t\t// Now iterate the fields\n\t\temptyRow = emptyRow.map( ( fieldObject ) => {\n\t\t\t// Remove the label\n\t\t\tfieldObject.label = '';\n\n\t\t\t// Remove the description\n\t\t\tfieldObject.description = '';\n\n\t\t\t// Check if there is a default value for this field\n\t\t\tif ( isDefined( fieldsData[ fieldObject.optionCode ] ) ) {\n\t\t\t\t// And if there is, use that data\n\t\t\t\tfieldObject.currentValue = fieldsData[ fieldObject.optionCode ];\n\t\t\t}\n\n\t\t\t// Create field\n\t\t\tconst field = new Field( fieldObject.fieldType, fieldObject );\n\n\t\t\t// Return field instance\n\t\t\treturn field;\n\t\t} );\n\n\t\t// Add it to the rows of fields\n\t\tthis.fieldRows.push( emptyRow );\n\n\t\t// Render form element again\n\t\tif ( reRender ) {\n\t\t\tthis.reRender( true );\n\t\t}\n\t}\n\n\t/**\n\t * Rerender the field again\n\t */\n\n\treRender( focusFirstFieldOfLastRow = false ) {\n\t\t// Destroy CodeMirror instances\n\t\tthis.destroyCodeMirror();\n\t\t// Destroy the token selector\n\t\tthis.destroyTokenSelector();\n\n\t\t// Create the form element again\n\t\tconst $currentFormElement = this.formElement;\n\t\tconst $newFormElement = this.createFormElement( false );\n\t\t$currentFormElement.replaceWith( $newFormElement );\n\n\t\t// Create the token selector\n\t\tthis.initTokenSelector();\n\t\t// Create the CodeMirror instances\n\t\tthis.initCodeMirror();\n\n\t\t// Check if we have to focus the first field of the last row\n\t\tif ( focusFirstFieldOfLastRow ) {\n\t\t\t// Get the last row\n\t\t\tconst lastRow = this.fieldRows[ this.fieldRows.length - 1 ];\n\n\t\t\tif ( isDefined( lastRow ) ) {\n\t\t\t\t// Get the first field\n\t\t\t\tconst firstField = lastRow[ 0 ];\n\n\t\t\t\tif ( isDefined( firstField ) ) {\n\t\t\t\t\tfirstField.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Delete row\n\t *\n\t * @since  2.0\n\t */\n\n\tdeleteRow( index ) {\n\t\t// Check if there is a row with that index\n\t\tif ( isDefined( this.fieldRows[ index ] ) ) {\n\t\t\t// Remove element\n\t\t\tthis.fieldRows.splice( index, 1 );\n\t\t}\n\n\t\t// Render form element again\n\t\tthis.formElement.replaceWith( this.createFormElement() );\n\t}\n\n\t/**\n\t * Get form element\n\t *\n\t * @since 2.0\n\t * @return {object} jQuery object of the field's container\n\t */\n\n\tgetFormElement() {\n\t\t// Return form element\n\t\treturn this.formElement;\n\t}\n\n\t/**\n\t * Get attributes\n\t *\n\t * @since 2.0\n\t * @return {object} Field attributes\n\t */\n\n\tgetAttributes() {\n\t\treturn this.attributes;\n\t}\n\n\t/**\n\t * Get field ID\n\t *\n\t * @since 2.0\n\t * @return {string} The field ID\n\t */\n\n\tgetFieldID() {\n\t\treturn this.attributes.optionCode;\n\t}\n\n\t/**\n\t * Validate the fields\n\t *\n\t * @since 2.0\n\t * @param {boolean} renderError - TRUE if you want to render the field errors, FALSE if you only want to return the response object\n\t * @return {object} Object where the key is the field ID and the value is a validateField object\n\t */\n\n\tvalidate( renderError = true ) {\n\t\t// Create validation object\n\t\tconst validation = {\n\t\t\tisValid: true,\n\t\t\tmessage: '',\n\t\t};\n\n\t\t// Create array to save the validation of the rows\n\t\tconst rowsValidation = [];\n\n\t\t// Iterate fields\n\t\tthis.fieldRows.forEach( ( row ) => {\n\t\t\t// Create object to save the row validation\n\t\t\tconst rowValidation = {};\n\n\t\t\t// Iterate each field\n\t\t\trow.forEach( ( fieldInstance ) => {\n\t\t\t\t// Validate and add response to the validation object\n\t\t\t\trowValidation[ fieldInstance.getFieldID() ] = fieldInstance.validate( renderError );\n\n\t\t\t\t// Update global validation\n\t\t\t\tvalidation.isValid = validation.isValid && rowValidation[ fieldInstance.getFieldID() ].isValid;\n\t\t\t} );\n\n\t\t\t// Add row validation to the main validation array\n\t\t\trowsValidation.push( rowValidation );\n\t\t} );\n\n\t\t// Return validation object\n\t\treturn validation;\n\t}\n\n\tinitTokenSelector() {\n\t\tthis.fieldRows.forEach( ( rowFields ) => {\n\t\t\t// Iterate row fields\n\t\t\trowFields.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add field\n\t\t\t\tfieldInstance.initTokenSelector();\n\t\t\t} );\n\t\t} );\n\t}\n\n\tdestroyTokenSelector() {\n\t\tthis.fieldRows.forEach( ( rowFields ) => {\n\t\t\t// Iterate row fields\n\t\t\trowFields.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add field\n\t\t\t\tfieldInstance.destroyTokenSelector();\n\t\t\t} );\n\t\t} );\n\t}\n\n\tinitCodeMirror() {\n\t\tthis.fieldRows.forEach( ( rowFields ) => {\n\t\t\t// Iterate row fields\n\t\t\trowFields.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add field\n\t\t\t\tfieldInstance.initCodeMirror();\n\t\t\t} );\n\t\t} );\n\t}\n\n\tdestroyCodeMirror() {\n\t\tthis.fieldRows.forEach( ( rowFields ) => {\n\t\t\t// Iterate row fields\n\t\t\trowFields.forEach( ( fieldInstance ) => {\n\t\t\t\t// Add field\n\t\t\t\tfieldInstance.destroyCodeMirror();\n\t\t\t} );\n\t\t} );\n\t}\n}\n\nexport default FieldsRepeater;\n","// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\n// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport Field from '../field/field.js';\nimport FieldsGroup from '../field/group.js';\nimport FieldsRepeater from '../field/repeater.js';\n\nimport RecipeTypeSelector from '../recipe/type-selector.js';\n\nimport Tokens from '../tokens/tokens.js';\n\nimport Modal from './modal.js';\n\n/**\n * Creates the data required for Automator to render\n *\n * @param {Function} callback The function to invoke after the data is ready\n * @return {undefined}\n */\nexport const createDataOnLoad = ( callback = '' ) => {\n\t// Output if the developer mode is enabled\n\tif ( UncannyAutomator.dev.developerMode ) {\n\t\tconsoleLogLabel( 'Start creating the main object' );\n\t}\n\n\t// Check if there is a callback defined\n\t// eslint-disable-next-line no-empty-function\n\tcallback = ! isEmpty( callback ) ? callback : () => {};\n\n\t/**\n\t * Completes the process of UI creation once it knows what's the\n\t * recipe type the user wants to create\n\t *\n\t * @return {undefined}\n\t */\n\tconst completeProcess = () => {\n\t\t// Filter Automator items\n\t\tfilterAutomatorItemsByRecipeType();\n\t\t// Group the triggers and actions by integration\n\t\tgroupItemsByIntegration();\n\n\t\t// Get recipe items on page load\n\t\trecipeObject( 'create', {\n\t\t\tallRecipes: UncannyAutomator.recipes_object,\n\t\t} );\n\n\t\t// Remove unnecessary data\n\t\t// delete UncannyAutomator.recipes_object;\n\t\tdelete UncannyAutomator.triggers;\n\t\tdelete UncannyAutomator.actions;\n\n\t\t// Output if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\tconsoleLogLabel( 'Ended creating the main object' );\n\t\t}\n\n\t\t// Invoke the callback\n\t\tcallback();\n\t};\n\n\t// Check if WP is ready\n\tif ( ! isEmpty( UncannyAutomator.recipe.type ) ) {\n\t\t// Complete the process\n\t\tcompleteProcess();\n\t} else {\n\t\t// Call to Recipe Type Selector\n\t\tnew RecipeTypeSelector( () => {\n\t\t\t// Complete the process\n\t\t\tcompleteProcess();\n\t\t} );\n\t}\n};\n\n/**\n * Updates all the objects used for the UI using the recipes_object object\n *\n * @param {String} action     Action to perform. Valid actions: 'create', 'delete',\n * @param {Object} attributes Data, check each switch to see the required data\n * @return {Boolean}            True if the action was made successfully\n */\nexport const recipeObject = ( action = null, attributes = {} ) => {\n\t// Create response variable and set default value\n\tlet response = false;\n\n\t// Define valid actions\n\tconst validActions = [ 'create', 'validate' ];\n\n\t// Check if the action is not undefined and if it's a valid action\n\tif ( isDefined( action ) && inArray( action, validActions ) ) {\n\t\tswitch ( action ) {\n\t\t\tcase 'create':\n\t\t\t\t// Define required attributes properties\n\t\t\t\tconst requiredData = [ 'allRecipes' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Get this recipe in the allRecipes object\n\t\t\t\t\tlet recipe;\n\n\t\t\t\t\t// Create allRecipes variable\n\t\t\t\t\tconst allRecipes = attributes.allRecipes;\n\n\t\t\t\t\t$.each( allRecipes, ( index, theRecipe ) => {\n\t\t\t\t\t\tif ( theRecipe.ID == UncannyAutomator.recipe.id ) {\n\t\t\t\t\t\t\trecipe = theRecipe;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Store extra options in the main UncannyAutomator object for future use\n\t\t\t\t\tif ( isDefined( recipe.extra_options ) && ! isEmpty( recipe.extra_options ) ) {\n\t\t\t\t\t\tUncannyAutomator.recipes_object[ recipe.ID ].extra_options = recipe.extra_options;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add element to all triggers, actions and closures to define the itemType. We're going to need this later\n\t\t\t\t\t$.each( recipe.triggers, ( index, item ) => ( item.itemType = 'trigger' ) );\n\t\t\t\t\t$.each( recipe.actions, ( index, item ) => ( item.itemType = 'action' ) );\n\t\t\t\t\t$.each( recipe.closures, ( index, item ) => ( item.itemType = 'closure' ) );\n\n\t\t\t\t\t// Merge all the recipe triggers, actions and closures into one array\n\t\t\t\t\tconst items = [].concat.apply( [], [ recipe.triggers, recipe.actions, recipe.closures ] );\n\n\t\t\t\t\t// Reset items object\n\t\t\t\t\titemsObject( 'reset' );\n\n\t\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\t\tconst recipeIsAnonymous = UncannyAutomator.recipe.type == 'anonymous';\n\n\t\t\t\t\t// Iterate each item and add it to the itemsObject\n\t\t\t\t\t$.each( items, ( index, item ) => {\n\t\t\t\t\t\t// We're going to get all the required information to before adding the item to the items object\n\t\t\t\t\t\tlet itemToAdd;\n\n\t\t\t\t\t\t// Get the integration ID\n\t\t\t\t\t\tconst itemIntegration = item.meta.integration;\n\n\t\t\t\t\t\t// Get the item code in this variable\n\t\t\t\t\t\tconst itemCode = item.meta.code;\n\n\t\t\t\t\t\tlet extraOptions;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\textraOptions =\n\t\t\t\t\t\t\t\tUncannyAutomator.recipes_object[ recipe.ID ].extra_options[ itemIntegration ][\n\t\t\t\t\t\t\t\t\titemCode\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\t\t// There are no extra options for this item, do nothing\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Get the data from the global item\n\t\t\t\t\t\tconst globalItem = getGlobalItem( itemIntegration, item.itemType, itemCode );\n\n\t\t\t\t\t\t// Check if the required PHP code for this item exists\n\t\t\t\t\t\tif ( isDefined( globalItem ) ) {\n\t\t\t\t\t\t\t// Create variable to save all the options\n\t\t\t\t\t\t\tconst options = {};\n\n\t\t\t\t\t\t\tif ( ! isEmpty( extraOptions ) ) {\n\t\t\t\t\t\t\t\t// If extra options were supplied, they will be used instead of the gloab ones\n\t\t\t\t\t\t\t\tif ( isDefined( extraOptions.options ) ) {\n\t\t\t\t\t\t\t\t\t$.each( extraOptions.options, ( i, option ) => {\n\t\t\t\t\t\t\t\t\t\toptions[ option.option_code ] = [ option ];\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif ( isDefined( extraOptions.options_group ) ) {\n\t\t\t\t\t\t\t\t\t$.extend( true, options, extraOptions.options_group );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Check if it has simple options (options that aren't part of a group of options)\n\t\t\t\t\t\t\t\tif ( isDefined( globalItem.options ) ) {\n\t\t\t\t\t\t\t\t\t$.each( globalItem.options, ( i, option ) => {\n\t\t\t\t\t\t\t\t\t\toptions[ option.option_code ] = [ option ];\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Add group of options\n\t\t\t\t\t\t\t\tif ( isDefined( globalItem.options_group ) ) {\n\t\t\t\t\t\t\t\t\t$.extend( true, options, globalItem.options_group );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// We're going to create another options variable to create the options object as we're going to add it to the item object\n\t\t\t\t\t\t\tconst groupsOfOptions = {};\n\n\t\t\t\t\t\t\t$.each( options, ( groupKey, fields ) => {\n\t\t\t\t\t\t\t\tconst allFieldsOnThisGroup = [];\n\n\t\t\t\t\t\t\t\t// Check if it has more this group of fields has more than one option\n\t\t\t\t\t\t\t\tconst hasMoreThanOneOption = fields.length > 1;\n\n\t\t\t\t\t\t\t\t$.each( fields, ( i, field ) => {\n\t\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t\t * Sanitizes the field data\n\t\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t\t * @param {Object} field The field data\n\t\t\t\t\t\t\t\t\t * @return {Object}      The field data, sanitized\n\t\t\t\t\t\t\t\t\t */\n\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line require-jsdoc, no-shadow\n\t\t\t\t\t\t\t\t\tconst sanitizeFieldData = ( field ) => {\n\t\t\t\t\t\t\t\t\t\t// Create field object\n\t\t\t\t\t\t\t\t\t\tconst fieldObject = {\n\t\t\t\t\t\t\t\t\t\t\tisGroup: hasMoreThanOneOption,\n\t\t\t\t\t\t\t\t\t\t\titemId: item.ID,\n\t\t\t\t\t\t\t\t\t\t\titemType: item.itemType,\n\n\t\t\t\t\t\t\t\t\t\t\tisRequired: isDefined( field.required ) ? field.required : false,\n\t\t\t\t\t\t\t\t\t\t\tisReadOnly: isDefined( field.read_only ) ? field.read_only : false,\n\t\t\t\t\t\t\t\t\t\t\tsupportsTinyMCE: isDefined( field.supports_tinymce )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.supports_tinymce\n\t\t\t\t\t\t\t\t\t\t\t\t: false,\n\t\t\t\t\t\t\t\t\t\t\tsupportsCopyToClipboard: isDefined( field.copy_to_clipboard )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.copy_to_clipboard\n\t\t\t\t\t\t\t\t\t\t\t\t: false,\n\n\t\t\t\t\t\t\t\t\t\t\tisAjax: isDefined( field.is_ajax ) ? field.is_ajax : false,\n\n\t\t\t\t\t\t\t\t\t\t\tgroupId: groupKey,\n\t\t\t\t\t\t\t\t\t\t\toptionCode: field.option_code,\n\t\t\t\t\t\t\t\t\t\t\tfieldType: field.input_type,\n\n\t\t\t\t\t\t\t\t\t\t\tlabel: field.label,\n\t\t\t\t\t\t\t\t\t\t\tdescription: field.description,\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: field.placeholder,\n\t\t\t\t\t\t\t\t\t\t\tisHidden: isDefined( field.is_hidden ) ? field.is_hidden : false,\n\t\t\t\t\t\t\t\t\t\t\ttokenName: isDefined( field.token_name ) ? field.token_name : field.label,\n\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue: field.default_value,\n\t\t\t\t\t\t\t\t\t\t\tcurrentValue: isDefined( item.meta[ field.option_code ] )\n\t\t\t\t\t\t\t\t\t\t\t\t? item.meta[ field.option_code ]\n\t\t\t\t\t\t\t\t\t\t\t\t: field.default_value,\n\t\t\t\t\t\t\t\t\t\t\tcustomFieldTokens: isDefined( field.relevant_tokens )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.relevant_tokens\n\t\t\t\t\t\t\t\t\t\t\t\t: false,\n\t\t\t\t\t\t\t\t\t\t\trelevantTokens: isDefined( field.relevant_tokens )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.relevant_tokens\n\t\t\t\t\t\t\t\t\t\t\t\t: false,\n\n\t\t\t\t\t\t\t\t\t\t\tmaxLength: isDefined( field.max_length ) ? field.max_length : null,\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t\t\t * Check for type-specific options\n\t\t\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\t\t\tif ( fieldObject.fieldType == 'date' ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.dateFormat = isDefined( field.date_format )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.date_format\n\t\t\t\t\t\t\t\t\t\t\t\t: 'Y-m-d';\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.dateAltFormat = isDefined( field.date_alt_format )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.date_alt_format\n\t\t\t\t\t\t\t\t\t\t\t\t: UncannyAutomator.format.date;\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it supports a range\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsRange = isDefined( field.supports_range )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.supports_range\n\t\t\t\t\t\t\t\t\t\t\t\t: false;\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it has min date defined\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.min_date ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.minDate = field.min_date;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it has max date defined\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.max_date ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.maxDate = field.max_date;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ( fieldObject.fieldType == 'time' ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.timeFormat = isDefined( field.time_format )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.time_format\n\t\t\t\t\t\t\t\t\t\t\t\t: 'h:i K';\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.timeAltFormat = isDefined( field.time_alt_format )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.time_alt_format\n\t\t\t\t\t\t\t\t\t\t\t\t: 'h:i K';\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it has min time defined\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.min_time ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.minTime = field.min_time;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it has max date defined\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.max_date ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.maxTime = field.max_time;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t\t\t * We want to make supportsTokens true by\n\t\t\t\t\t\t\t\t\t\t * default, but we have to check if the field\n\t\t\t\t\t\t\t\t\t\t * should support tokens first.\n\t\t\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t\t\t * - Field type: For now, the token selector\n\t\t\t\t\t\t\t\t\t\t * only supports text, textarea, integer, float,\n\t\t\t\t\t\t\t\t\t\t * email, and URL fields. Check if this field\n\t\t\t\t\t\t\t\t\t\t * is one of those.\n\t\t\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t\t\t * - Item type: The tokens are rendered only in\n\t\t\t\t\t\t\t\t\t\t * the user selector, actions and closures.\n\t\t\t\t\t\t\t\t\t\t * Check if the item type if one of those.\n\t\t\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t\t\t * - Read-only property: Check if the field is\n\t\t\t\t\t\t\t\t\t\t * not read-only. Even if the field meets the\n\t\t\t\t\t\t\t\t\t\t * previous conditions, it doesn't make sense\n\t\t\t\t\t\t\t\t\t\t * to render the token selector on a field\n\t\t\t\t\t\t\t\t\t\t * which value is supposed to be unmodifiable.\n\t\t\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t\t\t * If the field meets all the previous\n\t\t\t\t\t\t\t\t\t\t * conditions, check if it has a defined value\n\t\t\t\t\t\t\t\t\t\t * for the supportsTokens property. Otherwise,\n\t\t\t\t\t\t\t\t\t\t * set it true. If it doesn't meet at least\n\t\t\t\t\t\t\t\t\t\t * one of the conditions, make it false.\n\t\t\t\t\t\t\t\t\t\t */\n\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t'text',\n\t\t\t\t\t\t\t\t\t\t\t\t'textarea',\n\t\t\t\t\t\t\t\t\t\t\t\t'int',\n\t\t\t\t\t\t\t\t\t\t\t\t'float',\n\t\t\t\t\t\t\t\t\t\t\t\t'email',\n\t\t\t\t\t\t\t\t\t\t\t\t'url',\n\t\t\t\t\t\t\t\t\t\t\t\t'select',\n\t\t\t\t\t\t\t\t\t\t\t\t'date',\n\t\t\t\t\t\t\t\t\t\t\t\t'time',\n\t\t\t\t\t\t\t\t\t\t\t].includes( fieldObject.fieldType ) &&\n\t\t\t\t\t\t\t\t\t\t\t[ 'action', 'closure' ].includes( fieldObject.itemType ) &&\n\t\t\t\t\t\t\t\t\t\t\t! fieldObject.isReadOnly\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsTokens = isDefined( field.supports_tokens )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.supports_tokens\n\t\t\t\t\t\t\t\t\t\t\t\t: true;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsTokens = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// If it's a select, check if it support custom values\n\t\t\t\t\t\t\t\t\t\tif ( fieldObject.fieldType == 'select' ) {\n\t\t\t\t\t\t\t\t\t\t\t// Check if the supportsCustomValue parameter is defined. If it's not,\n\t\t\t\t\t\t\t\t\t\t\t// then check if the field is being used on an action or closure. If so, make it true\n\t\t\t\t\t\t\t\t\t\t\t// by default, or false otherwise. Then, on \"Field\", set the default value to false.\n\t\t\t\t\t\t\t\t\t\t\t// We're doing this because, for now, we're supporting custom values on dropdowns\n\t\t\t\t\t\t\t\t\t\t\t// only on actions and closures, nowhere else. So if someone tries to use a dropdown\n\t\t\t\t\t\t\t\t\t\t\t// outside an action or closure, it shouldn't render the \"custom value\" option by default\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.supports_custom_value ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsCustomValue = field.supports_custom_value;\n\t\t\t\t\t\t\t\t\t\t\t} else if ( [ 'action', 'closure' ].includes( fieldObject.itemType ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsCustomValue = true;\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsCustomValue = false;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it supports custom values and it also supports tokens\n\t\t\t\t\t\t\t\t\t\t\tif ( fieldObject.supportsCustomValue ) {\n\t\t\t\t\t\t\t\t\t\t\t\t// Add custom value\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.customValue = isDefined(\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.meta[ `${ fieldObject.optionCode }_custom` ]\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t? item.meta[ `${ fieldObject.optionCode }_custom` ]\n\t\t\t\t\t\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it has a description for the custom value field\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.custom_value_description ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.customValueDescription = field.custom_value_description;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it supports multiple values\n\t\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.supports_multiple_values ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.supportsMultipleValues = field.supports_multiple_values;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Check if it an AJAX field\n\t\t\t\t\t\t\t\t\t\tif ( fieldObject.isAjax ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.targetField = isDefined( field.fill_values_in )\n\t\t\t\t\t\t\t\t\t\t\t\t? field.fill_values_in\n\t\t\t\t\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.endpoint = isDefined( field.endpoint ) ? field.endpoint : '';\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.integrationId = globalItem.integration;\n\n\t\t\t\t\t\t\t\t\t\t\t// Check if it's an ajax field without target field\n\t\t\t\t\t\t\t\t\t\t\t// This means no other field will change when this one changes\n\t\t\t\t\t\t\t\t\t\t\t// and that we have to do an AJAX request when rendering the field, on page load\n\t\t\t\t\t\t\t\t\t\t\tif ( isEmpty( fieldObject.targetField ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\tfieldObject.targetField = field.option_code;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Check if it's select or radio. In that case, add the options\n\t\t\t\t\t\t\t\t\t\tif ( [ 'select', 'radio' ].includes( fieldObject.fieldType ) ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.options = isDefined( field.options ) ? field.options : [];\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Return field object\n\t\t\t\t\t\t\t\t\t\treturn fieldObject;\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tlet fieldObject, fieldInstance;\n\n\t\t\t\t\t\t\t\t\t// Check if it's a group of fields\n\t\t\t\t\t\t\t\t\tif ( field.input_type == 'group' ) {\n\t\t\t\t\t\t\t\t\t\t// Get the field data\n\t\t\t\t\t\t\t\t\t\tfieldObject = {\n\t\t\t\t\t\t\t\t\t\t\tgroupId: groupKey,\n\t\t\t\t\t\t\t\t\t\t\toptionCode: field.option_code,\n\t\t\t\t\t\t\t\t\t\t\tfieldType: field.input_type,\n\n\t\t\t\t\t\t\t\t\t\t\tisGroup: hasMoreThanOneOption,\n\t\t\t\t\t\t\t\t\t\t\titemId: item.ID,\n\t\t\t\t\t\t\t\t\t\t\titemType: item.itemType,\n\n\t\t\t\t\t\t\t\t\t\t\tlabel: field.label,\n\t\t\t\t\t\t\t\t\t\t\tdescription: field.description,\n\n\t\t\t\t\t\t\t\t\t\t\ttokenName: isDefined( field.token_name ) ? field.token_name : field.label,\n\n\t\t\t\t\t\t\t\t\t\t\tisRequired: isDefined( field.required ) ? field.required : false,\n\n\t\t\t\t\t\t\t\t\t\t\tfields: field.fields.map( ( fieldData ) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn sanitizeFieldData( fieldData );\n\t\t\t\t\t\t\t\t\t\t\t} ),\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t\t// Create field instance\n\t\t\t\t\t\t\t\t\t\tfieldInstance = new FieldsGroup( fieldObject );\n\t\t\t\t\t\t\t\t\t} else if ( field.input_type == 'repeater' ) {\n\t\t\t\t\t\t\t\t\t\t// Try to parse the value of the repeater\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\titem.meta[ field.option_code ] = JSON.parse(\n\t\t\t\t\t\t\t\t\t\t\t\titem.meta[ field.option_code ]\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.warn( e );\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Get field data\n\t\t\t\t\t\t\t\t\t\tfieldObject = {\n\t\t\t\t\t\t\t\t\t\t\tgroupId: groupKey,\n\t\t\t\t\t\t\t\t\t\t\toptionCode: field.option_code,\n\t\t\t\t\t\t\t\t\t\t\tfieldType: field.input_type,\n\n\t\t\t\t\t\t\t\t\t\t\tisGroup: hasMoreThanOneOption,\n\t\t\t\t\t\t\t\t\t\t\titemId: item.ID,\n\t\t\t\t\t\t\t\t\t\t\titemType: item.itemType,\n\n\t\t\t\t\t\t\t\t\t\t\tlabel: field.label,\n\t\t\t\t\t\t\t\t\t\t\tdescription: field.description,\n\n\t\t\t\t\t\t\t\t\t\t\ttokenName: isDefined( field.token_name ) ? field.token_name : field.label,\n\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue: field.default_value,\n\t\t\t\t\t\t\t\t\t\t\tcurrentValue: isDefined( item.meta[ field.option_code ] )\n\t\t\t\t\t\t\t\t\t\t\t\t? item.meta[ field.option_code ]\n\t\t\t\t\t\t\t\t\t\t\t\t: field.default_value,\n\n\t\t\t\t\t\t\t\t\t\t\tisRequired: isDefined( field.required ) ? field.required : false,\n\n\t\t\t\t\t\t\t\t\t\t\thideActions: isDefined( field.hide_actions ) ? field.hide_actions : false,\n\n\t\t\t\t\t\t\t\t\t\t\tfields: field.fields.map( ( fieldData ) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn sanitizeFieldData( fieldData );\n\t\t\t\t\t\t\t\t\t\t\t} ),\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t\t// Check if this one has a custom \"Add row\" label\n\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.add_row_button ) ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.addRowButtonLabel = field.add_row_button;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Check if this one has a custom \"Remove row\" label\n\t\t\t\t\t\t\t\t\t\tif ( isDefined( field.remove_row_button ) ) {\n\t\t\t\t\t\t\t\t\t\t\tfieldObject.removeRowButtonLabel = field.remove_row_button;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Create field instance\n\t\t\t\t\t\t\t\t\t\tfieldInstance = new FieldsRepeater( fieldObject );\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Otherwise, treat it as a normal field\n\n\t\t\t\t\t\t\t\t\t\t// Get the field data\n\t\t\t\t\t\t\t\t\t\tfieldObject = sanitizeFieldData( field );\n\n\t\t\t\t\t\t\t\t\t\t// Create the field instance\n\t\t\t\t\t\t\t\t\t\tfieldInstance = new Field( fieldObject.fieldType, fieldObject, false );\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Add field to the group of fields\n\t\t\t\t\t\t\t\t\tallFieldsOnThisGroup.push( fieldInstance );\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t// Array where we're going to save the buttons of this item\n\t\t\t\t\t\t\t\tconst buttons = [];\n\n\t\t\t\t\t\t\t\t// Check if this group of options has buttons\n\t\t\t\t\t\t\t\tif ( isDefined( globalItem.buttons ) ) {\n\t\t\t\t\t\t\t\t\t// Iterate buttons\n\t\t\t\t\t\t\t\t\t$.each( globalItem.buttons, ( i, button ) => {\n\t\t\t\t\t\t\t\t\t\t// Check if we have to add the button to this group\n\t\t\t\t\t\t\t\t\t\tif ( button.show_in == groupKey ) {\n\t\t\t\t\t\t\t\t\t\t\tbuttons.push( button );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Push fields to the groupsOfOptions object\n\t\t\t\t\t\t\t\tgroupsOfOptions[ groupKey ] = {\n\t\t\t\t\t\t\t\t\tfields: allFieldsOnThisGroup,\n\t\t\t\t\t\t\t\t\tisValid: false, // FALSE by default, but we're going to do a validation later\n\t\t\t\t\t\t\t\t\tbuttons: buttons,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t// Create object with the item data\n\t\t\t\t\t\t\titemToAdd = {\n\t\t\t\t\t\t\t\tid: item.ID,\n\t\t\t\t\t\t\t\titemType: item.itemType,\n\t\t\t\t\t\t\t\titemCode: itemCode,\n\t\t\t\t\t\t\t\tintegrationCode: globalItem.integration,\n\t\t\t\t\t\t\t\tisLive: item.post_status == 'publish' ? true : false,\n\t\t\t\t\t\t\t\toptions: groupsOfOptions,\n\t\t\t\t\t\t\t\tmeta: item.meta,\n\t\t\t\t\t\t\t\tisMissing: false,\n\t\t\t\t\t\t\t\ttokens: isDefined( item.tokens ) ? item.tokens : [],\n\t\t\t\t\t\t\t\tinlineCss: isDefined( globalItem.inline_css ) ? globalItem.inline_css : '',\n\t\t\t\t\t\t\t\tfilterTokens: isDefined( globalItem.filter_tokens ) ? globalItem.filter_tokens : '',\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Check if the support link is defined\n\t\t\t\t\t\t\tif ( isDefined( globalItem.support ) ) {\n\t\t\t\t\t\t\t\titemToAdd.support = globalItem.support;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Create meta for those field that don't have a value saved in the database but have a default value\n\n\t\t\t\t\t\t\t// Get all fields\n\t\t\t\t\t\t\tconst fields = {};\n\n\t\t\t\t\t\t\t// Create an object with all the options from the field\n\t\t\t\t\t\t\t$.each( groupsOfOptions, ( optionKey, opts ) => {\n\t\t\t\t\t\t\t\t$.each( opts.fields, ( i, field ) => {\n\t\t\t\t\t\t\t\t\tfields[ field.getAttributes().optionCode ] = field;\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t$.each( fields, ( i, field ) => {\n\t\t\t\t\t\t\t\tconst fieldAttributes = field.getAttributes();\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t( ! isDefined( itemToAdd.meta[ fieldAttributes.optionCode ] ) ||\n\t\t\t\t\t\t\t\t\t\tisEmpty( itemToAdd.meta[ fieldAttributes.optionCode ] ) ) &&\n\t\t\t\t\t\t\t\t\t! isEmpty( fieldAttributes.currentValue )\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\titemToAdd.meta[ fieldAttributes.optionCode ] = fieldAttributes.currentValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t// If it's anonymous, add the \"canLogUserIn\" property\n\t\t\t\t\t\t\t// Also set the default value\n\t\t\t\t\t\t\tif ( recipeIsAnonymous ) {\n\t\t\t\t\t\t\t\titemToAdd.canLogNewUserIn = isDefined( globalItem.can_log_in_new_user )\n\t\t\t\t\t\t\t\t\t? globalItem.can_log_in_new_user\n\t\t\t\t\t\t\t\t\t: true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Create object with the item data\n\t\t\t\t\t\t\titemToAdd = {\n\t\t\t\t\t\t\t\tid: item.ID,\n\t\t\t\t\t\t\t\titemType: item.itemType,\n\t\t\t\t\t\t\t\titemCode: item.meta.code,\n\t\t\t\t\t\t\t\tintegrationCode: item.meta.integration,\n\t\t\t\t\t\t\t\tintegrationName: item.meta.integration_name,\n\t\t\t\t\t\t\t\tsentence: item.meta.sentence,\n\t\t\t\t\t\t\t\tisLive: item.post_status == 'publish' ? true : false,\n\t\t\t\t\t\t\t\ttokens: [],\n\t\t\t\t\t\t\t\toptions: {},\n\t\t\t\t\t\t\t\tmeta: item.meta,\n\t\t\t\t\t\t\t\tisMissing: true,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// If it's anonymous, add the \"canLogUserIn\" property\n\t\t\t\t\t\t\t// Also set the default value\n\t\t\t\t\t\t\tif ( recipeIsAnonymous ) {\n\t\t\t\t\t\t\t\titemToAdd.canLogNewUserIn = isDefined( item.meta.can_log_in_new_user )\n\t\t\t\t\t\t\t\t\t? item.meta.can_log_in_new_user == 'true'\n\t\t\t\t\t\t\t\t\t: true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// We have to add it\n\t\t\t\t\t\titemsObject( 'add', itemToAdd );\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Check if the recipe is anonymous and can log the new user in\n\t\t\t\t\tif ( recipeIsAnonymous ) {\n\t\t\t\t\t\t// Set the default value\n\t\t\t\t\t\tUncannyAutomator.recipe.canLogNewUserIn = false;\n\n\t\t\t\t\t\t// Get the recipe items\n\t\t\t\t\t\tconst recipeTriggers = itemsObject( 'get', {\n\t\t\t\t\t\t\tfilter: {\n\t\t\t\t\t\t\t\titemType: 'trigger',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Check if it has items\n\t\t\t\t\t\tif ( Object.keys( recipeTriggers ) > 0 ) {\n\t\t\t\t\t\t\t// Change the default value\n\t\t\t\t\t\t\tUncannyAutomator.recipe.canLogNewUserIn = true;\n\n\t\t\t\t\t\t\t// Iterate the triggers\n\t\t\t\t\t\t\t$.each( recipeTriggers, ( index, trigger ) => {\n\t\t\t\t\t\t\t\t// Check if this trigger allows the recipe\n\t\t\t\t\t\t\t\t// to log the new user in\n\t\t\t\t\t\t\t\tUncannyAutomator.recipe.canLogNewUserIn =\n\t\t\t\t\t\t\t\t\tUncannyAutomator.recipe.canLogNewUserIn && trigger.canLogNewUserIn;\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if we should validate the data\n\t\t\t\t\tif (\n\t\t\t\t\t\t! isDefined( attributes.validate ) ||\n\t\t\t\t\t\t( isDefined( attributes.validate ) && attributes.validate )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Validate the recipe to update the isValid elements\n\t\t\t\t\t\trecipeObject( 'validate' );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'recipeObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'validate':\n\t\t\t\t// Valid by default, will be changed to false if we find an error\n\t\t\t\tlet isRecipeValid = true;\n\n\t\t\t\t// Check if the recipe has triggers, actions and/or closures\n\t\t\t\t// Update UncannyAutomator.recipe.hasLive\n\t\t\t\t$.each( UncannyAutomator.recipe.hasLive, ( itemType ) => {\n\t\t\t\t\t// All false\n\t\t\t\t\tUncannyAutomator.recipe.hasLive[ itemType ] = false;\n\t\t\t\t} );\n\n\t\t\t\t// Check if there is at least one item of that type in the main object\n\t\t\t\t$.each( UncannyAutomator.recipe.items, ( itemID, itemData ) => {\n\t\t\t\t\t// If at least one live item, then set TRUE\n\t\t\t\t\tif ( itemData.isLive ) {\n\t\t\t\t\t\tUncannyAutomator.recipe.hasLive[ itemData.itemType ] = true;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t// Iterate each item\n\t\t\t\t$.each( UncannyAutomator.recipe.items, ( itemID, itemData ) => {\n\t\t\t\t\t// We will use this variable to decide if the item is valid or not\n\t\t\t\t\tlet itemIsValid = true;\n\n\t\t\t\t\t// Iterate each group of fields\n\t\t\t\t\t$.each( itemData.options, ( optionsGroupID, optionsGroupData ) => {\n\t\t\t\t\t\t// We will use this variable to decide if the group of fields is valid or not\n\t\t\t\t\t\tlet groupIsValid = true;\n\n\t\t\t\t\t\t// Iterate each field\n\t\t\t\t\t\t$.each( optionsGroupData.fields, ( index, field ) => {\n\t\t\t\t\t\t\t// Validate the field. Read validateField comments to learn more.\n\t\t\t\t\t\t\tconst fieldValidation = field.validate( false );\n\n\t\t\t\t\t\t\t// Check if the option is invalid, if at least one field is invalid make all the group invalid\n\t\t\t\t\t\t\tif ( ! fieldValidation.isValid ) {\n\t\t\t\t\t\t\t\tgroupIsValid = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Set result\n\t\t\t\t\t\tUncannyAutomator.recipe.items[ itemID ].options[ optionsGroupID ].isValid = groupIsValid;\n\n\t\t\t\t\t\t// Check if the group is invalid, if at least on group of fields is invalid make all the item invalid\n\t\t\t\t\t\tif ( ! groupIsValid ) {\n\t\t\t\t\t\t\titemIsValid = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tUncannyAutomator.recipe.items[ itemID ].isValid = itemIsValid;\n\n\t\t\t\t\t// Check if the item is invalid. If at least one item is invalid make all the recipe invalid\n\t\t\t\t\tif ( itemData.isLive && ! itemIsValid ) {\n\t\t\t\t\t\tisRecipeValid = false;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t// Now check what items we have in the object\n\t\t\t\t// We must have at least one trigger and an action or closure\n\t\t\t\t// Check if it has at least one trigger\n\t\t\t\tif ( ! UncannyAutomator.recipe.hasLive.trigger ) {\n\t\t\t\t\tisRecipeValid = false;\n\n\t\t\t\t\t// Set error message\n\t\t\t\t\tUncannyAutomator.recipe.message.error = UncannyAutomator.i18n.validation.recipe.oneTrigger;\n\t\t\t\t} else {\n\t\t\t\t\t// Validate user selector\n\t\t\t\t\t// eslint-disable-next-line no-lonely-if\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Check if it's an anonymous recipe\n\t\t\t\t\t\tUncannyAutomator.recipe.type == 'anonymous' &&\n\t\t\t\t\t\t// if it requires user data (thus it needs the user selector)\n\t\t\t\t\t\tUncannyAutomator.recipe.requiresUserData &&\n\t\t\t\t\t\t// and if the user selector is not valid (doesn't have required data)\n\t\t\t\t\t\t! UncannyAutomator.recipe.userSelector.isValid\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Then the recipe is not valid\n\t\t\t\t\t\tisRecipeValid = false;\n\n\t\t\t\t\t\t// Add message\n\t\t\t\t\t\tUncannyAutomator.recipe.message.error = UncannyAutomator.i18n.validation.recipe.userSelector;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t// Check if it has at least one action or closure\n\t\t\t\t\t\t! UncannyAutomator.recipe.hasLive.action &&\n\t\t\t\t\t\t! UncannyAutomator.recipe.hasLive.closure\n\t\t\t\t\t) {\n\t\t\t\t\t\tisRecipeValid = false;\n\n\t\t\t\t\t\t// Set error message\n\t\t\t\t\t\tUncannyAutomator.recipe.message.error = UncannyAutomator.i18n.validation.recipe.oneAction;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t! UncannyAutomator.recipe.hasLive.trigger &&\n\t\t\t\t\t\t! UncannyAutomator.recipe.hasLive.action &&\n\t\t\t\t\t\t! UncannyAutomator.recipe.hasLive.closure\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Set error message\n\t\t\t\t\t\tUncannyAutomator.recipe.message.error = UncannyAutomator.i18n.validation.recipe.liveItems;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tUncannyAutomator.recipe.isValid = isRecipeValid;\n\n\t\t\t\t// Reset message if recipe is valid\n\t\t\t\tif ( isRecipeValid ) {\n\t\t\t\t\t// Reset message, we don't need it\n\t\t\t\t\tUncannyAutomator.recipe.message.error = '';\n\t\t\t\t}\n\n\t\t\t\t// Everything is ok, return true\n\t\t\t\tresponse = true;\n\n\t\t\t\tbreak;\n\t\t}\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error( vsprintf( '%s: The action \"%s\" isn\\'t defined', [ 'recipeObject', action ] ) );\n\t}\n\n\treturn response;\n};\n\n/**\n * Add, update, delete, update, validate and clean the main recipe object\n *\n * @param {String}  action              Action to perform. Valid actions: 'add', 'update', 'delete', 'reset', 'get', and 'clean'.\n * @param {Object}  attributes          The attributes\n * @param {Integer} attributes.id       Item ID\n * @param {String}  attributes.itemType The item type. The valid types are 'trigger', 'action' and 'closure'\n * @return {Boolean}                       True if the action was made successfully\n */\nexport const itemsObject = ( action = null, attributes = {} ) => {\n\t// Create response variable and set default value\n\tlet response = false;\n\n\t// Define valid actions\n\tconst validActions = [ 'add', 'delete', 'clean', 'reset', 'update', 'get' ];\n\n\t// Check if the action is not undefined and if it's a valid action\n\tif ( isDefined( action ) && inArray( action, validActions ) ) {\n\t\tswitch ( action ) {\n\t\t\tcase 'add':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend(\n\t\t\t\t\t{\n\t\t\t\t\t\tisValid: false, // Because it's going to be empty\n\t\t\t\t\t\tisLive: false, // Draft by default\n\t\t\t\t\t},\n\t\t\t\t\tattributes\n\t\t\t\t);\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\tconst requiredData = [ 'id', 'itemType' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Has ID, check if it wasn't added\n\t\t\t\t\tif ( ! isDefined( UncannyAutomator.recipe.items[ attributes.id ] ) ) {\n\t\t\t\t\t\t// Create property\n\t\t\t\t\t\tUncannyAutomator.recipe.items[ attributes.id ] = attributes;\n\n\t\t\t\t\t\t// Clean undefined properties\n\t\t\t\t\t\titemsObject( 'clean', {} );\n\n\t\t\t\t\t\t// Everything is ok, return true\n\t\t\t\t\t\tresponse = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'delete':\n\t\t\t\tattributes = $.extend(\n\t\t\t\t\t{\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t},\n\t\t\t\t\tattributes\n\t\t\t\t);\n\n\t\t\t\tif ( ! isEmpty( attributes.id ) ) {\n\t\t\t\t\tif ( isDefined( UncannyAutomator.recipe.items[ attributes.id ] ) ) {\n\t\t\t\t\t\tdelete UncannyAutomator.recipe.items[ attributes.id ];\n\n\t\t\t\t\t\t// Everything is ok, return true\n\t\t\t\t\t\tresponse = true;\n\t\t\t\t\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( \"%s: We didn't find an item with this the ID %s\", [\n\t\t\t\t\t\t\t\t'itemsObject',\n\t\t\t\t\t\t\t\tattributes.id,\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( vsprintf( '%s: Invalid item ID', [ 'itemsObject' ] ) );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'clean':\n\t\t\t\t// Delete undefined and null properties\n\n\t\t\t\tconst items = {};\n\n\t\t\t\t$.each( UncannyAutomator.recipe.items, ( index, value ) => {\n\t\t\t\t\tif ( isDefined( value ) ) {\n\t\t\t\t\t\titems[ index ] = value;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tUncannyAutomator.recipe.items = items;\n\n\t\t\t\t// Everything is ok, return true\n\t\t\t\tresponse = true;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'update':\n\t\t\t\t// Update item attributes\n\n\t\t\t\tif ( ! isEmpty( attributes.id ) ) {\n\t\t\t\t\tif ( isDefined( UncannyAutomator.recipe.items[ attributes.id ] ) ) {\n\t\t\t\t\t\t// Extend item object properties with new ones\n\t\t\t\t\t\tUncannyAutomator.recipe.items[ attributes.id ] = $.extend(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tUncannyAutomator.recipe.items[ attributes.id ],\n\t\t\t\t\t\t\tattributes\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Everything is ok, return true\n\t\t\t\t\t\tresponse = true;\n\t\t\t\t\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( \"%s: We didn't find an item with this the ID %s\", [\n\t\t\t\t\t\t\t\t'itemsObject',\n\t\t\t\t\t\t\t\tattributes.id,\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( vsprintf( '%s: Invalid item ID', [ 'itemsObject' ] ) );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'reset':\n\t\t\t\t// Delete all the items in the items object\n\t\t\t\tUncannyAutomator.recipe.items = {};\n\n\t\t\t\t// Return true\n\t\t\t\tresponse = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 'get':\n\t\t\t\t// Check if we have to filter items\n\t\t\t\tif ( ! isEmpty( attributes.filter ) ) {\n\t\t\t\t\t// Create a new items object. We're going to add items to this one if the filters match\n\t\t\t\t\t// eslint-disable-next-line no-shadow\n\t\t\t\t\tconst items = {};\n\t\t\t\t\t// Iterate all current items\n\t\t\t\t\t$.each( UncannyAutomator.recipe.items, ( itemId, item ) => {\n\t\t\t\t\t\tlet matchFilters = true;\n\n\t\t\t\t\t\t$.each( attributes.filter, ( key, value ) => {\n\t\t\t\t\t\t\tif ( item[ key ] != value ) {\n\t\t\t\t\t\t\t\tmatchFilters = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Check if we have to add this item\n\t\t\t\t\t\tif ( matchFilters ) {\n\t\t\t\t\t\t\titems[ itemId ] = item;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Return the new items object\n\t\t\t\t\tresponse = items;\n\t\t\t\t} else {\n\t\t\t\t\tresponse = UncannyAutomator.recipe.items;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error( vsprintf( '%s: The action \"%s\" isn\\'t defined', [ 'itemsObject', action ] ) );\n\t}\n\n\treturn response;\n};\n\n/**\n * Add the triggers and actions to each integration.\n * Change the data structure so it's possible to know\n * what items and integrations are pro\n *\n * @return {undefined}\n */\nexport const groupItemsByIntegration = () => {\n\t// Iterate the integrations\n\t// eslint-disable-next-line no-unused-vars\n\tObject.entries( UncannyAutomator.integrations ).forEach( ( [ integrationID, integration ] ) => {\n\t\t// Get the list of available triggers and actions\n\t\t// Sort them alphabetically\n\t\tconst triggers = {\n\t\t\t\tavailable: sortArrayOfObjectsAlphabetically(\n\t\t\t\t\tUncannyAutomator.triggers.filter( ( item ) => item.integration == integrationID ),\n\t\t\t\t\t'select_option_name',\n\t\t\t\t\t( sentence ) => replaceCurlyBraces( sentence )\n\t\t\t\t),\n\t\t\t\tunavailable: [],\n\t\t\t},\n\t\t\tactions = {\n\t\t\t\tavailable: sortArrayOfObjectsAlphabetically(\n\t\t\t\t\tUncannyAutomator.actions.filter( ( item ) => item.integration == integrationID ),\n\t\t\t\t\t'select_option_name',\n\t\t\t\t\t( sentence ) => replaceCurlyBraces( sentence )\n\t\t\t\t),\n\t\t\t\tunavailable: [],\n\t\t\t};\n\n\t\tif ( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp ) {\n\t\t\t// Check if there are PRO items for this integration\n\t\t\tif (\n\t\t\t\tisDefined( UncannyAutomator.proFeatures ) &&\n\t\t\t\tisDefined( UncannyAutomator.proFeatures[ integrationID ] )\n\t\t\t) {\n\t\t\t\t// Get the recipe type\n\t\t\t\tlet recipeType = UncannyAutomator.recipe.type;\n\t\t\t\t// Just for filtering the triggers, change \"user\" to \"logged-in\"\n\t\t\t\trecipeType = recipeType == 'user' ? 'logged-in' : recipeType;\n\n\t\t\t\t// Push the pro triggers to the unavailable triggers array\n\t\t\t\t// Sort them alphabetically\n\t\t\t\ttriggers.unavailable = sortArrayOfObjectsAlphabetically(\n\t\t\t\t\t// Elements to sort alphabetically\n\t\t\t\t\tUncannyAutomator.proFeatures[ integrationID ].triggers\n\t\t\t\t\t\t// Filter by recipe type\n\t\t\t\t\t\t// trigger.type is the trigger time\n\t\t\t\t\t\t.filter( ( trigger ) => trigger.type == recipeType ),\n\t\t\t\t\t// Sort them by name\n\t\t\t\t\t'name',\n\t\t\t\t\t// Remove the curly braces before comparing the names\n\t\t\t\t\t( sentence ) => replaceCurlyBraces( sentence )\n\t\t\t\t);\n\n\t\t\t\t// Push the pro actions to the unavailable actions array\n\t\t\t\t// Sort them alphabetically\n\t\t\t\tactions.unavailable = sortArrayOfObjectsAlphabetically(\n\t\t\t\t\tUncannyAutomator.proFeatures[ integrationID ].actions,\n\t\t\t\t\t'name',\n\t\t\t\t\t( sentence ) => replaceCurlyBraces( sentence )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Evaluate if all the available items are pro\n\t\t// To do that, iterate every element using the method every\n\t\t// and return the value of \"is_pro\"\n\t\ttriggers.allItemsArePro = triggers.available.every( ( item ) =>\n\t\t\tisDefined( item.is_pro ) ? item.is_pro : false\n\t\t);\n\t\tactions.allItemsArePro = actions.available.every( ( item ) =>\n\t\t\tisDefined( item.is_pro ) ? item.is_pro : false\n\t\t);\n\n\t\t// Check if the integration has available triggers and actions\n\t\ttriggers.hasAvailableItems = triggers.available.length > 0;\n\t\tactions.hasAvailableItems = actions.available.length > 0;\n\n\t\t// Check if the integration has unavailable triggers and actions\n\t\ttriggers.hasUnavailableItems = triggers.unavailable.length > 0;\n\t\tactions.hasUnavailableItems = actions.unavailable.length > 0;\n\n\t\t// Check if it has any kind of items\n\t\ttriggers.hasTriggers = triggers.hasAvailableItems || triggers.unavailable.length > 0;\n\t\tactions.hasActions = actions.hasAvailableItems || actions.unavailable.length > 0;\n\n\t\t// Add the items to the integration\n\t\tUncannyAutomator.integrations[ integrationID ].items = {\n\t\t\ttriggers: triggers,\n\t\t\tactions: actions,\n\t\t};\n\t} );\n};\n\n/**\n * Sorts an array of objects using one of the properties\n *\n * @param {Array}    items             The array\n * @param {String}   propertyToCompare The property used to compare the elements\n * @param {Function} filter            A custom function to compare the elements\n * @return {Array}                       The array, sorted\n */\nexport const sortArrayOfObjectsAlphabetically = ( items = [], propertyToCompare = '', filter ) => {\n\t// Check if there isn't a filter defined\n\tif ( ! isDefined( filter ) ) {\n\t\tfilter = ( value ) => value;\n\t}\n\n\t// Check if it's an array and it's not empty\n\tif ( Array.isArray( items ) && ! isEmpty( items ) ) {\n\t\t// Sort the array of integrations using the integration name\n\t\titems = items.sort( ( a, b ) => {\n\t\t\t// Define the default value\n\t\t\tlet compare = 0;\n\n\t\t\t// Check if the elements have the properties we're going to use to compare\n\t\t\tif ( isDefined( a[ propertyToCompare ] ) && isDefined( b[ propertyToCompare ] ) ) {\n\t\t\t\t// Filter the values\n\t\t\t\tconst valueA = filter( a[ propertyToCompare ] ),\n\t\t\t\t\tvalueB = filter( b[ propertyToCompare ] );\n\n\t\t\t\t// Check which integration name should go first\n\t\t\t\tcompare = valueA.localeCompare( valueB );\n\n\t\t\t\t// Validate the result\n\t\t\t\t// Do NOT rely on exact return values of -1 or 1\n\t\t\t\t// Negative and positive integer results vary between browsers (as well as between browser versions) because the W3C specification only mandates negative and positive values. Some browsers may return -2 or 2, or even some other negative or positive value.\n\t\t\t\tcompare = compare > 0 ? 1 : compare;\n\t\t\t\tcompare = compare < 0 ? -1 : compare;\n\t\t\t}\n\n\t\t\t// Return result\n\t\t\treturn compare;\n\t\t} );\n\t}\n\n\t// Return the new array\n\treturn items;\n};\n\n/**\n * Returns a list of triggers or actions by integration\n *\n * @param {String} integrationID The integration ID\n * @param {String} itemType      The item type. Valid values: \"trigger\", \"triggers\", \"action\" and \"actions\"\n * @param {Object} options       The options\n * @return {Object}                And object with the available and unavailable items\n */\nexport const getItemsByIntegration = ( integrationID = '', itemType = 'triggers', options ) => {\n\t// Extend the options\n\toptions = Object.assign(\n\t\t{\n\t\t\taddDeprecatedItems: false,\n\t\t},\n\t\toptions\n\t);\n\n\t// Create the array where we're going to save the items\n\tlet items = {\n\t\tavailable: {},\n\t\tunavailable: {},\n\t};\n\n\t// Convert itemType \"trigger\" to \"triggers\"\n\titemType = itemType == 'trigger' ? 'triggers' : itemType;\n\t// Convert itemType \"action\" to \"actions\"\n\titemType = itemType == 'action' ? 'actions' : itemType;\n\n\t// Validate the parameter itemType\n\tif ( [ 'triggers', 'actions' ].includes( itemType ) ) {\n\t\t// Check if the integration ID is defined\n\t\tif ( ! isEmpty( integrationID ) ) {\n\t\t\t// Check if the integration exists\n\t\t\tif ( isDefined( UncannyAutomator.integrations[ integrationID ] ) ) {\n\t\t\t\t// Get the requested items\n\t\t\t\titems = $.extend( true, {}, UncannyAutomator.integrations[ integrationID ].items[ itemType ] );\n\n\t\t\t\t// Check if we have to remove the deprecated items\n\t\t\t\tif ( ! options.addDeprecatedItems ) {\n\t\t\t\t\t// Remove deprecated items\n\t\t\t\t\titems = filterDeprecatedItems( items );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the triggers\n\treturn items;\n};\n\n/**\n * Returns the data about a trigger or action using the item code\n *\n * @param {String} integrationID The integration ID\n * @param {String} itemType      The item type. Vlaid values: \"trigger\", \"triggers\", \"action\" and \"actions\"\n * @param {String} itemCode      The item code\n * @param {Object} options       Options\n * @return {Object}               Data about the item\n */\nexport const getItemByCode = ( integrationID = '', itemType = 'triggers', itemCode = '', options = {} ) => {\n\t// Default response\n\tlet item;\n\n\t// Extend the options\n\toptions = Object.assign(\n\t\t{\n\t\t\taddDeprecatedItems: false,\n\t\t},\n\t\toptions\n\t);\n\n\t// Convert itemType \"trigger\" to \"triggers\"\n\titemType = itemType == 'trigger' ? 'triggers' : itemType;\n\t// Convert itemType \"action\" to \"actions\"\n\titemType = itemType == 'action' ? 'actions' : itemType;\n\n\t// Validate the parameter itemType\n\tif ( [ 'triggers', 'actions' ].includes( itemType ) ) {\n\t\t// Check if the integration ID is defined\n\t\tif ( ! isEmpty( integrationID ) ) {\n\t\t\t// Get the integration items\n\t\t\tconst integrationItems = getItemsByIntegration( integrationID, itemType, {\n\t\t\t\taddDeprecatedItems: options.addDeprecatedItems,\n\t\t\t} );\n\n\t\t\t// Get the available items\n\t\t\tconst items = integrationItems.available;\n\n\t\t\t// Search the item\n\t\t\titems.forEach( ( integrationItem ) => {\n\t\t\t\t// Check the item code\n\t\t\t\tif ( integrationItem.code == itemCode ) {\n\t\t\t\t\t// Save it\n\t\t\t\t\titem = integrationItem;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\treturn item;\n};\n\n/**\n * Removes deprecated items from an items object\n *\n * @param {Object} items Items object\n * @return {Object}        Items object, without deprecated items\n */\nexport const filterDeprecatedItems = ( items ) => {\n\t// Remove deprecated items\n\titems.available = items.available.filter( ( item ) => ! item.is_deprecated );\n\n\t// Check if there are still available items\n\titems.hasAvailableItems = items.available.length > 0;\n\n\t// Check if it still has triggers or actions\n\tif ( isDefined( items.hasTriggers ) ) {\n\t\titems.hasTriggers = items.hasAvailableItems || items.unavailable.length > 0;\n\t} else if ( isDefined( items.hasActions ) ) {\n\t\titems.hasActions = items.hasAvailableItems || items.unavailable.length > 0;\n\t}\n\n\t// Check if all the available items are pro now\n\titems.allItemsArePro = items.available.every( ( item ) => ( isDefined( item.is_pro ) ? item.is_pro : false ) );\n\n\treturn items;\n};\n\n/**\n * Updates the user selector data\n *\n * @param {String} action     Action to perform. Valid actions: 'set-step', 'get-step', 'set-source', 'update-fields', 'reset-fields'.\n * @param {Object} attributes The attributes\n * @return {Boolean}                       True if the action was made successfully\n */\nexport const userSelectorObject = ( action = null, attributes = {} ) => {\n\t// Create response variable and set default value\n\tlet response = false;\n\n\t// Define valid actions\n\tconst validActions = [ 'set-step', 'get-step', 'set-source', 'update-fields', 'reset-fields' ];\n\n\t// Create shortcut of the user selector object\n\t// const userSelector = UncannyAutomator.recipe.userSelector;\n\n\t// Check if the action is not undefined and if it's a valid action\n\tif ( isDefined( action ) && inArray( action, validActions ) ) {\n\t\t// Create empty array to check if the actions have the required data\n\t\tlet requiredData = [];\n\n\t\tswitch ( action ) {\n\t\t\t/**\n\t\t\t * Get the current step so we know what we have to render\n\t\t\t * There are 4 steps:\n\t\t\t *\n\t\t\t * 1. select-source: Where the recipe creator select the source of the user.\n\t\t\t *                   The options are \"Existing user\" and \"New user\".\n\t\t\t * 2. set-options: Where the recipe creator defines values of the fields.\n\t\t\t * 3. show-sentence: When the data is complete and valid.\n\t\t\t */\n\n\t\t\tcase 'set-step':\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'step' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Set status\n\t\t\t\t\tUncannyAutomator.recipe.userSelector.step = attributes.step;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [\n\t\t\t\t\t\t\t\t'userSelectorObject',\n\t\t\t\t\t\t\t\tmissingAttributes,\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'get-step':\n\t\t\t\t// Create the variable we're going to return\n\t\t\t\t// Set default value\n\t\t\t\tlet step = 'select-source';\n\n\t\t\t\t// Check if the step property is defined\n\t\t\t\tif ( isDefined( UncannyAutomator.recipe.userSelector.step ) ) {\n\t\t\t\t\t// If it is, then return that value\n\t\t\t\t\tstep = UncannyAutomator.recipe.userSelector.step;\n\t\t\t\t} else if (\n\t\t\t\t\t// Try to get step\n\t\t\t\t\t// Check if there are fields saved\n\t\t\t\t\t! isEmpty(\n\t\t\t\t\t\tUncannyAutomator.recipe.userSelector.data[ UncannyAutomator.recipe.userSelector.source ]\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\t// Show sentence\n\t\t\t\t\tstep = 'show-sentence';\n\n\t\t\t\t\t// If we have fields it's because we already valid them before,\n\t\t\t\t\t// thus the user selector is valid\n\t\t\t\t\tUncannyAutomator.recipe.userSelector.isValid = true;\n\t\t\t\t}\n\n\t\t\t\t// Return step\n\t\t\t\tresponse = step;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'set-source':\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'source' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Set status\n\t\t\t\t\tUncannyAutomator.recipe.userSelector.source = attributes.source;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [\n\t\t\t\t\t\t\t\t'userSelectorObject',\n\t\t\t\t\t\t\t\tmissingAttributes,\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'update-fields':\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'source', 'data' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Check if the source parameter is valid\n\t\t\t\t\tif ( [ 'existingUser', 'newUser' ].includes( attributes.source ) ) {\n\t\t\t\t\t\t// Check if we already have fields\n\t\t\t\t\t\tif ( isEmpty( UncannyAutomator.recipe.userSelector.data ) ) {\n\t\t\t\t\t\t\tUncannyAutomator.recipe.userSelector.data = {\n\t\t\t\t\t\t\t\texistingUser: {},\n\t\t\t\t\t\t\t\tnewUser: {},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Update fields\n\t\t\t\t\t\tUncannyAutomator.recipe.userSelector.data[ attributes.source ] = $.extend(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tUncannyAutomator.recipe.userSelector.data[ attributes.source ],\n\t\t\t\t\t\t\tattributes.data\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: The source parameter is invalid. Valid values are: %s', [\n\t\t\t\t\t\t\t\t'userSelectorObject',\n\t\t\t\t\t\t\t\t[ 'existingUser', 'newUser' ],\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [\n\t\t\t\t\t\t\t\t'userSelectorObject',\n\t\t\t\t\t\t\t\tmissingAttributes,\n\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'reset-fields':\n\t\t\t\t// Return boolean\n\t\t\t\tUncannyAutomator.recipe.userSelector.data = {\n\t\t\t\t\texistingUser: {},\n\t\t\t\t\tnewUser: {},\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t}\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error( vsprintf( '%s: The action \"%s\" isn\\'t defined', [ 'userSelectorObject', action ] ) );\n\t}\n\n\treturn response;\n};\n\n/**\n * Filters triggers, actions and closures by recipe type.\n * This won't filter the items of a recipe, but the available\n * items in Automator. This means that the filtered items won't\n * be available after.\n *\n * @return {undefined}\n */\nexport const filterAutomatorItemsByRecipeType = () => {\n\t// Check if the type attribute has a valid value\n\tif ( [ 'user', 'anonymous' ].includes( UncannyAutomator.recipe.type ) ) {\n\t\t// Output if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// Start group\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsoleLogLabel( 'Filter Automator items', true, {\n\t\t\t\tcollapseGroup: true,\n\t\t\t} );\n\n\t\t\t// Show current recipe type\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log( vsprintf( 'Current recipe type: %s', [ UncannyAutomator.recipe.type ] ) );\n\t\t}\n\n\t\t// Filter triggers\n\t\tUncannyAutomator.triggers = UncannyAutomator.triggers.filter( ( trigger ) => {\n\t\t\t// Output if the developer mode is enabled\n\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t// Show trigger\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.log( trigger );\n\n\t\t\t\t// Show decision\n\t\t\t\tif ( trigger.type == UncannyAutomator.recipe.type ) {\n\t\t\t\t\tconsoleLogResult( 'success', 'Keep' );\n\t\t\t\t} else {\n\t\t\t\t\tconsoleLogResult( 'error', 'Remove' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if it matches the recipe type\n\t\t\treturn trigger.type == UncannyAutomator.recipe.type;\n\t\t} );\n\n\t\t// Check if debug mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// Start group\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.groupEnd();\n\t\t}\n\t}\n};\n\n/**\n * Performs a REST Call\n *\n * @param {String}   endPoint  Endpoint of the REST call\n * @param {Object}   data      Data to be sent in the call\n * @param {Function} onSuccess Function to be invoked if the call is successful\n * @param {Function} onFail    Function to be invoked if the call fails\n * @param {Object}   options   The parameters sent in the call\n * @return {undefined}\n */\nexport const restCall = ( endPoint = null, data = null, onSuccess = null, onFail = null, options = {} ) => {\n\t// Define the valid endpoints\n\tconst validEndpoints = [\n\t\t'add',\n\t\t'delete',\n\t\t'update',\n\t\t'change_post_status',\n\t\t'recipe_completions_allowed',\n\t\t'recipe_max_completions_allowed',\n\t\t'change_post_title',\n\t\t'change_post_recipe_type',\n\t\t'user-selector',\n\t\t'set_recipe_terms',\n\t\t'schedule_action',\n\t\t'remove_schedule',\n\t\t'set_recipe_requires_user',\n\t];\n\n\t// Link to the support page\n\tconst supportPageURL = supportLink();\n\n\t// Check custom options\n\toptions = Object.assign({\n\t\trequiresRecipesObject: true,\n\t\trenderUI: true,\n\t\terrorMessaging: {\n\t\t\t// Access denied (access-denied)\n\t\t\t// 403. Usually caused by an invalid nonce or a server configuration.\n\t\t\t//  Reloading the page might fix the issue.\n\t\t\taccessDenied: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.accessDenied.title,\n\t\t\t\tcontent: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.accessDenied.content, [ `<strong>${ endPoint }</strong>` ] ),\n\t\t\t},\n\t\t\t// Not found.\n\t\t\t// 404. Thrown when Automator tries to do a request to a non-existing endpoint.\n\t\t\t//  Most probably an issue in Automator. Requires support.\n\t\t\tnotFound: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.notFound.title,\n\t\t\t\tcontent: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.notFound.content, [\n\t\t\t\t\t`<a href=\"${ UncannyAutomator.dev.permalinksURL }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.fatalErrorHandler.notFound.sitePermalinks }</a>`,\n\t\t\t\t\t`<a href=\"${ supportPageURL }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.automatorSupport }</a>`\n\t\t\t\t] )\n\t\t\t},\n\t\t\t// Request timeout. \n\t\t\t// 408. Caused by a server without enough resources.\n\t\t\t//  Requires the user to increase resources.\n\t\t\ttimeout: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.timeout.title,\n\t\t\t\tcontent: UncannyAutomator.i18n.debugging.fatalErrorHandler.timeout.content,\n\t\t\t},\n\t\t\t// Internal server error\n\t\t\t// 500. Server encountered an unexpected condition. We can't know if it's caused by Automator or another plugin automatically, we need to check the debug data shown below. Most of the time is an issue on Automator.\n\t\t\t//  Requires support.\n\t\t\tserverError: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.serverError.title,\n\t\t\t\tcontent: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.serverError.content, [\n\t\t\t\t\t`<a href=\"${ supportPageURL }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.automatorSupport }</a>`\n\t\t\t\t] ),\n\t\t\t},\n\t\t\t// Parser error. \n\t\t\t// There is likely a conflict with another plugin that throws a warning, making the returned data invalid.\n\t\t\t//  Most of the time, disabling all plugins but Automator will be enough. It might also be an issue in Automator, so it might require support.\n\t\t\tparserError: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.parserError.title,\n\t\t\t\tcontent: UncannyAutomator.i18n.debugging.fatalErrorHandler.parserError.content,\n\t\t\t},\n\t\t\t// Data missing.\n\t\t\t// Caused by missing data in Automator.\n\t\t\t//  Requires support.\n\t\t\tdataMissing: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.dataMissing.title,\n\t\t\t\tcontent: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.dataMissing.content, [\n\t\t\t\t\t`<a href=\"${ supportPageURL }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.fatalErrorHandler.dataMissing.contactSupport }</a>`,\n\t\t\t\t\t`<a href=\"${ UncannyAutomator.dev.automatorTools }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.fatalErrorHandler.dataMissing.automatorTools }</a>`\n\t\t\t\t] )\n\t\t\t},\n\t\t\t// Generic error\n\t\t\t// Fallback\n\t\t\tgeneric: {\n\t\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.generic.title,\n\t\t\t\tcontent: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.generic.content, [\n\t\t\t\t\t`<a href=\"${ supportPageURL }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.automatorSupport }</a>`\n\t\t\t\t] ),\n\t\t\t}\n\t\t}\n\t}, options );\n\n\t// Check if the endPoint parameter is a valid endpoint\n\tif ( inArray( endPoint, validEndpoints ) ) {\n\t\t// Do AJAX\n\t\t$.ajax( {\n\t\t\tmethod: 'POST',\n\t\t\turl: `${ UncannyAutomator.restURL }/${ endPoint }/`,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tdata: `${ $.param( data ) }&${ $.param( { doing_rest: 1 } ) }`,\n\t\t\tdataType: 'json',\n\n\t\t\t/**\n\t\t\t * Attachs Nonce the the header of the request\n\t\t\t *\n\t\t\t * @param {Object} xhr jqXHR\n\t\t\t * @return {undefined}\n\t\t\t */\n\t\t\tbeforeSend: ( xhr ) => {\n\t\t\t\txhr.setRequestHeader( 'X-WP-Nonce', UncannyAutomator.nonce );\n\t\t\t}\n\t\t} )\n\t\t\t// eslint-disable-next-line require-jsdoc\n\t\t\t.done( ( response, textStatus, errorThrown ) => {\n\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\tconsoleLogLabel( ` REST: ${ endPoint }`, true, {\n\t\t\t\t\t\tcollapseGroup: true,\n\t\t\t\t\t} );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( `Endpoint: ${ endPoint }` );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Data:' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Response:' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( response );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t}\n\n\t\t\t\t// Check if the request succeeded\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t// Check if we have the new recipes_object, otherwise the data will change on the server but not in the UI\n\t\t\t\t\tif ( isDefined( response.recipes_object ) || ! options.requiresRecipesObject ) {\n\t\t\t\t\t\t// Check if onSuccess\n\t\t\t\t\t\tif ( isDefined( onSuccess ) ) {\n\t\t\t\t\t\t\t// Check if we have to render the UI again\n\t\t\t\t\t\t\tif ( options.renderUI ) {\n\t\t\t\t\t\t\t\trecipeObject( 'create', {\n\t\t\t\t\t\t\t\t\tallRecipes: response.recipes_object,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Invoke callback\n\t\t\t\t\t\t\tonSuccess( response );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// The call was successful, but the new recipes_object is missing\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.error( 'The call was successful, but the new recipes_object is missing.' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if the onFail callback is defined\n\t\t\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\t\t\t// Invoke callback\n\t\t\t\t\t\t\tonFail( response, 'data-missing' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// The call was successful, but there were errors\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error( 'The call was successful, but there were errors.' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the onFail callback is defined\n\t\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\t\t// Invoke callback\n\t\t\t\t\t\tonFail( response, 'data-missing' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\t\t\t// eslint-disable-next-line require-jsdoc\n\t\t\t.fail( ( jqXHR, textStatus, errorThrown ) => {\n\t\t\t\t// Get error code\n\t\t\t\tlet errorCode = textStatus;\n\n\t\t\t\t// Get error messaging\n\t\t\t\tlet errorMessaging = options.errorMessaging.generic;\n\n\t\t\t\t// Improve readability of the error\n\t\t\t\tswitch ( errorCode ){\n\t\t\t\t\tcase 'parsererror':\n\t\t\t\t\t\t// Set code\n\t\t\t\t\t\terrorCode = 'parser-error';\n\n\t\t\t\t\t\t// Set messaging\n\t\t\t\t\t\terrorMessaging = options.errorMessaging.parserError;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t// Check the code\n\t\t\t\t\t\tif ( jqXHR.status == 403 ){\n\t\t\t\t\t\t\t// Set code\n\t\t\t\t\t\t\terrorCode = 'access-denied';\n\n\t\t\t\t\t\t\t// Set messaging\n\t\t\t\t\t\t\terrorMessaging = options.errorMessaging.accessDenied;\n\t\t\t\t\t\t} else if ( jqXHR.status == 404 ){\n\t\t\t\t\t\t\t// Set code\n\t\t\t\t\t\t\terrorCode = 'not-found';\n\n\t\t\t\t\t\t\t// Set messaging\n\t\t\t\t\t\t\terrorMessaging = options.errorMessaging.notFound;\n\t\t\t\t\t\t} else if ( jqXHR.status == 500 ){\n\t\t\t\t\t\t\t// Set code\n\t\t\t\t\t\t\terrorCode = 'server-error';\n\n\t\t\t\t\t\t\t// Set messaging\n\t\t\t\t\t\t\terrorMessaging = options.errorMessaging.serverError;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'timeout':\n\t\t\t\t\t\t// Set code\n\t\t\t\t\t\terrorCode = 'timeout';\n\n\t\t\t\t\t\t// Set messaging\n\t\t\t\t\t\terrorMessaging = options.errorMessaging.timeOut;\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Show console messages if debug is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsoleLogLabel( ` REST: ${ endPoint }`, true, {\n\t\t\t\t\t\tcollapseGroup: true,\n\t\t\t\t\t} );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Data:' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Response' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( jqXHR );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( errorCode );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( errorThrown );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t}\n\n\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\tonFail( {\n\t\t\t\t\t\tsuccess: false\n\t\t\t\t\t}, errorCode );\n\t\t\t\t}\n\n\t\t\t\t// Handle error by showing a modal with data\n\t\t\t\thandleFatalError({\n\t\t\t\t\ttitle:   errorMessaging.title,\n\t\t\t\t\twarning: errorMessaging.content,\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tconsole: `Data sent:\\n` +\n\t\t\t\t\t\t`${ JSON.stringify( data ) }\\n\\n` +\n\t\t\t\t\t\t`errorCode: \\n${ errorCode }\\n\\n` +\n\t\t\t\t\t\t`errorThrown:\\n${ JSON.stringify( errorThrown ) }\\n\\n` +\n\t\t\t\t\t\t`jqXHR: \\n${ JSON.stringify( jqXHR ) } \\n\\n`,\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tconfirm: null,\n\t\t\t\t\t\tcancel: {\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.close,\n\t\t\t\t\t\t\tonClick: ( $modal ) => {\n\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\t$modal.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} );\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\n\t\t\tvsprintf( 'The %s endPoint does not exists. The valid endpoints are %s', [\n\t\t\t\tendPoint,\n\t\t\t\tvalidEndpoints.join( ', ' ),\n\t\t\t] )\n\t\t);\n\t}\n};\n\n/**\n * Returns support link\n * \n * @return {String} Support link\n */\nexport const supportLink = () => {\n\treturn addParametersToURL( addUTMParameters( UncannyAutomator.dev.supportPage, {\n\t\tmedium: 'error-handler',\n\t\tcontent: 'get-support-link'\n\t} ), {\n\t\tsubject: 'technical-support',\n\t\tversion: UncannyAutomator.version,\n\t\tsite_url: UncannyAutomator.siteURL\n\t} );\n}\n\n/**\n * Performs an AJAX request\n *\n * @param {String}   action    The ID of the action\n * @param {Object}   data      Data to be sent in the request\n * @param {Function} onSuccess Function to be invoked if the request is successful\n * @param {Function} onFail    Function to be invoked if the request fails\n * @return {undefined}\n */\nexport const AJAXRequest = ( action = null, data = null, onSuccess = null, onFail = null ) => {\n\t// Check that {action} is defined\n\tif ( isDefined( action ) ) {\n\t\t// Add {action} to the data object\n\t\tdata = $.extend( true, data, {\n\t\t\taction: action,\n\t\t\tnonce: UncannyAutomator.nonce,\n\t\t} );\n\n\t\t// Do AJAX\n\t\t$.ajax( {\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\turl: ajaxurl,\n\t\t\tdata: data,\n\n\t\t\t// eslint-disable-next-line require-jsdoc\n\t\t\tsuccess: ( response ) => {\n\t\t\t\t// Show console messages if debug is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsoleLogLabel( 'AJAX call ', true, {\n\t\t\t\t\t\tcollapseGroup: true,\n\t\t\t\t\t} );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Data:' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Response' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( response );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t}\n\n\t\t\t\t// Reload page if user authentication fails\n\t\t\t\tif ( isDefined( response.status ) && response.status == 'auth-failed' ) {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t} else if ( isDefined( onSuccess ) ) {\n\t\t\t\t\t// Invoke callback\n\t\t\t\t\tonSuccess( response, data );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstatusCode: {\n\t\t\t\t// eslint-disable-next-line require-jsdoc\n\t\t\t\t403: ( response ) => {\n\t\t\t\t\t// Show console messages if debug is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsoleLogLabel( 'AJAX call ', true, {\n\t\t\t\t\t\t\tcollapseGroup: true,\n\t\t\t\t\t\t} );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.log( 'Data:' );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.log( 'Response' );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsoleLogLabel( '403: Access denied', false, { bgColor: '#ff0000' } );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\t\tonFail( response );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the onFail callback is defined\n\t\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\t\t// Invoke callback\n\t\t\t\t\t\tonFail( response );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t// eslint-disable-next-line require-jsdoc\n\t\t\tfail: ( response ) => {\n\t\t\t\t// Show console messages if debug is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsoleLogLabel( 'AJAX call ', true, {\n\t\t\t\t\t\tcollapseGroup: true,\n\t\t\t\t\t} );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Data:' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Response' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( '%cUnknown error', 'color: red' );\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t}\n\n\t\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\t\tonFail( response );\n\t\t\t\t}\n\t\t\t},\n\t\t} );\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error( 'We cannot do this AJAX request. {action} is not defined.' );\n\t}\n};\n\n/**\n * Returns all the current value of the field, even if they aren't saved on the database\n * This will use .val() to get the values\n *\n * @param {Integer} itemId The ID of the item\n * @return {Object}         The fields value\n */\nexport const getCurrentFieldsValues = ( itemId ) => {\n\tconst values = {};\n\n\t// Iterate the items' group of fields\n\t$.each( UncannyAutomator.recipe.items[ itemId ].options, ( index, groupOfFields ) => {\n\t\t// Iterate each field\n\t\t$.each( groupOfFields.fields, ( i, field ) => {\n\t\t\t// Get value\n\t\t\tconst fieldId = field.getFieldID();\n\t\t\tlet fieldValue = field.getValue();\n\n\t\t\t// Check if it isn't defined. In that case get the current value from the currentValue attribute\n\t\t\tif ( ! isDefined( fieldValue ) ) {\n\t\t\t\tfieldValue = field.getAttributes().currentValue;\n\t\t\t}\n\n\t\t\t// Check if the field is a select with custom value\n\t\t\tif ( field.getAttributes().fieldType == 'select' && fieldValue == 'automator_custom_value' ) {\n\t\t\t\tvalues[ `${ fieldId }_custom` ] = field.getSelectCustomValue();\n\t\t\t}\n\n\t\t\t// Save value\n\t\t\tvalues[ fieldId ] = fieldValue;\n\n\t\t\t// Check if it's a select and also get the readable value\n\t\t\tif ( ! isEmpty( fieldValue ) && field.getAttributes().fieldType == 'select' ) {\n\t\t\t\t// Get and save the readable value\n\t\t\t\tvalues[ `${ fieldId }_readable` ] = field.getReadableValue();\n\t\t\t}\n\t\t} );\n\t} );\n\n\treturn values;\n};\n\n/**\n * Returns a Field instance given a item and field ID\n *\n * @param {Integer} itemId  The item ID\n * @param {String}  fieldId The field ID\n * @return {Field}            The Field instance\n */\nexport const getField = ( itemId, fieldId ) => {\n\tlet field;\n\n\t$.each( UncannyAutomator.recipe.items[ itemId ].options, ( optionsGroupId, optionsGroup ) => {\n\t\t$.each( optionsGroup.fields, ( index, fieldInstance ) => {\n\t\t\tif ( fieldId == fieldInstance.getFieldID() ) {\n\t\t\t\tfield = fieldInstance;\n\t\t\t}\n\t\t} );\n\t} );\n\n\treturn field;\n};\n\n/**\n * Returns data about a trigger, action or closure\n *\n * @param {Integer} integrationID The item ID\n * @param {String}  itemType      The item type. Valid values are trigger, action and closure\n * @param {String}  itemCode      The item code\n * @return {Object}                Item's data\n */\nexport const getGlobalItem = ( integrationID = '', itemType = '', itemCode = '' ) => {\n\tlet theItem;\n\n\t// Check if all are defined\n\tif ( ! isEmpty( integrationID ) && ! isEmpty( itemType ) && ! isEmpty( itemCode ) ) {\n\t\tlet integrationItems = {};\n\n\t\t// Check if the we're trying to get a trigger or action\n\t\tif ( itemType == 'trigger' || itemType == 'action' ) {\n\t\t\t// Check if the integration exists\n\t\t\tif ( isDefined( UncannyAutomator.integrations[ integrationID ] ) ) {\n\t\t\t\t// Create a reference to the integration\n\t\t\t\tconst integration = UncannyAutomator.integrations[ integrationID ];\n\n\t\t\t\t// Check if the items are defined\n\t\t\t\tif ( isDefined( integration.items ) ) {\n\t\t\t\t\t// Set integrationItems\n\t\t\t\t\tintegrationItems =\n\t\t\t\t\t\titemType == 'trigger'\n\t\t\t\t\t\t\t? integration.items.triggers.available\n\t\t\t\t\t\t\t: integration.items.actions.available;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ( itemType == 'closure' ) {\n\t\t\tintegrationItems = UncannyAutomator.closures;\n\t\t}\n\n\t\t// Search for the item\n\t\t$.each( integrationItems, ( index, item ) => {\n\t\t\tif ( item.code == itemCode ) {\n\t\t\t\t// Save the item\n\t\t\t\ttheItem = item;\n\n\t\t\t\t// Return false in the loop callback to break the loop\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\t}\n\n\t// Return the item\n\treturn theItem;\n};\n\n/**\n * Sets the recipe \"requires user\" value\n *\n * @param {Boolean}  requires  TRUE if the recipe requires a user\n * @param {Function} onSuccess Callback, on success\n * @param {Function} onFail    Callback, on fail\n * @return {undefined}\n */\nexport const recipeSetRequiresUser = ( requires = false, onSuccess, onFail ) => {\n\trestCall(\n\t\t'set_recipe_requires_user',\n\t\t{\n\t\t\trecipePostID: UncannyAutomator.recipe.id,\n\t\t\trequiresUser: requires,\n\t\t},\n\t\t( response ) => {\n\t\t\t// Check if the call was successful\n\t\t\tif ( response.success ) {\n\t\t\t\t// Check if the onSuccess callback is defined\n\t\t\t\tif ( isDefined( onSuccess ) ) {\n\t\t\t\t\t// Update the global \"requiresData\"\n\t\t\t\t\tUncannyAutomator.recipe.requiresUserData = requires;\n\n\t\t\t\t\t// Get the User Selector\n\t\t\t\t\tconst $userSelector = getDOMElements( 'user-selector' );\n\t\t\t\t\t// Show it\n\t\t\t\t\t$userSelector.addClass( 'user-selector--show' );\n\n\t\t\t\t\tonSuccess( response );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t( response ) => {\n\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.log( \"Couldn't set the recipe requires user status\" );\n\t\t\t}\n\n\t\t\t// Check if the onFail callback is defined\n\t\t\tif ( isDefined( onFail ) ) {\n\t\t\t\tonFail( response );\n\t\t\t}\n\t\t}\n\t);\n};\n\n/**\n * Returns DOM elements, such as a metabox, item of optionGroup\n * In Automator DOM elements are deleted and created in each step, so the reference to a DOM element change.\n *\n * @param {String} element    Code of the element that you want to get\n * @param {Object} attributes Contains required data to get the elements. Depends of the \"element\" value. Check the variable requiredData in each case.\n * @return {Object}             Object with DOM elements. The properties depend of \"element\"\n */\nexport const getDOMElements = ( element, attributes = {} ) => {\n\t// Create response object\n\tlet response = {};\n\n\t// Define valid actions\n\tconst validElements = [ 'metabox', 'items', 'item', 'optionGroup', 'lastItem', 'user-selector' ];\n\n\t// Check if the action is not undefined and if it's a valid action\n\tif ( isDefined( element ) && inArray( element, validElements ) ) {\n\t\t// Create array that will store all the requires attributes properties based on the requested element\n\t\tlet requiredData = [];\n\n\t\tswitch ( element ) {\n\t\t\tcase 'metabox':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend( {}, attributes );\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'type' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\tattributes.cssSelectorMetabox = '';\n\n\t\t\t\t\t// Check the itemType\n\t\t\t\t\tif ( attributes.type == 'trigger' ) {\n\t\t\t\t\t\tattributes.cssSelectorMetabox = '#recipe-triggers-ui';\n\t\t\t\t\t} else if ( attributes.type == 'action' ) {\n\t\t\t\t\t\tattributes.cssSelectorMetabox = '#recipe-actions-ui';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst $metabox = $( attributes.cssSelectorMetabox );\n\n\t\t\t\t\tresponse = $metabox;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'items':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend( {}, attributes );\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'type' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\tconst metabox = getDOMElements( 'metabox', {\n\t\t\t\t\t\ttype: attributes.type,\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Get jQuery DOM element\n\t\t\t\t\tconst $items = metabox.find(\n\t\t\t\t\t\t'.item:not(.item--user-selector):not(.item--start):not(.item--closure)'\n\t\t\t\t\t);\n\n\t\t\t\t\t// Add element to the response\n\t\t\t\t\tresponse = $items;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'item':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend( {}, attributes );\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'id' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Define CSS Selector\n\t\t\t\t\tattributes.cssSelector = `.uap .item[data-id=\"${ attributes.id }\"]`;\n\n\t\t\t\t\t// Get jQuery DOM element\n\t\t\t\t\tconst $item = $( attributes.cssSelector ),\n\t\t\t\t\t\t$contentContainer = $item.find( '.item__content' );\n\n\t\t\t\t\t// Add element to the response\n\t\t\t\t\tresponse.item = $item;\n\t\t\t\t\tresponse.contentContainer = $contentContainer;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'optionGroup':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend( {}, attributes );\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'itemID', 'groupID' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Get main object\n\t\t\t\t\tconst item = getDOMElements( 'item', { id: attributes.itemID } ).item;\n\n\t\t\t\t\t// Define CSS Selector\n\t\t\t\t\tattributes.cssSelectorTokenInSentence = `.item-title__token[data-token-id=\"${ attributes.groupID }\"]`;\n\t\t\t\t\tattributes.cssSelectorFieldsContainer = `.item-options__group[data-optiongroup=\"${ attributes.groupID }\"]`;\n\n\t\t\t\t\tconst $tokenInSentence = item.find( attributes.cssSelectorTokenInSentence ),\n\t\t\t\t\t\t$fieldsContainer = item.find( attributes.cssSelectorFieldsContainer ),\n\t\t\t\t\t\t$optionsContainer = item.find( '.item-options' );\n\n\t\t\t\t\tresponse.tokenInSentence = $tokenInSentence;\n\t\t\t\t\tresponse.fieldsContainer = $fieldsContainer;\n\t\t\t\t\tresponse.optionsContainer = $optionsContainer;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'lastItem':\n\t\t\t\t// Extend default attributes object with default values\n\t\t\t\tattributes = $.extend( {}, attributes );\n\n\t\t\t\t// Define required attributes properties\n\t\t\t\trequiredData = [ 'type' ];\n\n\t\t\t\t// Check if the attributes object has all the required properties\n\t\t\t\tif ( inArray( requiredData, Object.keys( attributes ) ) ) {\n\t\t\t\t\t// Get metabox\n\t\t\t\t\tconst metabox = getDOMElements( 'metabox', {\n\t\t\t\t\t\ttype: attributes.type,\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Get last item\n\t\t\t\t\tconst lastItem = metabox\n\t\t\t\t\t\t.find( '.item:not(.item--user-selector):not(.item--start):not(.item--closure)' )\n\t\t\t\t\t\t.last();\n\n\t\t\t\t\tresponse = lastItem;\n\t\t\t\t} else {\n\t\t\t\t\t// Show to the developer what attributes are missing\n\t\t\t\t\tconst missingAttributes = JSON.stringify( arrayDifference( attributes, requiredData ) );\n\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\tvsprintf( '%s: Some attributes are missing: %s', [ 'itemsObject', missingAttributes ] )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'user-selector':\n\t\t\t\t// Get user selector container\n\t\t\t\tresponse = $( '.user-selector' );\n\n\t\t\t\tbreak;\n\t\t}\n\t} else if ( UncannyAutomator.dev.developerMode ) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error( vsprintf( '%s: The element \"%s\" isn\\'t defined', [ 'getDOMElements', element ] ) );\n\t}\n\n\treturn response;\n};\n\n/**\n * Returns the integration icon, both URL and node\n *\n * @param {String} integrationID The integration ID\n * @return {Object}               Object with the image URL and node\n */\nexport const getIntegrationIcon = ( integrationID = '' ) => {\n\t// Default response\n\tconst response = {\n\t\turl: '',\n\t\tnode: null,\n\t};\n\n\t// Get the integration data\n\tconst integration = UncannyAutomator.integrations[ integrationID ];\n\n\t// Check if the integration exists\n\tif ( isDefined( integration ) ) {\n\t\t// Create img element\n\t\tresponse.node = document.createElement( 'img' );\n\n\t\t// Check if it has a svg image\n\t\tif ( isDefined( integration.icon_svg ) ) {\n\t\t\t// Get the URL\n\t\t\tresponse.url = integration.icon_svg;\n\n\t\t\t// Add source to the img element\n\t\t\tresponse.node.setAttribute( 'src', integration.icon_svg );\n\n\t\t\t// Add alt\n\t\t\tresponse.node.setAttribute( 'alt', integration.name );\n\t\t} else if ( isDefined( integration.icon_32 ) && isDefined( integration.icon_64 ) ) {\n\t\t\t// Get the URLs\n\t\t\tresponse.url = {\n\t\t\t\ticon16: integration.icon_16,\n\t\t\t\ticon32: integration.icon_32,\n\t\t\t\ticon64: integration.icon_64,\n\t\t\t};\n\n\t\t\t// Add source to the img element\n\t\t\tresponse.node.setAttribute( 'src', integration.icon_32 );\n\n\t\t\tresponse.node.setAttribute(\n\t\t\t\t'srcset',\n\t\t\t\tvsprintf( '%s 1x, %s 2x', [ integration.icon_32, integration.icon_64 ] )\n\t\t\t);\n\n\t\t\t// Add alt\n\t\t\tresponse.node.setAttribute( 'alt', integration.name );\n\t\t}\n\t}\n\n\treturn response;\n};\n\n/**\n * Returns all valid field types.\n * Used for validation\n *\n * @return {Array} Valid field types\n */\nexport const getFieldTypes = () => {\n\t// Set valid field types\n\tconst validFieldTypes = [\n\t\t'select',\n\t\t'textarea',\n\t\t'text',\n\t\t'url',\n\t\t'email',\n\t\t'int',\n\t\t'float',\n\t\t'checkbox',\n\t\t'radio',\n\t\t'group',\n\t\t'date',\n\t\t'time',\n\t\t'repeater',\n\t];\n\n\treturn validFieldTypes;\n};\n\n/**\n * Parses string with SENTENCE tokens\n *\n * @param {Object} item   The item\n * @param {String} string The string with the tokens\n * @param {Object} data   Object with the data to replace the text in the tokens.\n * @return {Object}  response                   Object with information about the string\n *         {String}  response.html              The string with the tokens replaced with the data and enclosed in HTML tags\n *         {Object}  response.elements          Node parts of the sentence\n *         {Array}   response.elements.tokens   Array of jQuery object. All the tokens part of the sentence\n *         {Array}   response.parts             Object with information about each part of the sentence\n */\nexport const parseStringWithTokens = ( item = null, string = '', data = {} ) => {\n\tlet response = null;\n\n\tif (\n\t\t/* isDefined( UncannyAutomator.recipe.items[ item.id ].itemSentence )\n        && forceReDo == false */\n\t\tfalse\n\t) {\n\t\tresponse = UncannyAutomator.recipe.items[ item.id ].itemSentence;\n\t} else {\n\t\t// Create response object\n\t\tresponse = {\n\t\t\tplain: '',\n\t\t\tbrackets: '',\n\t\t\thtml: $( '<div/>' ),\n\t\t\telements: {\n\t\t\t\tnormal: [],\n\t\t\t\ttoken: [],\n\t\t\t},\n\t\t\tparts: [],\n\t\t};\n\n\t\t// Trim string\n\t\tstring = string.trim();\n\n\t\t// Check if the string isn't empty\n\t\tif ( ! isEmpty( string ) ) {\n\t\t\t// Create regex\n\t\t\tconst tokensRegex = new RegExp( /\\{\\{(.*?)\\}\\}/gm ),\n\t\t\t\tnormals = [],\n\t\t\t\ttokens = [];\n\n\t\t\tlet mappedString = string;\n\n\t\t\t// Get tokens\n\t\t\tlet tokenNumber = 0;\n\n\t\t\tstring = string.replace( tokensRegex, ( fullMatch, token ) => {\n\t\t\t\tconst tokenParts = token.split( ':' );\n\n\t\t\t\t// Get the token placeholder text\n\t\t\t\tconst tokenPlaceholderText = tokenParts[ 0 ];\n\n\t\t\t\t// Get the token value ID\n\t\t\t\tconst tokenValueID = tokenParts[ 1 ];\n\n\t\t\t\t// Get the ID of the group of fields this token has to open\n\t\t\t\t// Check if the token should open a different group of options\n\t\t\t\tconst optionsID = isDefined( tokenParts[ 2 ] ) ? tokenParts[ 2 ] : tokenValueID;\n\n\t\t\t\ttoken = {\n\t\t\t\t\ttype: 'token',\n\t\t\t\t\tid: tokenValueID,\n\t\t\t\t\ttext: tokenPlaceholderText,\n\t\t\t\t\toptionsID: optionsID,\n\t\t\t\t\thasFields: isDefined( item.options[ optionsID ] ),\n\t\t\t\t};\n\n\t\t\t\t// Check if we have data for the token\n\t\t\t\tif ( isDefined( data[ token.id ] ) ) {\n\t\t\t\t\tlet readableText;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tdata[ token.id ] == 'automator_custom_value' &&\n\t\t\t\t\t\tisDefined( data[ vsprintf( '%s_custom', [ token.id ] ) ] )\n\t\t\t\t\t) {\n\t\t\t\t\t\treadableText = data[ vsprintf( '%s_custom', [ token.id ] ) ];\n\t\t\t\t\t} else if ( isDefined( data[ vsprintf( '%s_readable', [ token.id ] ) ] ) ) {\n\t\t\t\t\t\treadableText = data[ vsprintf( '%s_readable', [ token.id ] ) ];\n\t\t\t\t\t}\n\n\t\t\t\t\ttoken.originalText = token.text;\n\t\t\t\t\ttoken.text = isDefined( readableText ) ? readableText : data[ token.id ];\n\t\t\t\t}\n\n\t\t\t\t// Add token\n\t\t\t\ttokens.push( token );\n\n\t\t\t\t// Add token to the mapped string\n\t\t\t\tmappedString = mappedString.replace( fullMatch, `{{token:${ tokenNumber }}}` );\n\t\t\t\ttokenNumber++;\n\n\t\t\t\treturn '{{v}}';\n\t\t\t} );\n\n\t\t\tconst stringParts = string.split( '{{v}}' );\n\n\t\t\t// Get normals\n\t\t\tlet normalNumber = 0;\n\t\t\t$.each( stringParts, ( key, sentenceSection ) => {\n\t\t\t\tif ( sentenceSection != '' ) {\n\t\t\t\t\t// Create normal part\n\t\t\t\t\tconst normal = {\n\t\t\t\t\t\ttype: 'normal',\n\t\t\t\t\t\ttext: sentenceSection,\n\t\t\t\t\t};\n\n\t\t\t\t\t// Add normal text\n\t\t\t\t\tnormals.push( normal );\n\n\t\t\t\t\t// Add \"normal\" part to the mapped string\n\t\t\t\t\tmappedString = mappedString.replace( sentenceSection, `{{normal:${ normalNumber }}}` );\n\t\t\t\t\tnormalNumber++;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Create response.parts\n\t\t\tlet match;\n\n\t\t\twhile ( ( match = tokensRegex.exec( mappedString ) ) !== null ) {\n\t\t\t\t// Get info\n\t\t\t\tlet part = match[ 1 ].split( ':' );\n\n\t\t\t\tpart = {\n\t\t\t\t\ttype: part[ 0 ],\n\t\t\t\t\tindex: part[ 1 ],\n\t\t\t\t};\n\n\t\t\t\t// Get part object and add to parts\n\t\t\t\tif ( part.type == 'normal' ) {\n\t\t\t\t\tresponse.parts.push( normals[ part.index ] );\n\t\t\t\t} else {\n\t\t\t\t\tresponse.parts.push( tokens[ part.index ] );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if the sentence has tokens\n\t\t\tlet itemTokens = null;\n\n\t\t\t// Create plain text and HTML versions\n\t\t\t$.each( response.parts, ( index, part ) => {\n\t\t\t\t// Plain text\n\t\t\t\tresponse.plain += part.text;\n\n\t\t\t\t// HTML\n\t\t\t\tif ( part.text != ' ' ) {\n\t\t\t\t\tlet elementAttributes,\n\t\t\t\t\t\ttext = part.text;\n\n\t\t\t\t\tlet contentIsNode = false,\n\t\t\t\t\t\ttagNodeContent = null;\n\n\t\t\t\t\tif ( part.type == 'normal' || ( part.type == 'token' && ! part.hasFields && ! item.isMissing ) ) {\n\t\t\t\t\t\telementAttributes = {\n\t\t\t\t\t\t\tclass: 'item-title__normal',\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Add normal-text part to the brackets version\n\t\t\t\t\t\tresponse.brackets += part.text;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst CSSClass = 'item-title__token';\n\n\t\t\t\t\t\telementAttributes = {\n\t\t\t\t\t\t\tclass: CSSClass,\n\t\t\t\t\t\t\t'data-token-id': part.id,\n\t\t\t\t\t\t\t'data-options-id': part.optionsID,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Check if it's using a valid ID\n\t\t\t\t\t\tif ( isDefined( item.options[ part.optionsID ] ) ) {\n\t\t\t\t\t\t\t// Check if the section is valid\n\t\t\t\t\t\t\tif ( item.options[ part.optionsID ].isValid ) {\n\t\t\t\t\t\t\t\t// Add filled class\n\t\t\t\t\t\t\t\telementAttributes.class += ' item-title__token--filled';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if it's filled\n\t\t\t\t\t\tif ( isDefined( part.originalText ) ) {\n\t\t\t\t\t\t\t// Add filled class\n\t\t\t\t\t\t\t// elementAttributes[ 'class' ] += ' item-title__token--filled';\n\n\t\t\t\t\t\t\t// Check if the text is a token\n\t\t\t\t\t\t\t// let isValidToken = false;\n\n\t\t\t\t\t\t\tif ( tokensRegex.test( text ) ) {\n\t\t\t\t\t\t\t\t// Check if we already have the tokens data\n\t\t\t\t\t\t\t\tif ( ! isDefined( itemTokens ) ) {\n\t\t\t\t\t\t\t\t\titemTokens = new Tokens( item.itemType, 'text', {\n\t\t\t\t\t\t\t\t\t\tincludeGroupName: false,\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Check if it's a valid token\n\t\t\t\t\t\t\t\tconst token = itemTokens.renderTextWithTokens( text );\n\n\t\t\t\t\t\t\t\tif ( isDefined( token ) ) {\n\t\t\t\t\t\t\t\t\t// Change the validity of the token\n\t\t\t\t\t\t\t\t\t// isValidToken = true;\n\t\t\t\t\t\t\t\t\tcontentIsNode = true;\n\t\t\t\t\t\t\t\t\ttagNodeContent = token;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( ! contentIsNode ) {\n\t\t\t\t\t\t\t\t// Define text of the token\n\t\t\t\t\t\t\t\tconst abbreviatedText = abbreviateText( text, 30 );\n\n\t\t\t\t\t\t\t\t// Check if the text was long enough to abbreviate it\n\t\t\t\t\t\t\t\tif ( abbreviatedText.isAbbreviated ) {\n\t\t\t\t\t\t\t\t\t// Add tooltip with the complete text\n\t\t\t\t\t\t\t\t\telementAttributes[ 'uap-tooltip' ] = text;\n\n\t\t\t\t\t\t\t\t\t// Replace original text\n\t\t\t\t\t\t\t\t\ttext = abbreviatedText.text;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Add token to the brackets version\n\t\t\t\t\t\tresponse.brackets += `{{${ decodeEntities( text ) }}}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst element = $( '<span/>', elementAttributes );\n\n\t\t\t\t\tif ( contentIsNode ) {\n\t\t\t\t\t\telement.append( tagNodeContent );\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.text( decodeEntities( text ) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add to the elements array\n\t\t\t\t\tresponse.elements[ part.type ].push( element );\n\n\t\t\t\t\t// Append HTML\n\t\t\t\t\tresponse.html.append( element );\n\t\t\t\t} else {\n\t\t\t\t\t// Add white spaces to the brackets version\n\t\t\t\t\tresponse.brackets += part.text;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Convert array of jQuery elements into wrapped set of elements\n\t\t\tresponse.elements.normal = $( response.elements.normal ).map( ( index, element ) => {\n\t\t\t\treturn element.get();\n\t\t\t} );\n\t\t\tresponse.elements.token = $( response.elements.token )\n\t\t\t\t.map( ( index, element ) => {\n\t\t\t\t\treturn element.get();\n\t\t\t\t} )\n\t\t\t\t.filter( ':not(.item-title__normal)' );\n\t\t}\n\n\t\tUncannyAutomator.recipe.items[ item.id ].itemSentence = response;\n\t}\n\n\treturn response;\n};\n\n/**\n * Opens URL on a new centered window\n *\n * @param {String}   options         The options\n * @param {String}   options.url     The URL\n * @param {String}   options.title   The window title\n * @param {Integer}  options.w       The window width\n * @param {Integer}  options.h       The window height\n * @param {Function} options.onClose Callback invoked when the window is closed\n * @return {WindowProxy}               The window instance\n */\nexport const openCenteredWindow = ( { url, title, w, h, onClose } ) => {\n\t// Fixes dual-screen position\n\tconst dualScreenLeft = isDefined( window.screenLeft ) ? window.screenLeft : window.screenX;\n\tconst dualScreenTop = isDefined( window.screenTop ) ? window.screenTop : window.screenY;\n\n\tlet width = document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\n\tif ( window.innerWidth ) {\n\t\twidth = window.innerWidth;\n\t}\n\n\tlet height = document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\n\tif ( window.innerHeight ) {\n\t\theight = window.innerHeight;\n\t}\n\n\tconst systemZoom = width / window.screen.availWidth;\n\tconst left = ( width - w ) / 2 / systemZoom + dualScreenLeft;\n\tconst top = ( height - h ) / 2 / systemZoom + dualScreenTop;\n\tconst newWindow = window.open(\n\t\turl,\n\t\ttitle,\n\t\t`\n\t\tscrollbars=yes,\n\t\twidth=${ w / systemZoom }, \n\t\theight=${ h / systemZoom }, \n\t\ttop=${ top }, \n\t\tleft=${ left }\n\t\t`\n\t);\n\n\tif ( window.focus ) {\n\t\tnewWindow.focus();\n\t}\n\n\t// Check if there is an onClose event defined\n\tif ( isDefined( onClose ) ) {\n\t\t/**\n\t\t * Checks if the window was closed\n\t\t */\n\t\tconst wasWindowClosed = () => {\n\t\t\tif ( newWindow.closed ) {\n\t\t\t\tonClose();\n\t\t\t} else {\n\t\t\t\t// Check in .5 seconds again\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\twasWindowClosed();\n\t\t\t\t}, 500 );\n\t\t\t}\n\t\t};\n\n\t\twasWindowClosed();\n\t}\n\n\treturn newWindow;\n};\n\n/**\n * Determines if a variable is set and is not NULL\n *\n * @param {Mixed} variable The variable being evaluated\n * @return {Boolean}           True if the variable is defined\n */\nexport const isDefined = ( variable ) => {\n\t// Returns true if the variable is undefined\n\treturn typeof variable !== 'undefined' && variable !== null;\n};\n\n/**\n * Determines whether a variable is empty\n *\n * @param {Mixed} variable The variable being evaluated\n * @return {Boolean}           True if the variable is empty\n */\nexport const isEmpty = ( variable ) => {\n\tlet response = true;\n\n\t// Check if the variable is defined, otherwise is empty\n\tif ( isDefined( variable ) ) {\n\t\t// Check if it's array\n\t\tif ( $.isArray( variable ) ) {\n\t\t\tresponse = variable.length == 0;\n\t\t} else if ( isObject( variable ) ) {\n\t\t\tresponse = $.isEmptyObject( variable );\n\t\t} else {\n\t\t\tresponse = variable == '';\n\t\t}\n\t}\n\n\treturn response;\n};\n\n/**\n * Checks if two strings are equal\n *\n * @param {String}  string1                String to be compared\n * @param {String}  string2                String to be compared\n * @param {Object}  settings               Object with settings\n * @param {Boolean} settings.caseSensitive If true, uppercase and lowercase chars will be treated as distinct\n * @return {Boolean}                         True if both strings are equal\n */\nexport const compareStrings = ( string1, string2, settings = { caseSensitive: true } ) => {\n\t// Create response variable\n\tlet response = false;\n\n\t// Check if it's case sensitive\n\tif ( ! settings.caseSensitive ) {\n\t\tresponse = string1.toString().toLowerCase() == string2.toString().toLowerCase();\n\t} else {\n\t\tresponse = string1.toString() == string2.toString();\n\t}\n\n\treturn response;\n};\n\n/**\n * Checks if a value exists in an array\n * If the needle is an array then it will check if all his elements exists in the haystack\n *\n * @param {Mixed} needle   The searched value. The comparison between values is strict. If the needle is an array then it will check if all his elements exists in the haystack\n * @param {Array} haystack An array through which to search.\n * @return {Boolean}           True if needle is found in the array or if needle is an array, TRUE if all the elements from the needle are in haystack\n */\nexport const inArray = ( needle, haystack ) => {\n\tlet response = false;\n\n\tif ( Array.isArray( needle ) ) {\n\t\t// Check that all the elements from the array \"value\" are in the array \"array\"\n\t\tresponse = arrayDifference( needle, haystack ).length == 0;\n\t} else {\n\t\t// Check if one element is in an array\n\t\tresponse = $.inArray( needle, haystack ) !== -1;\n\t}\n\n\treturn response;\n};\n\n/**\n * Compares the values of two arrays and returns the difference\n * Compares array1 against one array and returns the values in array1 that are not present in array2.\n * Examples:\n * +-------------------+-------------+--------------+\n * |      array1       |   array2    |    return    |\n * +-------------------+-------------+--------------+\n * | [ 1, 2, 3, 4, 5 ] | [ 1, 3, 4 ] | [ 2, 5]      |\n * | [ 1, 2, 3 ]       | [ 2, 3 ]    | [ 1 ]        |\n * | [ 2, 3 ]          | [ 1, 2, 3 ] | []           |\n * | [ 1, 2 ]          | [ 1, 2 ]    | []           |\n * | [ '1', '2' ]      | [ 1, 2 ]    | [ '1', '2' ] |\n * +-------------------+-------------+--------------+\n *\n * @param {Array} array1 The array to compare from\n * @param {Array} array2 An array to compare against\n * @return {Array}          Array containing all the entries from array1 that are not present in array2\n */\nexport const arrayDifference = ( array1, array2 ) => {\n\treturn $( array1 ).not( array2 ).get();\n};\n\n/**\n * Determines whether a variable is a string\n *\n * @param {Mixed} string The variable being evaluated\n * @return {Boolean}         True if the variable is an string\n */\nexport const isString = ( string ) => {\n\treturn typeof string === 'string';\n};\n\n/**\n * Determines whether a variable is an object\n *\n * @param {Mixed} variable The variable being evaluated\n * @return {Boolean}           True if the variable is an object\n */\nexport const isObject = ( variable ) => {\n\treturn variable !== null && typeof variable === 'object';\n};\n\n/**\n * Removes all spaces from a string\n *\n * @param {String} string The string\n * @return  {String}        String without spaces\n */\nexport const removeSpaces = ( string ) => {\n\treturn string.replace( /\\s/g, '' );\n};\n\n/**\n * Replaces curly braces\n *\n * @param {String} string The string to be searched\n * @param {String} start  The value to replace the for {{\n * @param {String} end    The value to replace the for }}\n * @return {String}          The value with the replaced values\n */\nexport const replaceCurlyBraces = ( string = '', start = '', end = '' ) => {\n\tstring = string.replace( /{{/g, start );\n\tstring = string.replace( /}}/g, end );\n\treturn string;\n};\n\n/**\n * Creates a console log label\n *\n * @param {String}  text    Text to show after the label\n * @param {Boolean} isGroup Define if we have to do a console.group instead of console.log\n * @param {Object}  options The options\n */\nexport const consoleLogLabel = ( text = '', isGroup = false, options = {} ) => {\n\t// Output if the developer mode is enabled\n\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t// Check if the user defined a custom background color\n\t\tif ( ! isDefined( options.bgColor ) ) {\n\t\t\toptions.bgColor = '#0790e8';\n\t\t}\n\n\t\t// Define console log Automator style\n\t\tconst labelStyle = `background: ${ options.bgColor }; color: #fff; font-weight: 500; padding: 2px 6px; font-family: -apple-system, system-ui, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif; border-radius: 8px;`;\n\n\t\t// Do console log\n\t\tif ( isGroup ) {\n\t\t\tif ( isDefined( options.collapseGroup ) && options.collapseGroup ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.groupCollapsed( '%cAutomator', labelStyle, text );\n\t\t\t} else {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.group( '%cAutomator', labelStyle, text );\n\t\t\t}\n\t\t} else {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log( '%cAutomator', labelStyle, text );\n\t\t}\n\t}\n};\n\n/**\n * Creates a custom console log with colors to\n * represent success and failure\n *\n * @param {String} status Message type. Use 'success' or 'error'\n * @param {String} text   Text to show after the label\n */\nexport const consoleLogResult = ( status = 'error', text = '' ) => {\n\t// Output if the developer mode is enabled\n\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t// Define console log Automator style\n\t\tlet labelStyle = [\n\t\t\t'color: #fff',\n\t\t\t'padding: 2px 7px',\n\t\t\t// eslint-disable-next-line max-len\n\t\t\t'font-family: -apple-system, system-ui, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n\t\t\t'font-weight: normal',\n\t\t].join( ';' );\n\n\t\t// Add error or success colors\n\t\tif ( status == 'error' ) {\n\t\t\tlabelStyle = `background: #f13c3c; ${ labelStyle }`;\n\t\t}\n\n\t\tif ( status == 'success' ) {\n\t\t\tlabelStyle = `background: #40b528; ${ labelStyle }`;\n\t\t}\n\n\t\t// Do console log\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log( `%c${ text }`, labelStyle );\n\t}\n};\n\n/**\n * Escape HTML characters\n *\n * @param {String} html The HTML\n * @return {String}      Scaped HTML\n */\nexport const escapeHTML = ( html = '' ) => {\n\tconst tagsToReplace = {\n\t\t'&': '&amp;',\n\t\t'<': '&lt;',\n\t\t'>': '&gt;',\n\t};\n\n\t/**\n\t * Replace tags\n\t *\n\t * @param {String} tag The tag to replace\n\t * @return {String}     The tag replaced\n\t */\n\tconst replaceTag = ( tag ) => {\n\t\treturn tagsToReplace[ tag ] || tag;\n\t};\n\n\treturn html.replace( /[&<>]/g, replaceTag );\n};\n\n/**\n * Abbreviate long texts. This function will convert a string\n * like \"123456789\" to \"123...789\"\n *\n * @param {String}  text   The string\n * @param {Integer} length The max length of the string\n * @return {Object}        Object with two properties: isAbbreviated and text\n */\nexport const abbreviateText = ( text = '', length = 10 ) => {\n\t// Default response\n\tconst response = {\n\t\tisAbbreviated: false,\n\t\ttext: text,\n\t};\n\n\t// Only abbreviate the text if the text is longer than the length\n\tif ( text.length > length ) {\n\t\t// Get length of each parts (start and end)\n\t\tconst partLengths = Math.floor( length / 2 );\n\n\t\t// Get parts\n\t\tconst textParts = {\n\t\t\tstart: text.substring( 0, partLengths ),\n\t\t\tend: text.slice( -partLengths ),\n\t\t};\n\n\t\t// Create abbrevited text\n\t\tresponse.text = `${ textParts.start } ... ${ textParts.end }`;\n\t\tresponse.isAbbreviated = true;\n\t}\n\n\t// Return response\n\treturn response;\n};\n\n/**\n * Returns an unique ID\n *\n * @return {String} The ID\n */\nexport const getUniqueId = () => {\n\t// Math.random should be unique because of its seeding algorithm.\n\t// Convert it to base 36 (numbers + letters), and grab the first 9 characters\n\t// after the decimal.\n\treturn `_${ Math.random().toString( 36 ).substr( 2, 9 ) }`;\n};\n\n/**\n * Inserts parameter(s) to an URL.\n * If the parameter already exists it will update it\n *\n * @param {String}  url              The URL\n * @param {Object}  parameters       The parameters\n * @param {Object}  options          The options.\n * @param {Boolean} options.setAsURL True to set the URL as the current URL\n * @param {Boolean} options.refresh  True to refresh the page after setting the URL\n * @return {String}                  The URL with the parameters\n */\nexport const addParametersToURL = ( url = '', parameters = {}, options = {} ) => {\n\t// If the URL is empty, use the site URL\n\tif ( isEmpty( url ) ) {\n\t\turl = window.location.href;\n\t}\n\n\t// Try to get an URL object\n\ttry {\n\t\turl = new URL( url );\n\t} catch ( e ) {\n\t\t// If something goes wrong, just return the original URL\n\t\treturn url;\n\t}\n\n\t// Get the current parameters in the URL\n\tlet urlParameters = url.search.substr( 1 ).split( '&' );\n\n\t// Iterate the parameters\n\tfor ( let [ key, value ] of Object.entries( parameters ) ) {\n\t\tkey = encodeURI( key );\n\t\tvalue = encodeURI( value );\n\n\t\tlet i = urlParameters.length;\n\t\tlet x;\n\n\t\twhile ( i-- ) {\n\t\t\tx = urlParameters[ i ].split( '=' );\n\n\t\t\tif ( x[ 0 ] == key ) {\n\t\t\t\tx[ 1 ] = value;\n\t\t\t\turlParameters[ i ] = x.join( '=' );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ( i < 0 ) {\n\t\t\turlParameters[ urlParameters.length ] = [ key, value ].join( '=' );\n\t\t}\n\t}\n\n\t// Remove empty parameters\n\turlParameters = urlParameters.filter( ( parameter ) => {\n\t\t// Remove parameters without values\n\t\tconst parameterParts = parameter.split( '=' );\n\n\t\treturn ! ( isEmpty( parameter ) || isEmpty( parameterParts[ 1 ] ) );\n\t} );\n\n\t// Add parameters to the URL\n\turl.search = urlParameters.join( '&' );\n\n\t// Set default options\n\toptions = $.extend(\n\t\t{},\n\t\t{\n\t\t\tsetAsURL: false,\n\t\t\trefresh: false,\n\t\t},\n\t\toptions\n\t);\n\n\t// Check if we have to set it as the current URL\n\tif ( options.setAsURL ) {\n\t\t// Check if we have to reload\n\t\tif ( options.refresh ) {\n\t\t\t// This will reload the page, it's likely better to store this until finished\n\t\t\twindow.location.href = url.href;\n\t\t} else {\n\t\t\t// Get title of the current page\n\t\t\tconst pageTitle = document.title;\n\n\t\t\t// Push history and update URL\n\t\t\twindow.history.pushState( {}, pageTitle, url.href );\n\t\t}\n\t}\n\n\t// Return URL\n\treturn url.href;\n};\n\n/**\n * Returns the value of a given parameter on a given URL\n *\n * @param {String} url       The URL containing the parameter\n * @param {String} parameter The parameter key\n * @return {String}           The parameter value\n */\nexport const getURLParameter = ( url = '', parameter = '' ) => {\n\t// If the URL is empty, use the site URL\n\tif ( isEmpty( url ) ) {\n\t\turl = window.location.href;\n\t}\n\n\t// Convert it to an URL object\n\turl = new URL( url );\n\n\t// Get parameter\n\treturn url.searchParams.get( parameter );\n};\n\n/**\n * Decodes HTML entities\n *\n * @since  2.1.4\n * @param {String} encodedString The string with encoded entities\n * @return {String}               The same string, with the entities decoded\n */\nexport const decodeEntities = ( encodedString = '' ) => {\n\tconst $textarea = document.createElement( 'textarea' );\n\t$textarea.innerHTML = encodedString;\n\treturn $textarea.value;\n};\n\n/**\n * Throttles a function\n *\n * @param {Function} func     The function to throttle\n * @param {Integer}  interval The interval, in milliseconds\n * @return {Function}           The function throttled\n */\nexport const throttle = ( func, interval ) => {\n\tlet lastCall = 0;\n\n\treturn () => {\n\t\tconst now = Date.now();\n\t\tif ( lastCall + interval < now ) {\n\t\t\tlastCall = now;\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\treturn func.apply( this, arguments );\n\t\t}\n\t};\n};\n\n/**\n * Debounces a function\n *\n * @param {Function} func     The function to debounce\n * @param {Integer}  interval The interval, in milliseconds\n * @return {Function}         The function debounced\n */\nexport const debounce = ( func, interval ) => {\n\tlet lastCall = -1;\n\n\treturn () => {\n\t\tclearTimeout( lastCall );\n\t\t// eslint-disable-next-line no-undef\n\t\tconst args = arguments;\n\t\tconst self = this;\n\t\tlastCall = setTimeout( () => {\n\t\t\tfunc.apply( self, args );\n\t\t}, interval );\n\t};\n};\n\n/**\n * Copies a string to the clipboard\n *\n * @param {String} string The string to copy\n * @return {undefined}\n */\nexport const copyToClipboard = ( string ) => {\n\t// Create temporal textarea\n\tconst $tempTextarea = document.createElement( 'textarea' );\n\n\t// Make the textarea really small\n\t$tempTextarea.style.width = '0px';\n\t$tempTextarea.style.height = '0px';\n\n\t// Set the string as the textarea value\n\t$tempTextarea.value = string;\n\n\t// Add the textarea to the body\n\tdocument.body.appendChild( $tempTextarea );\n\n\t// Select all the text from the textarea\n\t$tempTextarea.select();\n\n\t// Copy content\n\tdocument.execCommand( 'copy' );\n\n\t// Remove the element from the body\n\tdocument.body.removeChild( $tempTextarea );\n};\n\n/**\n * Creates and show a modal with useful data when the JS throws a fatal error\n *\n * @param {Object} settings The settings\n * @return {undefined}\n */\nexport const handleFatalError = ( settings = {} ) => {\n\tsettings = $.extend(\n\t\ttrue,\n\t\t{\n\t\t\ttitle: UncannyAutomator.i18n.debugging.fatalErrorHandler.title,\n\t\t\twarning: '',\n\t\t\tcontent: UncannyAutomator.i18n.debugging.fatalErrorHandler.content,\n\t\t\tconsole: null,\n\t\t\tbuttons: {\n\t\t\t\tconfirm: {\n\t\t\t\t\tlabel: UncannyAutomator.i18n.debugging.learnMore,\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t// Learn more\n\t\t\t\t\t\twindow.open( UncannyAutomator.dev.debuggingURL, '_blank' );\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcancel: {\n\t\t\t\t\tlabel: UncannyAutomator.i18n.close,\n\t\t\t\t\tonClick: ( $modal ) => {\n\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t$modal.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tsettings\n\t);\n\n\t// Create report log\n\tlet reportLog = '';\n\n\tlet recipeData;\n\ttry {\n\t\t// Get the recipe data\n\t\t$.each( UncannyAutomator.recipes_object, ( index, theRecipe ) => {\n\t\t\tif ( theRecipe.ID == UncannyAutomator.recipe.id ) {\n\t\t\t\trecipeData = theRecipe;\n\t\t\t}\n\t\t} );\n\t} catch ( e ) {\n\t\t// Continue regardless of error\n\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( e );\n\t\t}\n\t}\n\n\t// Get general information about the recipe\n\ttry {\n\t\tlet logRecipe = `====== ${ UncannyAutomator.i18n.debugging.recipeTitle } ====== \\n`;\n\n\t\t// Add recipe type\n\t\tlet recipeType = UncannyAutomator.i18n.debugging.recipeTypeUser;\n\t\tif ( recipeData.recipe_type == 'anonymous' ) {\n\t\t\trecipeType = UncannyAutomator.i18n.debugging.recipeTypeAnonymous;\n\t\t}\n\n\t\tlogRecipe += `${ UncannyAutomator.i18n.debugging.recipeType }: ${ recipeType }`;\n\n\t\t// Add recipe status\n\t\tlet recipeStatus = UncannyAutomator.i18n.debugging.recipeStatusDraft;\n\t\tif ( recipeData.post_status == 'publish' ) {\n\t\t\trecipeStatus = UncannyAutomator.i18n.debugging.recipeStatusLive;\n\t\t}\n\n\t\tlogRecipe += `\\n${ UncannyAutomator.i18n.debugging.recipeStatus }: ${ recipeStatus }`;\n\n\t\treportLog = logRecipe;\n\t} catch ( e ) {\n\t\t// Continue regardless of error\n\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( e );\n\t\t}\n\t}\n\n\t// Get information about the recipe items\n\ttry {\n\t\tlet logRecipeItems = `=== ${ UncannyAutomator.i18n.debugging.recipeItemsTitle } === \\n`;\n\n\t\t/**\n\t\t * Cleans extra data\n\t\t *\n\t\t * @param {Object} item The item\n\t\t * @return {String}      Information about the item\n\t\t */\n\t\tconst cleanItemData = ( item ) => {\n\t\t\t// Get status\n\t\t\tconst recipeStatus =\n\t\t\t\titem.post_status == 'publish'\n\t\t\t\t\t? UncannyAutomator.i18n.debugging.itemStatusLive\n\t\t\t\t\t: UncannyAutomator.i18n.debugging.itemStatusDraft;\n\n\t\t\treturn `> ${ item.meta.integration } - ${\n\t\t\t\titem.meta.code\n\t\t\t} - ${ recipeStatus }\\n  (${ item.meta.sentence.replace(\n\t\t\t\t/\\{\\{|\\:[a-zA-Z0-9]*\\}\\}/g,\n\t\t\t\t''\n\t\t\t) })\\n  ${ JSON.stringify( item )\n\t\t\t\t.replaceAll( '<', '&lt;' )\n\t\t\t\t.replaceAll( '>', '&gt;' ) }\\n`;\n\t\t};\n\n\t\t// Get triggers\n\t\tconst triggers = recipeData.triggers.map( cleanItemData );\n\t\tconst hasTriggers = triggers.length > 0;\n\n\t\t// Get actions\n\t\tconst actions = recipeData.actions.map( cleanItemData );\n\t\tconst hasActions = actions.length > 0;\n\n\t\t// Get closures\n\t\tconst closures = recipeData.closures.map( cleanItemData );\n\t\tconst hasClosures = closures.length > 0;\n\n\t\t// Check if it has recipe items\n\t\tif ( hasTriggers || hasActions || hasClosures ) {\n\t\t\t// Add triggers\n\t\t\tlogRecipeItems += `${ UncannyAutomator.i18n.debugging.triggersTitle }\\n\\n`;\n\n\t\t\t// Check if it has triggers\n\t\t\tif ( hasTriggers ) {\n\t\t\t\tlogRecipeItems += triggers.join( '\\n' );\n\t\t\t} else {\n\t\t\t\tlogRecipeItems += `> ${ UncannyAutomator.i18n.debugging.noTriggers }`;\n\t\t\t}\n\n\t\t\t// Add actions\n\t\t\tlogRecipeItems += `\\n${ UncannyAutomator.i18n.debugging.actionsTitle }\\n\\n`;\n\n\t\t\t// Check if it has actions\n\t\t\tif ( hasActions ) {\n\t\t\t\tlogRecipeItems += actions.join( '\\n' );\n\t\t\t} else {\n\t\t\t\tlogRecipeItems += `> ${ UncannyAutomator.i18n.debugging.noActions }`;\n\t\t\t}\n\n\t\t\t// Add closures\n\t\t\tlogRecipeItems += `\\n${ UncannyAutomator.i18n.debugging.closuresTitle }\\n\\n`;\n\n\t\t\t// Check if it has closures\n\t\t\tif ( hasClosures ) {\n\t\t\t\tlogRecipeItems += closures.join( '\\n' );\n\t\t\t} else {\n\t\t\t\tlogRecipeItems += `> ${ UncannyAutomator.i18n.debugging.noClosures }`;\n\t\t\t}\n\t\t} else {\n\t\t\tlogRecipeItems += `${ UncannyAutomator.i18n.debugging.noRecipeItemsFound }`;\n\t\t}\n\n\t\treportLog = reportLog !== '' ? `${ reportLog }\\n\\n${ logRecipeItems }` : reportLog;\n\t} catch ( e ) {\n\t\t// Continue regardless of error\n\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( e );\n\t\t}\n\t}\n\n\t// Add JS console\n\ttry {\n\t\t// Check if we have content to add\n\t\tif ( isDefined( settings.console ) ) {\n\t\t\t// Output only if the developer mode is enabled\n\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.log( settings.console );\n\t\t\t}\n\n\t\t\tlet jsConsole = `====== ${ UncannyAutomator.i18n.debugging.jsConsole } ====== \\n`;\n\n\t\t\t// Add JS console\n\t\t\ttry {\n\t\t\t\tjsConsole += `${ settings.console.stack.replaceAll( UncannyAutomator.siteURL, '{site_url}' ) }`;\n\t\t\t} catch ( e ){\n\t\t\t\ttry {\n\t\t\t\t\tjsConsole += `${ settings.console.replaceAll( UncannyAutomator.siteURL, '{site_url}' ) }`;\n\t\t\t\t} catch ( e ){\n\t\t\t\t\tjsConsole += settings.console;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treportLog = reportLog !== '' ? `${ reportLog }\\n\\n${ jsConsole }` : reportLog;\n\t\t}\n\t} catch ( e ) {\n\t\t// Continue regardless of error\n\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( e );\n\t\t}\n\t}\n\n\t// Escape HTML from report log\n\ttry {\n\t\treportLog = reportLog\n\t\t\t\t\t\t.replace( /&/g, '&amp;' )\n\t\t\t\t\t\t.replace( /</g, '&lt;' )\n\t\t\t\t\t\t.replace( />/g, '&gt;' )\n\t\t\t\t\t\t.replace( /\"/g, '&quot;' )\n\t\t\t\t\t\t.replace( /'/g, '&#039;' );\n\t} catch ( e ){\n\t\t// Continue regardless of error\n\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn( e );\n\t\t}\n\t}\n\n\t// Create buttons\n\tconst modalButtons = {};\n\n\tif ( isDefined( settings.buttons.cancel ) ){\n\t\tmodalButtons.cancel = settings.buttons.cancel.label;\n\t}\n\n\tif ( isDefined( settings.buttons.confirm ) ){\n\t\tmodalButtons.confirm = settings.buttons.confirm.label;\n\t}\n\n\tlet $modal = new Modal(\n\t\t{\n\t\t\ttitle: `<span class=\"modal__title-icon uo-icon uo-icon--exclamation-triangle\"></span> ${ settings.title }`,\n\t\t\twarning: `${ settings.warning }`,\n\t\t\tcontent: `\n\t\t\t<div>\n\t\t\t\t${ ! isEmpty( settings.content ) ? settings.content : '' }\n\t\t\t\t<div class=\"modal__content-code\">\n\t\t\t\t\t<pre id=\"uap-debugging\">${ reportLog }</pre>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,\n\t\t\tbuttons: modalButtons,\n\t\t},\n\t\t{\n\t\t\tsize: 'extra-large',\n\t\t\twarningFirst: true,\n\t\t}\n\t);\n\n\t$modal.setEvents( {\n\t\tonConfirm: () => {\n\t\t\tsettings.buttons.confirm.onClick( $modal );\n\t\t},\n\t\tonCancel: () => {\n\t\t\tsettings.buttons.cancel.onClick( $modal );\n\t\t},\n\t\tafterSetEvents: () => {\n\t\t\t// Get the element with the debugging\n\t\t\tconst $debuggingConsole = $( '#uap-debugging' );\n\n\t\t\t// On click, copy the content\n\t\t\t$debuggingConsole.on( 'click', () => {\n\t\t\t\t// Select the content of the container\n\t\t\t\t// This is just to improve the UX\n\t\t\t\tconst range = document.createRange();\n\t\t\t\trange.selectNodeContents( $debuggingConsole[ 0 ] );\n\t\t\t\t// eslint-disable-next-line @wordpress/no-global-get-selection\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t// eslint-disable-next-line @wordpress/no-global-get-selection\n\t\t\t\twindow.getSelection().addRange( range );\n\t\t\t} );\n\t\t},\n\t} );\n};\n\n/**\n * Filters items with specific post meta value\n *\n * @since 3.0\n * @param {array}  items The array of items to filter\n * @param {String} meta  Meta key\n * @param {String} value Meta value\n * @return {array} Array of filtered items\n */\nexport const filterMetaValue = ( items, meta, value ) => {\n\tconst itemsWithMeta = {};\n\n\t$.each( items, ( itemId, item ) => {\n\t\tif ( item.meta[ meta ] && item.meta[ meta ] == value ) {\n\t\t\titemsWithMeta[ itemId ] = item;\n\t\t}\n\t} );\n\n\treturn itemsWithMeta;\n};\n\n/**\n * Filters items without specific post meta\n *\n * @param {Array}  items The array of items to filter\n * @param {String} meta  Meta key\n * @param {String} value Meta value\n * @return {Array}          Array of filtered items\n */\nexport const filterMeta = ( items, meta, value = true ) => {\n\tconst filteredItems = {};\n\n\t$.each( items, ( itemId, item ) => {\n\t\tif ( meta in item.meta === value ) {\n\t\t\tfilteredItems[ itemId ] = item;\n\t\t}\n\t} );\n\n\treturn filteredItems;\n};\n\n/**\n * Opens a link on a new tab\n *\n * @param {String} href The URL\n * @return {undefined}\n */\nexport const openInNewTab = ( href ) => {\n\tObject.assign( document.createElement( 'a' ), {\n\t\ttarget: '_blank',\n\t\thref: href,\n\t} ).click();\n};\n\n/**\n * Adds the UTM parameters to a given URL\n *\n * @param {String} url                 The URL\n * @param {Object} parameters          The parameters to add\n * @param {String} parameters.medium   The utm_medium\n * @param {String} parameters.campaign The utm_campaign\n * @param {String} parameters.content  The utm_content\n * @return {String}                     The URL with the parameters\n */\nexport const addUTMParameters = ( url, { medium, campaign, content } ) => {\n\t// Define the parameters we're going to add\n\tconst urlParameters = {};\n\n\t// Add the utm_source\n\t// eslint-disable-next-line camelcase\n\turlParameters.utm_source =\n\t\tisDefined( UncannyAutomator.wp ) && UncannyAutomator.wp ? 'uncanny_automator_pro' : 'uncanny_automator';\n\n\t// Add the medium\n\tif ( ! isEmpty( medium ) ) {\n\t\t// eslint-disable-next-line camelcase\n\t\turlParameters.utm_medium = medium;\n\t}\n\n\t// Add the campaign\n\tif ( ! isEmpty( campaign ) ) {\n\t\t// eslint-disable-next-line camelcase\n\t\turlParameters.utm_campaign = campaign;\n\t}\n\n\t// Add the content\n\tif ( ! isEmpty( content ) ) {\n\t\t// eslint-disable-next-line camelcase\n\t\turlParameters.utm_content = content;\n\t}\n\n\t// Check if we have to add the utm_r parameter\n\tif ( ! isEmpty( UncannyAutomator.marketing.utmR ) ) {\n\t\t// eslint-disable-next-line camelcase\n\t\turlParameters.utm_r = UncannyAutomator.marketing.utmR;\n\t}\n\n\t// Add the parameters\n\turl = addParametersToURL( url, urlParameters );\n\n\t// Return the modified URL\n\treturn url;\n};\n","export const HOOKS = [\n    \"onChange\",\n    \"onClose\",\n    \"onDayCreate\",\n    \"onDestroy\",\n    \"onKeyDown\",\n    \"onMonthChange\",\n    \"onOpen\",\n    \"onParseConfig\",\n    \"onReady\",\n    \"onValueUpdate\",\n    \"onYearChange\",\n    \"onPreCalendarPosition\",\n];\nexport const defaults = {\n    _disable: [],\n    allowInput: false,\n    allowInvalidPreload: false,\n    altFormat: \"F j, Y\",\n    altInput: false,\n    altInputClass: \"form-control input\",\n    animate: typeof window === \"object\" &&\n        window.navigator.userAgent.indexOf(\"MSIE\") === -1,\n    ariaDateFormat: \"F j, Y\",\n    autoFillDefaultTime: true,\n    clickOpens: true,\n    closeOnSelect: true,\n    conjunction: \", \",\n    dateFormat: \"Y-m-d\",\n    defaultHour: 12,\n    defaultMinute: 0,\n    defaultSeconds: 0,\n    disable: [],\n    disableMobile: false,\n    enableSeconds: false,\n    enableTime: false,\n    errorHandler: (err) => typeof console !== \"undefined\" && console.warn(err),\n    getWeek: (givenDate) => {\n        const date = new Date(givenDate.getTime());\n        date.setHours(0, 0, 0, 0);\n        date.setDate(date.getDate() + 3 - ((date.getDay() + 6) % 7));\n        var week1 = new Date(date.getFullYear(), 0, 4);\n        return (1 +\n            Math.round(((date.getTime() - week1.getTime()) / 86400000 -\n                3 +\n                ((week1.getDay() + 6) % 7)) /\n                7));\n    },\n    hourIncrement: 1,\n    ignoredFocusElements: [],\n    inline: false,\n    locale: \"default\",\n    minuteIncrement: 5,\n    mode: \"single\",\n    monthSelectorType: \"dropdown\",\n    nextArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>\",\n    noCalendar: false,\n    now: new Date(),\n    onChange: [],\n    onClose: [],\n    onDayCreate: [],\n    onDestroy: [],\n    onKeyDown: [],\n    onMonthChange: [],\n    onOpen: [],\n    onParseConfig: [],\n    onReady: [],\n    onValueUpdate: [],\n    onYearChange: [],\n    onPreCalendarPosition: [],\n    plugins: [],\n    position: \"auto\",\n    positionElement: undefined,\n    prevArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>\",\n    shorthandCurrentMonth: false,\n    showMonths: 1,\n    static: false,\n    time_24hr: false,\n    weekNumbers: false,\n    wrap: false,\n};\n","export const english = {\n    weekdays: {\n        shorthand: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n        longhand: [\n            \"Sunday\",\n            \"Monday\",\n            \"Tuesday\",\n            \"Wednesday\",\n            \"Thursday\",\n            \"Friday\",\n            \"Saturday\",\n        ],\n    },\n    months: {\n        shorthand: [\n            \"Jan\",\n            \"Feb\",\n            \"Mar\",\n            \"Apr\",\n            \"May\",\n            \"Jun\",\n            \"Jul\",\n            \"Aug\",\n            \"Sep\",\n            \"Oct\",\n            \"Nov\",\n            \"Dec\",\n        ],\n        longhand: [\n            \"January\",\n            \"February\",\n            \"March\",\n            \"April\",\n            \"May\",\n            \"June\",\n            \"July\",\n            \"August\",\n            \"September\",\n            \"October\",\n            \"November\",\n            \"December\",\n        ],\n    },\n    daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],\n    firstDayOfWeek: 0,\n    ordinal: (nth) => {\n        const s = nth % 100;\n        if (s > 3 && s < 21)\n            return \"th\";\n        switch (s % 10) {\n            case 1:\n                return \"st\";\n            case 2:\n                return \"nd\";\n            case 3:\n                return \"rd\";\n            default:\n                return \"th\";\n        }\n    },\n    rangeSeparator: \" to \",\n    weekAbbreviation: \"Wk\",\n    scrollTitle: \"Scroll to increment\",\n    toggleTitle: \"Click to toggle\",\n    amPM: [\"AM\", \"PM\"],\n    yearAriaLabel: \"Year\",\n    monthAriaLabel: \"Month\",\n    hourAriaLabel: \"Hour\",\n    minuteAriaLabel: \"Minute\",\n    time_24hr: false,\n};\nexport default english;\n","export const pad = (number, length = 2) => `000${number}`.slice(length * -1);\nexport const int = (bool) => (bool === true ? 1 : 0);\nexport function debounce(fn, wait) {\n    let t;\n    return function () {\n        clearTimeout(t);\n        t = setTimeout(() => fn.apply(this, arguments), wait);\n    };\n}\nexport const arrayify = (obj) => obj instanceof Array ? obj : [obj];\n","export function toggleClass(elem, className, bool) {\n    if (bool === true)\n        return elem.classList.add(className);\n    elem.classList.remove(className);\n}\nexport function createElement(tag, className, content) {\n    const e = window.document.createElement(tag);\n    className = className || \"\";\n    content = content || \"\";\n    e.className = className;\n    if (content !== undefined)\n        e.textContent = content;\n    return e;\n}\nexport function clearNode(node) {\n    while (node.firstChild)\n        node.removeChild(node.firstChild);\n}\nexport function findParent(node, condition) {\n    if (condition(node))\n        return node;\n    else if (node.parentNode)\n        return findParent(node.parentNode, condition);\n    return undefined;\n}\nexport function createNumberInput(inputClassName, opts) {\n    const wrapper = createElement(\"div\", \"numInputWrapper\"), numInput = createElement(\"input\", \"numInput \" + inputClassName), arrowUp = createElement(\"span\", \"arrowUp\"), arrowDown = createElement(\"span\", \"arrowDown\");\n    if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n        numInput.type = \"number\";\n    }\n    else {\n        numInput.type = \"text\";\n        numInput.pattern = \"\\\\d*\";\n    }\n    if (opts !== undefined)\n        for (const key in opts)\n            numInput.setAttribute(key, opts[key]);\n    wrapper.appendChild(numInput);\n    wrapper.appendChild(arrowUp);\n    wrapper.appendChild(arrowDown);\n    return wrapper;\n}\nexport function getEventTarget(event) {\n    try {\n        if (typeof event.composedPath === \"function\") {\n            const path = event.composedPath();\n            return path[0];\n        }\n        return event.target;\n    }\n    catch (error) {\n        return event.target;\n    }\n}\n","import { int, pad } from \"../utils\";\nconst doNothing = () => undefined;\nexport const monthToStr = (monthNumber, shorthand, locale) => locale.months[shorthand ? \"shorthand\" : \"longhand\"][monthNumber];\nexport const revFormat = {\n    D: doNothing,\n    F: function (dateObj, monthName, locale) {\n        dateObj.setMonth(locale.months.longhand.indexOf(monthName));\n    },\n    G: (dateObj, hour) => {\n        dateObj.setHours(parseFloat(hour));\n    },\n    H: (dateObj, hour) => {\n        dateObj.setHours(parseFloat(hour));\n    },\n    J: (dateObj, day) => {\n        dateObj.setDate(parseFloat(day));\n    },\n    K: (dateObj, amPM, locale) => {\n        dateObj.setHours((dateObj.getHours() % 12) +\n            12 * int(new RegExp(locale.amPM[1], \"i\").test(amPM)));\n    },\n    M: function (dateObj, shortMonth, locale) {\n        dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));\n    },\n    S: (dateObj, seconds) => {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    U: (_, unixSeconds) => new Date(parseFloat(unixSeconds) * 1000),\n    W: function (dateObj, weekNum, locale) {\n        const weekNumber = parseInt(weekNum);\n        const date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);\n        date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);\n        return date;\n    },\n    Y: (dateObj, year) => {\n        dateObj.setFullYear(parseFloat(year));\n    },\n    Z: (_, ISODate) => new Date(ISODate),\n    d: (dateObj, day) => {\n        dateObj.setDate(parseFloat(day));\n    },\n    h: (dateObj, hour) => {\n        dateObj.setHours(parseFloat(hour));\n    },\n    i: (dateObj, minutes) => {\n        dateObj.setMinutes(parseFloat(minutes));\n    },\n    j: (dateObj, day) => {\n        dateObj.setDate(parseFloat(day));\n    },\n    l: doNothing,\n    m: (dateObj, month) => {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    n: (dateObj, month) => {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    s: (dateObj, seconds) => {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    u: (_, unixMillSeconds) => new Date(parseFloat(unixMillSeconds)),\n    w: doNothing,\n    y: (dateObj, year) => {\n        dateObj.setFullYear(2000 + parseFloat(year));\n    },\n};\nexport const tokenRegex = {\n    D: \"(\\\\w+)\",\n    F: \"(\\\\w+)\",\n    G: \"(\\\\d\\\\d|\\\\d)\",\n    H: \"(\\\\d\\\\d|\\\\d)\",\n    J: \"(\\\\d\\\\d|\\\\d)\\\\w+\",\n    K: \"\",\n    M: \"(\\\\w+)\",\n    S: \"(\\\\d\\\\d|\\\\d)\",\n    U: \"(.+)\",\n    W: \"(\\\\d\\\\d|\\\\d)\",\n    Y: \"(\\\\d{4})\",\n    Z: \"(.+)\",\n    d: \"(\\\\d\\\\d|\\\\d)\",\n    h: \"(\\\\d\\\\d|\\\\d)\",\n    i: \"(\\\\d\\\\d|\\\\d)\",\n    j: \"(\\\\d\\\\d|\\\\d)\",\n    l: \"(\\\\w+)\",\n    m: \"(\\\\d\\\\d|\\\\d)\",\n    n: \"(\\\\d\\\\d|\\\\d)\",\n    s: \"(\\\\d\\\\d|\\\\d)\",\n    u: \"(.+)\",\n    w: \"(\\\\d\\\\d|\\\\d)\",\n    y: \"(\\\\d{2})\",\n};\nexport const formats = {\n    Z: (date) => date.toISOString(),\n    D: function (date, locale, options) {\n        return locale.weekdays.shorthand[formats.w(date, locale, options)];\n    },\n    F: function (date, locale, options) {\n        return monthToStr(formats.n(date, locale, options) - 1, false, locale);\n    },\n    G: function (date, locale, options) {\n        return pad(formats.h(date, locale, options));\n    },\n    H: (date) => pad(date.getHours()),\n    J: function (date, locale) {\n        return locale.ordinal !== undefined\n            ? date.getDate() + locale.ordinal(date.getDate())\n            : date.getDate();\n    },\n    K: (date, locale) => locale.amPM[int(date.getHours() > 11)],\n    M: function (date, locale) {\n        return monthToStr(date.getMonth(), true, locale);\n    },\n    S: (date) => pad(date.getSeconds()),\n    U: (date) => date.getTime() / 1000,\n    W: function (date, _, options) {\n        return options.getWeek(date);\n    },\n    Y: (date) => pad(date.getFullYear(), 4),\n    d: (date) => pad(date.getDate()),\n    h: (date) => (date.getHours() % 12 ? date.getHours() % 12 : 12),\n    i: (date) => pad(date.getMinutes()),\n    j: (date) => date.getDate(),\n    l: function (date, locale) {\n        return locale.weekdays.longhand[date.getDay()];\n    },\n    m: (date) => pad(date.getMonth() + 1),\n    n: (date) => date.getMonth() + 1,\n    s: (date) => date.getSeconds(),\n    u: (date) => date.getTime(),\n    w: (date) => date.getDay(),\n    y: (date) => String(date.getFullYear()).substring(2),\n};\n","import { tokenRegex, revFormat, formats, } from \"./formatting\";\nimport { defaults } from \"../types/options\";\nimport { english } from \"../l10n/default\";\nexport const createDateFormatter = ({ config = defaults, l10n = english, isMobile = false, }) => (dateObj, frmt, overrideLocale) => {\n    const locale = overrideLocale || l10n;\n    if (config.formatDate !== undefined && !isMobile) {\n        return config.formatDate(dateObj, frmt, locale);\n    }\n    return frmt\n        .split(\"\")\n        .map((c, i, arr) => formats[c] && arr[i - 1] !== \"\\\\\"\n        ? formats[c](dateObj, locale, config)\n        : c !== \"\\\\\"\n            ? c\n            : \"\")\n        .join(\"\");\n};\nexport const createDateParser = ({ config = defaults, l10n = english }) => (date, givenFormat, timeless, customLocale) => {\n    if (date !== 0 && !date)\n        return undefined;\n    const locale = customLocale || l10n;\n    let parsedDate;\n    const dateOrig = date;\n    if (date instanceof Date)\n        parsedDate = new Date(date.getTime());\n    else if (typeof date !== \"string\" &&\n        date.toFixed !== undefined)\n        parsedDate = new Date(date);\n    else if (typeof date === \"string\") {\n        const format = givenFormat || (config || defaults).dateFormat;\n        const datestr = String(date).trim();\n        if (datestr === \"today\") {\n            parsedDate = new Date();\n            timeless = true;\n        }\n        else if (/Z$/.test(datestr) ||\n            /GMT$/.test(datestr))\n            parsedDate = new Date(date);\n        else if (config && config.parseDate)\n            parsedDate = config.parseDate(date, format);\n        else {\n            parsedDate =\n                !config || !config.noCalendar\n                    ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0)\n                    : new Date(new Date().setHours(0, 0, 0, 0));\n            let matched, ops = [];\n            for (let i = 0, matchIndex = 0, regexStr = \"\"; i < format.length; i++) {\n                const token = format[i];\n                const isBackSlash = token === \"\\\\\";\n                const escaped = format[i - 1] === \"\\\\\" || isBackSlash;\n                if (tokenRegex[token] && !escaped) {\n                    regexStr += tokenRegex[token];\n                    const match = new RegExp(regexStr).exec(date);\n                    if (match && (matched = true)) {\n                        ops[token !== \"Y\" ? \"push\" : \"unshift\"]({\n                            fn: revFormat[token],\n                            val: match[++matchIndex],\n                        });\n                    }\n                }\n                else if (!isBackSlash)\n                    regexStr += \".\";\n                ops.forEach(({ fn, val }) => (parsedDate = fn(parsedDate, val, locale) || parsedDate));\n            }\n            parsedDate = matched ? parsedDate : undefined;\n        }\n    }\n    if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {\n        config.errorHandler(new Error(`Invalid date provided: ${dateOrig}`));\n        return undefined;\n    }\n    if (timeless === true)\n        parsedDate.setHours(0, 0, 0, 0);\n    return parsedDate;\n};\nexport function compareDates(date1, date2, timeless = true) {\n    if (timeless !== false) {\n        return (new Date(date1.getTime()).setHours(0, 0, 0, 0) -\n            new Date(date2.getTime()).setHours(0, 0, 0, 0));\n    }\n    return date1.getTime() - date2.getTime();\n}\nexport function compareTimes(date1, date2) {\n    return (3600 * (date1.getHours() - date2.getHours()) +\n        60 * (date1.getMinutes() - date2.getMinutes()) +\n        date1.getSeconds() -\n        date2.getSeconds());\n}\nexport const isBetween = (ts, ts1, ts2) => {\n    return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);\n};\nexport const duration = {\n    DAY: 86400000,\n};\nexport function getDefaultHours(config) {\n    let hours = config.defaultHour;\n    let minutes = config.defaultMinute;\n    let seconds = config.defaultSeconds;\n    if (config.minDate !== undefined) {\n        const minHour = config.minDate.getHours();\n        const minMinutes = config.minDate.getMinutes();\n        const minSeconds = config.minDate.getSeconds();\n        if (hours < minHour) {\n            hours = minHour;\n        }\n        if (hours === minHour && minutes < minMinutes) {\n            minutes = minMinutes;\n        }\n        if (hours === minHour && minutes === minMinutes && seconds < minSeconds)\n            seconds = config.minDate.getSeconds();\n    }\n    if (config.maxDate !== undefined) {\n        const maxHr = config.maxDate.getHours();\n        const maxMinutes = config.maxDate.getMinutes();\n        hours = Math.min(hours, maxHr);\n        if (hours === maxHr)\n            minutes = Math.min(maxMinutes, minutes);\n        if (hours === maxHr && minutes === maxMinutes)\n            seconds = config.maxDate.getSeconds();\n    }\n    return { hours, minutes, seconds };\n}\n","import { defaults as defaultOptions, HOOKS, } from \"./types/options\";\nimport English from \"./l10n/default\";\nimport { arrayify, debounce, int, pad } from \"./utils\";\nimport { clearNode, createElement, createNumberInput, findParent, toggleClass, getEventTarget, } from \"./utils/dom\";\nimport { compareDates, createDateParser, createDateFormatter, duration, isBetween, getDefaultHours, } from \"./utils/dates\";\nimport { tokenRegex, monthToStr } from \"./utils/formatting\";\nimport \"./utils/polyfills\";\nconst DEBOUNCED_CHANGE_MS = 300;\nfunction FlatpickrInstance(element, instanceConfig) {\n    const self = {\n        config: Object.assign(Object.assign({}, defaultOptions), flatpickr.defaultConfig),\n        l10n: English,\n    };\n    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    self._handlers = [];\n    self.pluginElements = [];\n    self.loadedPlugins = [];\n    self._bind = bind;\n    self._setHoursFromDate = setHoursFromDate;\n    self._positionCalendar = positionCalendar;\n    self.changeMonth = changeMonth;\n    self.changeYear = changeYear;\n    self.clear = clear;\n    self.close = close;\n    self._createElement = createElement;\n    self.destroy = destroy;\n    self.isEnabled = isEnabled;\n    self.jumpToDate = jumpToDate;\n    self.open = open;\n    self.redraw = redraw;\n    self.set = set;\n    self.setDate = setDate;\n    self.toggle = toggle;\n    function setupHelperFunctions() {\n        self.utils = {\n            getDaysInMonth(month = self.currentMonth, yr = self.currentYear) {\n                if (month === 1 && ((yr % 4 === 0 && yr % 100 !== 0) || yr % 400 === 0))\n                    return 29;\n                return self.l10n.daysInMonth[month];\n            },\n        };\n    }\n    function init() {\n        self.element = self.input = element;\n        self.isOpen = false;\n        parseConfig();\n        setupLocale();\n        setupInputs();\n        setupDates();\n        setupHelperFunctions();\n        if (!self.isMobile)\n            build();\n        bindEvents();\n        if (self.selectedDates.length || self.config.noCalendar) {\n            if (self.config.enableTime) {\n                setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : undefined);\n            }\n            updateValue(false);\n        }\n        setCalendarWidth();\n        const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        if (!self.isMobile && isSafari) {\n            positionCalendar();\n        }\n        triggerEvent(\"onReady\");\n    }\n    function bindToInstance(fn) {\n        return fn.bind(self);\n    }\n    function setCalendarWidth() {\n        const config = self.config;\n        if (config.weekNumbers === false && config.showMonths === 1) {\n            return;\n        }\n        else if (config.noCalendar !== true) {\n            window.requestAnimationFrame(function () {\n                if (self.calendarContainer !== undefined) {\n                    self.calendarContainer.style.visibility = \"hidden\";\n                    self.calendarContainer.style.display = \"block\";\n                }\n                if (self.daysContainer !== undefined) {\n                    const daysWidth = (self.days.offsetWidth + 1) * config.showMonths;\n                    self.daysContainer.style.width = daysWidth + \"px\";\n                    self.calendarContainer.style.width =\n                        daysWidth +\n                            (self.weekWrapper !== undefined\n                                ? self.weekWrapper.offsetWidth\n                                : 0) +\n                            \"px\";\n                    self.calendarContainer.style.removeProperty(\"visibility\");\n                    self.calendarContainer.style.removeProperty(\"display\");\n                }\n            });\n        }\n    }\n    function updateTime(e) {\n        if (self.selectedDates.length === 0) {\n            const defaultDate = self.config.minDate === undefined ||\n                compareDates(new Date(), self.config.minDate) >= 0\n                ? new Date()\n                : new Date(self.config.minDate.getTime());\n            const defaults = getDefaultHours(self.config);\n            defaultDate.setHours(defaults.hours, defaults.minutes, defaults.seconds, defaultDate.getMilliseconds());\n            self.selectedDates = [defaultDate];\n            self.latestSelectedDateObj = defaultDate;\n        }\n        if (e !== undefined && e.type !== \"blur\") {\n            timeWrapper(e);\n        }\n        const prevValue = self._input.value;\n        setHoursFromInputs();\n        updateValue();\n        if (self._input.value !== prevValue) {\n            self._debouncedChange();\n        }\n    }\n    function ampm2military(hour, amPM) {\n        return (hour % 12) + 12 * int(amPM === self.l10n.amPM[1]);\n    }\n    function military2ampm(hour) {\n        switch (hour % 24) {\n            case 0:\n            case 12:\n                return 12;\n            default:\n                return hour % 12;\n        }\n    }\n    function setHoursFromInputs() {\n        if (self.hourElement === undefined || self.minuteElement === undefined)\n            return;\n        let hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== undefined\n            ? (parseInt(self.secondElement.value, 10) || 0) % 60\n            : 0;\n        if (self.amPM !== undefined) {\n            hours = ampm2military(hours, self.amPM.textContent);\n        }\n        const limitMinHours = self.config.minTime !== undefined ||\n            (self.config.minDate &&\n                self.minDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.minDate, true) ===\n                    0);\n        const limitMaxHours = self.config.maxTime !== undefined ||\n            (self.config.maxDate &&\n                self.maxDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.maxDate, true) ===\n                    0);\n        if (limitMaxHours) {\n            const maxTime = self.config.maxTime !== undefined\n                ? self.config.maxTime\n                : self.config.maxDate;\n            hours = Math.min(hours, maxTime.getHours());\n            if (hours === maxTime.getHours())\n                minutes = Math.min(minutes, maxTime.getMinutes());\n            if (minutes === maxTime.getMinutes())\n                seconds = Math.min(seconds, maxTime.getSeconds());\n        }\n        if (limitMinHours) {\n            const minTime = self.config.minTime !== undefined\n                ? self.config.minTime\n                : self.config.minDate;\n            hours = Math.max(hours, minTime.getHours());\n            if (hours === minTime.getHours() && minutes < minTime.getMinutes())\n                minutes = minTime.getMinutes();\n            if (minutes === minTime.getMinutes())\n                seconds = Math.max(seconds, minTime.getSeconds());\n        }\n        setHours(hours, minutes, seconds);\n    }\n    function setHoursFromDate(dateObj) {\n        const date = dateObj || self.latestSelectedDateObj;\n        if (date) {\n            setHours(date.getHours(), date.getMinutes(), date.getSeconds());\n        }\n    }\n    function setHours(hours, minutes, seconds) {\n        if (self.latestSelectedDateObj !== undefined) {\n            self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);\n        }\n        if (!self.hourElement || !self.minuteElement || self.isMobile)\n            return;\n        self.hourElement.value = pad(!self.config.time_24hr\n            ? ((12 + hours) % 12) + 12 * int(hours % 12 === 0)\n            : hours);\n        self.minuteElement.value = pad(minutes);\n        if (self.amPM !== undefined)\n            self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];\n        if (self.secondElement !== undefined)\n            self.secondElement.value = pad(seconds);\n    }\n    function onYearInput(event) {\n        const eventTarget = getEventTarget(event);\n        const year = parseInt(eventTarget.value) + (event.delta || 0);\n        if (year / 1000 > 1 ||\n            (event.key === \"Enter\" && !/[^\\d]/.test(year.toString()))) {\n            changeYear(year);\n        }\n    }\n    function bind(element, event, handler, options) {\n        if (event instanceof Array)\n            return event.forEach((ev) => bind(element, ev, handler, options));\n        if (element instanceof Array)\n            return element.forEach((el) => bind(el, event, handler, options));\n        element.addEventListener(event, handler, options);\n        self._handlers.push({\n            remove: () => element.removeEventListener(event, handler),\n        });\n    }\n    function triggerChange() {\n        triggerEvent(\"onChange\");\n    }\n    function bindEvents() {\n        if (self.config.wrap) {\n            [\"open\", \"close\", \"toggle\", \"clear\"].forEach((evt) => {\n                Array.prototype.forEach.call(self.element.querySelectorAll(`[data-${evt}]`), (el) => bind(el, \"click\", self[evt]));\n            });\n        }\n        if (self.isMobile) {\n            setupMobile();\n            return;\n        }\n        const debouncedResize = debounce(onResize, 50);\n        self._debouncedChange = debounce(triggerChange, DEBOUNCED_CHANGE_MS);\n        if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))\n            bind(self.daysContainer, \"mouseover\", (e) => {\n                if (self.config.mode === \"range\")\n                    onMouseOver(getEventTarget(e));\n            });\n        bind(window.document.body, \"keydown\", onKeyDown);\n        if (!self.config.inline && !self.config.static)\n            bind(window, \"resize\", debouncedResize);\n        if (window.ontouchstart !== undefined)\n            bind(window.document, \"touchstart\", documentClick);\n        else\n            bind(window.document, \"mousedown\", documentClick);\n        bind(window.document, \"focus\", documentClick, { capture: true });\n        if (self.config.clickOpens === true) {\n            bind(self._input, \"focus\", self.open);\n            bind(self._input, \"click\", self.open);\n        }\n        if (self.daysContainer !== undefined) {\n            bind(self.monthNav, \"click\", onMonthNavClick);\n            bind(self.monthNav, [\"keyup\", \"increment\"], onYearInput);\n            bind(self.daysContainer, \"click\", selectDate);\n        }\n        if (self.timeContainer !== undefined &&\n            self.minuteElement !== undefined &&\n            self.hourElement !== undefined) {\n            const selText = (e) => getEventTarget(e).select();\n            bind(self.timeContainer, [\"increment\"], updateTime);\n            bind(self.timeContainer, \"blur\", updateTime, { capture: true });\n            bind(self.timeContainer, \"click\", timeIncrement);\n            bind([self.hourElement, self.minuteElement], [\"focus\", \"click\"], selText);\n            if (self.secondElement !== undefined)\n                bind(self.secondElement, \"focus\", () => self.secondElement && self.secondElement.select());\n            if (self.amPM !== undefined) {\n                bind(self.amPM, \"click\", (e) => {\n                    updateTime(e);\n                    triggerChange();\n                });\n            }\n        }\n        if (self.config.allowInput) {\n            bind(self._input, \"blur\", onBlur);\n        }\n    }\n    function jumpToDate(jumpDate, triggerChange) {\n        const jumpTo = jumpDate !== undefined\n            ? self.parseDate(jumpDate)\n            : self.latestSelectedDateObj ||\n                (self.config.minDate && self.config.minDate > self.now\n                    ? self.config.minDate\n                    : self.config.maxDate && self.config.maxDate < self.now\n                        ? self.config.maxDate\n                        : self.now);\n        const oldYear = self.currentYear;\n        const oldMonth = self.currentMonth;\n        try {\n            if (jumpTo !== undefined) {\n                self.currentYear = jumpTo.getFullYear();\n                self.currentMonth = jumpTo.getMonth();\n            }\n        }\n        catch (e) {\n            e.message = \"Invalid date supplied: \" + jumpTo;\n            self.config.errorHandler(e);\n        }\n        if (triggerChange && self.currentYear !== oldYear) {\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        if (triggerChange &&\n            (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {\n            triggerEvent(\"onMonthChange\");\n        }\n        self.redraw();\n    }\n    function timeIncrement(e) {\n        const eventTarget = getEventTarget(e);\n        if (~eventTarget.className.indexOf(\"arrow\"))\n            incrementNumInput(e, eventTarget.classList.contains(\"arrowUp\") ? 1 : -1);\n    }\n    function incrementNumInput(e, delta, inputElem) {\n        const target = e && getEventTarget(e);\n        const input = inputElem ||\n            (target && target.parentNode && target.parentNode.firstChild);\n        const event = createEvent(\"increment\");\n        event.delta = delta;\n        input && input.dispatchEvent(event);\n    }\n    function build() {\n        const fragment = window.document.createDocumentFragment();\n        self.calendarContainer = createElement(\"div\", \"flatpickr-calendar\");\n        self.calendarContainer.tabIndex = -1;\n        if (!self.config.noCalendar) {\n            fragment.appendChild(buildMonthNav());\n            self.innerContainer = createElement(\"div\", \"flatpickr-innerContainer\");\n            if (self.config.weekNumbers) {\n                const { weekWrapper, weekNumbers } = buildWeeks();\n                self.innerContainer.appendChild(weekWrapper);\n                self.weekNumbers = weekNumbers;\n                self.weekWrapper = weekWrapper;\n            }\n            self.rContainer = createElement(\"div\", \"flatpickr-rContainer\");\n            self.rContainer.appendChild(buildWeekdays());\n            if (!self.daysContainer) {\n                self.daysContainer = createElement(\"div\", \"flatpickr-days\");\n                self.daysContainer.tabIndex = -1;\n            }\n            buildDays();\n            self.rContainer.appendChild(self.daysContainer);\n            self.innerContainer.appendChild(self.rContainer);\n            fragment.appendChild(self.innerContainer);\n        }\n        if (self.config.enableTime) {\n            fragment.appendChild(buildTime());\n        }\n        toggleClass(self.calendarContainer, \"rangeMode\", self.config.mode === \"range\");\n        toggleClass(self.calendarContainer, \"animate\", self.config.animate === true);\n        toggleClass(self.calendarContainer, \"multiMonth\", self.config.showMonths > 1);\n        self.calendarContainer.appendChild(fragment);\n        const customAppend = self.config.appendTo !== undefined &&\n            self.config.appendTo.nodeType !== undefined;\n        if (self.config.inline || self.config.static) {\n            self.calendarContainer.classList.add(self.config.inline ? \"inline\" : \"static\");\n            if (self.config.inline) {\n                if (!customAppend && self.element.parentNode)\n                    self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);\n                else if (self.config.appendTo !== undefined)\n                    self.config.appendTo.appendChild(self.calendarContainer);\n            }\n            if (self.config.static) {\n                const wrapper = createElement(\"div\", \"flatpickr-wrapper\");\n                if (self.element.parentNode)\n                    self.element.parentNode.insertBefore(wrapper, self.element);\n                wrapper.appendChild(self.element);\n                if (self.altInput)\n                    wrapper.appendChild(self.altInput);\n                wrapper.appendChild(self.calendarContainer);\n            }\n        }\n        if (!self.config.static && !self.config.inline)\n            (self.config.appendTo !== undefined\n                ? self.config.appendTo\n                : window.document.body).appendChild(self.calendarContainer);\n    }\n    function createDay(className, date, dayNumber, i) {\n        const dateIsEnabled = isEnabled(date, true), dayElement = createElement(\"span\", \"flatpickr-day \" + className, date.getDate().toString());\n        dayElement.dateObj = date;\n        dayElement.$i = i;\n        dayElement.setAttribute(\"aria-label\", self.formatDate(date, self.config.ariaDateFormat));\n        if (className.indexOf(\"hidden\") === -1 &&\n            compareDates(date, self.now) === 0) {\n            self.todayDateElem = dayElement;\n            dayElement.classList.add(\"today\");\n            dayElement.setAttribute(\"aria-current\", \"date\");\n        }\n        if (dateIsEnabled) {\n            dayElement.tabIndex = -1;\n            if (isDateSelected(date)) {\n                dayElement.classList.add(\"selected\");\n                self.selectedDateElem = dayElement;\n                if (self.config.mode === \"range\") {\n                    toggleClass(dayElement, \"startRange\", self.selectedDates[0] &&\n                        compareDates(date, self.selectedDates[0], true) === 0);\n                    toggleClass(dayElement, \"endRange\", self.selectedDates[1] &&\n                        compareDates(date, self.selectedDates[1], true) === 0);\n                    if (className === \"nextMonthDay\")\n                        dayElement.classList.add(\"inRange\");\n                }\n            }\n        }\n        else {\n            dayElement.classList.add(\"flatpickr-disabled\");\n        }\n        if (self.config.mode === \"range\") {\n            if (isDateInRange(date) && !isDateSelected(date))\n                dayElement.classList.add(\"inRange\");\n        }\n        if (self.weekNumbers &&\n            self.config.showMonths === 1 &&\n            className !== \"prevMonthDay\" &&\n            dayNumber % 7 === 1) {\n            self.weekNumbers.insertAdjacentHTML(\"beforeend\", \"<span class='flatpickr-day'>\" + self.config.getWeek(date) + \"</span>\");\n        }\n        triggerEvent(\"onDayCreate\", dayElement);\n        return dayElement;\n    }\n    function focusOnDayElem(targetNode) {\n        targetNode.focus();\n        if (self.config.mode === \"range\")\n            onMouseOver(targetNode);\n    }\n    function getFirstAvailableDay(delta) {\n        const startMonth = delta > 0 ? 0 : self.config.showMonths - 1;\n        const endMonth = delta > 0 ? self.config.showMonths : -1;\n        for (let m = startMonth; m != endMonth; m += delta) {\n            const month = self.daysContainer.children[m];\n            const startIndex = delta > 0 ? 0 : month.children.length - 1;\n            const endIndex = delta > 0 ? month.children.length : -1;\n            for (let i = startIndex; i != endIndex; i += delta) {\n                const c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 && isEnabled(c.dateObj))\n                    return c;\n            }\n        }\n        return undefined;\n    }\n    function getNextAvailableDay(current, delta) {\n        const givenMonth = current.className.indexOf(\"Month\") === -1\n            ? current.dateObj.getMonth()\n            : self.currentMonth;\n        const endMonth = delta > 0 ? self.config.showMonths : -1;\n        const loopDelta = delta > 0 ? 1 : -1;\n        for (let m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {\n            const month = self.daysContainer.children[m];\n            const startIndex = givenMonth - self.currentMonth === m\n                ? current.$i + delta\n                : delta < 0\n                    ? month.children.length - 1\n                    : 0;\n            const numMonthDays = month.children.length;\n            for (let i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {\n                const c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 &&\n                    isEnabled(c.dateObj) &&\n                    Math.abs(current.$i - i) >= Math.abs(delta))\n                    return focusOnDayElem(c);\n            }\n        }\n        self.changeMonth(loopDelta);\n        focusOnDay(getFirstAvailableDay(loopDelta), 0);\n        return undefined;\n    }\n    function focusOnDay(current, offset) {\n        const dayFocused = isInView(document.activeElement || document.body);\n        const startElem = current !== undefined\n            ? current\n            : dayFocused\n                ? document.activeElement\n                : self.selectedDateElem !== undefined && isInView(self.selectedDateElem)\n                    ? self.selectedDateElem\n                    : self.todayDateElem !== undefined && isInView(self.todayDateElem)\n                        ? self.todayDateElem\n                        : getFirstAvailableDay(offset > 0 ? 1 : -1);\n        if (startElem === undefined) {\n            self._input.focus();\n        }\n        else if (!dayFocused) {\n            focusOnDayElem(startElem);\n        }\n        else {\n            getNextAvailableDay(startElem, offset);\n        }\n    }\n    function buildMonthDays(year, month) {\n        const firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;\n        const prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);\n        const daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? \"prevMonthDay hidden\" : \"prevMonthDay\", nextMonthDayClass = isMultiMonth ? \"nextMonthDay hidden\" : \"nextMonthDay\";\n        let dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;\n        for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));\n        }\n        for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(\"\", new Date(year, month, dayNumber), dayNumber, dayIndex));\n        }\n        for (let dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth &&\n            (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {\n            days.appendChild(createDay(nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));\n        }\n        const dayContainer = createElement(\"div\", \"dayContainer\");\n        dayContainer.appendChild(days);\n        return dayContainer;\n    }\n    function buildDays() {\n        if (self.daysContainer === undefined) {\n            return;\n        }\n        clearNode(self.daysContainer);\n        if (self.weekNumbers)\n            clearNode(self.weekNumbers);\n        const frag = document.createDocumentFragment();\n        for (let i = 0; i < self.config.showMonths; i++) {\n            const d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));\n        }\n        self.daysContainer.appendChild(frag);\n        self.days = self.daysContainer.firstChild;\n        if (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n            onMouseOver();\n        }\n    }\n    function buildMonthSwitch() {\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType !== \"dropdown\")\n            return;\n        const shouldBuildMonth = function (month) {\n            if (self.config.minDate !== undefined &&\n                self.currentYear === self.config.minDate.getFullYear() &&\n                month < self.config.minDate.getMonth()) {\n                return false;\n            }\n            return !(self.config.maxDate !== undefined &&\n                self.currentYear === self.config.maxDate.getFullYear() &&\n                month > self.config.maxDate.getMonth());\n        };\n        self.monthsDropdownContainer.tabIndex = -1;\n        self.monthsDropdownContainer.innerHTML = \"\";\n        for (let i = 0; i < 12; i++) {\n            if (!shouldBuildMonth(i))\n                continue;\n            const month = createElement(\"option\", \"flatpickr-monthDropdown-month\");\n            month.value = new Date(self.currentYear, i).getMonth().toString();\n            month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);\n            month.tabIndex = -1;\n            if (self.currentMonth === i) {\n                month.selected = true;\n            }\n            self.monthsDropdownContainer.appendChild(month);\n        }\n    }\n    function buildMonth() {\n        const container = createElement(\"div\", \"flatpickr-month\");\n        const monthNavFragment = window.document.createDocumentFragment();\n        let monthElement;\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType === \"static\") {\n            monthElement = createElement(\"span\", \"cur-month\");\n        }\n        else {\n            self.monthsDropdownContainer = createElement(\"select\", \"flatpickr-monthDropdown-months\");\n            self.monthsDropdownContainer.setAttribute(\"aria-label\", self.l10n.monthAriaLabel);\n            bind(self.monthsDropdownContainer, \"change\", (e) => {\n                const target = getEventTarget(e);\n                const selectedMonth = parseInt(target.value, 10);\n                self.changeMonth(selectedMonth - self.currentMonth);\n                triggerEvent(\"onMonthChange\");\n            });\n            buildMonthSwitch();\n            monthElement = self.monthsDropdownContainer;\n        }\n        const yearInput = createNumberInput(\"cur-year\", { tabindex: \"-1\" });\n        const yearElement = yearInput.getElementsByTagName(\"input\")[0];\n        yearElement.setAttribute(\"aria-label\", self.l10n.yearAriaLabel);\n        if (self.config.minDate) {\n            yearElement.setAttribute(\"min\", self.config.minDate.getFullYear().toString());\n        }\n        if (self.config.maxDate) {\n            yearElement.setAttribute(\"max\", self.config.maxDate.getFullYear().toString());\n            yearElement.disabled =\n                !!self.config.minDate &&\n                    self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();\n        }\n        const currentMonth = createElement(\"div\", \"flatpickr-current-month\");\n        currentMonth.appendChild(monthElement);\n        currentMonth.appendChild(yearInput);\n        monthNavFragment.appendChild(currentMonth);\n        container.appendChild(monthNavFragment);\n        return {\n            container,\n            yearElement,\n            monthElement,\n        };\n    }\n    function buildMonths() {\n        clearNode(self.monthNav);\n        self.monthNav.appendChild(self.prevMonthNav);\n        if (self.config.showMonths) {\n            self.yearElements = [];\n            self.monthElements = [];\n        }\n        for (let m = self.config.showMonths; m--;) {\n            const month = buildMonth();\n            self.yearElements.push(month.yearElement);\n            self.monthElements.push(month.monthElement);\n            self.monthNav.appendChild(month.container);\n        }\n        self.monthNav.appendChild(self.nextMonthNav);\n    }\n    function buildMonthNav() {\n        self.monthNav = createElement(\"div\", \"flatpickr-months\");\n        self.yearElements = [];\n        self.monthElements = [];\n        self.prevMonthNav = createElement(\"span\", \"flatpickr-prev-month\");\n        self.prevMonthNav.innerHTML = self.config.prevArrow;\n        self.nextMonthNav = createElement(\"span\", \"flatpickr-next-month\");\n        self.nextMonthNav.innerHTML = self.config.nextArrow;\n        buildMonths();\n        Object.defineProperty(self, \"_hidePrevMonthArrow\", {\n            get: () => self.__hidePrevMonthArrow,\n            set(bool) {\n                if (self.__hidePrevMonthArrow !== bool) {\n                    toggleClass(self.prevMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hidePrevMonthArrow = bool;\n                }\n            },\n        });\n        Object.defineProperty(self, \"_hideNextMonthArrow\", {\n            get: () => self.__hideNextMonthArrow,\n            set(bool) {\n                if (self.__hideNextMonthArrow !== bool) {\n                    toggleClass(self.nextMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hideNextMonthArrow = bool;\n                }\n            },\n        });\n        self.currentYearElement = self.yearElements[0];\n        updateNavigationCurrentMonth();\n        return self.monthNav;\n    }\n    function buildTime() {\n        self.calendarContainer.classList.add(\"hasTime\");\n        if (self.config.noCalendar)\n            self.calendarContainer.classList.add(\"noCalendar\");\n        const defaults = getDefaultHours(self.config);\n        self.timeContainer = createElement(\"div\", \"flatpickr-time\");\n        self.timeContainer.tabIndex = -1;\n        const separator = createElement(\"span\", \"flatpickr-time-separator\", \":\");\n        const hourInput = createNumberInput(\"flatpickr-hour\", {\n            \"aria-label\": self.l10n.hourAriaLabel,\n        });\n        self.hourElement = hourInput.getElementsByTagName(\"input\")[0];\n        const minuteInput = createNumberInput(\"flatpickr-minute\", {\n            \"aria-label\": self.l10n.minuteAriaLabel,\n        });\n        self.minuteElement = minuteInput.getElementsByTagName(\"input\")[0];\n        self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;\n        self.hourElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getHours()\n            : self.config.time_24hr\n                ? defaults.hours\n                : military2ampm(defaults.hours));\n        self.minuteElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getMinutes()\n            : defaults.minutes);\n        self.hourElement.setAttribute(\"step\", self.config.hourIncrement.toString());\n        self.minuteElement.setAttribute(\"step\", self.config.minuteIncrement.toString());\n        self.hourElement.setAttribute(\"min\", self.config.time_24hr ? \"0\" : \"1\");\n        self.hourElement.setAttribute(\"max\", self.config.time_24hr ? \"23\" : \"12\");\n        self.hourElement.setAttribute(\"maxlength\", \"2\");\n        self.minuteElement.setAttribute(\"min\", \"0\");\n        self.minuteElement.setAttribute(\"max\", \"59\");\n        self.minuteElement.setAttribute(\"maxlength\", \"2\");\n        self.timeContainer.appendChild(hourInput);\n        self.timeContainer.appendChild(separator);\n        self.timeContainer.appendChild(minuteInput);\n        if (self.config.time_24hr)\n            self.timeContainer.classList.add(\"time24hr\");\n        if (self.config.enableSeconds) {\n            self.timeContainer.classList.add(\"hasSeconds\");\n            const secondInput = createNumberInput(\"flatpickr-second\");\n            self.secondElement = secondInput.getElementsByTagName(\"input\")[0];\n            self.secondElement.value = pad(self.latestSelectedDateObj\n                ? self.latestSelectedDateObj.getSeconds()\n                : defaults.seconds);\n            self.secondElement.setAttribute(\"step\", self.minuteElement.getAttribute(\"step\"));\n            self.secondElement.setAttribute(\"min\", \"0\");\n            self.secondElement.setAttribute(\"max\", \"59\");\n            self.secondElement.setAttribute(\"maxlength\", \"2\");\n            self.timeContainer.appendChild(createElement(\"span\", \"flatpickr-time-separator\", \":\"));\n            self.timeContainer.appendChild(secondInput);\n        }\n        if (!self.config.time_24hr) {\n            self.amPM = createElement(\"span\", \"flatpickr-am-pm\", self.l10n.amPM[int((self.latestSelectedDateObj\n                ? self.hourElement.value\n                : self.config.defaultHour) > 11)]);\n            self.amPM.title = self.l10n.toggleTitle;\n            self.amPM.tabIndex = -1;\n            self.timeContainer.appendChild(self.amPM);\n        }\n        return self.timeContainer;\n    }\n    function buildWeekdays() {\n        if (!self.weekdayContainer)\n            self.weekdayContainer = createElement(\"div\", \"flatpickr-weekdays\");\n        else\n            clearNode(self.weekdayContainer);\n        for (let i = self.config.showMonths; i--;) {\n            const container = createElement(\"div\", \"flatpickr-weekdaycontainer\");\n            self.weekdayContainer.appendChild(container);\n        }\n        updateWeekdays();\n        return self.weekdayContainer;\n    }\n    function updateWeekdays() {\n        if (!self.weekdayContainer) {\n            return;\n        }\n        const firstDayOfWeek = self.l10n.firstDayOfWeek;\n        let weekdays = [...self.l10n.weekdays.shorthand];\n        if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {\n            weekdays = [\n                ...weekdays.splice(firstDayOfWeek, weekdays.length),\n                ...weekdays.splice(0, firstDayOfWeek),\n            ];\n        }\n        for (let i = self.config.showMonths; i--;) {\n            self.weekdayContainer.children[i].innerHTML = `\n      <span class='flatpickr-weekday'>\n        ${weekdays.join(\"</span><span class='flatpickr-weekday'>\")}\n      </span>\n      `;\n        }\n    }\n    function buildWeeks() {\n        self.calendarContainer.classList.add(\"hasWeeks\");\n        const weekWrapper = createElement(\"div\", \"flatpickr-weekwrapper\");\n        weekWrapper.appendChild(createElement(\"span\", \"flatpickr-weekday\", self.l10n.weekAbbreviation));\n        const weekNumbers = createElement(\"div\", \"flatpickr-weeks\");\n        weekWrapper.appendChild(weekNumbers);\n        return {\n            weekWrapper,\n            weekNumbers,\n        };\n    }\n    function changeMonth(value, isOffset = true) {\n        const delta = isOffset ? value : value - self.currentMonth;\n        if ((delta < 0 && self._hidePrevMonthArrow === true) ||\n            (delta > 0 && self._hideNextMonthArrow === true))\n            return;\n        self.currentMonth += delta;\n        if (self.currentMonth < 0 || self.currentMonth > 11) {\n            self.currentYear += self.currentMonth > 11 ? 1 : -1;\n            self.currentMonth = (self.currentMonth + 12) % 12;\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        buildDays();\n        triggerEvent(\"onMonthChange\");\n        updateNavigationCurrentMonth();\n    }\n    function clear(triggerChangeEvent = true, toInitial = true) {\n        self.input.value = \"\";\n        if (self.altInput !== undefined)\n            self.altInput.value = \"\";\n        if (self.mobileInput !== undefined)\n            self.mobileInput.value = \"\";\n        self.selectedDates = [];\n        self.latestSelectedDateObj = undefined;\n        if (toInitial === true) {\n            self.currentYear = self._initialDate.getFullYear();\n            self.currentMonth = self._initialDate.getMonth();\n        }\n        if (self.config.enableTime === true) {\n            const { hours, minutes, seconds } = getDefaultHours(self.config);\n            setHours(hours, minutes, seconds);\n        }\n        self.redraw();\n        if (triggerChangeEvent)\n            triggerEvent(\"onChange\");\n    }\n    function close() {\n        self.isOpen = false;\n        if (!self.isMobile) {\n            if (self.calendarContainer !== undefined) {\n                self.calendarContainer.classList.remove(\"open\");\n            }\n            if (self._input !== undefined) {\n                self._input.classList.remove(\"active\");\n            }\n        }\n        triggerEvent(\"onClose\");\n    }\n    function destroy() {\n        if (self.config !== undefined)\n            triggerEvent(\"onDestroy\");\n        for (let i = self._handlers.length; i--;) {\n            self._handlers[i].remove();\n        }\n        self._handlers = [];\n        if (self.mobileInput) {\n            if (self.mobileInput.parentNode)\n                self.mobileInput.parentNode.removeChild(self.mobileInput);\n            self.mobileInput = undefined;\n        }\n        else if (self.calendarContainer && self.calendarContainer.parentNode) {\n            if (self.config.static && self.calendarContainer.parentNode) {\n                const wrapper = self.calendarContainer.parentNode;\n                wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);\n                if (wrapper.parentNode) {\n                    while (wrapper.firstChild)\n                        wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);\n                    wrapper.parentNode.removeChild(wrapper);\n                }\n            }\n            else\n                self.calendarContainer.parentNode.removeChild(self.calendarContainer);\n        }\n        if (self.altInput) {\n            self.input.type = \"text\";\n            if (self.altInput.parentNode)\n                self.altInput.parentNode.removeChild(self.altInput);\n            delete self.altInput;\n        }\n        if (self.input) {\n            self.input.type = self.input._type;\n            self.input.classList.remove(\"flatpickr-input\");\n            self.input.removeAttribute(\"readonly\");\n        }\n        [\n            \"_showTimeInput\",\n            \"latestSelectedDateObj\",\n            \"_hideNextMonthArrow\",\n            \"_hidePrevMonthArrow\",\n            \"__hideNextMonthArrow\",\n            \"__hidePrevMonthArrow\",\n            \"isMobile\",\n            \"isOpen\",\n            \"selectedDateElem\",\n            \"minDateHasTime\",\n            \"maxDateHasTime\",\n            \"days\",\n            \"daysContainer\",\n            \"_input\",\n            \"_positionElement\",\n            \"innerContainer\",\n            \"rContainer\",\n            \"monthNav\",\n            \"todayDateElem\",\n            \"calendarContainer\",\n            \"weekdayContainer\",\n            \"prevMonthNav\",\n            \"nextMonthNav\",\n            \"monthsDropdownContainer\",\n            \"currentMonthElement\",\n            \"currentYearElement\",\n            \"navigationCurrentMonth\",\n            \"selectedDateElem\",\n            \"config\",\n        ].forEach((k) => {\n            try {\n                delete self[k];\n            }\n            catch (_) { }\n        });\n    }\n    function isCalendarElem(elem) {\n        if (self.config.appendTo && self.config.appendTo.contains(elem))\n            return true;\n        return self.calendarContainer.contains(elem);\n    }\n    function documentClick(e) {\n        if (self.isOpen && !self.config.inline) {\n            const eventTarget = getEventTarget(e);\n            const isCalendarElement = isCalendarElem(eventTarget);\n            const isInput = eventTarget === self.input ||\n                eventTarget === self.altInput ||\n                self.element.contains(eventTarget) ||\n                (e.path &&\n                    e.path.indexOf &&\n                    (~e.path.indexOf(self.input) ||\n                        ~e.path.indexOf(self.altInput)));\n            const lostFocus = e.type === \"blur\"\n                ? isInput &&\n                    e.relatedTarget &&\n                    !isCalendarElem(e.relatedTarget)\n                : !isInput &&\n                    !isCalendarElement &&\n                    !isCalendarElem(e.relatedTarget);\n            const isIgnored = !self.config.ignoredFocusElements.some((elem) => elem.contains(eventTarget));\n            if (lostFocus && isIgnored) {\n                if (self.timeContainer !== undefined &&\n                    self.minuteElement !== undefined &&\n                    self.hourElement !== undefined &&\n                    self.input.value !== \"\" &&\n                    self.input.value !== undefined) {\n                    updateTime();\n                }\n                self.close();\n                if (self.config &&\n                    self.config.mode === \"range\" &&\n                    self.selectedDates.length === 1) {\n                    self.clear(false);\n                    self.redraw();\n                }\n            }\n        }\n    }\n    function changeYear(newYear) {\n        if (!newYear ||\n            (self.config.minDate && newYear < self.config.minDate.getFullYear()) ||\n            (self.config.maxDate && newYear > self.config.maxDate.getFullYear()))\n            return;\n        const newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;\n        self.currentYear = newYearNum || self.currentYear;\n        if (self.config.maxDate &&\n            self.currentYear === self.config.maxDate.getFullYear()) {\n            self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);\n        }\n        else if (self.config.minDate &&\n            self.currentYear === self.config.minDate.getFullYear()) {\n            self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);\n        }\n        if (isNewYear) {\n            self.redraw();\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n    }\n    function isEnabled(date, timeless = true) {\n        var _a;\n        const dateToCheck = self.parseDate(date, undefined, timeless);\n        if ((self.config.minDate &&\n            dateToCheck &&\n            compareDates(dateToCheck, self.config.minDate, timeless !== undefined ? timeless : !self.minDateHasTime) < 0) ||\n            (self.config.maxDate &&\n                dateToCheck &&\n                compareDates(dateToCheck, self.config.maxDate, timeless !== undefined ? timeless : !self.maxDateHasTime) > 0))\n            return false;\n        if (!self.config.enable && self.config.disable.length === 0)\n            return true;\n        if (dateToCheck === undefined)\n            return false;\n        const bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;\n        for (let i = 0, d; i < array.length; i++) {\n            d = array[i];\n            if (typeof d === \"function\" &&\n                d(dateToCheck))\n                return bool;\n            else if (d instanceof Date &&\n                dateToCheck !== undefined &&\n                d.getTime() === dateToCheck.getTime())\n                return bool;\n            else if (typeof d === \"string\") {\n                const parsed = self.parseDate(d, undefined, true);\n                return parsed && parsed.getTime() === dateToCheck.getTime()\n                    ? bool\n                    : !bool;\n            }\n            else if (typeof d === \"object\" &&\n                dateToCheck !== undefined &&\n                d.from &&\n                d.to &&\n                dateToCheck.getTime() >= d.from.getTime() &&\n                dateToCheck.getTime() <= d.to.getTime())\n                return bool;\n        }\n        return !bool;\n    }\n    function isInView(elem) {\n        if (self.daysContainer !== undefined)\n            return (elem.className.indexOf(\"hidden\") === -1 &&\n                elem.className.indexOf(\"flatpickr-disabled\") === -1 &&\n                self.daysContainer.contains(elem));\n        return false;\n    }\n    function onBlur(e) {\n        const isInput = e.target === self._input;\n        if (isInput &&\n            (self.selectedDates.length > 0 || self._input.value.length > 0) &&\n            !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {\n            self.setDate(self._input.value, true, e.target === self.altInput\n                ? self.config.altFormat\n                : self.config.dateFormat);\n        }\n    }\n    function onKeyDown(e) {\n        const eventTarget = getEventTarget(e);\n        const isInput = self.config.wrap\n            ? element.contains(eventTarget)\n            : eventTarget === self._input;\n        const allowInput = self.config.allowInput;\n        const allowKeydown = self.isOpen && (!allowInput || !isInput);\n        const allowInlineKeydown = self.config.inline && isInput && !allowInput;\n        if (e.keyCode === 13 && isInput) {\n            if (allowInput) {\n                self.setDate(self._input.value, true, eventTarget === self.altInput\n                    ? self.config.altFormat\n                    : self.config.dateFormat);\n                return eventTarget.blur();\n            }\n            else {\n                self.open();\n            }\n        }\n        else if (isCalendarElem(eventTarget) ||\n            allowKeydown ||\n            allowInlineKeydown) {\n            const isTimeObj = !!self.timeContainer &&\n                self.timeContainer.contains(eventTarget);\n            switch (e.keyCode) {\n                case 13:\n                    if (isTimeObj) {\n                        e.preventDefault();\n                        updateTime();\n                        focusAndClose();\n                    }\n                    else\n                        selectDate(e);\n                    break;\n                case 27:\n                    e.preventDefault();\n                    focusAndClose();\n                    break;\n                case 8:\n                case 46:\n                    if (isInput && !self.config.allowInput) {\n                        e.preventDefault();\n                        self.clear();\n                    }\n                    break;\n                case 37:\n                case 39:\n                    if (!isTimeObj && !isInput) {\n                        e.preventDefault();\n                        if (self.daysContainer !== undefined &&\n                            (allowInput === false ||\n                                (document.activeElement && isInView(document.activeElement)))) {\n                            const delta = e.keyCode === 39 ? 1 : -1;\n                            if (!e.ctrlKey)\n                                focusOnDay(undefined, delta);\n                            else {\n                                e.stopPropagation();\n                                changeMonth(delta);\n                                focusOnDay(getFirstAvailableDay(1), 0);\n                            }\n                        }\n                    }\n                    else if (self.hourElement)\n                        self.hourElement.focus();\n                    break;\n                case 38:\n                case 40:\n                    e.preventDefault();\n                    const delta = e.keyCode === 40 ? 1 : -1;\n                    if ((self.daysContainer &&\n                        eventTarget.$i !== undefined) ||\n                        eventTarget === self.input ||\n                        eventTarget === self.altInput) {\n                        if (e.ctrlKey) {\n                            e.stopPropagation();\n                            changeYear(self.currentYear - delta);\n                            focusOnDay(getFirstAvailableDay(1), 0);\n                        }\n                        else if (!isTimeObj)\n                            focusOnDay(undefined, delta * 7);\n                    }\n                    else if (eventTarget === self.currentYearElement) {\n                        changeYear(self.currentYear - delta);\n                    }\n                    else if (self.config.enableTime) {\n                        if (!isTimeObj && self.hourElement)\n                            self.hourElement.focus();\n                        updateTime(e);\n                        self._debouncedChange();\n                    }\n                    break;\n                case 9:\n                    if (isTimeObj) {\n                        const elems = [\n                            self.hourElement,\n                            self.minuteElement,\n                            self.secondElement,\n                            self.amPM,\n                        ]\n                            .concat(self.pluginElements)\n                            .filter((x) => x);\n                        const i = elems.indexOf(eventTarget);\n                        if (i !== -1) {\n                            const target = elems[i + (e.shiftKey ? -1 : 1)];\n                            e.preventDefault();\n                            (target || self._input).focus();\n                        }\n                    }\n                    else if (!self.config.noCalendar &&\n                        self.daysContainer &&\n                        self.daysContainer.contains(eventTarget) &&\n                        e.shiftKey) {\n                        e.preventDefault();\n                        self._input.focus();\n                    }\n                    break;\n                default:\n                    break;\n            }\n        }\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            switch (e.key) {\n                case self.l10n.amPM[0].charAt(0):\n                case self.l10n.amPM[0].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[0];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n                case self.l10n.amPM[1].charAt(0):\n                case self.l10n.amPM[1].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[1];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n            }\n        }\n        if (isInput || isCalendarElem(eventTarget)) {\n            triggerEvent(\"onKeyDown\", e);\n        }\n    }\n    function onMouseOver(elem) {\n        if (self.selectedDates.length !== 1 ||\n            (elem &&\n                (!elem.classList.contains(\"flatpickr-day\") ||\n                    elem.classList.contains(\"flatpickr-disabled\"))))\n            return;\n        const hoverDate = elem\n            ? elem.dateObj.getTime()\n            : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], undefined, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());\n        let containsDisabled = false;\n        let minRange = 0, maxRange = 0;\n        for (let t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {\n            if (!isEnabled(new Date(t), true)) {\n                containsDisabled =\n                    containsDisabled || (t > rangeStartDate && t < rangeEndDate);\n                if (t < initialDate && (!minRange || t > minRange))\n                    minRange = t;\n                else if (t > initialDate && (!maxRange || t < maxRange))\n                    maxRange = t;\n            }\n        }\n        for (let m = 0; m < self.config.showMonths; m++) {\n            const month = self.daysContainer.children[m];\n            for (let i = 0, l = month.children.length; i < l; i++) {\n                const dayElem = month.children[i], date = dayElem.dateObj;\n                const timestamp = date.getTime();\n                const outOfRange = (minRange > 0 && timestamp < minRange) ||\n                    (maxRange > 0 && timestamp > maxRange);\n                if (outOfRange) {\n                    dayElem.classList.add(\"notAllowed\");\n                    [\"inRange\", \"startRange\", \"endRange\"].forEach((c) => {\n                        dayElem.classList.remove(c);\n                    });\n                    continue;\n                }\n                else if (containsDisabled && !outOfRange)\n                    continue;\n                [\"startRange\", \"inRange\", \"endRange\", \"notAllowed\"].forEach((c) => {\n                    dayElem.classList.remove(c);\n                });\n                if (elem !== undefined) {\n                    elem.classList.add(hoverDate <= self.selectedDates[0].getTime()\n                        ? \"startRange\"\n                        : \"endRange\");\n                    if (initialDate < hoverDate && timestamp === initialDate)\n                        dayElem.classList.add(\"startRange\");\n                    else if (initialDate > hoverDate && timestamp === initialDate)\n                        dayElem.classList.add(\"endRange\");\n                    if (timestamp >= minRange &&\n                        (maxRange === 0 || timestamp <= maxRange) &&\n                        isBetween(timestamp, initialDate, hoverDate))\n                        dayElem.classList.add(\"inRange\");\n                }\n            }\n        }\n    }\n    function onResize() {\n        if (self.isOpen && !self.config.static && !self.config.inline)\n            positionCalendar();\n    }\n    function open(e, positionElement = self._positionElement) {\n        if (self.isMobile === true) {\n            if (e) {\n                e.preventDefault();\n                const eventTarget = getEventTarget(e);\n                if (eventTarget) {\n                    eventTarget.blur();\n                }\n            }\n            if (self.mobileInput !== undefined) {\n                self.mobileInput.focus();\n                self.mobileInput.click();\n            }\n            triggerEvent(\"onOpen\");\n            return;\n        }\n        else if (self._input.disabled || self.config.inline) {\n            return;\n        }\n        const wasOpen = self.isOpen;\n        self.isOpen = true;\n        if (!wasOpen) {\n            self.calendarContainer.classList.add(\"open\");\n            self._input.classList.add(\"active\");\n            triggerEvent(\"onOpen\");\n            positionCalendar(positionElement);\n        }\n        if (self.config.enableTime === true && self.config.noCalendar === true) {\n            if (self.config.allowInput === false &&\n                (e === undefined ||\n                    !self.timeContainer.contains(e.relatedTarget))) {\n                setTimeout(() => self.hourElement.select(), 50);\n            }\n        }\n    }\n    function minMaxDateSetter(type) {\n        return (date) => {\n            const dateObj = (self.config[`_${type}Date`] = self.parseDate(date, self.config.dateFormat));\n            const inverseDateObj = self.config[`_${type === \"min\" ? \"max\" : \"min\"}Date`];\n            if (dateObj !== undefined) {\n                self[type === \"min\" ? \"minDateHasTime\" : \"maxDateHasTime\"] =\n                    dateObj.getHours() > 0 ||\n                        dateObj.getMinutes() > 0 ||\n                        dateObj.getSeconds() > 0;\n            }\n            if (self.selectedDates) {\n                self.selectedDates = self.selectedDates.filter((d) => isEnabled(d));\n                if (!self.selectedDates.length && type === \"min\")\n                    setHoursFromDate(dateObj);\n                updateValue();\n            }\n            if (self.daysContainer) {\n                redraw();\n                if (dateObj !== undefined)\n                    self.currentYearElement[type] = dateObj.getFullYear().toString();\n                else\n                    self.currentYearElement.removeAttribute(type);\n                self.currentYearElement.disabled =\n                    !!inverseDateObj &&\n                        dateObj !== undefined &&\n                        inverseDateObj.getFullYear() === dateObj.getFullYear();\n            }\n        };\n    }\n    function parseConfig() {\n        const boolOpts = [\n            \"wrap\",\n            \"weekNumbers\",\n            \"allowInput\",\n            \"allowInvalidPreload\",\n            \"clickOpens\",\n            \"time_24hr\",\n            \"enableTime\",\n            \"noCalendar\",\n            \"altInput\",\n            \"shorthandCurrentMonth\",\n            \"inline\",\n            \"static\",\n            \"enableSeconds\",\n            \"disableMobile\",\n        ];\n        const userConfig = Object.assign(Object.assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);\n        const formats = {};\n        self.config.parseDate = userConfig.parseDate;\n        self.config.formatDate = userConfig.formatDate;\n        Object.defineProperty(self.config, \"enable\", {\n            get: () => self.config._enable,\n            set: (dates) => {\n                self.config._enable = parseDateRules(dates);\n            },\n        });\n        Object.defineProperty(self.config, \"disable\", {\n            get: () => self.config._disable,\n            set: (dates) => {\n                self.config._disable = parseDateRules(dates);\n            },\n        });\n        const timeMode = userConfig.mode === \"time\";\n        if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {\n            const defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaultOptions.dateFormat;\n            formats.dateFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"H:i\" + (userConfig.enableSeconds ? \":S\" : \"\")\n                    : defaultDateFormat + \" H:i\" + (userConfig.enableSeconds ? \":S\" : \"\");\n        }\n        if (userConfig.altInput &&\n            (userConfig.enableTime || timeMode) &&\n            !userConfig.altFormat) {\n            const defaultAltFormat = flatpickr.defaultConfig.altFormat || defaultOptions.altFormat;\n            formats.altFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"h:i\" + (userConfig.enableSeconds ? \":S K\" : \" K\")\n                    : defaultAltFormat + ` h:i${userConfig.enableSeconds ? \":S\" : \"\"} K`;\n        }\n        Object.defineProperty(self.config, \"minDate\", {\n            get: () => self.config._minDate,\n            set: minMaxDateSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxDate\", {\n            get: () => self.config._maxDate,\n            set: minMaxDateSetter(\"max\"),\n        });\n        const minMaxTimeSetter = (type) => (val) => {\n            self.config[type === \"min\" ? \"_minTime\" : \"_maxTime\"] = self.parseDate(val, \"H:i:S\");\n        };\n        Object.defineProperty(self.config, \"minTime\", {\n            get: () => self.config._minTime,\n            set: minMaxTimeSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxTime\", {\n            get: () => self.config._maxTime,\n            set: minMaxTimeSetter(\"max\"),\n        });\n        if (userConfig.mode === \"time\") {\n            self.config.noCalendar = true;\n            self.config.enableTime = true;\n        }\n        Object.assign(self.config, formats, userConfig);\n        for (let i = 0; i < boolOpts.length; i++)\n            self.config[boolOpts[i]] =\n                self.config[boolOpts[i]] === true ||\n                    self.config[boolOpts[i]] === \"true\";\n        HOOKS.filter((hook) => self.config[hook] !== undefined).forEach((hook) => {\n            self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);\n        });\n        self.isMobile =\n            !self.config.disableMobile &&\n                !self.config.inline &&\n                self.config.mode === \"single\" &&\n                !self.config.disable.length &&\n                !self.config.enable &&\n                !self.config.weekNumbers &&\n                /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        for (let i = 0; i < self.config.plugins.length; i++) {\n            const pluginConf = self.config.plugins[i](self) || {};\n            for (const key in pluginConf) {\n                if (HOOKS.indexOf(key) > -1) {\n                    self.config[key] = arrayify(pluginConf[key])\n                        .map(bindToInstance)\n                        .concat(self.config[key]);\n                }\n                else if (typeof userConfig[key] === \"undefined\")\n                    self.config[key] = pluginConf[key];\n            }\n        }\n        if (!userConfig.altInputClass) {\n            self.config.altInputClass =\n                getInputElem().className + \" \" + self.config.altInputClass;\n        }\n        triggerEvent(\"onParseConfig\");\n    }\n    function getInputElem() {\n        return self.config.wrap\n            ? element.querySelector(\"[data-input]\")\n            : element;\n    }\n    function setupLocale() {\n        if (typeof self.config.locale !== \"object\" &&\n            typeof flatpickr.l10ns[self.config.locale] === \"undefined\")\n            self.config.errorHandler(new Error(`flatpickr: invalid locale ${self.config.locale}`));\n        self.l10n = Object.assign(Object.assign({}, flatpickr.l10ns.default), (typeof self.config.locale === \"object\"\n            ? self.config.locale\n            : self.config.locale !== \"default\"\n                ? flatpickr.l10ns[self.config.locale]\n                : undefined));\n        tokenRegex.K = `(${self.l10n.amPM[0]}|${self.l10n.amPM[1]}|${self.l10n.amPM[0].toLowerCase()}|${self.l10n.amPM[1].toLowerCase()})`;\n        const userConfig = Object.assign(Object.assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));\n        if (userConfig.time_24hr === undefined &&\n            flatpickr.defaultConfig.time_24hr === undefined) {\n            self.config.time_24hr = self.l10n.time_24hr;\n        }\n        self.formatDate = createDateFormatter(self);\n        self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    }\n    function positionCalendar(customPositionElement) {\n        if (typeof self.config.position === \"function\") {\n            return void self.config.position(self, customPositionElement);\n        }\n        if (self.calendarContainer === undefined)\n            return;\n        triggerEvent(\"onPreCalendarPosition\");\n        const positionElement = customPositionElement || self._positionElement;\n        const calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, ((acc, child) => acc + child.offsetHeight), 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(\" \"), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === \"above\" ||\n            (configPosVertical !== \"below\" &&\n                distanceFromBottom < calendarHeight &&\n                inputBounds.top > calendarHeight);\n        const top = window.pageYOffset +\n            inputBounds.top +\n            (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);\n        toggleClass(self.calendarContainer, \"arrowTop\", !showOnTop);\n        toggleClass(self.calendarContainer, \"arrowBottom\", showOnTop);\n        if (self.config.inline)\n            return;\n        let left = window.pageXOffset + inputBounds.left;\n        let isCenter = false;\n        let isRight = false;\n        if (configPosHorizontal === \"center\") {\n            left -= (calendarWidth - inputBounds.width) / 2;\n            isCenter = true;\n        }\n        else if (configPosHorizontal === \"right\") {\n            left -= calendarWidth - inputBounds.width;\n            isRight = true;\n        }\n        toggleClass(self.calendarContainer, \"arrowLeft\", !isCenter && !isRight);\n        toggleClass(self.calendarContainer, \"arrowCenter\", isCenter);\n        toggleClass(self.calendarContainer, \"arrowRight\", isRight);\n        const right = window.document.body.offsetWidth -\n            (window.pageXOffset + inputBounds.right);\n        const rightMost = left + calendarWidth > window.document.body.offsetWidth;\n        const centerMost = right + calendarWidth > window.document.body.offsetWidth;\n        toggleClass(self.calendarContainer, \"rightMost\", rightMost);\n        if (self.config.static)\n            return;\n        self.calendarContainer.style.top = `${top}px`;\n        if (!rightMost) {\n            self.calendarContainer.style.left = `${left}px`;\n            self.calendarContainer.style.right = \"auto\";\n        }\n        else if (!centerMost) {\n            self.calendarContainer.style.left = \"auto\";\n            self.calendarContainer.style.right = `${right}px`;\n        }\n        else {\n            const doc = getDocumentStyleSheet();\n            if (doc === undefined)\n                return;\n            const bodyWidth = window.document.body.offsetWidth;\n            const centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);\n            const centerBefore = \".flatpickr-calendar.centerMost:before\";\n            const centerAfter = \".flatpickr-calendar.centerMost:after\";\n            const centerIndex = doc.cssRules.length;\n            const centerStyle = `{left:${inputBounds.left}px;right:auto;}`;\n            toggleClass(self.calendarContainer, \"rightMost\", false);\n            toggleClass(self.calendarContainer, \"centerMost\", true);\n            doc.insertRule(`${centerBefore},${centerAfter}${centerStyle}`, centerIndex);\n            self.calendarContainer.style.left = `${centerLeft}px`;\n            self.calendarContainer.style.right = \"auto\";\n        }\n    }\n    function getDocumentStyleSheet() {\n        let editableSheet = null;\n        for (let i = 0; i < document.styleSheets.length; i++) {\n            const sheet = document.styleSheets[i];\n            try {\n                sheet.cssRules;\n            }\n            catch (err) {\n                continue;\n            }\n            editableSheet = sheet;\n            break;\n        }\n        return editableSheet != null ? editableSheet : createStyleSheet();\n    }\n    function createStyleSheet() {\n        const style = document.createElement(\"style\");\n        document.head.appendChild(style);\n        return style.sheet;\n    }\n    function redraw() {\n        if (self.config.noCalendar || self.isMobile)\n            return;\n        buildMonthSwitch();\n        updateNavigationCurrentMonth();\n        buildDays();\n    }\n    function focusAndClose() {\n        self._input.focus();\n        if (window.navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\n            navigator.msMaxTouchPoints !== undefined) {\n            setTimeout(self.close, 0);\n        }\n        else {\n            self.close();\n        }\n    }\n    function selectDate(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        const isSelectable = (day) => day.classList &&\n            day.classList.contains(\"flatpickr-day\") &&\n            !day.classList.contains(\"flatpickr-disabled\") &&\n            !day.classList.contains(\"notAllowed\");\n        const t = findParent(getEventTarget(e), isSelectable);\n        if (t === undefined)\n            return;\n        const target = t;\n        const selectedDate = (self.latestSelectedDateObj = new Date(target.dateObj.getTime()));\n        const shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth ||\n            selectedDate.getMonth() >\n                self.currentMonth + self.config.showMonths - 1) &&\n            self.config.mode !== \"range\";\n        self.selectedDateElem = target;\n        if (self.config.mode === \"single\")\n            self.selectedDates = [selectedDate];\n        else if (self.config.mode === \"multiple\") {\n            const selectedIndex = isDateSelected(selectedDate);\n            if (selectedIndex)\n                self.selectedDates.splice(parseInt(selectedIndex), 1);\n            else\n                self.selectedDates.push(selectedDate);\n        }\n        else if (self.config.mode === \"range\") {\n            if (self.selectedDates.length === 2) {\n                self.clear(false, false);\n            }\n            self.latestSelectedDateObj = selectedDate;\n            self.selectedDates.push(selectedDate);\n            if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)\n                self.selectedDates.sort((a, b) => a.getTime() - b.getTime());\n        }\n        setHoursFromInputs();\n        if (shouldChangeMonth) {\n            const isNewYear = self.currentYear !== selectedDate.getFullYear();\n            self.currentYear = selectedDate.getFullYear();\n            self.currentMonth = selectedDate.getMonth();\n            if (isNewYear) {\n                triggerEvent(\"onYearChange\");\n                buildMonthSwitch();\n            }\n            triggerEvent(\"onMonthChange\");\n        }\n        updateNavigationCurrentMonth();\n        buildDays();\n        updateValue();\n        if (!shouldChangeMonth &&\n            self.config.mode !== \"range\" &&\n            self.config.showMonths === 1)\n            focusOnDayElem(target);\n        else if (self.selectedDateElem !== undefined &&\n            self.hourElement === undefined) {\n            self.selectedDateElem && self.selectedDateElem.focus();\n        }\n        if (self.hourElement !== undefined)\n            self.hourElement !== undefined && self.hourElement.focus();\n        if (self.config.closeOnSelect) {\n            const single = self.config.mode === \"single\" && !self.config.enableTime;\n            const range = self.config.mode === \"range\" &&\n                self.selectedDates.length === 2 &&\n                !self.config.enableTime;\n            if (single || range) {\n                focusAndClose();\n            }\n        }\n        triggerChange();\n    }\n    const CALLBACKS = {\n        locale: [setupLocale, updateWeekdays],\n        showMonths: [buildMonths, setCalendarWidth, buildWeekdays],\n        minDate: [jumpToDate],\n        maxDate: [jumpToDate],\n        clickOpens: [\n            () => {\n                if (self.config.clickOpens === true) {\n                    bind(self._input, \"focus\", self.open);\n                    bind(self._input, \"click\", self.open);\n                }\n                else {\n                    self._input.removeEventListener(\"focus\", self.open);\n                    self._input.removeEventListener(\"click\", self.open);\n                }\n            },\n        ],\n    };\n    function set(option, value) {\n        if (option !== null && typeof option === \"object\") {\n            Object.assign(self.config, option);\n            for (const key in option) {\n                if (CALLBACKS[key] !== undefined)\n                    CALLBACKS[key].forEach((x) => x());\n            }\n        }\n        else {\n            self.config[option] = value;\n            if (CALLBACKS[option] !== undefined)\n                CALLBACKS[option].forEach((x) => x());\n            else if (HOOKS.indexOf(option) > -1)\n                self.config[option] = arrayify(value);\n        }\n        self.redraw();\n        updateValue(true);\n    }\n    function setSelectedDate(inputDate, format) {\n        let dates = [];\n        if (inputDate instanceof Array)\n            dates = inputDate.map((d) => self.parseDate(d, format));\n        else if (inputDate instanceof Date || typeof inputDate === \"number\")\n            dates = [self.parseDate(inputDate, format)];\n        else if (typeof inputDate === \"string\") {\n            switch (self.config.mode) {\n                case \"single\":\n                case \"time\":\n                    dates = [self.parseDate(inputDate, format)];\n                    break;\n                case \"multiple\":\n                    dates = inputDate\n                        .split(self.config.conjunction)\n                        .map((date) => self.parseDate(date, format));\n                    break;\n                case \"range\":\n                    dates = inputDate\n                        .split(self.l10n.rangeSeparator)\n                        .map((date) => self.parseDate(date, format));\n                    break;\n                default:\n                    break;\n            }\n        }\n        else\n            self.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(inputDate)}`));\n        self.selectedDates = (self.config.allowInvalidPreload\n            ? dates\n            : dates.filter((d) => d instanceof Date && isEnabled(d, false)));\n        if (self.config.mode === \"range\")\n            self.selectedDates.sort((a, b) => a.getTime() - b.getTime());\n    }\n    function setDate(date, triggerChange = false, format = self.config.dateFormat) {\n        if ((date !== 0 && !date) || (date instanceof Array && date.length === 0))\n            return self.clear(triggerChange);\n        setSelectedDate(date, format);\n        self.latestSelectedDateObj =\n            self.selectedDates[self.selectedDates.length - 1];\n        self.redraw();\n        jumpToDate(undefined, triggerChange);\n        setHoursFromDate();\n        if (self.selectedDates.length === 0) {\n            self.clear(false);\n        }\n        updateValue(triggerChange);\n        if (triggerChange)\n            triggerEvent(\"onChange\");\n    }\n    function parseDateRules(arr) {\n        return arr\n            .slice()\n            .map((rule) => {\n            if (typeof rule === \"string\" ||\n                typeof rule === \"number\" ||\n                rule instanceof Date) {\n                return self.parseDate(rule, undefined, true);\n            }\n            else if (rule &&\n                typeof rule === \"object\" &&\n                rule.from &&\n                rule.to)\n                return {\n                    from: self.parseDate(rule.from, undefined),\n                    to: self.parseDate(rule.to, undefined),\n                };\n            return rule;\n        })\n            .filter((x) => x);\n    }\n    function setupDates() {\n        self.selectedDates = [];\n        self.now = self.parseDate(self.config.now) || new Date();\n        const preloadedDate = self.config.defaultDate ||\n            ((self.input.nodeName === \"INPUT\" ||\n                self.input.nodeName === \"TEXTAREA\") &&\n                self.input.placeholder &&\n                self.input.value === self.input.placeholder\n                ? null\n                : self.input.value);\n        if (preloadedDate)\n            setSelectedDate(preloadedDate, self.config.dateFormat);\n        self._initialDate =\n            self.selectedDates.length > 0\n                ? self.selectedDates[0]\n                : self.config.minDate &&\n                    self.config.minDate.getTime() > self.now.getTime()\n                    ? self.config.minDate\n                    : self.config.maxDate &&\n                        self.config.maxDate.getTime() < self.now.getTime()\n                        ? self.config.maxDate\n                        : self.now;\n        self.currentYear = self._initialDate.getFullYear();\n        self.currentMonth = self._initialDate.getMonth();\n        if (self.selectedDates.length > 0)\n            self.latestSelectedDateObj = self.selectedDates[0];\n        if (self.config.minTime !== undefined)\n            self.config.minTime = self.parseDate(self.config.minTime, \"H:i\");\n        if (self.config.maxTime !== undefined)\n            self.config.maxTime = self.parseDate(self.config.maxTime, \"H:i\");\n        self.minDateHasTime =\n            !!self.config.minDate &&\n                (self.config.minDate.getHours() > 0 ||\n                    self.config.minDate.getMinutes() > 0 ||\n                    self.config.minDate.getSeconds() > 0);\n        self.maxDateHasTime =\n            !!self.config.maxDate &&\n                (self.config.maxDate.getHours() > 0 ||\n                    self.config.maxDate.getMinutes() > 0 ||\n                    self.config.maxDate.getSeconds() > 0);\n    }\n    function setupInputs() {\n        self.input = getInputElem();\n        if (!self.input) {\n            self.config.errorHandler(new Error(\"Invalid input element specified\"));\n            return;\n        }\n        self.input._type = self.input.type;\n        self.input.type = \"text\";\n        self.input.classList.add(\"flatpickr-input\");\n        self._input = self.input;\n        if (self.config.altInput) {\n            self.altInput = createElement(self.input.nodeName, self.config.altInputClass);\n            self._input = self.altInput;\n            self.altInput.placeholder = self.input.placeholder;\n            self.altInput.disabled = self.input.disabled;\n            self.altInput.required = self.input.required;\n            self.altInput.tabIndex = self.input.tabIndex;\n            self.altInput.type = \"text\";\n            self.input.setAttribute(\"type\", \"hidden\");\n            if (!self.config.static && self.input.parentNode)\n                self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);\n        }\n        if (!self.config.allowInput)\n            self._input.setAttribute(\"readonly\", \"readonly\");\n        self._positionElement = self.config.positionElement || self._input;\n    }\n    function setupMobile() {\n        const inputType = self.config.enableTime\n            ? self.config.noCalendar\n                ? \"time\"\n                : \"datetime-local\"\n            : \"date\";\n        self.mobileInput = createElement(\"input\", self.input.className + \" flatpickr-mobile\");\n        self.mobileInput.tabIndex = 1;\n        self.mobileInput.type = inputType;\n        self.mobileInput.disabled = self.input.disabled;\n        self.mobileInput.required = self.input.required;\n        self.mobileInput.placeholder = self.input.placeholder;\n        self.mobileFormatStr =\n            inputType === \"datetime-local\"\n                ? \"Y-m-d\\\\TH:i:S\"\n                : inputType === \"date\"\n                    ? \"Y-m-d\"\n                    : \"H:i:S\";\n        if (self.selectedDates.length > 0) {\n            self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);\n        }\n        if (self.config.minDate)\n            self.mobileInput.min = self.formatDate(self.config.minDate, \"Y-m-d\");\n        if (self.config.maxDate)\n            self.mobileInput.max = self.formatDate(self.config.maxDate, \"Y-m-d\");\n        if (self.input.getAttribute(\"step\"))\n            self.mobileInput.step = String(self.input.getAttribute(\"step\"));\n        self.input.type = \"hidden\";\n        if (self.altInput !== undefined)\n            self.altInput.type = \"hidden\";\n        try {\n            if (self.input.parentNode)\n                self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);\n        }\n        catch (_a) { }\n        bind(self.mobileInput, \"change\", (e) => {\n            self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);\n            triggerEvent(\"onChange\");\n            triggerEvent(\"onClose\");\n        });\n    }\n    function toggle(e) {\n        if (self.isOpen === true)\n            return self.close();\n        self.open(e);\n    }\n    function triggerEvent(event, data) {\n        if (self.config === undefined)\n            return;\n        const hooks = self.config[event];\n        if (hooks !== undefined && hooks.length > 0) {\n            for (let i = 0; hooks[i] && i < hooks.length; i++)\n                hooks[i](self.selectedDates, self.input.value, self, data);\n        }\n        if (event === \"onChange\") {\n            self.input.dispatchEvent(createEvent(\"change\"));\n            self.input.dispatchEvent(createEvent(\"input\"));\n        }\n    }\n    function createEvent(name) {\n        const e = document.createEvent(\"Event\");\n        e.initEvent(name, true, true);\n        return e;\n    }\n    function isDateSelected(date) {\n        for (let i = 0; i < self.selectedDates.length; i++) {\n            if (compareDates(self.selectedDates[i], date) === 0)\n                return \"\" + i;\n        }\n        return false;\n    }\n    function isDateInRange(date) {\n        if (self.config.mode !== \"range\" || self.selectedDates.length < 2)\n            return false;\n        return (compareDates(date, self.selectedDates[0]) >= 0 &&\n            compareDates(date, self.selectedDates[1]) <= 0);\n    }\n    function updateNavigationCurrentMonth() {\n        if (self.config.noCalendar || self.isMobile || !self.monthNav)\n            return;\n        self.yearElements.forEach((yearElement, i) => {\n            const d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            if (self.config.showMonths > 1 ||\n                self.config.monthSelectorType === \"static\") {\n                self.monthElements[i].textContent =\n                    monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + \" \";\n            }\n            else {\n                self.monthsDropdownContainer.value = d.getMonth().toString();\n            }\n            yearElement.value = d.getFullYear().toString();\n        });\n        self._hidePrevMonthArrow =\n            self.config.minDate !== undefined &&\n                (self.currentYear === self.config.minDate.getFullYear()\n                    ? self.currentMonth <= self.config.minDate.getMonth()\n                    : self.currentYear < self.config.minDate.getFullYear());\n        self._hideNextMonthArrow =\n            self.config.maxDate !== undefined &&\n                (self.currentYear === self.config.maxDate.getFullYear()\n                    ? self.currentMonth + 1 > self.config.maxDate.getMonth()\n                    : self.currentYear > self.config.maxDate.getFullYear());\n    }\n    function getDateStr(format) {\n        return self.selectedDates\n            .map((dObj) => self.formatDate(dObj, format))\n            .filter((d, i, arr) => self.config.mode !== \"range\" ||\n            self.config.enableTime ||\n            arr.indexOf(d) === i)\n            .join(self.config.mode !== \"range\"\n            ? self.config.conjunction\n            : self.l10n.rangeSeparator);\n    }\n    function updateValue(triggerChange = true) {\n        if (self.mobileInput !== undefined && self.mobileFormatStr) {\n            self.mobileInput.value =\n                self.latestSelectedDateObj !== undefined\n                    ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr)\n                    : \"\";\n        }\n        self.input.value = getDateStr(self.config.dateFormat);\n        if (self.altInput !== undefined) {\n            self.altInput.value = getDateStr(self.config.altFormat);\n        }\n        if (triggerChange !== false)\n            triggerEvent(\"onValueUpdate\");\n    }\n    function onMonthNavClick(e) {\n        const eventTarget = getEventTarget(e);\n        const isPrevMonth = self.prevMonthNav.contains(eventTarget);\n        const isNextMonth = self.nextMonthNav.contains(eventTarget);\n        if (isPrevMonth || isNextMonth) {\n            changeMonth(isPrevMonth ? -1 : 1);\n        }\n        else if (self.yearElements.indexOf(eventTarget) >= 0) {\n            eventTarget.select();\n        }\n        else if (eventTarget.classList.contains(\"arrowUp\")) {\n            self.changeYear(self.currentYear + 1);\n        }\n        else if (eventTarget.classList.contains(\"arrowDown\")) {\n            self.changeYear(self.currentYear - 1);\n        }\n    }\n    function timeWrapper(e) {\n        e.preventDefault();\n        const isKeyDown = e.type === \"keydown\", eventTarget = getEventTarget(e), input = eventTarget;\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            self.amPM.textContent =\n                self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n        }\n        const min = parseFloat(input.getAttribute(\"min\")), max = parseFloat(input.getAttribute(\"max\")), step = parseFloat(input.getAttribute(\"step\")), curValue = parseInt(input.value, 10), delta = e.delta ||\n            (isKeyDown ? (e.which === 38 ? 1 : -1) : 0);\n        let newValue = curValue + step * delta;\n        if (typeof input.value !== \"undefined\" && input.value.length === 2) {\n            const isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;\n            if (newValue < min) {\n                newValue =\n                    max +\n                        newValue +\n                        int(!isHourElem) +\n                        (int(isHourElem) && int(!self.amPM));\n                if (isMinuteElem)\n                    incrementNumInput(undefined, -1, self.hourElement);\n            }\n            else if (newValue > max) {\n                newValue =\n                    input === self.hourElement ? newValue - max - int(!self.amPM) : min;\n                if (isMinuteElem)\n                    incrementNumInput(undefined, 1, self.hourElement);\n            }\n            if (self.amPM &&\n                isHourElem &&\n                (step === 1\n                    ? newValue + curValue === 23\n                    : Math.abs(newValue - curValue) > step)) {\n                self.amPM.textContent =\n                    self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n            }\n            input.value = pad(newValue);\n        }\n    }\n    init();\n    return self;\n}\nfunction _flatpickr(nodeList, config) {\n    const nodes = Array.prototype.slice\n        .call(nodeList)\n        .filter((x) => x instanceof HTMLElement);\n    const instances = [];\n    for (let i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n        try {\n            if (node.getAttribute(\"data-fp-omit\") !== null)\n                continue;\n            if (node._flatpickr !== undefined) {\n                node._flatpickr.destroy();\n                node._flatpickr = undefined;\n            }\n            node._flatpickr = FlatpickrInstance(node, config || {});\n            instances.push(node._flatpickr);\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    return instances.length === 1 ? instances[0] : instances;\n}\nif (typeof HTMLElement !== \"undefined\" &&\n    typeof HTMLCollection !== \"undefined\" &&\n    typeof NodeList !== \"undefined\") {\n    HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n    HTMLElement.prototype.flatpickr = function (config) {\n        return _flatpickr([this], config);\n    };\n}\nvar flatpickr = function (selector, config) {\n    if (typeof selector === \"string\") {\n        return _flatpickr(window.document.querySelectorAll(selector), config);\n    }\n    else if (selector instanceof Node) {\n        return _flatpickr([selector], config);\n    }\n    else {\n        return _flatpickr(selector, config);\n    }\n};\nflatpickr.defaultConfig = {};\nflatpickr.l10ns = {\n    en: Object.assign({}, English),\n    default: Object.assign({}, English),\n};\nflatpickr.localize = (l10n) => {\n    flatpickr.l10ns.default = Object.assign(Object.assign({}, flatpickr.l10ns.default), l10n);\n};\nflatpickr.setDefaults = (config) => {\n    flatpickr.defaultConfig = Object.assign(Object.assign({}, flatpickr.defaultConfig), config);\n};\nflatpickr.parseDate = createDateParser({});\nflatpickr.formatDate = createDateFormatter({});\nflatpickr.compareDates = compareDates;\nif (typeof jQuery !== \"undefined\" && typeof jQuery.fn !== \"undefined\") {\n    jQuery.fn.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n}\nDate.prototype.fp_incr = function (days) {\n    return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === \"string\" ? parseInt(days, 10) : days));\n};\nif (typeof window !== \"undefined\") {\n    window.flatpickr = flatpickr;\n}\nexport default flatpickr;\n","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport Tokens from './tokens.js';\n\nimport {\n\tisEmpty,\n\tisDefined,\n\tdebounce,\n\tthrottle,\n\tcopyToClipboard,\n\topenInNewTab,\n\trecipeSetRequiresUser,\n\taddParametersToURL,\n\taddUTMParameters\n} from '../common/utilities';\n\nimport Modal from '../common/modal';\n\nimport Field from '../field/field';\n\nexport default class TokenSelector {\n\tconstructor( Field ){\n\t\t// Check if the field supports tokens\n\t\tif ( Field.attributes.supportsTokens ){\n\t\t\t// Create different Tokens Selectors depending on the field type\n\t\t\tif ( Field.type == 'textarea' ){\n\t\t\t\treturn new TokenSelectorTextarea( Field );\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn new TokenSelectorInput( Field );\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass TokenSelectorInput extends Tokens {\n\tconstructor( Field ){\n\t\tsuper(\n\t\t\tField.attributes.itemType,\n\t\t\tField.type\n\t\t);\n\n\t\t// Save field\n\t\tthis.Field = Field;\n\n\t\t// Save the Token Selector instance in the field\n\t\tthis.Field.TokenSelector = this;\n\n\t\t// Render the token selector\n\t\tthis.render();\n\n\t\t// Set data\n\t\tthis.setData();\n\n\t\t// CodeMirror methods\n\t\tthis.Field.getField().on( 'ua-codemirror-ready', () => {\n\t\t\t// Get the CodeMirror editor\n\t\t\tthis.getCodeMirrorEditor();\n\n\t\t\t// Render tokens right away, without the delay\n\t\t\tthis.editor.setValue( this.editor.getValue() );\n\t\t\tthis.renderTokens();\n\n\t\t\t// Handle requests to add tokens to the field\n\t\t\tthis.handleAddTokens();\n\n\t\t\t// Render tokens in real time\n\t\t\tthis.renderTokensInRealTime();\n\t\t}); \n\t}\n\n\trender(){\n\t\tthis.RenderTokenSelector = new RenderTokenSelector( this.Field, this.tokens );\n\t}\n\n\tsetData(){\n\t\tthis.data = {\n\t\t\ttokenRenderingDebounce: 200,\n\t\t\t// cachedCMWidgets: []\n\t\t}\n\t}\n\n\tgetCodeMirrorEditor(){\n\t\tthis.editor = this.Field.fieldCM;\n\t}\n\n\thandleAddTokens(){\n\t\t// Listen events that are trying to add a token\n\t\tthis.Field.field\n\t\t\t.off( 'ua-add-token' )\n\t\t\t.on( 'ua-add-token', ( event, token ) => {\n\t\t\t\t// Check if it's a date or time field\n\t\t\t\tif ( [ 'date', 'time' ].includes( this.Field.attributes.fieldType ) ){\n\t\t\t\t\t// Remove the value of the field\n\t\t\t\t\tthis.editor.setValue( '' );\n\t\t\t\t}\n\n\t\t\t\t// Add it to the editor\n\t\t\t\tthis.insertTextAtCursor( `{{${ token.id }}}` );\n\n\t\t\t\t// Render tokens right away, without the delay\n\t\t\t\tthis.renderTokens({\n\t\t\t\t\tignoreRequiresUserModal: true\n\t\t\t\t});\n\n\t\t\t\t// Check if it's NOT a date or time field\n\t\t\t\tif ( ! [ 'date', 'time' ].includes( this.Field.attributes.fieldType ) ){\n\t\t\t\t\t// Focus the field again\n\t\t\t\t\tthis.editor.focus();\n\t\t\t\t}\n\n\t\t\t\t // Check if it's a date or time field\n\t\t\t\tif ( [ 'date', 'time' ].includes( this.Field.attributes.fieldType ) ){\n\t\t\t\t\t// Set value in the real field\n\t\t\t\t\tthis.Field.setValue( `{{${ token.id }}}` );\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tdestroy(){\n\t\t// Destroy wrapper\n\t\tthis.RenderTokenSelector.destroy();\n\t}\n\n\t/**\n\t * Insert content in the CM field at the current position\n\t *\n\t * @since 3.0\n\t * \n\t * @param  String   text The content to be added\n\t */\n\tinsertTextAtCursor( text ){\n\t\tthis.editor.doc.replaceRange( text, this.editor.doc.getCursor() );\n\t}\n\n\trenderTokensInRealTime(){\n\t\tthis.editor.on( 'changes', debounce( ( event ) => {\n\t\t\t// Render tokens\n\t\t\tthis.renderTokens();\n\t\t}, this.data.tokenRenderingDebounce ) );\n\t}\n\n\trenderTokens( options ){\n\t\t// Clear all the current widgets\n\t\t// this.data.cachedCMWidgets.forEach( marker => marker.clear() );\n\t\t// this.data.cachedCMWidgets = [];\n\n\t\t// Get the options\n\t\toptions = Object.assign({\n\t\t\tignoreRequiresUserModal: false,\n\t\t}, options );\n\n\t\t// Search tokens\n\t\tconst querySearchTokens = this.editor.getSearchCursor( /\\{\\{(.*?)\\}\\}/ );\n\n\t\t// Iterate them\n\t\twhile ( querySearchTokens.findNext() ){\n\t\t\t// Get position\n\t\t\tconst position = {\n\t\t\t\tfrom: querySearchTokens.from(),\n\t\t\t\tto:   querySearchTokens.to()\n\t\t\t}\n\n\t\t\t// Get the content\n\t\t\tconst content = this.editor.getRange(\n\t\t\t\tposition.from,\n\t\t\t\tposition.to\n\t\t\t);\n\n\t\t\t// Remove the opening and closing brackets\n\t\t\tconst tokenId = content.replace( '{{', '' ).replace( '}}', '' );\n\t\t\t\n\t\t\t// Get the token HMTL\n\t\t\tconst $tokenNode = this.createTokenDOMNode( tokenId );\n\n\t\t\t// Create CodeMirror widget\n\t\t\tconst widget = this.editor.markText( \n\t\t\t\tposition.from,\n\t\t\t\tposition.to,\n\t\t\t\t{\n\t\t\t\t\treplacedWith: $tokenNode\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\tUncannyAutomator.recipe.type == 'anonymous'\n\t\t\t\t// Check if the recipe currently doesn't require user data\n\t\t\t\t&& ! UncannyAutomator.recipe.requiresUserData\n\t\t\t\t&& (\n\t\t\t\t\t// Check if the current tokens requires user data\n\t\t\t\t\tthis.tokensThatRequireUser.includes( tokenId )\n\t\t\t\t\t// Check if it's the user meta token\n\t\t\t\t\t|| tokenId.startsWith( 'USERMETA:' )\n\t\t\t\t)\n\t\t\t\t// Check if we have to ignore the requires user modal\n\t\t\t\t&& ! options.ignoreRequiresUserModal\n\t\t\t){\n\t\t\t\tthis.tokenNeedsUserModal( $tokenNode, {\n\t\t\t\t\t// Create function to remove the current token\n\t\t\t\t\tremoveToken: () => {\n\t\t\t\t\t\t// Get the widget position\n\t\t\t\t\t\tconst widgetPosition = widget.find();\n\n\t\t\t\t\t\t// Remove the widget\n\t\t\t\t\t\twidget.clear();\n\n\t\t\t\t\t\t// Remove the token content\n\t\t\t\t\t\tthis.editor.replaceRange(\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\twidgetPosition.from,\n\t\t\t\t\t\t\twidgetPosition.to\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Stop the loop\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Add events to the tokens, but only if the field is not read only\n\t\t\tif ( ! this.Field.attributes.isReadOnly ){\n\t\t\t\t// Select on click\n\t\t\t\t$tokenNode.addEventListener( 'click', () => {\n\t\t\t\t\t// Check if it's focus\n\t\t\t\t\tif ( ! $tokenNode.classList.contains( 'uap-token--cm-focused' ) ){\n\t\t\t\t\t\t// Add focus class\n\t\t\t\t\t\t$tokenNode.classList.add( 'uap-token--cm-focused' );\n\n\t\t\t\t\t\tconst onFocusOut = () => {\n\t\t\t\t\t\t\t// Remove focus class\n\t\t\t\t\t\t\t$tokenNode.classList.remove( 'uap-token--cm-focused' );\n\n\t\t\t\t\t\t\t// Remove the event listener that listen clicks\n\t\t\t\t\t\t\t// outside the token\n\t\t\t\t\t\t\tdocument.removeEventListener( 'mouseup', onClickOutside );\n\n\t\t\t\t\t\t\t// Remove the event listener to copy to the\n\t\t\t\t\t\t\t// token to the clipboard\n\t\t\t\t\t\t\tdocument.removeEventListener( 'copy', onCopy );\n\n\t\t\t\t\t\t\t// Remove the event listener to remove the token\n\t\t\t\t\t\t\tdocument.removeEventListener( 'keydown', onDelete );\n\n\t\t\t\t\t\t\t// Remove the event listener to move the cursor\n\t\t\t\t\t\t\t// to the left or right using the direction keys\n\t\t\t\t\t\t\tdocument.removeEventListener( 'keydown', onNavigation );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Listen clicks outside\n\t\t\t\t\t\tconst onClickOutside = ( event ) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t// Check if the clicked element is not the token\n\t\t\t\t\t\t\t\t! ( $tokenNode === event.target )\n\t\t\t\t\t\t\t\t// And check if the clicked element is NOT a child\n\t\t\t\t\t\t\t\t// of the token\n\t\t\t\t\t\t\t\t&& ! ( $tokenNode.contains( event.target ) )\n\t\t\t\t\t\t\t){\n\t\t\t\t\t\t\t\tonFocusOut();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdocument.addEventListener( 'mouseup', onClickOutside );\n\n\t\t\t\t\t\t// Listen copy event\n\t\t\t\t\t\tconst onCopy = ( event ) => {\n\t\t\t\t\t\t\tonFocusOut();\n\n\t\t\t\t\t\t\t// Copy the token ID\n\t\t\t\t\t\t\tcopyToClipboard( `{{${ tokenId }}}` );\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdocument.addEventListener( 'copy', onCopy );\n\n\t\t\t\t\t\t// Listen delete event\n\t\t\t\t\t\tconst onDelete = ( event ) => {\n\t\t\t\t\t\t\t// Get the pressed key\n\t\t\t\t\t\t\tconst key = event.keyCode || event.charCode;\n\n\t\t\t\t\t\t\t// Check if it's the \"backspace\" or \"del\" key\n\t\t\t\t\t\t\tif ( key == 8 || key == 46 ){\n\t\t\t\t\t\t\t\t// Get the widget position\n\t\t\t\t\t\t\t\tconst widgetPosition = widget.find();\n\n\t\t\t\t\t\t\t\t// Remove the widget\n\t\t\t\t\t\t\t\twidget.clear();\n\n\t\t\t\t\t\t\t\t// Remove the token content\n\t\t\t\t\t\t\t\tthis.editor.replaceRange(\n\t\t\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\t\t\twidgetPosition.from,\n\t\t\t\t\t\t\t\t\twidgetPosition.to\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tonFocusOut();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdocument.addEventListener( 'keydown', onDelete );\n\n\t\t\t\t\t\t// Listen navigation events\n\t\t\t\t\t\tconst onNavigation = ( event ) => {\n\t\t\t\t\t\t\t// Get the pressed key\n\t\t\t\t\t\t\tconst key = event.keyCode || event.charCode;\n\n\t\t\t\t\t\t\t// Check if it's one of the <- or -> keys\n\t\t\t\t\t\t\tif ( key == 37 || key == 39 ){\n\t\t\t\t\t\t\t\tonFocusOut();\n\n\t\t\t\t\t\t\t\t// Get the widget position\n\t\t\t\t\t\t\t\tconst widgetPosition = widget.find();\n\n\t\t\t\t\t\t\t\t// Get the new position\n\t\t\t\t\t\t\t\tlet position;\n\n\t\t\t\t\t\t\t\t// Check if it's the \"<-\" (left) key\n\t\t\t\t\t\t\t\tif ( key == 37 ){\n\t\t\t\t\t\t\t\t\t// Get the left position\n\t\t\t\t\t\t\t\t\tposition = widgetPosition.from;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Check if it's the \"->\" (right) key\n\t\t\t\t\t\t\t\tif ( key == 39 ){\n\t\t\t\t\t\t\t\t\t// Get the right position\n\t\t\t\t\t\t\t\t\tposition = widgetPosition.to;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Set focus\n\t\t\t\t\t\t\t\tthis.editor.focus();\n\n\t\t\t\t\t\t\t\t// Set the cursor\n\t\t\t\t\t\t\t\tthis.editor.setCursor( position )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdocument.addEventListener( 'keydown', onNavigation );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}  \n\t\t}\n\t}\n\n\t/**\n\t * Shows modal to tell the user that the token added needs user data\n\t * \n\t * @param  {Object} token     The token added\n\t * @param  {Object} callbacks Object with callbacks\n\t */\n\ttokenNeedsUserModal( $tokenNode, callbacks = {} ){\n\t\t/**\n\t\t * Create modal to ley the user know that\n\t\t * they will need user data\n\t\t */\n\t\tlet modal;\n\n\t\t// Check if WP is ready\n\t\tif ( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp ){\n\t\t\tmodal = new Modal({\n\t\t\t\ttitle:   `${ UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.title } <span class=\"needs-user-data-modal-pro-badge\">${ UncannyAutomator.i18n.proOnly.pro }</span>`,\n\t\t\t\tcontent: `\n\t\t\t\t\t<div class=\"needs-user-data-modal\">\n\t\t\t\t\t\t<div class=\"needs-user-data-modal__title\">${ vsprintf( UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.mustRunOnUser, [ $tokenNode.outerHTML ] ) }</div>\n\t\t\t\t\t\t<div class=\"needs-user-data-modal__disclaimer\">\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<div class=\"description\">${ vsprintf( UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.description, [ UncannyAutomator.i18n.uncannyAutomatorPro ] ) } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/pricing/', { 'medium': 'select_an_item', 'campaign': 'update_to_pro', 'content': 'requires_user_data',\n\t\t\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.upgradeNow } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a></div>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<div class=\"description\">${ UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.upgradeLater } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/knowledge-base/creating-a-recipe/#Recipe_types', { 'medium': 'select_an_item', 'content': 'requires_user_data-learn-more',\n\t\t\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.learnMore } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a></div>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tbuttons: {\n\t\t\t\t\tcancel:  UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.cancelButton,\n\t\t\t\t\tconfirm: UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.confirmButton,\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tsize: 'large'\n\t\t\t});\n\n\t\t\tmodal.setEvents({\n\t\t\t\tonConfirm: () => {\n\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t// Open link in new tab\n\t\t\t\t\topenInNewTab( addUTMParameters( 'https://automatorplugin.com/pricing/', { 'medium': 'add_token', 'campaign': 'update_to_pro', 'content': 'requires_user_data',\n\t\t\t\t\t\t\t}) );\n\n\t\t\t\t\t// Remove token\n\t\t\t\t\tif ( isDefined( callbacks.removeToken ) ){\n\t\t\t\t\t\tcallbacks.removeToken();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Can't add, confirm\n\t\t\t\t\tif ( isDefined( callbacks.forbiddenConfirm ) ){\n\t\t\t\t\t\tcallbacks.forbiddenConfirm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t// Remove token\n\t\t\t\t\tif ( isDefined( callbacks.removeToken ) ){\n\t\t\t\t\t\tcallbacks.removeToken();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Can't add, cancel\n\t\t\t\t\tif ( isDefined( callbacks.forbiddenCancel ) ){\n\t\t\t\t\t\tcallbacks.forbiddenCancel();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t// Check if we should set the recipe to draft when the user adds the action\n\t\t\t// We're doing this because the user will need to fill the User Selector\n\t\t\tconst actionWillSetRecipeToDraft = UncannyAutomator.recipe.isLive;\n\n\t\t\tmodal = new Modal({\n\t\t\t\ttitle:   `${ UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.title } <span class=\"needs-user-data-modal-pro-badge needs-user-data-modal-pro-badge--gray\">${ UncannyAutomator.i18n.proOnly.pro }</span>`,\n\t\t\t\tcontent: `\n\t\t\t\t\t<div class=\"needs-user-data-modal\">\n\t\t\t\t\t\t<div class=\"needs-user-data-modal__title\">${ vsprintf( UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.content.mustRunOnUser, [ $tokenNode.outerHTML ] ) }</div>\n\t\t\t\t\t\t<div class=\"needs-user-data-modal__disclaimer\">\n\t\t\t\t\t\t\t<div class=\"description\">${ UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.content.description }</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tbuttons: {\n\t\t\t\t\tcancel:  UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.cancelButton,\n\t\t\t\t\tconfirm: UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.confirmButton,\n\t\t\t\t},\n\t\t\t}, {\n\t\t\t\tsize: 'large',\n\t\t\t});\n\n\t\t\tmodal.setEvents({\n\t\t\t\tonConfirm: () => {\n\t\t\t\t\tlet modalElements = modal.getElements();\n\n\t\t\t\t\t// Add loading class to button\n\t\t\t\t\tmodalElements.modal.box.buttons.confirm.addClass( 'uap-btn--loading' ).prop( 'disabled', true );\n\n\t\t\t\t\t// Do an AJAX call to set the global recipe requires user\n\t\t\t\t\trecipeSetRequiresUser(\n\t\t\t\t\t\t// Set to true (requires user)\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t// On success\n\t\t\t\t\t\t( response ) => {\n\t\t\t\t\t\t\t// On success, close and destroy the modal\n\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\t// Render the tokens again, some might be missing\n\t\t\t\t\t\t\tthis.renderTokens();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t// On fail\n\t\t\t\t\t\t( response ) => {\n\t\t\t\t\t\t\t// Remove loading class to button\n\t\t\t\t\t\t\tmodalElements.modal.box.buttons.confirm.removeClass( 'uap-btn--loading' ).prop( 'disabled', false );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Do a call to set the recipe to draft\n\t\t\t\t\tif ( actionWillSetRecipeToDraft ){\n\t\t\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Can add, confirm\n\t\t\t\t\tif ( isDefined( callbacks.allowedConfirm ) ){\n\t\t\t\t\t\tcallbacks.allowedConfirm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t// Remove token\n\t\t\t\t\tif ( isDefined( callbacks.removeToken ) ){\n\t\t\t\t\t\tcallbacks.removeToken();\n\t\t\t\t\t}\n\n\t\t\t\t\t // Can add, confirm\n\t\t\t\t\tif ( isDefined( callbacks.allowedCancel ) ){\n\t\t\t\t\t\tcallbacks.allowedCancel();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass TokenSelectorTextarea extends TokenSelectorInput {\n\tconstructor( Field ){\n\t\tsuper( Field );\n\n\t\t// Check if it supports TinyMCE\n\t\tif ( this.Field.attributes.supportsTinyMCE ){\n\t\t\t// TinyMCE methods\n\t\t\tthis.Field.getField().on( 'ua-tinymce-ready', () => {\n\t\t\t\t// Get the CodeMirror editor\n\t\t\t\tthis.getTinyMCEEditor();\n\n\t\t\t\t// Add styles to the editor\n\t\t\t\tthis.addStylesToEditor();\n\n\t\t\t\t// Parse tokens in the TinyMCE editor\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.parsePlainTokensInTinyMCE({\n\t\t\t\t\t\tparseTokensInAttributes: false\n\t\t\t\t\t});\n\t\t\t\t}, this.data.tokenRenderingDebounce );\n\n\t\t\t\t// Parse tokens in the text editor\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.parseHTMLTokensInPlainTextarea();\n\t\t\t\t}, this.data.tokenRenderingDebounce );\n\t\t\t\t\n\t\t\t\t// Handle requests to add tokens to the field\n\t\t\t\tthis.handleAddTokens();\n\n\t\t\t\t// Handle tokens added to the textarea (HTML)\n\t\t\t\tthis.handleHTMLTokensInPlainTextarea();\n\n\t\t\t\t// Handle tokens added to TinyMCE (plain)\n\t\t\t\tthis.handlePlainTokensInTinyMCE();\n\t\t\t});\n\t\t}\n\t}\n\n\tsetData(){\n\t\tthis.data = {\n\t\t\ttokenRenderingDebounce: 200,\n\t\t\ttokenCSSClass: 'uap-token-tinymce' \n\t\t}\n\t}\n\n\trender(){\n\t\tthis.RenderTokenSelector = new RenderTokenSelector( this.Field, this.tokens );\n\t}\n\n\tinsertTextAtCursor( token = '' ){\n\t\t// Check if \"Text\" view is selected\n\t\t// Insert using CodeMirror methods\n\t\tif (\n\t\t\t// Doesn't have TinyMCE\n\t\t\t! isDefined( this.tinyMCEeditor )\n\t\t\t// It has TinyMCE, but it's hidden\n\t\t\t|| isDefined( this.tinyMCEeditor ) && this.tinyMCEeditor.hidden\n\t\t){\n\t\t\t// Insert content in the CM field at the current position\n\t\t\tthis.editor.doc.replaceRange( token, this.editor.doc.getCursor() );\n\t\t}\n\t\t// Insert using TinyMCE methods\n\t\telse {\n\t\t\t// Token without brackets\n\t\t\ttoken = token.replace( '{{', '' ).replace( '}}', '' );\n\n\t\t\t// Get the token HMTL\n\t\t\tconst $tokenNode = this.createTokenDOMNode( token );\n\n\t\t\t// Check if the token needs user data\n\t\t\t// Because of how TinyMCE works, we have to do this here\n\t\t\tif (\n\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\tUncannyAutomator.recipe.type == 'anonymous'\n\t\t\t\t// Check if the recipe currently doesn't require user data\n\t\t\t\t&& ! UncannyAutomator.recipe.requiresUserData\n\t\t\t\t// Check if the current tokens requires user data\n\t\t\t\t&& (\n\t\t\t\t\t// Check if the current tokens requires user data\n\t\t\t\t\tthis.tokensThatRequireUser.includes( token )\n\t\t\t\t\t// Check if it's the user meta token\n\t\t\t\t\t|| token.startsWith( 'USERMETA:' )\n\t\t\t\t)\n\t\t\t){\n\t\t\t\tthis.tokenNeedsUserModal( $tokenNode, {\n\t\t\t\t\tallowedConfirm: () => {\n\t\t\t\t\t\t// Insert token\n\t\t\t\t\t\tthis.tinyMCEeditor.execCommand( 'mceInsertContent', false, `<span class=\"${ this.data.tokenCSSClass }\" contenteditable=\"false\" data-token-id=\"${ token }\">${ $tokenNode.outerHTML }</span>` );\n\n\t\t\t\t\t\t// Trigger a change event in the field\n\t\t\t\t\t\tthis.Field.getField()\n\t\t\t\t\t\t\t.trigger( 'change input' );\n\t\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Insert token\n\t\t\t\tthis.tinyMCEeditor.execCommand( 'mceInsertContent', false, `<span class=\"${ this.data.tokenCSSClass }\" contenteditable=\"false\" data-token-id=\"${ token }\">${ $tokenNode.outerHTML }</span>` );\n\n\t\t\t\t// Trigger a change event in the field\n\t\t\t\tthis.Field.getField()\n\t\t\t\t\t.trigger( 'change input' );\n\t\t\t} \n\t\t}\n\t}\n\n\tgetTinyMCEEditor(){\n\t\tthis.tinyMCEeditor = this.Field.fieldTinyMCE;\n\t}\n\n\taddStylesToEditor(){\n\t\tthis.tinyMCEeditor.dom.addStyle( `\n\t\t\thtml body {\n\t\t\t\tfont-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n\t\t\t\tfont-size: 15px;\n\t\t\t\tmargin-left: 12px;\n\t\t\t\tmargin-right: 12px;\n\t\t\t}\n\n\t\t\t.uap-token {\n\t\t\t\tdisplay: inline-flex;\n\t\t\t\talign-items: center;\n\t\t\t\tbackground: #eee;\n\t\t\t\tline-height: 1;\n\t\t\t\tpadding: 3px 8px;\n\t\t\t\tborder-radius: 150px;\n\n\t\t\t\tfont-size: 15px;\n\t\t\t\tfont-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n\t\t\t\t-webkit-font-smoothing:antialiased;\n\t\t\t\t-moz-osx-font-smoothing:grayscale;\n\t\t\t}\n\n\t\t\t\t.uap-token-tinymce {\n\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\tline-height: 1;\n\t\t\t\t\tborder-radius: 150px;\n\t\t\t\t\tbox-shadow: 0 0 0 2px transparent;\n\t\t\t\t\ttransition: box-shadow 150ms ease-in-out;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\n\t\t\t\t.uap-token-tinymce[data-mce-selected=\"1\"] {\n\t\t\t\t\toutline: 0 !important;\n\t\t\t\t\tbox-shadow: 0 0 0 2px #0790e8;\n\t\t\t\t}\n\n\t\t\t\t.uap-token img {\n\t\t\t\t\twidth: 12px;\n\t\t\t\t\theight: 11px;\n\t\t\t\t\tmargin-right: 5px;\n\t\t\t\t\tobject-fit: contain;\n\t\t\t\t\tobject-position: center;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t}\n\n\t\t\t\t.uap-token .uo-icon {\n\t\t\t\t\twidth: 14px;\n\t\t\t\t\theight: 14px;\n\t\t\t\t\tborder: 1px solid #444;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tfont-size: 9px;\n\t\t\t\t\tcolor: #444;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tline-height: 15px;\n\t\t\t\t\tbackground: #fff;\n\t\t\t\t\topacity: .8;\n\t\t\t\t\tmargin-right: 5px;\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\n\t\t\t\t\t.uap-token .uo-icon.uo-icon--bolt:before {\n\t\t\t\t\t\tcontent: '';\n\n\t\t\t\t\t\twidth: 9px;\n\t\t\t\t\t\theight: 9px;\n\n\t\t\t\t\t\tbackground-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 384 512'%3E%3Cpath fill='%23444' d='M377.8 167.9c-8.2-14.3-23.1-22.9-39.6-22.9h-94.4l28.7-87.5c3.7-13.8.8-28.3-7.9-39.7C255.8 6.5 242.5 0 228.2 0H97.7C74.9 0 55.4 17.1 52.9 37.1L.5 249.3c-1.9 13.8 2.2 27.7 11.3 38.2C20.9 298 34.1 304 48 304h98.1l-34.9 151.7c-3.2 13.7-.1 27.9 8.6 38.9 8.7 11.1 21.8 17.4 35.9 17.4 16.3 0 31.5-8.8 38.8-21.6l183.2-276.7c8.4-14.3 8.4-31.5.1-45.8zM160.1 457.4L206.4 256H47.5L97.7 48l127.6-.9L177.5 193H334L160.1 457.4z'%3E%3C/path%3E%3C/svg%3E\");\n\n\t\t\t\t\t\tbackground-size: contain;\n\t\t\t\t\t\tbackground-position: center;\n\t\t\t\t\t\tbackground-repeat: no-repeat;\n\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\ttop: 50%;\n\t\t\t\t\t\tleft: 50%;\n\t\t\t\t\t\ttransform: translate(-50%,-50%);\n\t\t\t\t\t}\n\n\t\t\t\t.uap-token__name {\n\t\t\t\t\tcolor: #444444;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t}\n\n\t\t\t\t\t.uap-token--invalid {\n\t\t\t\t\t\tbackground: #f9e2e2;\n\t\t\t\t\t}\n\n\t\t\t\t\t.uap-token--invalid .uo-icon {\n\t\t\t\t\t\tcolor: #c00;\n\t\t\t\t\t\tborder-color: #c00;\n\t\t\t\t\t}\n\n\t\t` );\n\t}\n\n\thandleHTMLTokensInPlainTextarea(){\n\t\t// Listen changes to the field\n\t\tthis.Field.getField()\n\t\t\t.on( 'change input',\n\t\t\t\tdebounce(() => {\n\t\t\t\t\t// Parse tokens\n\t\t\t\t\tthis.parseHTMLTokensInPlainTextarea();\n\t\t\t\t}, this.data.tokenRenderingDebounce )\n\t\t\t);\n\n\t\t// Trigger a change event in the text field \n\t\t// when the user changes to the \"Text\" tab\n\t\tthis.Field.getField()\n\t\t\t.on( 'ua-tinymce-activate-text-view', () => {\n\t\t\t\t// Parse tokens\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.parseHTMLTokensInPlainTextarea();\n\t\t\t\t}, this.data.tokenRenderingDebounce );\n\t\t\t});\n\t}\n\n\thandlePlainTokensInTinyMCE(){\n\t\t// Trigger a change event in the text field \n\t\t// when the user changes to the \"Text\" tab\n\t\tthis.Field.getField()\n\t\t\t.on( 'ua-tinymce-activate-visual-view', () => {\n\t\t\t\t// Parse tokens in the editor\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.parsePlainTokensInTinyMCE({\n\t\t\t\t\t\tparseTokensInAttributes: false\n\t\t\t\t\t});\n\t\t\t\t}, this.data.tokenRenderingDebounce );\n\t\t\t});\n\t}\n\n\tparsePlainTokensInTinyMCE( options = {} ){\n\t\t// Get options\n\t\toptions = Object.assign( {\n\t\t\tparseTokensInAttributes: true\n\t\t}, options );\n\n\t\t// Get the content of the TinyMCE field\n\t\tconst editorContent = this.tinyMCEeditor.getContent({\n\t\t\tformat: 'raw'\n\t\t});\n\n\t\t// Render the tokens\n\t\tconst editorContentWithTokens = this.renderTextWithTokens(\n\t\t\teditorContent,\n\t\t\t{\n\t\t\t\t// 1. Token HTML, 2. Token ID\n\t\t\t\ttemplate: `<span class=\"${ this.data.tokenCSSClass }\" contenteditable=\"false\" data-token-id=\"%2$s\">%1$s</span>`,\n\t\t\t\tparseTokensInAttributes: options.parseTokensInAttributes\n\t\t\t}\n\t\t);\n\n\t\t// Check if the content is different\n\t\tif ( editorContent != editorContentWithTokens ){\n\t\t\t// Set the content again\n\t\t\tthis.tinyMCEeditor.setContent( editorContentWithTokens.innerHTML );\n\t\t}   \n\t}\n\n\tparseHTMLTokensInPlainTextarea(){\n\t\t// Get the content of the field\n\t\tlet content = this.Field.getField().val();\n\n\t\t// Remove the HTML and leave the tokens as plain text\n\t\tlet $temporalContainer = document.createElement( 'div' );\n\t\t$temporalContainer.innerHTML = content;\n\n\t\t// Get the HTML tokens\n\t\tconst $tokens = $temporalContainer.querySelectorAll( `.${ this.data.tokenCSSClass }` );\n\n\t\t// Check if it has tokens\n\t\t// Otherwise, do nothing\n\t\tif ( $tokens.length > 0 ){\n\t\t\t// Iterate the tokens\n\t\t\t$tokens.forEach(( $tokenNode ) => {\n\t\t\t\t// Get the token ID\n\t\t\t\tconst tokenID = $tokenNode.dataset.tokenId;\n\n\t\t\t\t// Replace the tokenNode with the tokenID\n\t\t\t\t$tokenNode.outerHTML = `{{${ tokenID }}}`;\n\t\t\t});\n\n\t\t\t// Update the content\n\t\t\tcontent = $temporalContainer.innerHTML;\n\n\t\t\t// Set the value of the normal field\n\t\t\t// But don't trigger the change event\n\t\t\ttry {\n\t\t\t\tthis.editor.setValue( content );\n\t\t\t} catch ( e ){\n\t\t\t\tthis.Field.getField().val( content );\n\t\t\t}\n\t\t}    \n\t}\n\n\tdestroy(){\n\t\tthis.RenderTokenSelector.destroy();\n\t}\n}\n\nclass RenderTokenSelector {\n\tconstructor( Field, tokens ){\n\t\tthis.Field  = Field;\n\t\tthis.tokens = tokens;\n\n\t\t// Get data\n\t\tthis.getData();\n\n\t\t// Get elements\n\t\tthis.getElements();\n\n\t\t// Create wrapper\n\t\tthis.createWrapper();\n\n\t\t// Create filter\n\t\tthis.createFilter();\n\n\t\t// Create groups of tokens\n\t\tthis.createGroupsOfTokens();\n\n\t\t// Open tokens on click\n\t\tthis.listenToggleButton();\n\n\t\t// Resize dropdown on window resize\n\t\tthis.resizeDropdownOnWindowResize();\n\n\t\t// Resize on scroll\n\t\tthis.resizeDropdownOnWindowScroll();\n\n\t\t// Refresh when the field value changes\n\t\tthis.refreshOnFieldChange();\n\n\t\t// Search\n\t\tthis.search();\n\n\t\t// Set default filter\n\t\tif ( this.shouldSupportFilters() ){\n\t\t\tthis.setFilter( true );\n\t\t}\n\t}\n\n\tgetData(){\n\t\tthis.data = {\n\t\t\tisOpen:   false,\n\t\t\tposition: 'below'\n\t\t}\n\t}\n\n\tgetElements(){\n\t\tthis.$elements = {\n\t\t\twrapper: null,\n\t\t\ttoggleButton: null,\n\t\t\tsearchField: null,\n\t\t\tdropdown: null,\n\t\t\tallGroups: null,\n\t\t\tdropdownGroupsContainer: null,\n\t\t\tdropdownTokens: null,\n\t\t\tnoResultsOption: null\n\t\t};\n\t}\n\n\tcreateWrapper(){\n\t\tconst $wrapper = $( `\n\t\t\t<div class=\"form-variable\">\n\t\t\t\t<div class=\"form-variable__element\">\n\t\t\t\t\t<div class=\"form-variable__render-container\"></div>\n\t\t\t\t\t<div class=\"form-variable__toggle\">\n\t\t\t\t\t\t<span class=\"uo-icon uo-icon--asterisk\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-variable__dropdown\">\n\t\t\t\t\t<div class=\"form-variable__dropdown-container\">\n\t\t\t\t\t\t<div class=\"form-variable__search\">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\tclass=\"form-variable__search-input\" \n\t\t\t\t\t\t\t\tplaceholder=\"${ UncannyAutomator.i18n.tokens.search }\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"form-variable__groups\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Get the fields that we have to move\n\t\tconst $fieldsToMove = [];\n\n\t\t// Check if it's a textarea\n\t\tif ( this.Field.type == 'textarea' ){\n\t\t\t$fieldsToMove.push( this.Field.getField() );\n\t\t}\n\n\t\t// Check if the CodeMirror field is defined\n\t\tif ( isDefined( this.Field.getFieldCM() ) ){\n\t\t\t$fieldsToMove.push( this.Field.getFieldCM() );\n\t\t}\n\n\t\t// Move the fields\n\t\t$fieldsToMove.forEach(( $field ) => {\n\t\t\t// Move the field\n\t\t\t$wrapper\n\t\t\t\t.insertAfter( $field );\n\n\t\t\t$wrapper\n\t\t\t\t.find( '.form-variable__render-container' )\n\t\t\t\t.append( $field );\n\t\t});\n\n\t\t// Save the element\n\t\tthis.$elements.wrapper = $wrapper;\n\n\t\t// Save the element that has the field inside\n\t\tthis.$elements.renderContainer = $wrapper\n\t\t\t.find( '.form-variable__render-container' );\n\n\t\t// Save the search field container\n\t\tthis.$elements.searchFieldContainer = $wrapper.find( '.form-variable__search' );\n\n\t\t// Save the search field\n\t\tthis.$elements.searchField = $wrapper.find( '.form-variable__search-input' );\n\n\t\t// Save the toggle button\n\t\tthis.$elements.toggleButton = $wrapper.find( '.form-variable__toggle' );\n\n\t\t// Save the dropdown\n\t\tthis.$elements.dropdown = $wrapper.find( '.form-variable__dropdown' );\n\n\t\t// Save the container of the groups\n\t\tthis.$elements.dropdownGroupsContainer = $wrapper.find( '.form-variable__groups' );\n\t}\n\n\tcreateFilter(){\n\t\t// Check if it's a field that should filter tokens\n\t\tif ( this.shouldSupportFilters() ){\n\t\t\t// Get the field type\n\t\t\tconst fieldType = this.Field.attributes.fieldType;\n\n\t\t\t// Get the field type human-readable name\n\t\t\tconst fieldTypeHumanReadable = isDefined( UncannyAutomator.i18n.tokens.tokenType[ fieldType ] ) ? UncannyAutomator.i18n.tokens.tokenType[ fieldType ] : fieldType;\n\n\t\t\t// Create filter container\n\t\t\tconst $filterContainer = $( `\n\t\t\t\t<div class=\"form-variable__filter\"></div>\n\t\t\t` );\n\n\t\t\t// Create checkbox\n\t\t\tconst filterToggle = new Field( 'checkbox', {\n\t\t\t\toptionCode:   'token__enableFilter',\n\t\t\t\tcurrentValue: true,\n\t\t\t\tlabel: `<span class=\"form-variable__filter-label\">` + vsprintf( UncannyAutomator.i18n.tokens.filter, [ `<span class=\"form-variable__filter-type\">${ fieldTypeHumanReadable }</span>` ] ) + `<span>`,\n\t\t\t});\n\n\t\t\t// Get checkbox form element\n\t\t\tconst $filterFormElement = filterToggle.createFormElement();\n\n\t\t\t// Add the field\n\t\t\t$filterContainer.prepend( $filterFormElement );\n\n\t\t\t// Add filter to the DOM\n\t\t\tthis.$elements.searchFieldContainer.append( $filterContainer );\n\n\t\t\t// Save the filter container\n\t\t\tthis.$elements.filterContainer = $filterContainer;\n\n\t\t\t// Listen changes to the checkbox value\n\t\t\t$filterFormElement.on( 'automator:field:change', () => {\n\t\t\t\t// Get value\n\t\t\t\tconst filterValue = filterToggle.getValue();\n\n\t\t\t\t// Check if we have to filter or remove the filter\n\t\t\t\tif ( filterValue ){\n\t\t\t\t\tthis.setFilter( true );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.setFilter( false );\n\t\t\t\t}\n\t\t\t});\n\t\t}    \n\t}\n\n\tcreateGroupsOfTokens(){\n\t\t// Get the container\n\t\tconst $container = this.$elements.wrapper.find( '.form-variable__groups' );\n\n\t\t// Iterate the groups of tokens\n\t\tthis.tokens.forEach(( groupOfTokens ) => {\n\t\t\t$container.append( this.createIndividualGroupOfTokens( groupOfTokens ) );\n\t\t});\n\n\t\t// Save all the groups\n\t\tthis.$elements.allGroups = $container.find( '.form-variable__group' );\n\n\t\t// Save all the items\n\t\tthis.$elements.dropdownTokens = $container.find( '.form-variable__group-item' );\n\n\t\t// Add the \"no results\" option\n\t\tthis.$elements.noResultsOption = $( `\n\t\t\t<div class=\"form-variable__group-item-no-results form-variable__group-item-no-results--hide\">\n\t\t\t\t<div class=\"form-variable__group-item-no-results-title\">\n\t\t\t\t\t${ UncannyAutomator.i18n.tokens.noResults }\n\t\t\t\t</div>\n\t\t\t\t<div class=\"form-variable__group-item-no-results-description\">\n\t\t\t\t\t${ this.shouldSupportFilters() ? UncannyAutomator.i18n.tokens.noResultsDescriptionWithFilter : UncannyAutomator.i18n.tokens.noResultsDescription }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\t\t$container.append( this.$elements.noResultsOption );\n\t}\n\n\tcreateIndividualGroupOfTokens( groupOfTokens ){\n\t\tconst $group = $( `\n\t\t\t<div \n\t\t\t\tclass=\"form-variable__group\"\n\t\t\t\tdata-id=\"${ groupOfTokens.id }\"\n\t\t\t>\n\t\t\t\t<div class=\"form-variable__group-source\">\n\t\t\t\t\t<div class=\"form-variable-group-source__icon\"></div>\n\t\t\t\t\t<div class=\"form-variable-group-source__description\"></div>\n\t\t\t\t\t<div class=\"form-variable-group-source__toggle\">\n\t\t\t\t\t\t<span class=\"form-variable-group-source__toggle-icon\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"form-variable__group-children\"></span>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Add the name\n\t\tconst groupName = groupOfTokens.name;\n\t\tif ( ! typeof groupName == 'string' ){\n\t\t\tgroupName = groupName.html.clone();\n\t\t}\n\n\t\t$group\n\t\t\t.find( '.form-variable-group-source__description' )\n\t\t\t.append( groupOfTokens.name );\n\n\t\t// Create the icon\n\t\tlet $icon = groupOfTokens.icon.clone();\n\n\t\t// Add the icon to the group\n\t\t$group.find( '.form-variable-group-source__icon' ).append( $icon );\n\n\t\t// Get the toggle button\n\t\tconst $toggleButton = $group.find( '.form-variable__group-source' );\n\t\t// Listen clicks to the toggle button\n\t\t$toggleButton.on( 'click', () => {\n\t\t\t$group.toggleClass( 'form-variable__group--open' );\n\t\t});\n\n\t\t// Get the container where we're going to add the tokens\n\t\tconst $tokensListContainer = $group.find( '.form-variable__group-children' );\n\n\t\t// Add tokens\n\t\tgroupOfTokens.tokens.forEach(( token ) => {\n\t\t\tlet tokenName = ! isEmpty( token.name ) ? token.name : '';\n\n\t\t\t// Create the token\n\t\t\tconst $token = $( `\n\t\t\t\t<div \n\t\t\t\t\tclass=\"form-variable__group-item\"\n\t\t\t\t\tdata-search=\"${\n\t\t\t\t\t\ttokenName\n\t\t\t\t\t\t\t.trim()\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.replace( /\\s/g, '' )\n\t\t\t\t\t}\"\n\t\t\t\t\tdata-type=\"${ token.type }\"\n\t\t\t\t>\n\t\t\t\t\t${ tokenName }\n\n\t\t\t\t\t${ UncannyAutomator.recipe.type == 'anonymous' && ! UncannyAutomator.recipe.requiresUserData && isDefined( token.requiresUser ) && token.requiresUser ? '<span class=\"form-variable__group-item-tag\">' + UncannyAutomator.i18n.needsUserData + '</span>' : '' }\n\t\t\t\t</div>\n\t\t\t` );\n\n\t\t\t// Check if it's the \"USERMETA:KEY\" token\n\t\t\tif ( token.id == 'USERMETA:KEY' ){\n\t\t\t\t// Listen clicks to the tokens\n\t\t\t\t$token.on( 'click', () => {\n\t\t\t\t\t// Close the token selector\n\t\t\t\t\tthis.close();\n\n\t\t\t\t\t// Create the content for the modal\n\t\t\t\t\tconst $modalContent = $( `<div></div>` );\n\n\t\t\t\t\t// Create the field\n\t\t\t\t\tconst metaKeyField = new Field( 'text', {\n\t\t\t\t\t\toptionCode: 'token__metaKeyField',\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.userMetaKey,\n\t\t\t\t\t\tdescription: UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.userMetaKeyDescription,\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t}); \n\n\t\t\t\t\t// Add the field\n\t\t\t\t\t$modalContent.append( metaKeyField.createFormElement() );\n\n\t\t\t\t\t// Show a modal\n\t\t\t\t\tconst modal = new Modal({\n\t\t\t\t\t\ttitle: UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.title,\n\t\t\t\t\t\tcontent: $modalContent,\n\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\t\t\t\tconfirm: UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.confirmButton,\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmodal.setEvents({\n\t\t\t\t\t\tafterSetEvents: () => {\n\t\t\t\t\t\t\tmodal.show();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonConfirm: () => {\n\t\t\t\t\t\t\t// Validate the field\n\t\t\t\t\t\t\tconst fieldValidation = metaKeyField.validate();\n\n\t\t\t\t\t\t\t// Get the field value\n\t\t\t\t\t\t\tconst fieldValue = metaKeyField.getValue();\n\n\t\t\t\t\t\t\t// Check if the field is valid\n\t\t\t\t\t\t\tif ( fieldValidation.isValid ){\n\t\t\t\t\t\t\t\t// Clone the token, don't modify the original\n\t\t\t\t\t\t\t\ttoken = $.extend( true, {}, token );\n\n\t\t\t\t\t\t\t\t// Change ID of the token\n\t\t\t\t\t\t\t\ttoken.id = token.id.replace( 'KEY', fieldValue );\n\n\t\t\t\t\t\t\t\t// Change name of the token\n\t\t\t\t\t\t\t\ttoken.name = vsprintf( UncannyAutomator.i18n.tokens.global.userMetaKeyTemplate, [ fieldValue ] );\n\n\t\t\t\t\t\t\t\t// Add the token\n\t\t\t\t\t\t\t\tthis.Field.field.trigger( 'ua-add-token', token );\n\n\t\t\t\t\t\t\t\t// Destroy the modal\n\t\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tafterHide: function(){\n\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Listen clicks to the tokens\n\t\t\t\t$token.on( 'click', () => {\n\t\t\t\t\t// Trigger event to add the token\n\t\t\t\t\tthis.Field.field.trigger( 'ua-add-token', token );\n\n\t\t\t\t\t// Close the token selector\n\t\t\t\t\tthis.close();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Add token\n\t\t\t$tokensListContainer.append( $token );\n\t\t});\n\n\t\treturn $group;\n\t}\n\n\tlistenToggleButton(){\n\t\tthis.$elements.toggleButton.on( 'click', () => {\n\t\t\t// Check if it's NOT open\n\t\t\tif ( ! this.data.isOpen ){\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t});\n\t}\n\n\tsearch(){\n\t\t// Listen changes to the search field\n\t\tthis.$elements.searchField.on( 'input', throttle( () => {\n\t\t\t// Get the value\n\t\t\tlet query = this.$elements.searchField.val();\n\n\t\t\t// Remove spaces and make the query lowercase\n\t\t\tquery = query\n\t\t\t\t.trim()\n\t\t\t\t.toLowerCase()\n\t\t\t\t.replace( /\\s/g, '' );\n\n\t\t\tif ( ! isEmpty( query ) ){\n\t\t\t\t// Open all groups of tokens\n\t\t\t\tthis.$elements.allGroups\n\t\t\t\t\t.addClass( 'form-variable__group--open' );\n\n\t\t\t\t// Hide all elements\n\t\t\t\tthis.$elements.dropdownTokens\n\t\t\t\t\t.addClass( 'form-variable__group-item--hidden-by-search' );\n\n\t\t\t\t// Get search matches\n\t\t\t\tconst $searchMatches = this.$elements.dropdownTokens\n\t\t\t\t\t.filter(( i, token ) => {\n\t\t\t\t\t\treturn token.dataset.search.search( query ) !== -1\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Show the search matches\n\t\t\t\t$searchMatches\n\t\t\t\t\t.removeClass( 'form-variable__group-item--hidden-by-search' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Close all groups\n\t\t\t\tthis.$elements.allGroups\n\t\t\t\t\t.removeClass( 'form-variable__group--open' );\n\n\t\t\t\t// Show all tokens\n\t\t\t\tthis.$elements.dropdownTokens\n\t\t\t\t\t.removeClass( 'form-variable__group-item--hidden-by-search' );\n\t\t\t}\n\n\t\t\t// Set the visibility of the group of tokens\n\t\t\tthis.updateGroupsOfTokensVisibility();\n\t\t}, 30 ) );\n\t}\n\n\tsetFilter( filterByType = true ){\n\t\t// Check if we have to filter\n\t\tif ( filterByType ){\n\t\t\t// Hide all elements\n\t\t\tthis.$elements.dropdownTokens\n\t\t\t\t.addClass( 'form-variable__group-item--hidden-by-filter' );\n\n\t\t\t// Get the tokens by type\n\t\t\tconst $tokensByType = this.$elements.dropdownTokens\n\t\t\t\t.filter(( i, token ) => {\n\t\t\t\t\t// Check if the field is a \"float\" field. In that case,\n\t\t\t\t\t// promote all the \"int\" tokens to \"float\". All integers\n\t\t\t\t\t// are floats\n\t\t\t\t\tconst tokenType = ( token.dataset.type == 'int' && this.Field.attributes.fieldType == 'float' ) ? 'float' : token.dataset.type;\n\n\t\t\t\t\t// Return the tokens that match the field type\n\t\t\t\t\treturn tokenType == this.Field.attributes.fieldType;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// Show the tokens that match the field type\n\t\t\t$tokensByType\n\t\t\t\t.removeClass( 'form-variable__group-item--hidden-by-filter' );\n\t\t}\n\t\telse {\n\t\t\t// Show all tokens\n\t\t\tthis.$elements.dropdownTokens\n\t\t\t\t.removeClass( 'form-variable__group-item--hidden-by-filter' );\n\t\t}\n\n\t\t// Set the visibility of the group of tokens\n\t\tthis.updateGroupsOfTokensVisibility();\n\t}\n\n\tupdateGroupsOfTokensVisibility(){\n\t\t// this.$elements.allGroups\n\t\t\t// .removeClass( 'form-variable__group--open' );\n\n\t\t// Create the variable that we will use to evaluate\n\t\t// if there are available tokens\n\t\tlet hasResults = false;\n\n\t\t// Show all the groups of tokens\n\t\tthis.$elements.allGroups\n\t\t\t.removeClass( 'form-variable__group--without-available-tokens' );\n\n\t\t// Hide the group of tokens that don't have available tokens\n\t\tthis.$elements.allGroups\n\t\t\t.filter(( i, group ) => {\n\t\t\t\t// Check if the group has available tokens\n\t\t\t\tconst groupHasAvailableTokens = group\n\t\t\t\t\t.querySelectorAll( '.form-variable__group-item:not(.form-variable__group-item--hidden-by-filter):not(.form-variable__group-item--hidden-by-search)' )\n\t\t\t\t\t.length > 0;\n\n\t\t\t\t// If it doesn't have available tokens, then hide the group\n\t\t\t\tif ( ! groupHasAvailableTokens ){\n\t\t\t\t\tgroup.classList.add( 'form-variable__group--without-available-tokens' );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// The group has available tokens, update \"hasResults\"\n\t\t\t\t\thasResults = true;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\t// Check if there are available tokens at all\n\t\tif ( hasResults ){\n\t\t\tthis.$elements.noResultsOption\n\t\t\t\t.addClass( 'form-variable__group-item-no-results--hide' );\n\t\t}\n\t\telse {\n\t\t\tthis.$elements.noResultsOption\n\t\t\t\t.removeClass( 'form-variable__group-item-no-results--hide' );\n\t\t}\n\t}\n\n\topen(){\n\t\t// If it's a date or time field, try to close\n\t\t// the calendar\n\t\tif ( [ 'date', 'time' ].includes( this.Field.attributes.fieldType ) ){\n\t\t\ttry {\n\t\t\t\tthis.Field.flatpickrInstance.close();\n\t\t\t} catch ( e ){\n\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warning( e );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add open class\n\t\tthis.$elements.wrapper.addClass( 'form-variable--open' );\n\n\t\t// Save status\n\t\tthis.data.isOpen = true;\n\n\t\t// Listen clicks outside the token selector and close it\n\t\tthis.closeWhenClickedOutside();\n\n\t\t// Reset the search field (remove the value)\n\t\tthis.$elements.searchField\n\t\t\t.val( '' )\n\t\t\t.trigger( 'input' )\n\t\t\t// Set padding of the search field depending on the width\n\t\t\t// of the checkbox label\n\t\t\t.css({\n\t\t\t\t'padding-right': `${ ( ( isDefined( this.$elements.filterContainer ) ? this.$elements.filterContainer.outerWidth() : 0 ) + 12 ) }px`\n\t\t\t});;\n\n\t\t// Focus the search field\n\t\tthis.$elements.searchField\n\t\t\t.focus();\n\t\t\t\t\t\t\t\t\n\t\t// Determine direction of the selector\n\t\tthis.setDropdownDirection();\n\n\t\t// Set scroll\n\t\tthis.setDropdownHeight();\n\t}\n\n\tclose(){\n\t\tthis.$elements.wrapper.removeClass( 'form-variable--open' );\n\n\t\t// Save status\n\t\tthis.data.isOpen = false;\n\n\t\t// Rest input value and trigger 'input' event\n\t\tthis.$elements.searchField\n\t\t\t.val( '' )\n\t\t\t.trigger( 'input' );\n\n\t\t// Stop listening clicks outside the token selector\n\t\t$( document ).off( 'mouseup.uap-token-selector-click-outside' );\n\t}\n\n\tdestroy(){\n\t\t// Remove all the elements but the original field\n\t\tthis.$elements.renderContainer.children().insertAfter( this.$elements.wrapper );\n\t\tthis.$elements.wrapper.remove();\n\t}\n\n\tcloseWhenClickedOutside(){\n\t\t$( document ).on( 'mouseup.uap-token-selector-click-outside', ( event ) => {\n\t\t\t// Set the targetted container\n\t\t\tconst $container = this.$elements.wrapper;\n\n\t\t\tif ( ! $container.is( event.target ) && $container.has( event.target ).length === 0 ){\n\t\t\t\t// Hide\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t});\n\t}\n\n\tgetDropdownPosition(){\n\t\tconst $window = $( window );\n\n\t\tconst position = {}\n\t\tposition.above = this.$elements.wrapper.offset().top - $window.scrollTop();\n\t\tposition.below = $window.height() - ( position.above + this.$elements.wrapper.outerHeight() );\n\n\t\t// Check if the current field is a textarea\n\t\tif ( this.Field.type == 'textarea' ){\n\t\t\t// Recalculate the space below\n\t\t\tposition.below = $window.height() - ( position.above + 38 );\n\t\t}\n\n\t\t// Add \"real size\" class. We're using this to\n\t\t// get the real size of the dropdown\n\t\tthis.$elements.dropdown.addClass( 'uo-realsize' );\n\t\t// Get the dropdown height\n\t\tconst dropdownHeight = this.$elements.dropdown.outerHeight() + 110; // + 75px to show at least 1 option\n\t\tthis.$elements.dropdown.removeClass( 'uo-realsize' );\n\n\t\t// Show dropdown always below for textareas\n\t\tif ( this.Field.type == 'textarea' ){\n\t\t\tposition.hasSpaceBelow = true;\n\t\t}\n\t\telse {\n\t\t\tposition.hasSpaceBelow = position.below >= dropdownHeight;\n\t\t}\n\n\t\treturn position;\n\t}\n\n\tsetDropdownDirection(){\n\t\t// Get the position of the dropdown\n\t\tconst position = this.getDropdownPosition();\n\n\t\t// Remove the position classes\n\t\tthis.$elements.wrapper.removeClass( 'form-variable--above form-variable--below' );\n\n\t\t// Determine the position\n\t\tif ( position.below > position.above || position.hasSpaceBelow ){\n\t\t\t// Let's show it below\n\t\t\tthis.$elements.wrapper.addClass( 'form-variable--below' );\n\n\t\t\t// Save the position\n\t\t\tthis.data.position = 'below';\n\t\t}\n\t\telse {\n\t\t\t// Let's show it above\n\t\t\tthis.$elements.wrapper.addClass( 'form-variable--above' );\n\n\t\t\t// Save the position\n\t\t\tthis.data.position = 'above';\n\t\t}\n\t}\n\n\tsetDropdownHeight(){\n\t\t// Check if it's open\n\t\tif ( this.data.isOpen ){\n\t\t\t// Get the max height of the dropdown\n\t\t\tconst maxHeight = this.getDropdownPosition()[ this.data.position ] - this.$elements.searchField.outerHeight() - 45;\n\n\t\t\t// Set the max height\n\t\t\tthis.$elements.dropdownGroupsContainer\n\t\t\t\t.css({ \n\t\t\t\t\t'max-height' : `${ maxHeight }px`\n\t\t\t\t});\n\t\t}\n\t}\n\n\tfocusSearchField(){\n\t\tthis.$elements.searchField\n\t\t\t.focus();\n\t}\n\n\tresizeDropdownOnWindowResize(){\n\t\t$( window ).on( 'resize', \n\t\t\tthrottle( () => {\n\t\t\t\t// Determine direction of the selector\n\t\t\t\tthis.setDropdownDirection();\n\n\t\t\t\t// Set height\n\t\t\t\tthis.setDropdownHeight();\n\t\t\t}, 20 )\n\t\t);\n\t}\n\n\tresizeDropdownOnWindowScroll(){\n\t\t$( window ).on( 'scroll', \n\t\t\tdebounce( () => {\n\t\t\t\t// Determine direction of the selector\n\t\t\t\tthis.setDropdownDirection();\n\n\t\t\t\t// Set height\n\t\t\t\tthis.setDropdownHeight();\n\t\t\t}, 300 )\n\t\t);\n\t}\n\n\trefreshOnFieldChange(){\n\t\t// CodeMirror methods\n\t\tthis.Field.formElement.on( 'automator:field:change', () => {\n\t\t\t// Determine direction of the selector\n\t\t\tthis.setDropdownDirection();\n\n\t\t\t// Set height\n\t\t\tthis.setDropdownHeight();\n\t\t});\n\t}\n\n\tshouldSupportFilters(){\n\t\t// Get the field type\n\t\tconst fieldType = this.Field.attributes.fieldType;\n\n\t\treturn [ 'email', 'int', 'float', 'url', 'date', 'time' ].includes( fieldType );\n\t}\n}","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\n// Import select2 (Dropdown)\n// select2.org\nimport 'select2';\n\n// Import flatpickr (DatePicker)\n// flatpickr.js.org\nimport flatpickr from 'flatpickr';\n\nimport {\n\tAJAXRequest,\n\tcompareStrings,\n\tgetCurrentFieldsValues,\n\tgetField,\n\tgetFieldTypes,\n\tgetUniqueId,\n\tinArray,\n\tisDefined,\n\tisEmpty,\n\tdebounce,\n\tremoveSpaces,\n} from '../common/utilities.js';\n\nimport { initURLChecker, validateField } from '../validation/validation.js';\n\nimport TokenSelector from '../tokens/token-selector.js';\n\n/**\n * Create a field\n *\n * @since 0.4\n * @param {string}              type                     - Field type\n * @param {object}              attributes               - Object with information about the field\n * @param {string}              attributes.itemType      Item type. Valid values are trigger, action and closure.\n * @param {int}                 attributes.itemID        ID of the recipe item\n * @param {(null|string|array)} attributes.defaultValue  Default value of the field\n * @param {string}              attributes.currentValue  Current value of the field\n * @param {string}              attributes.placeholder   Placeholder of the field\n * @param {string}              attributes.isHidden      Defines if the field should be hidden\n * @param {string}              attributes.label         Label of the field\n * @param {string}              attributes.description   Description of the field\n * @param {object}              attributes.options       Only used if the field is a select. All the options of the select.\n * @param {null|string}         [attributes.color]       Only used for checkboxes. Valid values are null, 'gutenberg' or 'green'\n * @param {null|string}         [attributes.align]       Only used for checkboxes. Valid values are null, 'left' or 'right'\n * @param {object}              [attributes.toggle]      Only used for checkboxes. Has On and Off strings\n * @param {string}              [attributes.toggle.on]   String shown when the toggle is selected\n * @param {string}              [attributes.toggle.off]  String shown when the toggle is unselected\n * @param {boolean}             attributes.isAjax        Only used if the field is a select. Add listner for the AJAX request.\n * @param {(null|string|array)} attributes.targetField   Only used if the field is a select. AJAX return values and populate this field.\n * @param {string}              attributes.integrationID Integration of plugin\n * @param {string}              attributes.endPoint      endPoint for Ajax Call\n */\n\nclass Field {\n\tconstructor( type, attributes, createDOMelements = true, customValidationFunction = null ) {\n\t\tthis.type = type;\n\n\t\tthis.attributes = this.setAttributes( attributes );\n\t\tthis.customValidationFunction = customValidationFunction;\n\n\t\tif ( createDOMelements ) {\n\t\t\tthis.createFormElement();\n\t\t}\n\t}\n\n\t/**\n\t * Create a jQuery DOM element with the field\n\t *\n\t * @since 0.3\n\t */\n\n\tcreateFormElement( initLibraries = true ) {\n\t\t// Create response object\n\t\tlet response = null;\n\n\t\t// Local variables\n\t\tconst type = this.type;\n\t\tconst attributes = this.attributes;\n\n\t\t// Check if it's a valid field type\n\t\tif ( inArray( type, getFieldTypes() ) ) {\n\t\t\t// Create form element container, this is global\n\t\t\tconst formElement = $( '<div/>', { class: 'form-element' } );\n\n\t\t\t// Check the user is trying to add a custom class to the formElement element\n\t\t\tif ( isDefined( attributes.formElementClass ) ) {\n\t\t\t\tformElement.addClass( attributes.formElementClass );\n\t\t\t}\n\n\t\t\t// Fields attributes, those will be added to the field jQuery object\n\t\t\tconst fieldAttributes = {\n\t\t\t\tname: attributes.optionCode,\n\t\t\t\tid: attributes.uniqueFieldID,\n\n\t\t\t\t'data-isajax': attributes.isAjax,\n\t\t\t\t'data-targetfield': attributes.targetField,\n\t\t\t\t'data-integrationid': attributes.integrationID,\n\t\t\t\t'data-endPoint': attributes.endPoint,\n\n\t\t\t\t'data-supportsTokens': attributes.supportsTokens,\n\t\t\t\t'data-supportsTinymce': attributes.supportsTinyMCE,\n\t\t\t\t'data-required': attributes.isRequired,\n\t\t\t\t'data-item_type': attributes.itemType,\n\t\t\t\t'data-item-id': attributes.itemId,\n\n\t\t\t\t'data-option-group': attributes.groupId,\n\n\t\t\t\t'data-is-hidden': attributes.isHidden,\n\t\t\t\t'data-is-child-field': attributes.isChildField,\n\t\t\t};\n\n\t\t\t// Define field container variable once. An different jQuery object will be created based on the field type\n\t\t\tlet fieldContainer, field;\n\n\t\t\t// Create field based in field type\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'select':\n\t\t\t\t\t// Field container\n\t\t\t\t\tfieldContainer = $( '<div/>', {\n\t\t\t\t\t\tclass: 'form-select',\n\t\t\t\t\t} );\n\n\t\t\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t\t\t// Create select element and add fieldAttributes to jQuery object. Merge second object into fieldAttributes, recursively\n\t\t\t\t\tfield = $(\n\t\t\t\t\t\t'<select/>',\n\t\t\t\t\t\t$.extend( {}, fieldAttributes, {\n\t\t\t\t\t\t\t'data-type': 'select',\n\t\t\t\t\t\t\tclass: 'form-element__select',\n\t\t\t\t\t\t\t'data-supports-custom-value': attributes.supportsCustomValue,\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Check if it supports multiple values\n\t\t\t\t\tif ( attributes.supportsMultipleValues ) {\n\t\t\t\t\t\t// Make it a multiple select\n\t\t\t\t\t\tfield.prop( 'multiple', 'multiple' );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.field = field;\n\n\t\t\t\t\tlet hasSelectedOption = false,\n\t\t\t\t\t\tnumberOfOptions = 0,\n\t\t\t\t\t\tdefaultValue,\n\t\t\t\t\t\tdefaultOptionExists;\n\n\t\t\t\t\t// Check if it has default option and get the default option's value\n\t\t\t\t\tif ( attributes.hasDefaultValue ) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t! isEmpty( attributes.defaultValue.option_value ) &&\n\t\t\t\t\t\t\t! isEmpty( attributes.defaultValue.option_name )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// The default option has value and name, so we have to add a new option instead of searching for one\n\t\t\t\t\t\t\tdefaultValue = attributes.defaultValue.option_value;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdefaultValue = attributes.defaultValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create select options\n\t\t\t\t\tconst $normalOptions = $(\n\t\t\t\t\t\t`<optgroup\n\t\t\t\t\t\t\ttitle=\"form-element__select-normal-options\"\n\t\t\t\t\t\t\tclass=\"form-element__select-normal-options\">\n\t\t\t\t\t\t</optgroup>`\n\t\t\t\t\t);\n\n\t\t\t\t\t// console.log( attributes.label );\n\t\t\t\t\t// console.log( ' Original value: ' + attributes.currentValue );\n\n\t\t\t\t\t// Remove the \"automator_custom_value\" option\n\t\t\t\t\tattributes.options = attributes.options.filter( ( option ) => {\n\t\t\t\t\t\treturn option.value !== 'automator_custom_value';\n\t\t\t\t\t} );\n\n\t\t\t\t\t$.each( attributes.options, function ( value, option_data ) {\n\t\t\t\t\t\tconst selectOption = $( '<option/>', {\n\t\t\t\t\t\t\tvalue: option_data.value,\n\t\t\t\t\t\t\ttext: option_data.text,\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// Check if one of the options value match with the default value. In that case, just select it instead of creating another one with the same value\n\t\t\t\t\t\tif ( attributes.hasDefaultValue && compareStrings( defaultValue, value ) ) {\n\t\t\t\t\t\t\tselectOption.prop( 'selected', true );\n\t\t\t\t\t\t\tdefaultOptionExists = true;\n\t\t\t\t\t\t\thasSelectedOption = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// But also check if the select has a value (and it's not empty), in that case we have to select that one\n\t\t\t\t\t\tif ( attributes.hasValue && compareStrings( attributes.currentValue, option_data.value ) ) {\n\t\t\t\t\t\t\tselectOption.prop( 'selected', true );\n\t\t\t\t\t\t\thasSelectedOption = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tselectOption.appendTo( $normalOptions );\n\t\t\t\t\t\tnumberOfOptions++;\n\t\t\t\t\t} );\n\t\t\t\t\t// Append options to the field\n\t\t\t\t\t$normalOptions.appendTo( field );\n\n\t\t\t\t\t//  Check if it's a multiselect\n\t\t\t\t\tif ( attributes.supportsMultipleValues ) {\n\t\t\t\t\t\t// If so, check if it's has a current value\n\t\t\t\t\t\tif ( ! isEmpty( attributes.currentValue ) ) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tfield.val( attributes.currentValue );\n\t\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if it has a selected value\n\t\t\t\t\t\tif ( ! isEmpty( field.val() ) ) {\n\t\t\t\t\t\t\thasSelectedOption = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if an option was selected, if not then check if we have a default option that doesn't exist in the select, in that case, create one\n\t\t\t\t\tif ( attributes.hasDefaultValue && ! defaultOptionExists ) {\n\t\t\t\t\t\t// Create option\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t! isEmpty( attributes.defaultValue.option_value ) &&\n\t\t\t\t\t\t\t! isEmpty( attributes.defaultValue.option_name )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst defaultOption = $( '<option/>', {\n\t\t\t\t\t\t\t\tvalue: attributes.defaultValue.option_value,\n\t\t\t\t\t\t\t\ttext: attributes.defaultValue.option_name,\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t! attributes.hasValue &&\n\t\t\t\t\t\t\t\t! compareStrings( attributes.defaultValue.option_value, attributes.currentValue )\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tdefaultOption.prop( 'selected', true );\n\t\t\t\t\t\t\t\thasSelectedOption = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Add first (or second, if the select has a placeholder)\n\t\t\t\t\t\t\tdefaultOption.prependTo( field );\n\t\t\t\t\t\t\tnumberOfOptions++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if we have to add a placeholder\n\t\t\t\t\tif ( attributes.hasPlaceholder ) {\n\t\t\t\t\t\t// Add empty option at the top\n\t\t\t\t\t\tfield.prepend( '<option></option>' );\n\n\t\t\t\t\t\t// If nothing else is selected, then remove the selected\n\t\t\t\t\t\t// value of the select\n\t\t\t\t\t\tif ( ! attributes.hasDefaultValue && ! attributes.hasValue ) {\n\t\t\t\t\t\t\tfield.find( 'option:selected' ).prop( 'selected', false );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if this select supports the token selector\n\t\t\t\t\t// If it does, create the \"Custom value\" field\n\t\t\t\t\tif ( attributes.supportsCustomValue ) {\n\t\t\t\t\t\tlet customFieldValue = attributes.customValue;\n\n\t\t\t\t\t\t// Create \"Other options\" section\n\t\t\t\t\t\tconst $otherOptions = $( `\n\t\t\t\t\t\t\t<optgroup label=\"${ UncannyAutomator.i18n.validation.field.select.otherOptions }\">\n\t\t\t\t\t\t\t\t<option value=\"automator_custom_value\">${ UncannyAutomator.i18n.validation.field.select.customValue }</option>\n\t\t\t\t\t\t\t</optgroup>\n\t\t\t\t\t\t` );\n\n\t\t\t\t\t\t// Append \"Other options\" to the field\n\t\t\t\t\t\tfield.append( $otherOptions );\n\n\t\t\t\t\t\t// Check if we have to select it\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tattributes.hasValue &&\n\t\t\t\t\t\t\tcompareStrings( attributes.currentValue, 'automator_custom_value' )\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// Select that option\n\t\t\t\t\t\t\t$otherOptions.find( 'option' ).attr( 'selected', true );\n\t\t\t\t\t\t\thasSelectedOption = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if it doesn't have a selected value\n\t\t\t\t\t\tif ( attributes.hasValue && ! hasSelectedOption ) {\n\t\t\t\t\t\t\t// Select that option\n\t\t\t\t\t\t\t$otherOptions.find( 'option' ).attr( 'selected', true );\n\t\t\t\t\t\t\thasSelectedOption = true;\n\n\t\t\t\t\t\t\t// Set the current value as the custom value\n\t\t\t\t\t\t\tcustomFieldValue = attributes.currentValue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Create the custom field\n\t\t\t\t\t\tthis.customValueField = new Field( 'text', {\n\t\t\t\t\t\t\titemId: attributes.itemId,\n\t\t\t\t\t\t\titemType: attributes.itemType,\n\n\t\t\t\t\t\t\tisRequired: attributes.isRequired,\n\t\t\t\t\t\t\tisReadOnly: false,\n\t\t\t\t\t\t\tsupportsTinyMCE: false,\n\t\t\t\t\t\t\tsupportsCopyToClipboard: false,\n\t\t\t\t\t\t\tsupportsTokens: attributes.supportsTokens,\n\n\t\t\t\t\t\t\tisAjax: false, //\n\n\t\t\t\t\t\t\tfieldType: 'text',\n\t\t\t\t\t\t\toptionCode: `${ attributes.optionCode }_custom`,\n\n\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\tdescription: attributes.hasCustomValueDescription\n\t\t\t\t\t\t\t\t? attributes.customValueDescription\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\tplaceholder: '',\n\t\t\t\t\t\t\tisHidden: false,\n\t\t\t\t\t\t\ttokenName: vsprintf( UncannyAutomator.i18n.validation.field.select.customValueToken, [\n\t\t\t\t\t\t\t\tattributes.label,\n\t\t\t\t\t\t\t] ),\n\n\t\t\t\t\t\t\tdefaultValue: null,\n\t\t\t\t\t\t\tcurrentValue: customFieldValue,\n\n\t\t\t\t\t\t\tisChildField: true,\n\t\t\t\t\t\t\tparentOptionCode: attributes.optionCode,\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Has a selected option\n\t\t\t\t\tthis.selectHasSelectedOption = hasSelectedOption;\n\n\t\t\t\t\t// Check if it has options, if it doesn't then add one and disable\n\t\t\t\t\tif ( numberOfOptions == 0 ) {\n\t\t\t\t\t\tconst $noResults = $( new Option( UncannyAutomator.i18n.noResults, '', true, true ) );\n\n\t\t\t\t\t\t$noResults.prop( 'disabled', true );\n\n\t\t\t\t\t\tthis.field.find( '.form-element__select-normal-options' ).append( $noResults );\n\n\t\t\t\t\t\tif ( ! this.attributes.supportsCustomValue ) {\n\t\t\t\t\t\t\t// Disable the select\n\t\t\t\t\t\t\tthis.field.prop( 'disabled', true );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Bind changes\n\t\t\t\t\tfield.on( 'change', function( event, customData ) {\n\t\t\t\t\t\tformElement.trigger( 'automator:field:change', customData );\n\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'url':\n\t\t\t\tcase 'email':\n\t\t\t\tcase 'int':\n\t\t\t\tcase 'float':\n\t\t\t\tcase 'date':\n\t\t\t\tcase 'time':\n\t\t\t\t\t// FALLTHROUGH: These fields share the same structure as all of them are input text. The validation is done by another function. For now, these fields types only have two differences, the CSS class added in fieldContainer and the type property of the attributes object added to the field variable.\n\n\t\t\t\t\t// Create CSS classes that will be used by the field container element. This will create classes like \"form-input--url\". They are not used for validation but are useful to add custom CSS to each field\n\t\t\t\t\tconst fieldContainerClass = `form-input form-input--${ type }`;\n\n\t\t\t\t\t// Field container\n\t\t\t\t\tfieldContainer = $( '<div/>', {\n\t\t\t\t\t\tclass: fieldContainerClass,\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Add the CodeMirror field\n\t\t\t\t\tthis.$fakeCodemirrorField = $( '<div/>', {\n\t\t\t\t\t\tclass: 'form-element__input-cm',\n\t\t\t\t\t} );\n\n\t\t\t\t\tfieldContainer.append( this.$fakeCodemirrorField );\n\n\t\t\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t\t\t// Create input element and add fieldAttributes to jQuery object. Merge second object into fieldAttributes, recursively\n\t\t\t\t\tfield = $(\n\t\t\t\t\t\t'<input/>',\n\t\t\t\t\t\t$.extend( {}, fieldAttributes, {\n\t\t\t\t\t\t\tclass: 'form-element__input',\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t'data-type': type,\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Check if maxlength is defined\n\t\t\t\t\tif ( isDefined( attributes.maxLength ) ) {\n\t\t\t\t\t\tfield.prop( 'maxlength', attributes.maxLength );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.field = field;\n\n\t\t\t\t\t// Add tokens CSS class to field. This will be used to render the Token Selector once the element is added to the DOM\n\t\t\t\t\tif ( attributes.supportsTokens ) {\n\t\t\t\t\t\tfieldContainer.addClass( 'form-input--token' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the field has a placeholder and add it\n\t\t\t\t\tif ( attributes.hasPlaceholder ) {\n\t\t\t\t\t\tfield.prop( 'placeholder', attributes.placeholder );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the field has a value and add it\n\t\t\t\t\tif ( attributes.hasValue ) {\n\t\t\t\t\t\tfield.prop( 'value', attributes.currentValue );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Now that we now that the field doesn't have a value we can check if the developer defined a default value\n\t\t\t\t\t\tif ( attributes.hasDefaultValue ) {\n\t\t\t\t\t\t\tfield.prop( 'value', attributes.defaultValue );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add \"clear\" button to date and time fields\n\t\t\t\t\tif ( [ 'date', 'time' ].includes( attributes.fieldType ) ) {\n\t\t\t\t\t\t// Add button\n\t\t\t\t\t\tconst $clearButton = $( `\n\t\t\t\t\t\t\t\t<div class=\"form-element__input-clear\" uap-tooltip=\"${ UncannyAutomator.i18n.clear }\">\n\t\t\t\t\t\t\t\t\t<span class=\"uo-icon uo-icon--times\"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t` );\n\n\t\t\t\t\t\t// Add class to the container\n\t\t\t\t\t\tfieldContainer.addClass( 'form-input--has-clear' );\n\n\t\t\t\t\t\t// Append the clear button\n\t\t\t\t\t\tthis.$fakeCodemirrorField.append( $clearButton );\n\n\t\t\t\t\t\t// Listen clicks to the button\n\t\t\t\t\t\t$clearButton.on( 'click', () => {\n\t\t\t\t\t\t\tthis.clearValue();\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Bind changes\n\t\t\t\t\tfield.on( 'input', function() {\n\t\t\t\t\t\tformElement.trigger( 'automator:field:change' );\n\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'textarea':\n\t\t\t\t\t// Field container\n\t\t\t\t\tfieldContainer = $( '<div/>', { class: 'form-textarea' } );\n\n\t\t\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t\t\t// Create textarea\n\t\t\t\t\tfield = $(\n\t\t\t\t\t\t'<textarea/>',\n\t\t\t\t\t\t$.extend( true, fieldAttributes, {\n\t\t\t\t\t\t\t'data-type': 'textarea',\n\t\t\t\t\t\t\tclass: 'form-element__textarea',\n\t\t\t\t\t\t\t'data-item_type': attributes.itemType,\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Check if maxlength is defined\n\t\t\t\t\tif ( isDefined( attributes.maxLength ) ) {\n\t\t\t\t\t\tfield.prop( 'maxlength', attributes.maxLength );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.field = field;\n\n\t\t\t\t\t// Add tokens CSS class to field. This will be used to render the Token Selector once the element is added to the DOM\n\t\t\t\t\tif ( attributes.supportsTokens ) {\n\t\t\t\t\t\tfieldContainer.addClass( 'form-textarea--token' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the field has a placeholder and add it\n\t\t\t\t\tif ( attributes.hasPlaceholder ) {\n\t\t\t\t\t\tfield.prop( 'placeholder', attributes.placeholder );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Add the CodeMirror field\n\t\t\t\t\t// All textareas have a CodeMirror editor, independently on\n\t\t\t\t\t// whether they also have TinyMCE.\n\t\t\t\t\tthis.$fakeCodemirrorField = $( '<div/>', {\n\t\t\t\t\t\tclass: 'form-element__input-cm',\n\t\t\t\t\t} );\n\n\t\t\t\t\tfieldContainer.append( this.$fakeCodemirrorField );\n\n\t\t\t\t\t// Check if the field has a value and add it\n\t\t\t\t\tif ( attributes.hasValue ) {\n\t\t\t\t\t\tfield.text( attributes.currentValue );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Now that we now that the field doesn't have a value we can check if the developer defined a default value\n\t\t\t\t\t\tif ( attributes.hasDefaultValue ) {\n\t\t\t\t\t\t\tfield.text( attributes.defaultValue );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Bind changes\n\t\t\t\t\tfield.on( 'input', function() {\n\t\t\t\t\t\tformElement.trigger( 'automator:field:change' );\n\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\t// Field container\n\t\t\t\t\tfieldContainer = $( '<div/>', { class: 'form-checkbox' } );\n\n\t\t\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t\t\tconst checkboxLabel = $( '<label/>', { class: 'form-checkbox__container' } );\n\t\t\t\t\tconst checkboxPseudo = $( '<div/>', { class: 'checkbox--show' } );\n\n\t\t\t\t\t// Create checkbox\n\t\t\t\t\tfield = $(\n\t\t\t\t\t\t'<input/>',\n\t\t\t\t\t\t$.extend( {}, fieldAttributes, {\n\t\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\t\t'data-type': 'checkbox',\n\t\t\t\t\t\t\tclass: 'checkbox--hidden checkbox--primary',\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Check if checked by default\n\t\t\t\t\tif ( attributes.hasValue && attributes.currentValue ) {\n\t\t\t\t\t\tfield.prop( 'checked', true );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.field = field;\n\n\t\t\t\t\t// Add label\n\t\t\t\t\tif ( attributes.hasLabel ) {\n\t\t\t\t\t\tcheckboxLabel.html( attributes.label );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Append elements\n\t\t\t\t\tfieldContainer.append( checkboxLabel );\n\t\t\t\t\tcheckboxLabel.append( field );\n\t\t\t\t\tcheckboxLabel.append( checkboxPseudo );\n\n\t\t\t\t\t// Check if we have to render a Toggle\n\t\t\t\t\tif ( isDefined( attributes.isToggle ) && attributes.isToggle ) {\n\t\t\t\t\t\tfieldContainer.addClass( 'form-checkbox--toggle' );\n\n\t\t\t\t\t\t// Check if we have to add on and off strings divs\n\t\t\t\t\t\tif ( isDefined( attributes.toggle ) ) {\n\t\t\t\t\t\t\t// Check \"on\"\n\t\t\t\t\t\t\tif ( isDefined( attributes.toggle.on ) ) {\n\t\t\t\t\t\t\t\tconst checkboxToggleOn = $( '<span/>', {\n\t\t\t\t\t\t\t\t\tclass: 'checkbox-label checkbox-label--on',\n\t\t\t\t\t\t\t\t} ).text( attributes.toggle.on );\n\t\t\t\t\t\t\t\tcheckboxLabel.append( checkboxToggleOn );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Check \"off\"\n\t\t\t\t\t\t\tif ( isDefined( attributes.toggle.off ) ) {\n\t\t\t\t\t\t\t\tconst checkboxToggleOff = $( '<span/>', {\n\t\t\t\t\t\t\t\t\tclass: 'checkbox-label checkbox-label--off',\n\t\t\t\t\t\t\t\t} ).text( attributes.toggle.off );\n\t\t\t\t\t\t\t\tcheckboxLabel.append( checkboxToggleOff );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Define color\n\t\t\t\t\tif ( isDefined( attributes.color ) ) {\n\t\t\t\t\t\t// Check if the color is valid\n\t\t\t\t\t\tif ( inArray( attributes.color, [ 'gutenberg', 'green' ] ) ) {\n\t\t\t\t\t\t\t// Add class\n\t\t\t\t\t\t\tswitch ( attributes.color ) {\n\t\t\t\t\t\t\t\tcase 'gutenberg':\n\t\t\t\t\t\t\t\t\tfieldContainer.addClass( 'form-checkbox--toggle-gutenberg' );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase 'green':\n\t\t\t\t\t\t\t\t\tfieldContainer.addClass( 'form-checkbox--toggle-green' );\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\tvsprintf( 'The color %s does not exists. Default color will be used instead.', [\n\t\t\t\t\t\t\t\t\tattributes.color,\n\t\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Define align\n\t\t\t\t\tif ( isDefined( attributes.align ) ) {\n\t\t\t\t\t\t// Check if it's a valid value\n\t\t\t\t\t\tif ( inArray( attributes.align, [ 'left', 'right' ] ) ) {\n\t\t\t\t\t\t\t// Check if it's 'right', otherwise ignore, since 'left' doesn't needs a class\n\t\t\t\t\t\t\tif ( attributes.align == 'right' ) {\n\t\t\t\t\t\t\t\t// Add class\n\t\t\t\t\t\t\t\tfieldContainer.addClass( 'form-checkbox--toggle-right' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\tvsprintf( 'The alignment %s does not exists. %s will be used instead.', [\n\t\t\t\t\t\t\t\t\tattributes.align,\n\t\t\t\t\t\t\t\t\t'\"left\"',\n\t\t\t\t\t\t\t\t] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Bind changes\n\t\t\t\t\tfield.on( 'change', function( event, customData ) {\n\t\t\t\t\t\tformElement.trigger( 'automator:field:change', customData );\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Change field variable with all the container\n\t\t\t\t\tfield = checkboxLabel;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\t// Field container\n\t\t\t\t\tfieldContainer = $( '<div/>', { class: 'form-radio' } );\n\t\t\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t\t\t// Create array to save all the jQuery DOM elements\n\t\t\t\t\tlet $fields = $(),\n\t\t\t\t\t\t$fieldContainers = $();\n\n\t\t\t\t\t// Iterate options\n\t\t\t\t\t$.each( attributes.options, function( index, option ) {\n\t\t\t\t\t\t// Create container\n\t\t\t\t\t\tconst $formRadioContainer = $( '<label/>', { class: 'form-radio__container' } );\n\n\t\t\t\t\t\t// Add label\n\t\t\t\t\t\t$formRadioContainer.html( option.text );\n\n\t\t\t\t\t\t// Create radio\n\t\t\t\t\t\tconst $field = $(\n\t\t\t\t\t\t\t'<input/>',\n\t\t\t\t\t\t\t$.extend( {}, fieldAttributes, {\n\t\t\t\t\t\t\t\ttype: 'radio',\n\t\t\t\t\t\t\t\t'data-type': 'radio',\n\t\t\t\t\t\t\t\tclass: 'radio--hidden radio--primary',\n\n\t\t\t\t\t\t\t\tvalue: option.value,\n\t\t\t\t\t\t\t\tname: fieldAttributes.id,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Save radio\n\t\t\t\t\t\t$fields = $fields.add( $field );\n\n\t\t\t\t\t\t// Create fake radio\n\t\t\t\t\t\tconst $fakeRadio = $( '<div/>', { class: 'radio--show' } );\n\n\t\t\t\t\t\t// Append elements\n\t\t\t\t\t\t$formRadioContainer.append( $field );\n\t\t\t\t\t\t$formRadioContainer.append( $fakeRadio );\n\n\t\t\t\t\t\t// Check if this field has a value, if it does, and the value\n\t\t\t\t\t\t// matches the input radio name, then check it\n\t\t\t\t\t\tif ( attributes.hasValue && attributes.currentValue == option.value ) {\n\t\t\t\t\t\t\t$field.prop( 'checked', true );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Otherwise, check if it has a default value and use that\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\t! attributes.hasValue &&\n\t\t\t\t\t\t\tattributes.hasDefaultValue &&\n\t\t\t\t\t\t\tattributes.defaultValue == option.value\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t$field.prop( 'checked', true );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Save container\n\t\t\t\t\t\t$fieldContainers = $fieldContainers.add( $formRadioContainer );\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Save fields\n\t\t\t\t\tthis.field = $fieldContainers;\n\t\t\t\t\tfield = $fieldContainers;\n\n\t\t\t\t\t// Bind changes\n\t\t\t\t\t$fields.on( 'change', ( event, customData ) => {\n\t\t\t\t\t\t// Check if the value is different\n\t\t\t\t\t\tformElement.trigger( 'automator:field:change', customData );\n\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Append field jQuery object to field container\n\t\t\tfieldContainer.append( field );\n\n\t\t\t// Create label\n\n\t\t\t// Create Label, even if it's empty but the field is required, so we can add the asterisk\n\t\t\tlet fieldLabel;\n\n\t\t\tif ( type != 'checkbox' && ( attributes.hasLabel || attributes.isRequired ) ) {\n\t\t\t\tfieldLabel = $( '<label/>', {\n\t\t\t\t\tclass: 'form-element__label',\n\t\t\t\t\tfor: attributes.uniqueFieldID,\n\t\t\t\t} );\n\n\t\t\t\t// Add label text\n\t\t\t\tif ( attributes.hasLabel ) {\n\t\t\t\t\tfieldLabel.html( attributes.label );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if it's a required field\n\t\t\tif ( attributes.isRequired ) {\n\t\t\t\t// Add required class to the field container\n\t\t\t\tfieldContainer.addClass( 'form-element--required' );\n\n\t\t\t\t// Check if it's a checkbox\n\t\t\t\tif ( attributes.fieldType == 'checkbox' ) {\n\t\t\t\t\t// Add required attribute to the field\n\t\t\t\t\tfield.find( 'input' ).prop( 'required', true );\n\n\t\t\t\t\t// Add asterisk to the label\n\t\t\t\t\tif ( attributes.hasLabel ) {\n\t\t\t\t\t\t// Add required icon next to label\n\t\t\t\t\t\tconst fieldLabelAsterisk = $( '<span/>', { class: 'form-element-label__required' } );\n\t\t\t\t\t\tfield.append( fieldLabelAsterisk );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Add required attribute to the field\n\t\t\t\t\tfield.prop( 'required', true );\n\n\t\t\t\t\t// Add asterisk to the label\n\t\t\t\t\tif ( attributes.hasLabel ) {\n\t\t\t\t\t\t// Add required icon next to label\n\t\t\t\t\t\tconst fieldLabelAsterisk = $( '<span/>', { class: 'form-element-label__required' } );\n\t\t\t\t\t\tfieldLabel.append( fieldLabelAsterisk );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if it's read only\n\t\t\tif ( isDefined( attributes.isReadOnly ) && attributes.isReadOnly ) {\n\t\t\t\t// Check if it's NOT a date or time field\n\t\t\t\tif ( ! [ 'date', 'time' ].includes( this.attributes.fieldType ) ) {\n\t\t\t\t\t// Add required class to the field container\n\t\t\t\t\tfieldContainer.addClass( 'form-element--readonly' );\n\t\t\t\t}\n\n\t\t\t\t// Check if it's a select\n\t\t\t\tif ( attributes.fieldType == 'select' ) {\n\t\t\t\t\t// Disable the select\n\t\t\t\t\tfield.prop( 'disabled', true );\n\t\t\t\t} else if ( [ 'checkbox', 'radio' ].includes( attributes.fieldType ) ) {\n\t\t\t\t\t// Disable the radio and checkbox\n\t\t\t\t\tfield.find( 'input' ).prop( 'disabled', true );\n\t\t\t\t} else {\n\t\t\t\t\t// Add read only attribute to the field\n\t\t\t\t\tfield.prop( 'readonly', true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Append label element if is defined\n\t\t\tif ( attributes.hasLabel || attributes.isRequired ) {\n\t\t\t\tfieldContainer.prepend( fieldLabel );\n\t\t\t}\n\n\t\t\t// Error container\n\t\t\tconst fieldError = $( '<div/>', { class: 'form-element__error' } );\n\t\t\tfieldContainer.append( fieldError );\n\n\t\t\tthis.fieldContainer = fieldContainer;\n\n\t\t\t// Field description\n\t\t\tif ( attributes.hasDescription ) {\n\t\t\t\tconst fieldDescription = $( '<div/>', { class: 'description' } );\n\t\t\t\tfieldDescription.html( attributes.description );\n\t\t\t\tfieldContainer.append( fieldDescription );\n\t\t\t}\n\n\t\t\t// Check if the field is hidden\n\t\t\tif ( attributes.isHidden ) {\n\t\t\t\t// Add class to hide the field container\n\t\t\t\tfieldContainer.addClass( 'form-element--hidden' );\n\t\t\t}\n\n\t\t\t// Append everything to the form element container\n\t\t\tformElement.append( fieldContainer );\n\n\t\t\t// Check if it's a select and has a customField defined,\n\t\t\t// if so, add it\n\t\t\tif ( attributes.fieldType == 'select' && isDefined( this.customValueField ) ) {\n\t\t\t\t// Create container for the custom value field\n\t\t\t\tthis.customValueFieldContainer = $(\n\t\t\t\t\t`<div class=\"form-select-custom\">\n\t\t\t\t\t\t<div class=\"form-element-children\"></div>\n\t\t\t\t\t</div>`\n\t\t\t\t);\n\n\t\t\t\t// Get the form element\n\t\t\t\tthis.customValueFieldContainer\n\t\t\t\t\t.find( '.form-element-children' )\n\t\t\t\t\t.append( this.customValueField.createFormElement() );\n\n\t\t\t\t// Append it\n\t\t\t\tformElement.append( this.customValueFieldContainer );\n\n\t\t\t\t// Check if we have to show the custom field\n\t\t\t\tif ( this.getValue() == 'automator_custom_value' ) {\n\t\t\t\t\tthis.customValueFieldContainer.addClass( 'form-select-custom--visible' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.customValueFieldContainer.removeClass( 'form-select-custom--visible' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Response\n\t\t\tresponse = formElement;\n\n\t\t\t// Save Form Element\n\t\t\tthis.formElement = formElement;\n\n\t\t\t// Init libraries\n\t\t\tif ( initLibraries ) {\n\t\t\t\tthis.initLibraries();\n\t\t\t}\n\n\t\t\t// Trigger methods on change\n\t\t\tthis.onChange();\n\n\t\t\t// Trigger methods on focus\n\t\t\tthis.onFocus();\n\t\t} else {\n\t\t\t// Error: Invalid field type\n\t\t\tconsole.error(\n\t\t\t\tvsprintf( 'The field type \"%s\" is invalid. The valid ones are %s', [\n\t\t\t\t\ttype,\n\t\t\t\t\tgetFieldTypes().join( ', ' ),\n\t\t\t\t] )\n\t\t\t);\n\t\t}\n\n\t\treturn response;\n\t}\n\n\t/**\n\t * Set attributes. It add properties like hasValue, hasPlaceholder, etc, automatically\n\t *\n\t * @since 0.4\n\t * @param {object} attributes - The field attributes\n\t * @return {object} attributes - The field attributes\n\t */\n\n\tsetAttributes( attributes ) {\n\t\t// Save field type in the attributes\n\t\tattributes.fieldType = this.type;\n\n\t\t// Create an unique ID\n\t\tattributes.uniqueFieldID = `${ attributes.optionCode }__${ getUniqueId() }`;\n\n\t\t// Check if it's a checkbox and sanitaze the current value\n\t\tif ( attributes.fieldType == 'checkbox' && ! isEmpty( attributes.currentValue ) ) {\n\t\t\t// Check if the value is \"true\" or \"false\"\n\t\t\tif ( [ 'true', 'false' ].includes( attributes.currentValue ) ) {\n\t\t\t\t// Make it a boolean\n\t\t\t\tattributes.currentValue = attributes.currentValue == 'true' ? true : false;\n\n\t\t\t\t// If it's false, set hasValue to false\n\t\t\t\tif ( ! attributes.currentValue ) {\n\t\t\t\t\tattributes.hasValue = false;\n\t\t\t\t} else {\n\t\t\t\t\tattributes.hasValue = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Has value\n\t\tif ( ! isDefined( attributes.hasValue ) ) {\n\t\t\tif ( ! isEmpty( attributes.currentValue ) ) {\n\t\t\t\tattributes.hasValue = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasValue = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has placeholder\n\t\tif ( ! isDefined( attributes.hasPlaceholder ) ) {\n\t\t\tif ( ! isEmpty( attributes.placeholder ) ) {\n\t\t\t\tattributes.hasPlaceholder = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasPlaceholder = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has default value\n\t\tif ( ! isDefined( attributes.hasDefaultValue ) ) {\n\t\t\tif ( ! isEmpty( attributes.defaultValue ) ) {\n\t\t\t\tattributes.hasDefaultValue = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasDefaultValue = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has label\n\t\tif ( ! isDefined( attributes.hasLabel ) ) {\n\t\t\tif ( ! isEmpty( attributes.label ) ) {\n\t\t\t\tattributes.hasLabel = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasLabel = false;\n\t\t\t}\n\t\t}\n\n\t\t// Has description\n\t\tif ( ! isDefined( attributes.hasDescription ) ) {\n\t\t\tif ( ! isEmpty( attributes.description ) ) {\n\t\t\t\tattributes.hasDescription = true;\n\t\t\t} else {\n\t\t\t\tattributes.hasDescription = false;\n\t\t\t}\n\t\t}\n\n\t\t// Is Required\n\t\tif ( ! isDefined( attributes.isRequired ) ) {\n\t\t\tattributes.isRequired = false;\n\t\t}\n\n\t\t// Is children\n\t\tif ( ! isDefined( attributes.isChildField ) ) {\n\t\t\tattributes.isChildField = false;\n\t\t}\n\n\t\t// Supports tokens\n\t\tif ( ! isDefined( attributes.supportsTokens ) ) {\n\t\t\tattributes.supportsTokens = false;\n\t\t}\n\n\t\t// Check if it can support tokens\n\t\tif (\n\t\t\tattributes.supportsTokens &&\n\t\t\tattributes.fieldType == 'select' &&\n\t\t\t! [ 'action', 'closure' ].includes( attributes.itemType )\n\t\t) {\n\t\t\tattributes.supportsTokens = false;\n\t\t}\n\n\t\t// Check default value for readOnly\n\t\tif ( ! isDefined( attributes.isReadOnly ) ) {\n\t\t\tattributes.isReadOnly = false;\n\t\t}\n\n\t\t// Check if it's a select\n\t\tif ( attributes.fieldType == 'select' ) {\n\t\t\t// Check if it supports multiple values\n\t\t\tif ( ! isDefined( attributes.supportsMultipleValues ) ) {\n\t\t\t\tattributes.supportsMultipleValues = false;\n\t\t\t}\n\n\t\t\t//  Check if it supports multiple values, if it does,\n\t\t\t// don't support custom values.\n\t\t\tif ( attributes.supportsMultipleValues ) {\n\t\t\t\tattributes.supportsCustomValue = false;\n\t\t\t}\n\n\t\t\t//  Check if the current dropdown is a multiselect,\n\t\t\t// if so, check if it has a current value. In case it\n\t\t\t// has a value, try to parse it, because it might be a\n\t\t\t// JSON string\n\t\t\tif ( attributes.supportsMultipleValues ) {\n\t\t\t\ttry {\n\t\t\t\t\tattributes.currentValue = JSON.parse( attributes.currentValue );\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if it can support custom tokens\n\t\t\tif ( ! isDefined( attributes.supportsCustomValue ) ) {\n\t\t\t\tattributes.supportsCustomValue = false;\n\t\t\t}\n\n\t\t\t// Check if it can support tokens, but can't support custom values\n\t\t\t// if ( attributes.supportsTokens && ! attributes.supportsCustomValue ){\n\t\t\t// \tattributes.supportsCustomValue = true;\n\t\t\t// }\n\n\t\t\t// Check if the user defined a description for the custom field too\n\t\t\tattributes.hasCustomValueDescription = ! isEmpty( attributes.customValueDescription );\n\t\t}\n\n\t\t// Check if it's a date field\n\t\tif ( attributes.fieldType == 'date' ) {\n\t\t\tattributes.isReadOnly = true;\n\n\t\t\t// Check if it doesn't have a custom date format\n\t\t\tif ( ! isDefined( attributes.dateFormat ) ) {\n\t\t\t\tattributes.dateFormat = 'Y-m-d';\n\t\t\t}\n\n\t\t\t// Check if it doesn't have a custom date alt format\n\t\t\tif ( ! isDefined( attributes.dateAltFormat ) ) {\n\t\t\t\tattributes.dateAltFormat = UncannyAutomator.format.date;\n\t\t\t}\n\n\t\t\t// Check if it has a min date\n\t\t\tif ( isDefined( attributes.minDate ) ) {\n\t\t\t\tattributes.minDate = attributes.minDate;\n\t\t\t}\n\n\t\t\t// Check if it has a max date\n\t\t\tif ( isDefined( attributes.maxDate ) ) {\n\t\t\t\tattributes.maxDate = attributes.maxDate;\n\t\t\t}\n\n\t\t\t// Set default value for the supports range option\n\t\t\tif ( ! isDefined( attributes.supportsRange ) ) {\n\t\t\t\tattributes.supportsRange = false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if it's a time field\n\t\tif ( attributes.fieldType == 'time' ) {\n\t\t\tattributes.isReadOnly = true;\n\n\t\t\t// Check if it doesn't have a custom time format\n\t\t\tif ( ! isDefined( attributes.timeFormat ) ) {\n\t\t\t\tattributes.timeFormat = 'h:i K';\n\t\t\t}\n\n\t\t\t// Check if it doesn't have a custom time alt format\n\t\t\tif ( ! isDefined( attributes.timeAltFormat ) ) {\n\t\t\t\tattributes.timeAltFormat = 'h:i K';\n\t\t\t}\n\n\t\t\t// Check if it has a min time\n\t\t\tif ( isDefined( attributes.minTime ) ) {\n\t\t\t\tattributes.minTime = attributes.minTime;\n\t\t\t}\n\n\t\t\t// Check if it has a max time\n\t\t\tif ( isDefined( attributes.maxTime ) ) {\n\t\t\t\tattributes.maxTime = attributes.maxTime;\n\t\t\t}\n\t\t}\n\n\t\t// Supports tinyMCE\n\t\tif ( ! isDefined( attributes.supportsTinyMCE ) ) {\n\t\t\tattributes.supportsTinyMCE = false;\n\t\t}\n\n\t\t// Is Toggle\n\t\tif ( ! isDefined( attributes.isToggle ) && isDefined( attributes.toggle ) ) {\n\t\t\tattributes.isToggle = true;\n\t\t}\n\n\t\t// Is AJAX\n\t\tif ( ! isDefined( attributes.isAjax ) ) {\n\t\t\tattributes.isAjax = false;\n\t\t}\n\n\t\t// Set the default value for isHidden\n\t\tif ( ! isDefined( attributes.isHidden ) ) {\n\t\t\tattributes.isHidden = false;\n\t\t}\n\n\t\treturn attributes;\n\t}\n\n\t/**\n\t * Validate field\n\t *\n\t * @since 0.4\n\t * @param {boolean} renderError - TRUE if you want to render the field errors, FALSE if you only want to return the response object\n\t * @return {validateField} validateField object. Read the comments on Validation.js to learn more\n\t */\n\n\tvalidate( renderError = true ) {\n\t\t// Parameters\n\n\t\t// Field (DOM)\n\t\tlet field = null,\n\t\t\tvalue;\n\n\t\tif ( renderError ) {\n\t\t\tfield = this.getFieldContainer();\n\t\t\tvalue = this.getValue();\n\t\t} else {\n\t\t\tvalue = this.attributes.currentValue;\n\t\t}\n\n\t\t// Type\n\t\tconst fieldType = this.type;\n\n\t\t// Attributes\n\t\tconst attributes = {\n\t\t\tsupportsTokens: this.attributes.supportsTokens,\n\t\t\trequired: this.attributes.isRequired,\n\t\t};\n\n\t\t// This uses the validateField function. Check Validation.js for more information\n\t\treturn validateField( field, this.type, value, attributes, this.customValidationFunction );\n\t}\n\n\t/**\n\t * Invoke functions on field change\n\t * Those functions are global for all the Field objects\n\t * Don't use directly, use 'automator:field:change' instead\n\t */\n\n\tonChange() {\n\t\tthis.formElement.on( 'automator:field:change', ( event, customData ) => {\n\t\t\t// Check if it's a select that supports custom values (and that option is selected)\n\t\t\t// console.log( this.attributes.label );\n\t\t\t// console.log( '>  Change (automator:field:change)' );\n\n\t\t\t// Check if it has a value\n\t\t\tif ( isDefined( this.fieldContainer ) ) {\n\t\t\t\tif ( ! isEmpty( this.getValue() ) ) {\n\t\t\t\t\tthis.fieldContainer.addClass( 'form-input--has-value' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.fieldContainer.removeClass( 'form-input--has-value' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( this.attributes.fieldType == 'select' && this.attributes.supportsCustomValue ) {\n\t\t\t\tif ( this.getValue() == 'automator_custom_value' ) {\n\t\t\t\t\t// Show custom field container\n\t\t\t\t\tthis.customValueFieldContainer.addClass( 'form-select-custom--visible' );\n\t\t\t\t} else {\n\t\t\t\t\t// Hide custom field container\n\t\t\t\t\tthis.customValueFieldContainer.removeClass( 'form-select-custom--visible' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst onChangeAJAXCallback = () => {\n\t\t\t\t// Check if it's an AJAX field\n\t\t\t\tif ( this.attributes.isAjax ) {\n\t\t\t\t\t// Check if the target field is different\n\t\t\t\t\tif ( this.attributes.targetField !== this.attributes.optionCode ) {\n\t\t\t\t\t\t// console.log( this.attributes.label );\n\t\t\t\t\t\t// console.log( '> AJAX (onChangeAJAXCallback)' );\n\n\t\t\t\t\t\tthis.doAJAX();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Check if it's a child field\n\t\t\t\tif ( isDefined( this.attributes.isChildField ) && this.attributes.isChildField ) {\n\t\t\t\t\t// Check if the option code of the parent is defined\n\t\t\t\t\tif ( isDefined( this.attributes.parentOptionCode ) ) {\n\t\t\t\t\t\t// Get the field\n\t\t\t\t\t\tconst parentField = getField( this.attributes.itemId, this.attributes.parentOptionCode );\n\n\t\t\t\t\t\t// Check if we found it\n\t\t\t\t\t\tif ( isDefined( parentField ) ) {\n\t\t\t\t\t\t\t// console.log( this.attributes.label + ' --> ' + parentField.attributes.label );\n\t\t\t\t\t\t\t// console.log( '> AJAX (onChangeAJAXCallback)' );\n\n\t\t\t\t\t\t\t// Do AJAX call on parent\n\t\t\t\t\t\t\tparentField.doAJAX();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Check if it's an AJAX field, has a target field\n\t\t\t// and the target field is different than the option code\n\t\t\tif (\n\t\t\t\t// Check if the field is ajax\n\t\t\t\tthis.attributes.isAjax &&\n\t\t\t\t// Check if there is a valid target field (Field instance)\n\t\t\t\tisDefined( this.attributes.targetField ) &&\n\t\t\t\t// Check if the ID of the target field is different that the\n\t\t\t\t// ID of the parent field\n\t\t\t\tthis.attributes.targetField !== this.attributes.optionCode &&\n\t\t\t\t// Check if the parent field completed the first load\n\t\t\t\t( this.attributes.completedFirstLoad ||\n\t\t\t\t\t// Otherwise, even if the first load wasn't completed,\n\t\t\t\t\t// check if the \"current value\" (value saved) on\n\t\t\t\t\t// the database is empty, or if it doesn't have a default value\n\t\t\t\t\t( isEmpty( this.attributes.currentValue ) &&\n\t\t\t\t\t\t! this.attributes.hasDefaultValue &&\n\t\t\t\t\t\t! this.attributes.completedFirstLoad ) )\n\t\t\t) {\n\t\t\t\t// Get the target field\n\t\t\t\tconst targetField = getField( this.attributes.itemId, this.attributes.targetField );\n\n\t\t\t\t// console.log( 'Reset value of ' + targetField.attributes.label );\n\n\t\t\t\t// Reset the value of the target field\n\t\t\t\ttargetField.setValue( null, false );\n\t\t\t\ttargetField.setCustomValue( null, false );\n\t\t\t}\n\n\t\t\t// Check if it's a dropdown, checkbox or radio\n\t\t\tif ( [ 'select', 'radio', 'checkbox' ].includes( this.attributes.fieldType ) ) {\n\t\t\t\t// Do it right away\n\t\t\t\tonChangeAJAXCallback();\n\t\t\t} else {\n\t\t\t\t// Check if the inverval exists, and clear it\n\t\t\t\tif ( isDefined( this.onChangeTimeout ) ) {\n\t\t\t\t\tclearTimeout( this.onChangeTimeout );\n\t\t\t\t}\n\n\t\t\t\t// Wait a few seconds before doing the change\n\t\t\t\tthis.onChangeTimeout = setTimeout( () => {\n\t\t\t\t\tonChangeAJAXCallback();\n\t\t\t\t}, 1500 );\n\t\t\t}\n\n\t\t\t// Return false to prevent bubbling in child fields\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t/**\n\t * Invoke functions on field change\n\t * Those functions are global for all the Field objects\n\t * Don't use directly, use 'automator:field:change' instead\n\t */\n\n\tonFocus() {\n\t\tthis.field.on( 'focusin', ( event ) => {\n\t\t\t// Check if it's a read-only field\n\t\t\tif ( this.attributes.isReadOnly ) {\n\t\t\t\t// Select the text\n\t\t\t\t$( event.currentTarget ).select();\n\t\t\t}\n\t\t} );\n\n\t\tthis.field.on( 'focusout', () => {} );\n\t}\n\n\t/**\n\t * Check if the item's object has all the required properties\n\t *\n\t * @since 0.5\n\t */\n\n\tisReady() {\n\t\tlet ready = false;\n\n\t\tif ( isDefined( UncannyAutomator.recipe.items[ this.attributes.itemId ] ) ) {\n\t\t\tready = true;\n\t\t}\n\n\t\treturn ready;\n\t}\n\n\t/**\n\t * Do AJAX\n\t *\n\t * @since 0.5\n\t */\n\n\tdoAJAX() {\n\t\t// Get field value. If it isn't defined in the DOM then get the default value\n\t\tconst fieldValue = isDefined( this.getValue() ) ? this.getValue() : this.getMetaValue();\n\n\t\t// Check if we have to do an AJAX call on this field\n\t\tif ( this.attributes.isAjax ) {\n\t\t\t// Get the target field\n\t\t\tlet targetField = this;\n\n\t\t\tif ( this.attributes.optionCode != this.attributes.targetField ) {\n\t\t\t\ttargetField = getField( this.attributes.itemId, this.attributes.targetField );\n\t\t\t}\n\n\t\t\t// Check that we have everything\n\t\t\tif ( ! isEmpty( this.attributes.integrationId ) && ! isEmpty( this.attributes.endpoint ) ) {\n\t\t\t\t// Before doing the request, show a loading animation in the changed field\n\t\t\t\tthis.startLoadingAnimation();\n\t\t\t\t// And show animation in the target field too\n\t\t\t\ttargetField.startLoadingAnimation();\n\n\t\t\t\t// Get parent field value\n\t\t\t\tlet parentFieldValue = this.getValue(),\n\t\t\t\t\ttargetFieldValue = isDefined( targetField.getValue() )\n\t\t\t\t\t\t? targetField.getValue()\n\t\t\t\t\t\t: targetField.getMetaValue();\n\n\t\t\t\tAJAXRequest(\n\t\t\t\t\tthis.attributes.endpoint,\n\t\t\t\t\t{\n\t\t\t\t\t\trecipe_id: UncannyAutomator.recipe.id,\n\t\t\t\t\t\tintegration_id: this.attributes.integrationId,\n\t\t\t\t\t\titem_id: this.attributes.itemId,\n\t\t\t\t\t\tgroup_id: this.attributes.groupId,\n\t\t\t\t\t\tfield_id: this.attributes.optionCode,\n\t\t\t\t\t\ttarget_field: this.attributes.targetField,\n\t\t\t\t\t\tvalue: parentFieldValue,\n\t\t\t\t\t\tvalues: getCurrentFieldsValues( this.attributes.itemId ),\n\t\t\t\t\t},\n\t\t\t\t\t( response ) => {\n\t\t\t\t\t\t// console.log( this.attributes.label );\n\t\t\t\t\t\t// console.log( '%c> AJAX completed', 'background: red; color: #fff;' );\n\n\t\t\t\t\t\t// Stop loading animation in both fields\n\t\t\t\t\t\tthis.stopLoadingAnimation();\n\t\t\t\t\t\ttargetField.stopLoadingAnimation();\n\n\t\t\t\t\t\tconst targetFieldAttributes = targetField.getAttributes();\n\n\t\t\t\t\t\t// console.table({\n\t\t\t\t\t\t// \tparentField:      this.getAttributes().optionCode,\n\t\t\t\t\t\t// \tparentFieldValue: parentFieldValue,\n\t\t\t\t\t\t// \ttargetField:      this.attributes.targetField,\n\t\t\t\t\t\t// \ttargetFieldValue: targetFieldValue\n\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t// Check if the target field is a select and the response is an array\n\n\t\t\t\t\t\t// console.log( targetFieldAttributes.label );\n\t\t\t\t\t\t// console.log( '> Set options' );\n\n\t\t\t\t\t\tif ( targetFieldAttributes.fieldType == 'select' && $.isArray( response ) ) {\n\t\t\t\t\t\t\t// Value of the target field before the call\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t// Check if the field is ajax\n\t\t\t\t\t\t\t\tthis.attributes.isAjax &&\n\t\t\t\t\t\t\t\t// Check if there is a valid target field (Field instance)\n\t\t\t\t\t\t\t\tisDefined( this.attributes.targetField ) &&\n\t\t\t\t\t\t\t\t// Check if the ID of the target field is different that the\n\t\t\t\t\t\t\t\t// ID of the parent field\n\t\t\t\t\t\t\t\tthis.attributes.targetField !== this.attributes.optionCode &&\n\t\t\t\t\t\t\t\t// Check if the parent field completed the first load\n\t\t\t\t\t\t\t\t( this.attributes.completedFirstLoad ||\n\t\t\t\t\t\t\t\t\t// Otherwise, even if the first load wasn't completed,\n\t\t\t\t\t\t\t\t\t// check if the \"current value\" (value saved) on\n\t\t\t\t\t\t\t\t\t// the database is empty, or if it doesn't have a default value\n\t\t\t\t\t\t\t\t\t( isEmpty( this.attributes.currentValue ) &&\n\t\t\t\t\t\t\t\t\t\t! this.attributes.hasDefaultValue &&\n\t\t\t\t\t\t\t\t\t\t! this.attributes.completedFirstLoad ) )\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\ttargetFieldValue = null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// console.log( this.attributes.label );\n\t\t\t\t\t\t\t// console.log( this.attributes.completedFirstLoad );\n\t\t\t\t\t\t\t// console.log( targetFieldValue );\n\t\t\t\t\t\t\t// console.log( targetField.attributes.currentValue );\n\t\t\t\t\t\t\t// debugger;\n\n\t\t\t\t\t\t\t// Check if the value of the target field is custom\n\t\t\t\t\t\t\tif ( targetFieldValue == 'automator_custom_value' ) {\n\t\t\t\t\t\t\t\t// Get the custom field value\n\t\t\t\t\t\t\t\tconst customFieldValue = targetField.getSelectCustomValue();\n\n\t\t\t\t\t\t\t\t// Check if the value of the custom field is NOT empty\n\t\t\t\t\t\t\t\tif ( ! isEmpty( customFieldValue ) ) {\n\t\t\t\t\t\t\t\t\t// Then use the custom value as the real value\n\t\t\t\t\t\t\t\t\ttargetFieldValue = customFieldValue;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Otherwise, don't use the custom value at all\n\t\t\t\t\t\t\t\t\ttargetFieldValue = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// console.log( targetField.attributes.label );\n\t\t\t\t\t\t\t// console.log( '> Value: ' + targetFieldValue );\n\n\t\t\t\t\t\t\t// The developer wants to set new options for a select\n\t\t\t\t\t\t\t// Don't trigger change (even though select2 needs it),\n\t\t\t\t\t\t\t// we're going to trigger it later\n\t\t\t\t\t\t\ttargetField.setSelectOptions( response, false );\n\n\t\t\t\t\t\t\t// console.log( targetField.attributes.label + ' (by ' + this.attributes.label + ')' );\n\t\t\t\t\t\t\t// console.log( '> Set: ' + targetFieldValue );\n\n\t\t\t\t\t\t\t// Set the value again\n\t\t\t\t\t\t\ttargetField.setValue( targetFieldValue );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Try to set the value\n\t\t\t\t\t\t\ttargetField.setValue( response );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Update the \"completed first load\" status\n\t\t\t\t\t\tthis.attributes.completedFirstLoad = true;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get form element\n\t *\n\t * @since 0.4\n\t * @return {object} jQuery object of the field's container\n\t */\n\n\tgetFormElement() {\n\t\tif ( this.isReady() ) {\n\t\t\t// Reset the \"first load\" status\n\t\t\tthis.attributes.completedFirstLoad = false;\n\n\t\t\t// Do the AJAX call only if it's not a child field\n\t\t\t// Otherwise, we will just wait for the AJAX call\n\t\t\t// of the parent field to end. That will trigger an\n\t\t\t// AJAX call in the child field.\n\t\t\tlet isTargetField = false;\n\n\t\t\ttry {\n\t\t\t\t// Get group of options\n\t\t\t\tconst fields =\n\t\t\t\t\tUncannyAutomator.recipe.items[ this.attributes.itemId ].options[ this.attributes.groupId ].fields;\n\n\t\t\t\t// Determine if it's a target field\n\t\t\t\tisTargetField = fields.reduce( ( accumulator, field ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\taccumulator ||\n\t\t\t\t\t\t// Check if this field is the target field of another field\n\t\t\t\t\t\t( field.attributes.targetField == this.attributes.optionCode &&\n\t\t\t\t\t\t\t// But it's not the field itself\n\t\t\t\t\t\t\tfield.attributes.optionCode != this.attributes.optionCode &&\n\t\t\t\t\t\t\t// And it's AJAX\n\t\t\t\t\t\t\tfield.attributes.isAjax )\n\t\t\t\t\t);\n\t\t\t\t}, false );\n\t\t\t} catch ( e ) {\n\t\t\t\t// Continue regardless of error\n\n\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warning( e );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( ! isTargetField ) {\n\t\t\t\t// console.log( this.attributes.label );\n\t\t\t\t// console.log( '> AJAX (getFormElement)' );\n\n\t\t\t\t// Check if the field AJAX, and it's both the parent and target\n\t\t\t\tif ( this.attributes.targetField == this.attributes.optionCode && this.attributes.isAjax ) {\n\t\t\t\t\tthis.doAJAX();\n\t\t\t\t}\n\n\t\t\t\tthis.field.trigger( 'automator:field:change', {\n\t\t\t\t\tmanuallySet: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\treturn this.formElement;\n\t}\n\n\t/**\n\t * Get field container\n\t *\n\t * @since 0.4\n\t * @return {object} jQuery object of the field's container\n\t */\n\n\tgetFieldContainer() {\n\t\treturn this.fieldContainer;\n\t}\n\n\t/**\n\t * Get field ID\n\t *\n\t * @since 0.5\n\t * @return {string} The field ID\n\t */\n\n\tgetFieldID() {\n\t\treturn this.attributes.optionCode;\n\t}\n\n\t/**\n\t * Get field\n\t *\n\t * @since 0.4\n\t * @return {object} jQuery object of the field\n\t */\n\n\tgetField() {\n\t\treturn this.field;\n\t}\n\n\tgetFieldCM() {\n\t\treturn this.$fakeCodemirrorField;\n\t}\n\n\t/**\n\t * Get attributes\n\t *\n\t * @since 0.5\n\t * @return {object} Field attributes\n\t */\n\n\tgetAttributes() {\n\t\treturn this.attributes;\n\t}\n\n\t/**\n\t * Get field's value FROM THE DOM ELEMENT\n\t * If you want to get the value from the main object then check {attributes.currentValue}\n\t *\n\t * @since 0.4\n\t * @return {string|int} Value of the field\n\t */\n\n\tgetValue() {\n\t\tlet response = null;\n\n\t\tif ( isDefined( this.field ) ) {\n\t\t\tswitch ( this.type ) {\n\t\t\t\tcase 'select':\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'url':\n\t\t\t\tcase 'email':\n\t\t\t\tcase 'int':\n\t\t\t\tcase 'float':\n\t\t\t\t\tresponse = this.field.val();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'textarea':\n\t\t\t\t\t// Check if it has a token selector\n\t\t\t\t\tif ( isDefined( this.TokenSelector ) ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.TokenSelector.parseHTMLTokensInPlainTextarea();\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresponse = this.field.val();\n\n\t\t\t\t\tif ( this.attributes.supportsTinyMCE ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// Replace \"\\n\" characters\n\t\t\t\t\t\t\t// We're doing this because TinyMCE is already adding paragraphs\n\t\t\t\t\t\t\tresponse = response.replaceAll( '\\n', '' );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tresponse = this.field.is( ':checked' );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tresponse = this.field.find( 'input:checked' ).val();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'date':\n\t\t\t\t\tresponse = this.field.val();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'time':\n\t\t\t\t\tresponse = this.field.val();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ( ! isDefined( this.field ) || ! isDefined( response ) ) {\n\t\t\t// Check if the field has a value and add it\n\t\t\tif ( this.attributes.hasValue ) {\n\t\t\t\t// Return that value\n\t\t\t\tresponse = this.attributes.currentValue;\n\t\t\t} else {\n\t\t\t\t// If it doesn't have a value, then check if it has a default\n\t\t\t\t// value\n\t\t\t\tif ( this.attributes.hasDefaultValue ) {\n\t\t\t\t\t// Return the default value\n\t\t\t\t\tresponse = this.attributes.defaultValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn response;\n\t}\n\n\t/**\n\t * Get readable value\n\t *\n\t * @since 0.6\n\t * @return string with the value\n\t */\n\n\tgetReadableValue() {\n\t\tlet response = null,\n\t\t\tvalue = this.getValue();\n\n\t\tswitch ( this.type ) {\n\t\t\tcase 'select':\n\t\t\t\t// Check if the field DOM element is defined\n\t\t\t\tif ( isDefined( this.field ) ) {\n\t\t\t\t\t// Check if it supports multiple values, and the value is an array\n\t\t\t\t\tif ( this.attributes.supportsMultipleValues && $.isArray( value ) ) {\n\t\t\t\t\t\tconst optionsText = '';\n\n\t\t\t\t\t\tresponse = value\n\t\t\t\t\t\t\t.map( ( optionValue ) => {\n\t\t\t\t\t\t\t\treturn this.field.find( vsprintf( 'option[value=\"%s\"]', [ optionValue ] ) ).text();\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t.join( `${ UncannyAutomator.i18n.itemSeparator } ` );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresponse = this.field.find( vsprintf( 'option[value=\"%s\"]', [ value ] ) ).text();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Check if it supports multiple values, and the value is an array\n\t\t\t\t\tif ( this.attributes.supportsMultipleValues && $.isArray( value ) ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst optionsText = '';\n\n\t\t\t\t\t\t\tresponse = value\n\t\t\t\t\t\t\t\t.map( ( optionValue ) => {\n\t\t\t\t\t\t\t\t\treturn this.getSelectOptionByValue( optionValue ).text;\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t.join( `${ UncannyAutomator.i18n.itemSeparator } ` );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// Get option from the options array\n\t\t\t\t\t\t\tresponse = this.getSelectOptionByValue( value ).text;\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'text':\n\t\t\tcase 'url':\n\t\t\tcase 'email':\n\t\t\tcase 'int':\n\t\t\tcase 'float':\n\t\t\tcase 'textarea':\n\t\t\t\t// Create DOM element to remove the HTML tags\n\t\t\t\tvalue = $( '<p/>' ).html( value ).text();\n\t\t\t\tbreak;\n\n\t\t\tcase 'checkbox':\n\t\t\t\tif ( value ) {\n\t\t\t\t\tresponse = UncannyAutomator.i18n.trueLabel;\n\t\t\t\t} else {\n\t\t\t\t\tresponse = UncannyAutomator.i18n.falseLabel;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'radio':\n\t\t\t\t// Check if the field DOM element is defined\n\t\t\t\tif ( isDefined( this.field ) ) {\n\t\t\t\t\t// Get checked radio\n\t\t\t\t\tconst $checkedRadio = this.field.find( 'input:checked' );\n\n\t\t\t\t\t// Check if there is a checked radio\n\t\t\t\t\tif ( $checkedRadio.length == 1 ) {\n\t\t\t\t\t\t// Get container\n\t\t\t\t\t\tconst $radioContainer = $checkedRadio.closest( '.form-radio__container' );\n\n\t\t\t\t\t\t// Get text\n\t\t\t\t\t\tresponse = $radioContainer.text().trim();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Get option from the options array\n\t\t\t\t\t\tresponse = this.getSelectOptionByValue( value ).text;\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date':\n\t\t\t\t// Create DOM element to remove the HTML tags\n\t\t\t\tvalue = $( '<p/>' ).html( value ).text();\n\t\t\t\tbreak;\n\n\t\t\tcase 'time':\n\t\t\t\t// Create DOM element to remove the HTML tags\n\t\t\t\tvalue = $( '<p/>' ).html( value ).text();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn response;\n\t}\n\n\t/**\n\t * Get the custom value of a select (if there is one)\n\t *\n\t * @since 2.5\n\t * @return string, with the value\n\t */\n\tgetSelectCustomValue() {\n\t\t// Default response\n\t\tlet fieldValue = null;\n\n\t\t// Check if it's a select\n\t\tif (\n\t\t\tthis.attributes.fieldType == 'select' &&\n\t\t\tthis.attributes.supportsCustomValue &&\n\t\t\tthis.getValue() == 'automator_custom_value'\n\t\t) {\n\t\t\t// Check if the child field was created\n\t\t\tif ( isDefined( this.customValueField ) ) {\n\t\t\t\tfieldValue = this.customValueField.getValue();\n\t\t\t} else {\n\t\t\t\t// Try to get it from the meta\n\t\t\t\ttry {\n\t\t\t\t\tfieldValue =\n\t\t\t\t\t\tUncannyAutomator.recipe.items[ this.attributes.itemId ].meta[\n\t\t\t\t\t\t\t`${ this.attributes.optionCode }_custom`\n\t\t\t\t\t\t];\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn fieldValue;\n\t}\n\n\t/**\n\t * Get a select option by option value\n\t *\n\t * @param  value\n\t * @since 2.5\n\t * @return array\n\t */\n\tgetSelectOptionByValue( value = '' ) {\n\t\tlet option = null;\n\n\t\t// Get the field options\n\t\tconst options = this.attributes.options;\n\n\t\t// Check if it supports a custom value\n\t\tif ( this.attributes.supportsCustomValue ) {\n\t\t\toptions.push( {\n\t\t\t\tvalue: 'automator_custom_value',\n\t\t\t\ttext: UncannyAutomator.i18n.validation.field.select.customValue,\n\t\t\t} );\n\t\t}\n\n\t\t// Check if the options are defined\n\t\tif ( ! isEmpty( options ) ) {\n\t\t\t// Iterate options and find the value\n\t\t\toptions.forEach( ( selectOption ) => {\n\t\t\t\t// Compare the option value with the value parameter\n\t\t\t\tif ( value == selectOption.value ) {\n\t\t\t\t\toption = selectOption;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\treturn option;\n\t}\n\n\t/**\n\t * Get field's meta value\n\t *\n\t * @since 0.5\n\t * @return {string|int} Value of the field\n\t */\n\n\tgetMetaValue() {\n\t\tlet response;\n\n\t\t// If the item is defined\n\t\tif ( isDefined( UncannyAutomator.recipe.items[ this.attributes.itemId ] ) ) {\n\t\t\tconst metaValue =\n\t\t\t\tUncannyAutomator.recipe.items[ this.attributes.itemId ].meta[ this.attributes.optionCode ];\n\n\t\t\tif ( isDefined( metaValue ) ) {\n\t\t\t\tresponse = metaValue;\n\t\t\t}\n\t\t}\n\n\t\treturn response;\n\t}\n\n\t/**\n\t * Set value\n\t *\n\t * @since 0.4\n\t * @param {string} Value of the field\n\t */\n\n\tsetValue( value, doTrigger = true, options = { updateCodemirror: true } ) {\n\t\t// console.log( this.attributes.label );\n\t\t// console.log( '> setValue: ' + value );\n\n\t\tif ( isDefined( this.field ) ) {\n\t\t\tswitch ( this.type ) {\n\t\t\t\tcase 'select':\n\t\t\t\t\t// Sanitize the value\n\t\t\t\t\tif ( ! isDefined( value ) ) {\n\t\t\t\t\t\tif ( this.attributes.supportsMultipleValues ) {\n\t\t\t\t\t\t\tvalue = [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Get all options\n\t\t\t\t\tconst allOptions = this.field.find( 'option' );\n\n\t\t\t\t\tif ( this.attributes.supportsMultipleValues ) {\n\t\t\t\t\t\t// Unselect all the options\n\t\t\t\t\t\tallOptions.prop( 'selected', false );\n\n\t\t\t\t\t\t// Iterate the selected options\n\t\t\t\t\t\tif ( $.isArray( value ) && ! isEmpty( value ) ) {\n\t\t\t\t\t\t\t// Iterate the values\n\t\t\t\t\t\t\tvalue.forEach( ( optionID ) => {\n\t\t\t\t\t\t\t\t// Get option\n\t\t\t\t\t\t\t\tconst option = this.field.find( `option[value=\"${ optionID }\"]` );\n\n\t\t\t\t\t\t\t\t// Check if option exists\n\t\t\t\t\t\t\t\tif ( option.length > 0 ) {\n\t\t\t\t\t\t\t\t\t// Select option\n\t\t\t\t\t\t\t\t\toption.prop( 'selected', true );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t// Trigger change\n\t\t\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\t\t\tthis.field.trigger( 'change', {\n\t\t\t\t\t\t\t\t\tmanuallySet: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Get option\n\t\t\t\t\t\tconst option = this.field.find( `option[value=\"${ value }\"]` );\n\n\t\t\t\t\t\t// Check if option exists\n\t\t\t\t\t\tif ( option.length > 0 ) {\n\t\t\t\t\t\t\t// Unselect all the options\n\t\t\t\t\t\t\tallOptions.prop( 'selected', false );\n\n\t\t\t\t\t\t\t// Select option\n\t\t\t\t\t\t\toption.prop( 'selected', true );\n\n\t\t\t\t\t\t\t// Trigger change\n\t\t\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\t\t\tthis.field.trigger( 'change', {\n\t\t\t\t\t\t\t\t\tmanuallySet: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Unselect all the options\n\t\t\t\t\t\t\tallOptions.prop( 'selected', false );\n\n\t\t\t\t\t\t\t// Check if the field supports custom options\n\t\t\t\t\t\t\tif ( this.attributes.supportsCustomValue && ! isEmpty( value ) ) {\n\t\t\t\t\t\t\t\t// Set the value as a custom option\n\t\t\t\t\t\t\t\tthis.setCustomValue( value, false );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Trigger change\n\t\t\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\t\t\tthis.field.trigger( 'change', {\n\t\t\t\t\t\t\t\t\tmanuallySet: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// console.error( vsprintf( 'The option with ID %s does not exists', [ value ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'url':\n\t\t\t\tcase 'email':\n\t\t\t\tcase 'int':\n\t\t\t\tcase 'float':\n\t\t\t\t\t// Check if we should try to update the CodeMirror field\n\t\t\t\t\tif (\n\t\t\t\t\t\tisDefined( options.updateCodemirror ) &&\n\t\t\t\t\t\toptions.updateCodemirror &&\n\t\t\t\t\t\tisDefined( this.fieldCM )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Try to set the value\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// console.log( 'Set the value in Codemirror' );\n\t\t\t\t\t\t\t// Set value using CodeMirror's method\n\t\t\t\t\t\t\t// this will copy the value in the real field\n\t\t\t\t\t\t\tthis.fieldCM.setValue( value );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t// console.log( 'Set the value in the real field FALLBACK' );\n\t\t\t\t\t\t\t// Fallback. Set the value in the real field\n\t\t\t\t\t\t\tthis.field.val( value );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// console.log( 'Set the value in the real field' );\n\t\t\t\t\t\t// Set value\n\t\t\t\t\t\tthis.field.val( value );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Trigger change\n\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'textarea':\n\t\t\t\t\t// Set the value\n\t\t\t\t\tthis.field.val( value );\n\n\t\t\t\t\t// Set the value in the TinyMCE editor too\n\t\t\t\t\tif ( isDefined( this.fieldTinyMCE ) ) {\n\t\t\t\t\t\tthis.fieldTinyMCE.setContent( value );\n\t\t\t\t\t}\n\n\t\t\t\t\t/*\n\t\t\t\t\t// Check if \"Text\" view is selected\n\t\t\t\t\tif ( this.field.is( ':visible' ) ){\n\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Insert token\n\t\t\t\t\t\tthis.editor.execCommand( 'mceInsertContent', false, token );\n\t\t\t\t\t}\n\n\n\n\t\t\t\t\t// Set value\n\t\t\t\t\tthis.field.val( value );*/\n\n\t\t\t\t\t// Trigger change\n\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tconst wantsToCheck = value, // Just for readability\n\t\t\t\t\t\tisChecked = this.getValue();\n\n\t\t\t\t\t// If true, check\n\t\t\t\t\tif ( wantsToCheck && ! isChecked ) {\n\t\t\t\t\t\tthis.field.prop( 'checked', true );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! wantsToCheck && isChecked ) {\n\t\t\t\t\t\tthis.field.prop( 'checked', false );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( doTrigger && ( ( wantsToCheck && ! isChecked ) || ( ! wantsToCheck && isChecked ) ) ) {\n\t\t\t\t\t\t// Trigger change\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\t// Search for the radio and check it\n\t\t\t\t\tthis.field.filter( `[name=\"${ value }\"]` ).prop( 'checked', true );\n\n\t\t\t\t\t// Trigger change\n\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\t// Trigger change\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'date':\n\t\t\t\t\t// Set value\n\t\t\t\t\tthis.field.val( value );\n\n\t\t\t\t\t// Trigger change\n\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'time':\n\t\t\t\t\t// Set value\n\t\t\t\t\tthis.field.val( value );\n\n\t\t\t\t\t// Trigger change\n\t\t\t\t\tif ( doTrigger ) {\n\t\t\t\t\t\tthis.field.trigger( 'automator:field:change' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Clear the value\n\t *\n\t * @since 3.0\n\t */\n\n\tclearValue() {\n\t\t// Set an empty value\n\t\tthis.setValue( '', true );\n\n\t\t// Clear the value in the Codemirror instance\n\t\ttry {\n\t\t\tthis.fieldCM.setValue( '' );\n\t\t} catch ( e ) {\n\t\t\t// Continue regardless of error\n\n\t\t\t// Output error if the developer mode is enabled\n\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warning( e );\n\t\t\t}\n\t\t}\n\n\t\t// Check if it's a date or time field\n\t\tif ( [ 'date', 'time' ].includes( this.attributes.fieldType ) ) {\n\t\t\t// Try to clear the flatpickr value\n\t\t\ttry {\n\t\t\t\tthis.flatpickrInstance.clear();\n\t\t\t} catch ( e ) {\n\t\t\t\t// Continue regardless of error\n\n\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warning( e );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Set value of the custom value\n\t *\n\t * @since 2.8.2\n\t */\n\n\tsetCustomValue( value, doTrigger = true ) {\n\t\t// console.log( this.attributes.label );\n\t\t// console.log( '> setCustomValue: ' + value );\n\n\t\t// Check if it's a select and has a customField defined,\n\t\t// if so, add it\n\t\tif ( this.attributes.fieldType == 'select' && isDefined( this.customValueField ) ) {\n\t\t\t// First, select the custom option\n\t\t\tthis.field.val( 'automator_custom_value' );\n\n\t\t\t// Set the value in the custom value field\n\t\t\tthis.customValueField.setValue( value, doTrigger );\n\n\t\t\t// Check if the user wants to trigger the change event\n\t\t\tif ( doTrigger ) {\n\t\t\t\tthis.field.trigger( 'change', {\n\t\t\t\t\tmanuallySet: false,\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Check if a select has a selected option\n\t *\n\t * @since 0.5\n\t */\n\n\thasSelectedOption() {\n\t\treturn this.selectHasSelectedOption;\n\t}\n\n\t/**\n\t * Set select options\n\t *\n\t * @since 0.5\n\t * @param {array}\n\t */\n\n\tsetSelectOptions( options, triggerChange = true ) {\n\t\t// Remove current options\n\t\tthis.removeSelectOptions();\n\n\t\t// Sanitize the select options\n\t\ttry {\n\t\t\toptions = options.filter( ( option ) => {\n\t\t\t\treturn isDefined( option.value ) && isDefined( option.text );\n\t\t\t} );\n\t\t} catch ( e ) {\n\t\t\t// Continue regardless of error\n\n\t\t\t// Output error if the developer mode is enabled\n\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warning( e );\n\t\t\t}\n\t\t}\n\n\t\tif ( isDefined( this.field ) ) {\n\t\t\t// Get the container where we're going to add the options\n\t\t\tconst $optionsContainer = this.field.find( '.form-element__select-normal-options' );\n\n\t\t\tif ( options.length > 0 ) {\n\t\t\t\t// Remove disabled\n\t\t\t\tthis.field.prop( 'disabled', false );\n\n\t\t\t\t// Get value\n\t\t\t\tconst value = isDefined( this.getValue() ) ? this.getValue() : this.getMetaValue();\n\n\t\t\t\t// Create array to save all options\n\t\t\t\tconst optionsDOM = [];\n\n\t\t\t\t// Create and append options\n\t\t\t\t$.each( options, ( index, option ) => {\n\t\t\t\t\tconst optionDOM = new Option( option.text, option.value, false, false );\n\n\t\t\t\t\t$optionsContainer.append( optionDOM );\n\t\t\t\t\toptionsDOM.push( optionDOM );\n\t\t\t\t} );\n\n\t\t\t\tif ( ! isEmpty( value ) ) {\n\t\t\t\t\t$.each( this.field.find( 'option' ), ( index, option ) => {\n\t\t\t\t\t\tif ( option.value == value ) {\n\t\t\t\t\t\t\t$( option ).prop( 'selected', true );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst $noResults = $(\n\t\t\t\t\tnew Option(\n\t\t\t\t\t\tUncannyAutomator.i18n.noResults,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t! this.attributes.supportsCustomValue,\n\t\t\t\t\t\t! this.attributes.supportsCustomValue\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\t$noResults.prop( 'disabled', true );\n\n\t\t\t\t$optionsContainer.append( $noResults );\n\n\t\t\t\tif ( ! this.attributes.supportsCustomValue ) {\n\t\t\t\t\t// Disable the select\n\t\t\t\t\tthis.field.prop( 'disabled', true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( triggerChange ) {\n\t\t\t\tthis.field.trigger( 'change' );\n\t\t\t\t// this.field.trigger( 'automator:field:change' );\n\t\t\t}\n\n\t\t\t// Render this select2 again\n\t\t\tthis.rerenderSelect2();\n\t\t}\n\t}\n\n\t/**\n\t * Remove select options\n\t *\n\t * @since 0.5\n\t */\n\n\tremoveSelectOptions() {\n\t\tif ( isDefined( this.field ) ) {\n\t\t\tthis.field.find( '.form-element__select-normal-options' ).empty();\n\t\t}\n\t}\n\n\t/**\n\t * Check if field has loading animation\n\t *\n\t * @since 0.4\n\t * @return {boolean} TRUE if the field has the loading animation\n\t */\n\n\tisLoading() {\n\t\treturn this.formElement.hasClass( 'form-element--loading' );\n\t}\n\n\t/**\n\t * Add loading animation to field\n\t *\n\t * @since 0.4\n\t */\n\n\tstartLoadingAnimation() {\n\t\t// Check if has class\n\t\tconst CSSclass = 'form-element--loading';\n\n\t\tif ( isDefined( this.formElement ) && ! this.formElement.hasClass( CSSclass ) ) {\n\t\t\t// Add class\n\t\t\tthis.formElement.addClass( CSSclass );\n\n\t\t\t// Check if it's a checkbox\n\t\t\tif ( this.type == 'checkbox' && ! isDefined( this.attributes.isToggle ) ) {\n\t\t\t\tthis.fieldContainer.addClass( 'form-checkbox--loading-inline' );\n\t\t\t}\n\n\t\t\t// Trigger\n\t\t\tthis.formElement.trigger( 'automator:field:loading' );\n\t\t}\n\t}\n\n\t/**\n\t * Remove loading animation to field\n\t *\n\t * @since 0.4\n\t */\n\n\tstopLoadingAnimation() {\n\t\t// Check if has class\n\t\tconst CSSclass = 'form-element--loading';\n\n\t\tif ( isDefined( this.formElement ) && this.formElement.hasClass( CSSclass ) ) {\n\t\t\t// Remove class\n\t\t\tthis.formElement.removeClass( CSSclass );\n\n\t\t\t// Remove checkbox class\n\t\t\tthis.fieldContainer.removeClass( 'form-checkbox--loading-inline' );\n\n\t\t\t// Trigger\n\t\t\tthis.formElement.trigger( 'automator:field:loading' );\n\t\t}\n\t}\n\n\t/**\n\t * Init field libraries, like Select2\n\t *\n\t * @since 0.5\n\t */\n\n\tinitLibraries() {\n\t\tswitch ( this.type ) {\n\t\t\tcase 'select':\n\t\t\t\t// Select2\n\t\t\t\tthis.initSelect2( this.field );\n\t\t\t\tbreak;\n\n\t\t\tcase 'text':\n\t\t\tcase 'url':\n\t\t\tcase 'email':\n\t\t\tcase 'int':\n\t\t\tcase 'float':\n\t\t\tcase 'textarea':\n\t\t\t\t// URL Checker\n\t\t\t\tif ( this.attributes.fieldType == 'url' ) {\n\t\t\t\t\tinitURLChecker( this.fieldContainer );\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date':\n\t\t\tcase 'time':\n\t\t\t\t// Init flatpickr.js\n\t\t\t\tthis.initFlatpickr( this.field );\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Select\n\t * Get the select2 settings\n\t *\n\t * @since 2.7.3\n\t */\n\n\tgetSelect2Settings() {\n\t\t// Define select2 settings\n\t\tconst settings = {\n\t\t\ttheme: 'uap-select2',\n\t\t\tsearchInputPlaceholder: UncannyAutomator.i18n.search,\n\t\t\tlanguage: {\n\t\t\t\tnoResults: function() {\n\t\t\t\t\treturn UncannyAutomator.i18n.noResults;\n\t\t\t\t},\n\t\t\t},\n\t\t\ttemplateResult: ( data ) => {\n\t\t\t\tlet template = data.text;\n\n\t\t\t\t// Check if the ID is defined\n\t\t\t\tif ( isDefined( data.id ) ) {\n\t\t\t\t\t// Check if it's a number\n\t\t\t\t\tif ( Number.isInteger( parseInt( data.id ) ) && parseInt( data.id ) > 0 ) {\n\t\t\t\t\t\ttemplate = `<span class=\"uap-select2-item__meta\">(${ vsprintf(\n\t\t\t\t\t\t\tUncannyAutomator.i18n.postIDPlaceholder,\n\t\t\t\t\t\t\t[ data.id.replace( '-objectkey', '' ) ]\n\t\t\t\t\t\t) })</span> ${ data.text }`;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn template;\n\t\t\t},\n\t\t\ttemplateSelection: function( data ) {\n\t\t\t\tlet template = data.text;\n\n\t\t\t\t// Check if the ID is defined\n\t\t\t\tif ( isDefined( data.id ) ) {\n\t\t\t\t\t// Check if it's a number\n\t\t\t\t\tif ( Number.isInteger( parseInt( data.id ) ) && parseInt( data.id ) > 0 ) {\n\t\t\t\t\t\ttemplate = `<span class=\"uap-select2-item__meta\">(${ vsprintf(\n\t\t\t\t\t\t\tUncannyAutomator.i18n.postIDPlaceholder,\n\t\t\t\t\t\t\t[ data.id.replace( '-objectkey', '' ) ]\n\t\t\t\t\t\t) })</span> ${ template }`;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn template;\n\t\t\t},\n\t\t\tescapeMarkup: function( markUp ) {\n\t\t\t\treturn markUp;\n\t\t\t},\n\t\t};\n\n\t\t// Check if we have to add a placeholder\n\t\tif ( this.attributes.hasPlaceholder ) {\n\t\t\t// Add placeholder\n\t\t\tsettings.placeholder = this.attributes.placeholder;\n\t\t}\n\n\t\t// Check if we don't need the search field\n\t\tif ( this.attributes.customClass ) {\n\t\t\tsettings.customClass = this.attributes.customClass;\n\t\t}\n\n\t\treturn settings;\n\t}\n\n\t/**\n\t * Init Select2\n\t *\n\t * @since 0.5\n\t */\n\n\tinitSelect2( $field ) {\n\t\tconst settings = this.getSelect2Settings();\n\n\t\tif ( ! $field.hasClass( 'select2-hidden-accessible' ) ) {\n\t\t\t$field.select2( settings );\n\t\t}\n\t}\n\n\t/**\n\t * Init Flatpickr\n\t *\n\t * @since 3.0\n\t */\n\n\tinitFlatpickr( $field ) {\n\t\t// Create a global element to add the calendar\n\t\tif ( ! isDefined( document.getElementById( 'uap-flatpickr-calendar' ) ) ) {\n\t\t\t$( 'body' ).append( $( `<div id=\"uap-flatpickr-calendar\" class=\"uap uap-flatpickr-calendar\"></div>` ) );\n\t\t}\n\t\tconst container = document.getElementById( 'uap-flatpickr-calendar' );\n\n\t\tlet settings = {\n\t\t\tallowInput: true,\n\n\t\t\tpositionElement: this.$fakeCodemirrorField[ 0 ],\n\n\t\t\taltInput: true,\n\n\t\t\tclickOpens: false,\n\n\t\t\tappendTo: container,\n\n\t\t\tlocale: {\n\t\t\t\tweekdays: {\n\t\t\t\t\tshorthand: [\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.sunday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.monday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.tuesday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.wednesday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.thursday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.friday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.shorthand.saturday,\n\t\t\t\t\t],\n\t\t\t\t\tlonghand: [\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.sunday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.monday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.tuesday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.wednesday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.thursday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.friday,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.weekdays.longhand.saturday,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tmonths: {\n\t\t\t\t\tshorthand: [\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.january,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.february,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.march,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.april,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.may,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.june,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.july,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.august,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.september,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.october,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.november,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.shorthand.december,\n\t\t\t\t\t],\n\t\t\t\t\tlonghand: [\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.january,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.february,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.march,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.april,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.may,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.june,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.july,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.august,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.september,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.october,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.november,\n\t\t\t\t\t\tUncannyAutomator.i18n.format.date.months.longhand.december,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\trangeSeparator: ` ${ UncannyAutomator.i18n.format.date.rangeSeparator } `,\n\t\t\t\t// Numeric representation of the day of the week. 0 (for Sunday) through 6 (for Saturday)\n\t\t\t\t// In the translatable string we say that 1 is Sunday and Saturday is 7, so we have to subtract 1\n\t\t\t\tfirstDayOfWeek:\n\t\t\t\t\tparseInt( UncannyAutomator.i18n.format.date.firstDayOfWeek ) >= 1 &&\n\t\t\t\t\tparseInt( UncannyAutomator.i18n.format.date.firstDayOfWeek ) <= 7\n\t\t\t\t\t\t? parseInt( UncannyAutomator.i18n.format.date.firstDayOfWeek ) - 1\n\t\t\t\t\t\t: 0,\n\t\t\t\tweekAbbreviation: ` ${ UncannyAutomator.i18n.format.date.weekAbbreviation } `,\n\t\t\t\tscrollTitle: UncannyAutomator.i18n.scrollToIncrement,\n\t\t\t\ttoggleTitle: UncannyAutomator.i18n.clickToToggle,\n\t\t\t\tamPM: [ UncannyAutomator.i18n.format.date.am, UncannyAutomator.i18n.format.date.pm ],\n\t\t\t\tyearAriaLabel: UncannyAutomator.i18n.format.date.year,\n\t\t\t\tmonthAriaLabel: UncannyAutomator.i18n.format.date.month,\n\t\t\t\thourAriaLabel: UncannyAutomator.i18n.format.date.hour,\n\t\t\t\tminuteAriaLabel: UncannyAutomator.i18n.format.date.minute,\n\t\t\t},\n\n\t\t\tonReady: ( selectedDates, dateStr, instance ) => {\n\t\t\t\t// Check if the value of the date field is not equal\n\t\t\t\t// to the value of the Codemirror field. That would mean\n\t\t\t\t// that the date field has a valid value, and that we\n\t\t\t\t// have to format it\n\t\t\t\ttry {\n\t\t\t\t\tconst formatCodemirrorDate = () => {\n\t\t\t\t\t\t// Check if the field value is not a token\n\t\t\t\t\t\tif ( ! this.getValue().includes( '}}' ) ) {\n\t\t\t\t\t\t\t// Check if the date in the field is formatted differently than\n\t\t\t\t\t\t\t// the date in the alternative date field\n\t\t\t\t\t\t\tif ( this.fieldCM.getValue() != instance.altInput.value ) {\n\t\t\t\t\t\t\t\tthis.fieldCM.setValue( instance.altInput.value );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// Check if CodeMirror is ready\n\t\t\t\t\tif ( isDefined( this.fieldCM ) ) {\n\t\t\t\t\t\tformatCodemirrorDate();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.field.on( 'ua-codemirror-ready', () => {\n\t\t\t\t\t\t\tformatCodemirrorDate();\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonChange: ( selectedDates, dateStr, instance ) => {\n\t\t\t\t// Update the Codemirror field\n\t\t\t\ttry {\n\t\t\t\t\tconst setCodemirrorValue = () => {\n\t\t\t\t\t\t// Remove the current value from the Codemirror field,\n\t\t\t\t\t\t// and set the value of the alt date/time field as value\n\t\t\t\t\t\tthis.fieldCM.setValue( instance.altInput.value );\n\t\t\t\t\t};\n\n\t\t\t\t\t// Check if CodeMirror is ready\n\t\t\t\t\tif ( isDefined( this.fieldCM ) ) {\n\t\t\t\t\t\tsetCodemirrorValue();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.field.on( 'ua-codemirror-ready', () => {\n\t\t\t\t\t\t\tsetCodemirrorValue();\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\t// Settings depending on the field type\n\t\t// https://github.com/flatpickr/flatpickr/blob/master/src/types/options.ts#L19\n\t\tif ( this.attributes.fieldType == 'date' ) {\n\t\t\tsettings = $.extend( settings, {\n\t\t\t\t// https://flatpickr.js.org/formatting/\n\t\t\t\tdateFormat: this.attributes.dateFormat,\n\t\t\t\taltFormat: this.attributes.dateAltFormat,\n\t\t\t} );\n\n\t\t\t// Check if it supports a range\n\t\t\tif ( this.attributes.supportsRange ) {\n\t\t\t\tsettings.mode = 'range';\n\t\t\t}\n\n\t\t\t// Check if it has a min date\n\t\t\tif ( isDefined( this.attributes.minDate ) ) {\n\t\t\t\tsettings.minDate = this.attributes.minDate;\n\t\t\t}\n\n\t\t\t// Check if it has a max date\n\t\t\tif ( isDefined( this.attributes.maxDate ) ) {\n\t\t\t\tsettings.maxDate = this.attributes.maxDate;\n\t\t\t}\n\t\t}\n\n\t\tif ( this.attributes.fieldType == 'time' ) {\n\t\t\tsettings = $.extend( settings, {\n\t\t\t\tenableTime: true,\n\t\t\t\tnoCalendar: true,\n\n\t\t\t\t// https://flatpickr.js.org/formatting/\n\t\t\t\tdateFormat: this.attributes.timeFormat,\n\t\t\t\taltFormat: this.attributes.timeAltFormat,\n\t\t\t} );\n\n\t\t\t// Check if it has a min time\n\t\t\tif ( isDefined( this.attributes.minTime ) ) {\n\t\t\t\tsettings.minTime = this.attributes.minTime;\n\t\t\t}\n\n\t\t\t// Check if it has a max time\n\t\t\tif ( isDefined( this.attributes.manTime ) ) {\n\t\t\t\tsettings.manTime = this.attributes.manTime;\n\t\t\t}\n\t\t}\n\n\t\t// Init flatpickr\n\t\tthis.flatpickrInstance = $field.flatpickr( settings );\n\t}\n\n\t/**\n\t * Init CodeMirror\n\t *\n\t * @since 3.0\n\t */\n\n\tinitCodeMirror() {\n\t\t// Check if this isn't already a CodeMirror instance\n\t\tif (\n\t\t\t[ 'text', 'url', 'email', 'int', 'float', 'date', 'time', 'textarea' ].includes( this.attributes.fieldType )\n\t\t) {\n\t\t\t// Check if we already created a CodeMirror for this field\n\t\t\tthis.destroyCodeMirror();\n\n\t\t\tconst initialValue = this.getValue();\n\n\t\t\t// CodeMirror\n\t\t\tthis.fieldCM = CodeMirror( this.$fakeCodemirrorField[ 0 ], {\n\t\t\t\tlineNumbers: 0,\n\t\t\t\ttabSize: 4,\n\t\t\t\tvalue: initialValue,\n\t\t\t\tmode: 'default',\n\t\t\t\tdragDrop: false,\n\t\t\t\tviewportMargin: Infinity,\n\t\t\t\tlineWrapping: true,\n\t\t\t\tautoRefresh: true,\n\n\t\t\t\t// Only allow breaklines in textareas\n\t\t\t\tnoNewlines: ! ( this.attributes.fieldType == 'textarea' ),\n\t\t\t\t// Only allow scrollbars in textareas\n\t\t\t\tscrollbarStyle: this.attributes.fieldType == 'textarea' ? 'native' : null,\n\n\t\t\t\textraKeys: {\n\t\t\t\t\tTab: () => {\n\t\t\t\t\t\t// Get next field\n\t\t\t\t\t\tconst nextField = this.getNextField();\n\n\t\t\t\t\t\t// Check if there is a next field\n\t\t\t\t\t\tif ( isDefined( nextField ) ) {\n\t\t\t\t\t\t\t// Focus the field\n\t\t\t\t\t\t\tnextField.focus();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\treadOnly: this.attributes.isReadOnly,\n\t\t\t} );\n\n\t\t\t// Add the placeholder\n\t\t\tif ( this.attributes.hasPlaceholder ) {\n\t\t\t\tthis.fieldCM.setOption( 'placeholder', this.attributes.placeholder );\n\t\t\t}\n\n\t\t\tthis.fieldCM.on( 'changes', ( event, source ) => {\n\t\t\t\t// Check if the current field is NOT a date or time field\n\t\t\t\tif ( ! [ 'date', 'time' ].includes( this.attributes.fieldType ) ) {\n\t\t\t\t\tthis.setValue( this.fieldCM.getValue(), true, {\n\t\t\t\t\t\tupdateCodemirror: false,\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.fieldCM.on( 'focus', () => {\n\t\t\t\t// If it's a date or time field, try to open the calendar\n\t\t\t\tif ( [ 'date', 'time' ].includes( this.attributes.fieldType ) ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Open calendar\n\t\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t\tthis.flatpickrInstance.open();\n\t\t\t\t\t\t}, 50 );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.field.on( 'focus', () => {\n\t\t\t\tthis.fieldCM.focus();\n\t\t\t} );\n\n\t\t\tthis.field.trigger( 'ua-codemirror-ready' );\n\t\t}\n\n\t\tif ( this.attributes.fieldType == 'select' ) {\n\t\t\t// Check if it has a custom value\n\t\t\tif ( isDefined( this.customValueField ) ) {\n\t\t\t\tthis.customValueField.initCodeMirror();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get the field below the current field\n\t *\n\t * @since 3.0\n\t */\n\n\tgetNextField() {\n\t\tlet nextField = null;\n\n\t\t// Check if this field is part of an item\n\t\tif ( isDefined( this.attributes.itemId ) && isDefined( this.attributes.groupId ) ) {\n\t\t\t// Get the group of fields\n\t\t\tconst groupOfFields =\n\t\t\t\tUncannyAutomator.recipe.items[ this.attributes.itemId ].options[ this.attributes.groupId ].fields;\n\n\t\t\t// Check if it's defined and is an array\n\t\t\tif ( isDefined( groupOfFields ) && $.isArray( groupOfFields ) ) {\n\t\t\t\t// Get the position of the current field\n\t\t\t\tconst fieldPosition = groupOfFields.indexOf( this );\n\n\t\t\t\t// Check if we found the field\n\t\t\t\tif ( fieldPosition != -1 ) {\n\t\t\t\t\t// Check if it's NOT the last field\n\t\t\t\t\tif ( fieldPosition != groupOfFields.length - 1 ) {\n\t\t\t\t\t\t// Get the next field\n\t\t\t\t\t\tnextField = groupOfFields[ fieldPosition + 1 ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check if it's the user selector\n\t\tif ( isDefined( this.attributes.itemType ) && this.attributes.itemType == 'user-selector' ) {\n\t\t\t// Get fields\n\t\t\tconst groupOfFields = UncannyAutomator.recipe.userSelector.fields;\n\n\t\t\t// Check if it's defined and is an array\n\t\t\tif ( isDefined( groupOfFields ) && $.isArray( groupOfFields ) ) {\n\t\t\t\t// Get the position of the current field\n\t\t\t\tconst fieldPosition = groupOfFields.indexOf( this );\n\n\t\t\t\t// Check if we found the field\n\t\t\t\tif ( fieldPosition != -1 ) {\n\t\t\t\t\t// Check if it's NOT the last field\n\t\t\t\t\tif ( fieldPosition != groupOfFields.length - 1 ) {\n\t\t\t\t\t\t// Get the next field\n\t\t\t\t\t\tnextField = groupOfFields[ fieldPosition + 1 ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn nextField;\n\t}\n\n\t/**\n\t * Focus the current field\n\t *\n\t * @since 3.0\n\t */\n\n\tfocus() {\n\t\tif ( isDefined( this.field ) ) {\n\t\t\tswitch ( this.type ) {\n\t\t\t\tcase 'select':\n\t\t\t\t\t// Try to open the select2 field\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.field.select2( 'focus' );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// Otherwise, just try to focus the normal dropdown\n\t\t\t\t\t\tthis.field.focus();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'url':\n\t\t\t\tcase 'email':\n\t\t\t\tcase 'int':\n\t\t\t\tcase 'float':\n\t\t\t\tcase 'date':\n\t\t\t\tcase 'time':\n\t\t\t\t\t// Check if it's using CodeMirror\n\t\t\t\t\tif ( isDefined( this.fieldCM ) ) {\n\t\t\t\t\t\tthis.fieldCM.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.field.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'textarea':\n\t\t\t\t\t// Check if it's using TinyMCE\n\t\t\t\t\tif ( isDefined( this.fieldTinyMCE ) ) {\n\t\t\t\t\t\t// Check if it's using the \"Text\" tab\n\t\t\t\t\t\tif ( this.field.is( ':visible' ) ) {\n\t\t\t\t\t\t\tthis.field.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t// Focus the TinyMCE field\n\t\t\t\t\t\t\t\tthis.fieldTinyMCE.focus();\n\t\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t\t// Continue regardless of error\n\n\t\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.field.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tthis.field.focus();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tthis.field.focus();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Destroy CodeMirror\n\t *\n\t * @since 3.0\n\t */\n\tdestroyCodeMirror() {\n\t\t// Check if we already created a CodeMirror for this field\n\t\tif ( isDefined( this.fieldCM ) ) {\n\t\t\ttry {\n\t\t\t\tconst $field = this.fieldCM.getWrapperElement();\n\t\t\t\t$field.parentNode.removeChild( $field );\n\t\t\t\tthis.fieldCM = null;\n\t\t\t} catch ( e ) {\n\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warning( e );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Select\n\t * Rerender the dropdown\n\t */\n\n\trerenderSelect2() {\n\t\tconst settings = this.getSelect2Settings();\n\n\t\tif ( ! isEmpty( this.field ) && this.field.hasClass( 'select2-hidden-accessible' ) ) {\n\t\t\tthis.field.select2( 'destroy' ).select2( settings );\n\t\t}\n\t}\n\n\t/**\n\t * Init Token Selector\n\t *\n\t * @since 3.0\n\t */\n\n\tinitTokenSelector() {\n\t\tif ( this.attributes.supportsTokens ) {\n\t\t\t// Check if we already created the token selector\n\t\t\tthis.destroyTokenSelector();\n\n\t\t\tthis.tokenSelector = new TokenSelector( this );\n\t\t}\n\n\t\tif ( this.attributes.fieldType == 'select' ) {\n\t\t\t// Check if it has a custom value\n\t\t\tif ( isDefined( this.customValueField ) ) {\n\t\t\t\tthis.customValueField.initTokenSelector();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Destroy the Token selector\n\t *\n\t * @since 3.0\n\t */\n\n\tdestroyTokenSelector() {\n\t\t// Check if we already created the token selector\n\t\tif ( isDefined( this.tokenSelector ) ) {\n\t\t\tthis.tokenSelector.destroy();\n\t\t}\n\t}\n\n\t/**\n\t * Init TinyMCE\n\t * We're going to call this in ItemOptions.js because TinyMCE needs the item in the DOM before changing it\n\t *\n\t * @since 0.5\n\t */\n\n\tinitTinyMCE() {\n\t\tconst $textarea = this.field;\n\n\t\t// TinyMCE\n\t\tif ( isDefined( this.field ) && this.attributes.fieldType == 'textarea' && this.attributes.supportsTinyMCE ) {\n\t\t\t// Get field ID\n\t\t\tconst fieldId = this.field.prop( 'id' );\n\n\t\t\t// Get editor\n\t\t\tlet editor = tinymce.get( fieldId );\n\n\t\t\tif ( isDefined( editor ) ) {\n\t\t\t\twp.editor.remove( fieldId );\n\t\t\t}\n\n\t\t\twp.editor.initialize( fieldId, {\n\t\t\t\tmediaButtons: true,\n\t\t\t\ttinymce: {\n\t\t\t\t\t// wpautop: true,\n\t\t\t\t\ttoolbar1:\n\t\t\t\t\t\t'formatselect bold italic bullist numlist blockquote alignleft aligncenter alignright link unlink wp_more',\n\t\t\t\t\ttoolbar2: 'strikethrough hr forecolor pastetext removeformat visualchars outdent indent undo redo',\n\t\t\t\t},\n\t\t\t\tquicktags: true,\n\t\t\t} );\n\n\t\t\t// Get editor\n\t\t\teditor = tinymce.get( fieldId );\n\n\t\t\t// Check what's the current active tab\n\t\t\t// If .hidden is true, then the active tab is \"Text\"\n\t\t\tif ( editor.hidden ) {\n\t\t\t\tthis.fieldContainer.addClass( 'form-textarea--tinymce-text' );\n\t\t\t} else {\n\t\t\t\tthis.fieldContainer.addClass( 'form-textarea--tinymce-visual' );\n\t\t\t}\n\n\t\t\t// Detect changes on the \"Visual\" and \"Text\" tabs\n\t\t\tthis.formElement.find( '.switch-tmce' ).on( 'click', () => {\n\t\t\t\tthis.field.trigger( 'ua-tinymce-activate-visual-view' );\n\n\t\t\t\t// Change class to indicate what's the activate tab\n\t\t\t\tthis.fieldContainer\n\t\t\t\t\t.removeClass( 'form-textarea--tinymce-text' )\n\t\t\t\t\t.addClass( 'form-textarea--tinymce-visual' );\n\t\t\t} );\n\n\t\t\tthis.formElement.find( '.switch-html' ).on( 'click', () => {\n\t\t\t\tthis.field.trigger( 'ua-tinymce-activate-text-view' );\n\n\t\t\t\t// Change class to indicate what's the activate tab\n\t\t\t\tthis.fieldContainer\n\t\t\t\t\t.removeClass( 'form-textarea--tinymce-visual' )\n\t\t\t\t\t.addClass( 'form-textarea--tinymce-text' );\n\n\t\t\t\t// Set the value of the normal field\n\t\t\t\t// But don't trigger the change event\n\t\t\t\ttry {\n\t\t\t\t\tthis.fieldCM.setValue(\n\t\t\t\t\t\teditor.getContent( {\n\t\t\t\t\t\t\tformat: 'raw',\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\tthis.field.val(\n\t\t\t\t\t\teditor.getContent( {\n\t\t\t\t\t\t\tformat: 'raw',\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.fieldTinyMCE = editor;\n\n\t\t\teditor.on( 'init', () => {\n\t\t\t\tthis.field.trigger( 'ua-tinymce-ready' );\n\t\t\t} );\n\t\t}\n\t}\n}\n\nexport default Field;\n\n/**\n * Extend Select2 to add a placeholder in the search input\n *\n * @since 0.1\n * @param {object} Select2 Instance\n * @return  {object} Select2 Instance\n */\n\n( function ( $ ) {\n\t// Get default settings\n\tconst Defaults = $.fn.select2.amd.require( 'select2/defaults' );\n\n\t// Set default value for searchInputPlaceholder\n\t$.extend( Defaults.defaults, {\n\t\tsearchInputPlaceholder: '',\n\t} );\n\n\t// Get search element\n\tconst SearchDropdown = $.fn.select2.amd.require( 'select2/dropdown/search' );\n\n\t// Save instance of search element\n\tconst _renderSearchDropdown = SearchDropdown.prototype.render;\n\n\tSearchDropdown.prototype.render = function () {\n\t\t// Add placeholder attribute\n\t\tconst $rendered = _renderSearchDropdown.apply( this, Array.prototype.slice.apply( arguments ) );\n\t\tthis.$search.attr( 'placeholder', this.options.get( 'searchInputPlaceholder' ) );\n\t\tthis.$search.addClass( this.options.get( 'customClass' ) );\n\t\t// Return search element\n\t\treturn $rendered;\n\t};\n} )( window.jQuery );\n","import $ from 'jquery';\n\nimport {\n\trestCall,\n\tgetGlobalItem,\n\tisDefined,\n\treplaceCurlyBraces,\n\taddUTMParameters\n} from '../common/utilities.js';\n\nimport Modal from '../common/modal.js';\n\nimport Triggers from './triggers.js';\nimport Actions  from './actions.js';\n\nclass ItemHeaderMenu {\n\t/**\n\t * Create item actions\n\t *\n\t * @since 0.5\n\t *\n\t * @return jQuery DOM element with the item actions\n\t */\n\n\tconstructor( itemType, integrationID, itemCode, itemId ){\n\t\tthis.itemType      = itemType;\n\t\tthis.integrationID = integrationID;\n\t\tthis.itemCode      = itemCode;\n\t\tthis.itemId        = itemId;\n\t\tthis.item          = UncannyAutomator.recipe.items[ itemId ];\n\n\t\treturn this.createItemActions();\n\t}\n\n\tcreateItemActions(){\n\t\t// Create elements\n\t\tlet container     = $( '<div/>', { 'class': 'item-actions' }),\n\t\t\tbtn           = $( '<div/>', { 'class': 'item-actions__btn' }),\n\t\t\tbtnIcon       = $( '<i/>', { 'class': 'uo-icon uo-icon--ellipsis-h-alt' }),\n\t\t\tdropdown      = $( '<div/>', { 'class': 'item-actions__dropdown' }),\n\t\t\tdropdownUl    = $( '<ul/>', { 'class': 'item-actions-dropdown__ul' });\n\n\t\tbtn.append( btnIcon );\n\t\tcontainer.append( btn );\n\n\t\t// Delete\n\t\tlet deleteAction  = $( '<li/>', { 'class': 'item-actions-dropdown__action' }),\n\t\t\tdeleteText    = $( '<span/>' ).text( UncannyAutomator.i18n.delete );\n\n\t\tdeleteAction.append( deleteText );\n\t\tdropdownUl.append( deleteAction );\n\n\t\t// Support\n\t\tif ( isDefined( this.itemType ) && isDefined( this.itemCode ) ) {\n\t\t\tif ( ! isDefined( this.item) || isDefined( this.item ) && ! this.item.isMissing ){\n\t\t\t\tlet globalItemData = getGlobalItem( this.integrationID, this.itemType, this.itemCode );\n\n\t\t\t\tif ( isDefined( globalItemData.support_link ) ){\n\t\t\t\t\tlet utmContent = `support_menu_link-${ this.integrationID }-${ this.integrationID }_${ this.itemCode }-${ this.integrationID }_${ replaceCurlyBraces( globalItemData.select_option_name, '', '' ).toLowerCase().replace( /\\s+|{|}/g, '_' ) }`;\n\n\t\t\t\t\tlet supportAction = $( '<a/>', {\n\t\t\t\t\t\t'href':  addUTMParameters( globalItemData.support_link, {\n\t\t\t\t\t\t\t'medium':  'action_menu',\n\t\t\t\t\t\t\t'content': utmContent\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t'class': 'item-actions-dropdown__action',\n\t\t\t\t\t\t'target': '_blank'\n\t\t\t\t\t}),\n\t\t\t\t\t\tsupportText   = $( '<span/>' ).text( UncannyAutomator.i18n.support );\n\n\t\t\t\t\tsupportAction.append( supportText );\n\t\t\t\t\tdropdownUl.append( supportAction );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdropdown.append( dropdownUl );\n\t\tcontainer.append( dropdown );\n\n\t\t// Listen clicks to the open button\n\t\tbtn.on( 'click', () => {\n\t\t\t// Evaluate if it's open\n\t\t\tconst isOpen = container.hasClass( 'item-actions--open' );\n\n\t\t\t// Check if it's not open\n\t\t\tif ( ! isOpen ){\n\t\t\t\t// Open the dropdown\n\t\t\t\tcontainer.addClass( 'item-actions--open' );\n\n\t\t\t\t// Listen clicks outside the dropdown\n\t\t\t\t$( document ).on( 'mouseup.uap-actions-click-outside', ( event ) => {\n\t\t\t\t\tif ( ! container.is( event.target ) && container.has( event.target ).length === 0 ){\n\t\t\t\t\t\t// Close dropdown\n\t\t\t\t\t\tcontainer.removeClass( 'item-actions--open' );\n\n\t\t\t\t\t\t// Remove event listener to listen clicks outside the dropdown\n\t\t\t\t\t\t$( document ).off( 'mouseup.uap-actions-click-outside' );\n\t\t\t\t\t}\n\t\t\t\t});           \n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Close dropdown\n\t\t\t\tcontainer.removeClass( 'item-actions--open' );\n\n\t\t\t\t// Remove event listener to listen clicks outside the dropdown\n\t\t\t\t$( document ).off( 'mouseup.uap-actions-click-outside' );\n\t\t\t}\n\t\t});\n\n\t\t// Delete\n\t\tdeleteAction.on( 'click', () => {\n\t\t\tif ( isDefined( this.itemId ) && UncannyAutomator.recipe.isLive && UncannyAutomator.recipe.items[ this.itemId ].isLive ){\n\t\t\t\t// Hide dropdown with options\n\t\t\t\tcontainer.removeClass( 'item-actions--open' );\n\n\t\t\t\t// Create modal box\n\t\t\t\t// Read Modal.js comments for more information\n\t\t\t\tlet modal = new Modal({\n\t\t\t\t\ttitle:       UncannyAutomator.i18n.confirmationModal.title,\n\t\t\t\t\twarning:     replaceCurlyBraces( UncannyAutomator.i18n.confirmationModal.deleteWarning, '<strong>', '</strong>' ),\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\t\t\tconfirm: UncannyAutomator.i18n.confirm,\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmodal.setEvents({\n\t\t\t\t\tafterSetEvents: () => {\n\t\t\t\t\t\tmodal.show();\n\t\t\t\t\t},\n\t\t\t\t\tonConfirm: () => {\n\t\t\t\t\t\tlet elements        = modal.getElements();\n\t\t\t\t\t\tlet confirmButton   = elements.modal.box.buttons.confirm;\n\n\t\t\t\t\t\t// Add loading class to button\n\t\t\t\t\t\tconfirmButton.addClass( 'uap-btn--loading' ).prop( 'disabled', true );\n\n\t\t\t\t\t\t// Do call and hide\n\t\t\t\t\t\trestCall( 'delete', {\n\t\t\t\t\t\t\t'ID': this.itemId\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\t// Refresh UI\n\t\t\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\t\t\tnew Triggers();\n\n\t\t\t\t\t\t\t\t// Check if it's an anonymous recipe\n\t\t\t\t\t\t\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t\t\t\t\t\t\t// Render the Actions metabox again\n\t\t\t\t\t\t\t\t\t// We're doing this because we need to update the user selector\n\t\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( this.itemType == 'action' || this.itemType == 'closure' ){\n\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Check if the recipe is still valid, if it isn't then make the recipe draft\n\t\t\t\t\t\t\tif ( ! UncannyAutomator.recipe.isValid ){\n\t\t\t\t\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t delete the item' );\n\n\t\t\t\t\t\t\t// Refresh UI\n\t\t\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( this.itemType == 'action' || this.itemType == 'closure' ){\n\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tafterHide: function(){\n\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Delete without warning\n\t\t\t\tif ( isDefined( this.itemId ) ){\n\t\t\t\t\t// Set loading to the \"delete\" option\n\t\t\t\t\tdeleteAction.addClass( 'item-actions-dropdown__action--loading' );\n\n\t\t\t\t\t// Do the AJAX request to delete it\n\t\t\t\t\trestCall( 'delete', {\n\t\t\t\t\t\t'ID': this.itemId\n\t\t\t\t\t}, () => {\n\t\t\t\t\t\t// Reset UI\n\t\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\t\tnew Triggers();\n\n\t\t\t\t\t\t\t// Check if it's an anonymous recipe\n\t\t\t\t\t\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t\t\t\t\t\t// Render the Actions metabox again\n\t\t\t\t\t\t\t\t// We're doing this because we need to update the user selector\n\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ( this.itemType == 'action' || this.itemType == 'closure' ){\n\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, () => {\n\t\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t delete the item' );\n\n\t\t\t\t\t\t// Reset UI\n\t\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif ( this.itemType == 'action' || this.itemType == 'closure' ){\n\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Reset UI\n\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif ( this.itemType == 'action' ){\n\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn container;\n\t}\n}\n\nexport default ItemHeaderMenu;\n","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tuserSelectorObject,\n\trecipeObject,\n\trestCall,\n\tgetDOMElements,\n\taddParametersToURL,\n\taddUTMParameters,\n\tisDefined,\n\tisEmpty\n} from '../common/utilities.js';\n\nimport Field from '../field/field.js';\n\nimport Actions from '../item/actions.js';\n\nimport RecipeNotices from '../recipe/notices.js';\n\nclass UserSelector {\n\tconstructor(){\n\t\t// On page load, get current step\n\t\tUncannyAutomator.recipe.userSelector.step = userSelectorObject( 'get-step' );\n\n\t\t// Render\n\t\tthis.render();\n\t}\n\n\trender(){\n\t\t// Create variable to save the content to be added\n\t\tlet $content = ``;\n\n\t\t// Get content depending of the step\n\t\tswitch ( UncannyAutomator.recipe.userSelector.step ){\n\t\t\tcase 'select-source':\n\t\t\t\t// Set validation to false\n\t\t\t\t// We're setting it to false here in case the user already\n\t\t\t\t// has valid values, but wanted to go to the first step\n\t\t\t\t// to change the source\n\t\t\t\tUncannyAutomator.recipe.userSelector.isValid = false;\n\n\t\t\t\t// Validate recipe\n\t\t\t\trecipeObject( 'validate' );\n\n\t\t\t\t// Where the recipe creator select the source of the user.\n\t\t\t\t// The options are \"Existing user\" and \"New user\".\n\t\t\t\t$content = this.getSelectSourceNodes();\n\t\t\t\tbreak;\n\n\t\t\tcase 'set-options':\n\t\t\t\t// Where the recipe creator defines values of the fields\n\t\t\t\t$content = this.getOptionsNodes();\n\t\t\t\tbreak;\n\n\t\t\tcase 'show-sentence':\n\t\t\t\t// Validate recipe\n\t\t\t\trecipeObject( 'validate' );\n\n\t\t\t\t// Set error mode\n\t\t\t\tUncannyAutomator.recipe.errorMode = false;\n\n\t\t\t\t// Show error\n\t\t\t\tnew RecipeNotices();\n\n\t\t\t\t// When the data is complete and valid.\n\t\t\t\t$content = this.getSentenceNodes();\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Get container\n\t\tlet $metabox = getDOMElements( 'metabox', {\n\t\t\ttype: 'action'\n\t\t});\n\n\t\tconsole.log( '%cRender User Selector', 'background: red; color: #fff; padding: 2px 10px;');\n\n\t\t// Append content\n\t\t$metabox.prepend( $content );\n\t}\n\n\tgetSelectSourceNodes(){\n\t\t// Create elements\n\t\tlet $userSelector = $( `\n\t\t\t<div class=\"user-selector ${ UncannyAutomator.recipe.requiresUserData ? 'user-selector--show' : '' }\">\n\t\t\t\t<div class=\"item item--user-selector\">\n\t\t\t\t\t<div class=\"item__content\">\n\t\t\t\t\t\t<div class=\"item-integrations\">\n\t\t\t\t\t\t\t<div class=\"item-integration user-selector-option user-selector-option--existing-user\" data-source=\"existingUser\">\n\t\t\t\t\t\t\t\t<div class=\"item-integration__logo\"></div>\n\t\t\t\t\t\t\t\t<div class=\"item-integration__name\">\n\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.userSelector.userType.existing }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"item-integration user-selector-option user-selector-option--new-user\" data-source=\"newUser\">\n\t\t\t\t\t\t\t\t<div class=\"item-integration__logo\"></div>\n\t\t\t\t\t\t\t\t<div class=\"item-integration__name\">\n\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.userSelector.userType.new }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t` );\n\n\t\t// Add header\n\t\t$userSelector.find( '.item' ).prepend( this.getHeaderNodes() );\n\n\t\t// Get user type boxes\n\t\tlet $userTypeButtons = $userSelector.find( '.user-selector-option' );\n\n\t\t// Bind click on the user type buttons\n\t\t$userTypeButtons.on( 'click', ( event ) => {\n\t\t\t// Get clicked button\n\t\t\tlet $option = $( event.currentTarget );\n\n\t\t\t// Get user type\n\t\t\tlet userSource = $option.data( 'source' );\n\t\t\t\n\t\t\t// Save selected source in main object\n\t\t\tuserSelectorObject( 'set-source', {\n\t\t\t\tsource: userSource\n\t\t\t});\n\n\t\t\t// Define next step\n\t\t\tUncannyAutomator.recipe.userSelector.step = 'set-options';\n\n\t\t\t// Render the actions metabox again\n\t\t\tnew Actions();\n\t\t});\n\n\t\t// Return element\n\t\treturn $userSelector;\n\t}\n\n\tgetOptionsNodes(){\n\t\t// Create elements\n\t\tlet $optionsContainer = $( `\n\t\t\t<div class=\"user-selector ${ UncannyAutomator.recipe.requiresUserData ? 'user-selector--show' : '' }\">\n\t\t\t\t<div class=\"item item--user-selector\">\n\t\t\t\t\t<div class=\"item__content\">\n\t\t\t\t\t\t<div class=\"item-options\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Add header\n\t\t$optionsContainer.find( '.item' ).prepend( this.getHeaderNodes() );\n\n\t\t// Get options container, we will add the fields there\n\t\tlet $fieldsContainer = $optionsContainer.find( '.item-options' );\n\n\t\t// Add fields\n\t\t$fieldsContainer.append( this.getOptionsFields() );\n\n\t\t// Return node\n\t\treturn $optionsContainer;\n\t}\n\n\tgetOptionsFields(){\n\t\t// Create container\n\t\tconst $container = $( `<div></div>` );\n\n\t\t// Create the fields container\n\t\tlet $fields = $( `<div class=\"item-options__group\"></div>` );\n\n\t\t// Create array to save all the fields\n\t\tlet optionsFields = [];\n\n\t\t// Update fields data object so it's an object and not an array\n\t\tuserSelectorObject( 'update-fields', {\n\t\t\tsource: 'existingUser',\n\t\t\tdata: {}\n\t\t});\n\n\t\tuserSelectorObject( 'update-fields', {\n\t\t\tsource: 'newUser',\n\t\t\tdata: {}\n\t\t});\n\n\t\t// Get WordPress roles, but remove the \"administrator\" one\n\t\tlet roles = UncannyAutomator.recipe.userSelector.resources.roles;\n\t\tdelete roles.administrator;\n\n\t\t// Check what's the source\n\t\tswitch ( UncannyAutomator.recipe.userSelector.source ){\n\t\t\tcase 'existingUser':\n\t\t\t\t// Create group\n\t\t\t\tlet $groupOfFields = $( `<div class=\"user-selector__field-group user-selector__field-group--two-columns\"></div>` );\n\n\t\t\t\t// Create \"Unique field\" field\n\t\t\t\tlet uniqueField = new Field( 'select', {\n\t\t\t\t\titemType: 'user-selector',\n\t\t\t\t\toptionCode: 'uniqueField',\n\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldLabel,\n\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.uniqueField,\n\t\t\t\t\tisRequired: true,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'email',\n\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionEmail\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'id',\n\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionId\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'username',\n\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionUsername\n\t\t\t\t\t\t},\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t\toptionsFields.push( uniqueField );\n\n\t\t\t\t// Create value field\n\t\t\t\tlet valueField = new Field( 'text', {\n\t\t\t\t\titemType: 'user-selector',\n\t\t\t\t\toptionCode: 'uniqueFieldValue',\n\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.uniqueFieldValue,\n\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.existingUser.valueFieldLabel,\n\t\t\t\t\t// placeholder: UncannyAutomator.i18n.userSelector.existingUser.valueFieldPlaceholder,\n\t\t\t\t\tisRequired: true,\n\t\t\t\t\tsupportsTokens: true\n\t\t\t\t});\n\t\t\t\toptionsFields.push( valueField );\n\n\t\t\t\t// Create and add form element\n\t\t\t\tlet $uniqueFieldFormElement = uniqueField.getFormElement();\n\n\t\t\t\t// Init Codemirror\n\t\t\t\t// AFTER we added the elements to the DOM let's call init \n\t\t\t\t// TokenSelector and CodeMirror. We're going to call this in\n\t\t\t\t// ItemOptions.js because the TokenSelector and \n\t\t\t\t// CodeMirror need the item in the DOM before changing it\n\t\t\t\tvalueField.initTokenSelector();\n\t\t\t\tvalueField.initCodeMirror();\n\n\t\t\t\t$groupOfFields.append( $uniqueFieldFormElement );\n\n\t\t\t\tlet $valueFieldFormElement = valueField.getFormElement();\n\t\t\t\t$groupOfFields.append( $valueFieldFormElement );\n\n\t\t\t\t// Add elements to the main container\n\t\t\t\t$fields.append( $groupOfFields );\n\n\t\t\t\t// Create field to decide what to do if the user doesn't exist\n\t\t\t\tlet fallbackField = new Field( 'radio', {\n\t\t\t\t\titemType: 'user-selector',\n\t\t\t\t\toptionCode: 'fallback',\n\t\t\t\t\tname: 'user-selector-existing-user-fallback',\n\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldLabel,\n\t\t\t\t\tisRequired: true,\n\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.fallback,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'create-new-user',\n\t\t\t\t\t\t\ttext: UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionCreateUser\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'do-nothing',\n\t\t\t\t\t\t\ttext: UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionDoNothing\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t\toptionsFields.push( fallbackField );\n\n\t\t\t\t// Create and add form element\n\t\t\t\tlet $fallbackFieldFormElement = fallbackField.getFormElement();\n\t\t\t\t$fields.append( $fallbackFieldFormElement );\n\n\t\t\t\t// Listen changes\n\t\t\t\t$uniqueFieldFormElement.on( 'automator:field:change', () => {\n\t\t\t\t\t// Get and save value\n\t\t\t\t\tuserSelectorObject( 'update-fields', {\n\t\t\t\t\t\tsource: 'existingUser',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuniqueField: uniqueField.getValue()\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t$valueFieldFormElement.on( 'automator:field:change', () => {\n\t\t\t\t\t// Get and save value\n\t\t\t\t\tuserSelectorObject( 'update-fields', {\n\t\t\t\t\t\tsource: 'existingUser',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuniqueFieldValue: valueField.getValue()\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t// Listen changes\n\t\t\t\t$fallbackFieldFormElement.on( 'automator:field:change', () => {\n\t\t\t\t\t// Get and save value\n\t\t\t\t\tuserSelectorObject( 'update-fields', {\n\t\t\t\t\t\tsource: 'existingUser',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfallback: fallbackField.getValue()\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Render the actions metabox again\n\t\t\t\t\tnew Actions();\n\t\t\t\t});\n\n\t\t\t\t// Check if we have to add more fields or the do-nothing notice\n\t\t\t\tif ( UncannyAutomator.recipe.userSelector.data.existingUser.fallback == 'do-nothing' ){\n\t\t\t\t\t// Create \"Do nothing\" notice\n\t\t\t\t\tconst $doNothingNotice = $( `\n\t\t\t\t\t\t<div class=\"user-selector__warning\">\n\t\t\t\t\t\t\t${ UncannyAutomator.i18n.userSelector.existingUser.doNothingMessage }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t` );\n\n\t\t\t\t\t$fields.append( $doNothingNotice );\n\t\t\t\t}\n\t\t\t\telse if ( UncannyAutomator.recipe.userSelector.data.existingUser.fallback == 'create-new-user' ){\n\t\t\t\t\t// Create container\n\t\t\t\t\tlet $subOptionsContainer = $( '<div/>', {\n\t\t\t\t\t\t'class': 'item-options'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Create new users fields\n\t\t\t\t\tlet newUserFields = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'firstName',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.firstName,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.firstName,\n\t\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'lastName',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.lastName,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.lastName,\n\t\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'email',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.email,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.email,\n\t\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'username',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.username,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.username,\n\t\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'displayName',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.displayName,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.displayName,\n\t\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\t\toptionCode: 'password',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.existingUser.password,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.password,\n\t\t\t\t\t\t\tdescription: UncannyAutomator.i18n.userSelector.newUser.passwordDescription,\n\t\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\t\tfieldType:  'select',\n\t\t\t\t\t\t\toptionCode: 'role',\n\t\t\t\t\t\t\tcurrentValue: ! isEmpty( UncannyAutomator.recipe.userSelector.data.existingUser.role ) ? UncannyAutomator.recipe.userSelector.data.existingUser.role : 'subscriber',\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.role,\n\t\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\t\tsupportsTokens: false,\n\t\t\t\t\t\t\toptions: Object.keys( roles ).map( ( key, index ) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tvalue: key,\n\t\t\t\t\t\t\t\t\ttext:  roles[ key ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemType: 'user-selector',\n\t\t\t\t\t\t\tfieldType: 'radio',\n\t\t\t\t\t\t\toptionCode: 'logUserIn',\n\t\t\t\t\t\t\tname: 'logUserIn',\n\t\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.canLogNewUserIn ? ( ! isEmpty( UncannyAutomator.recipe.userSelector.data.existingUser.logUserIn ) ? UncannyAutomator.recipe.userSelector.data.existingUser.logUserIn : 'no' ) : 'no',\n\t\t\t\t\t\t\tisHidden: ! UncannyAutomator.recipe.canLogNewUserIn,\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.logUserIn,\n\t\t\t\t\t\t\tsupportsTokens: false,\n\t\t\t\t\t\t\toptions: [{\n\t\t\t\t\t\t\t\t\tvalue: 'yes',\n\t\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.yes\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue: 'no',\n\t\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.no\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\n\t\t\t\t\t// Create fields\n\t\t\t\t\tnewUserFields.forEach(( fieldObject ) => {\n\t\t\t\t\t\t// Create field\n\t\t\t\t\t\tconst field = new Field( fieldObject.fieldType, fieldObject );\n\n\t\t\t\t\t\t// Get container\n\t\t\t\t\t\tlet $fieldFormElement = field.getFormElement();\n\n\t\t\t\t\t\t$subOptionsContainer.append( $fieldFormElement );\n\n\t\t\t\t\t\t// AFTER we added the elements to the DOM let's call init \n\t\t\t\t\t\t// TokenSelector and CodeMirror. We're going to call this in\n\t\t\t\t\t\t// ItemOptions.js because the TokenSelector and \n\t\t\t\t\t\t// CodeMirror need the item in the DOM before changing it\n\t\t\t\t\t\tfield.initTokenSelector();\n\t\t\t\t\t\tfield.initCodeMirror();\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * We don't need this for now, but we could need it in the future\n\t\t\t\t\t\t * \n\n\t\t\t\t\t\t// Listen changes\n\t\t\t\t\t\t$fieldFormElement.on( 'automator:field:change', () => {\n\t\t\t\t\t\t\t// Get ID\n\t\t\t\t\t\t\tconst fieldId = fieldObject.optionCode;\n\n\t\t\t\t\t\t\t// Get value\n\t\t\t\t\t\t\tconst value = field.getValue();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t*/\n\n\t\t\t\t\t\t// Save field\n\t\t\t\t\t\toptionsFields.push( field );\n\t\t\t\t\t});\n\n\t\t\t\t\t// Append container\n\t\t\t\t\t$fields.append( $subOptionsContainer );\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'newUser':\n\t\t\t\t// Create new users fields\n\t\t\t\tlet newUserFields = [\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'firstName',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.firstName,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.firstName,\n\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'lastName',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.lastName,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.lastName,\n\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'email',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.email,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.email,\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'username',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.username,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.username,\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'displayName',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.displayName,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.displayName,\n\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'text',\n\t\t\t\t\t\toptionCode: 'password',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.password,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.password,\n\t\t\t\t\t\tdescription: UncannyAutomator.i18n.userSelector.newUser.passwordDescription,\n\t\t\t\t\t\tisRequired: false,\n\t\t\t\t\t\tsupportsTokens: true\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\t\tfieldType:  'select',\n\t\t\t\t\t\toptionCode: 'role',\n\t\t\t\t\t\tcurrentValue: ! isEmpty( UncannyAutomator.recipe.userSelector.data.newUser.role ) ? UncannyAutomator.recipe.userSelector.data.newUser.role : 'subscriber',\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.role,\n\t\t\t\t\t\tisRequired: true,\n\t\t\t\t\t\tsupportsTokens: false,\n\t\t\t\t\t\toptions: Object.keys( roles ).map( ( key, index ) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tvalue: key,\n\t\t\t\t\t\t\t\ttext:  roles[ key ]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\titemType: 'user-selector',\n\t\t\t\t\t\tfieldType: 'radio',\n\t\t\t\t\t\toptionCode: 'logUserIn',\n\t\t\t\t\t\tname: 'logUserIn',\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.canLogNewUserIn ? ( ! isEmpty( UncannyAutomator.recipe.userSelector.data.newUser.logUserIn ) ? UncannyAutomator.recipe.userSelector.data.newUser.logUserIn : 'no' ) : 'no',\n\t\t\t\t\t\tisHidden: ! UncannyAutomator.recipe.canLogNewUserIn,\n\t\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.logUserIn,\n\t\t\t\t\t\tsupportsTokens: false,\n\t\t\t\t\t\toptions: [{\n\t\t\t\t\t\t\t\tvalue: 'yes',\n\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.yes\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'no',\n\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.no\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t];\n\n\t\t\t\t// Create fields\n\t\t\t\tnewUserFields.forEach(( fieldObject ) => {\n\t\t\t\t\t// Create field\n\t\t\t\t\tconst field = new Field( fieldObject.fieldType, fieldObject );\n\n\t\t\t\t\t// Get container\n\t\t\t\t\tlet $fieldFormElement = field.getFormElement();\n\n\t\t\t\t\t$fields.append( $fieldFormElement );\n\n\t\t\t\t\t// AFTER we added the elements to the DOM let's call init \n\t\t\t\t\t// TokenSelector and CodeMirror. We're going to call this in\n\t\t\t\t\t// ItemOptions.js because the TokenSelector and \n\t\t\t\t\t// CodeMirror need the item in the DOM before changing it\n\t\t\t\t\tfield.initTokenSelector();\n\t\t\t\t\tfield.initCodeMirror();\n\n\t\t\t\t\t// Save field\n\t\t\t\t\toptionsFields.push( field );\n\t\t\t\t});\n\n\t\t\t\t// Create fallback field\n\t\t\t\tlet newUserFallbackField = new Field( 'radio', {\n\t\t\t\t\titemType:   'user-selector',\n\t\t\t\t\toptionCode: 'fallback',\n\t\t\t\t\tname: 'user-selector-new-user-fallback',\n\t\t\t\t\tlabel: UncannyAutomator.i18n.userSelector.newUser.existingUserFieldLabel,\n\t\t\t\t\tisRequired: true,\n\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.fallback,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'select-existing-user',\n\t\t\t\t\t\t\ttext: UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionExisting\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvalue: 'do-nothing',\n\t\t\t\t\t\t\ttext: UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionDoNothing\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t\toptionsFields.push( newUserFallbackField );\n\n\t\t\t\t// Add fallback field to the container\n\t\t\t\tlet $newUserfallbackFieldFormElement = newUserFallbackField.getFormElement();\n\t\t\t\t$fields.append( $newUserfallbackFieldFormElement );\n\n\t\t\t\t// Listen changes\n\t\t\t\t$newUserfallbackFieldFormElement.on( 'automator:field:change', () => {\n\t\t\t\t\t// Update the value of all the fields (don't validate them yet)\n\t\t\t\t\tlet fieldsValues = {};\n\n\t\t\t\t\t// Iterate fields\n\t\t\t\t\toptionsFields.forEach(( Field ) => {\n\t\t\t\t\t\t// Save the field using the optionCode as ID and field value as value\n\t\t\t\t\t\tfieldsValues[ Field.getAttributes().optionCode ] = Field.getValue();\n\t\t\t\t\t});\n\n\t\t\t\t\t// Get and save value\n\t\t\t\t\tuserSelectorObject( 'update-fields', {\n\t\t\t\t\t\tsource: 'newUser',\n\t\t\t\t\t\tdata: fieldsValues\n\t\t\t\t\t});\n\n\t\t\t\t\t// Render the actions metabox again\n\t\t\t\t\tnew Actions();\n\t\t\t\t});\n\n\t\t\t\t// Check if we have to add more fields or the do-nothing notice\n\t\t\t\tif ( UncannyAutomator.recipe.userSelector.data.newUser.fallback == 'do-nothing' ){\n\t\t\t\t\t// Create \"Do nothing\" notice\n\t\t\t\t\tconst $doNothingNotice = $( `\n\t\t\t\t\t\t<div class=\"user-selector__warning\">\n\t\t\t\t\t\t\t${ UncannyAutomator.i18n.userSelector.newUser.doNothingMessage }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t` );\n\n\t\t\t\t\t$fields.append( $doNothingNotice );\n\t\t\t\t}\n\t\t\t\telse if ( UncannyAutomator.recipe.userSelector.data.newUser.fallback == 'select-existing-user' ){\n\t\t\t\t\t// Create container\n\t\t\t\t\tlet $subOptionsContainer = $( '<div/>', {\n\t\t\t\t\t\t'class': 'item-options'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Create \"Prioritized Field\" field\n\t\t\t\t\tlet prioritizedField = new Field( 'select', {\n\t\t\t\t\t\titemType:     'user-selector',\n\t\t\t\t\t\toptionCode:   'prioritizedField',\n\t\t\t\t\t\tlabel:        UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldLabel,\n\t\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.userSelector.data.newUser.prioritizedField,\n\t\t\t\t\t\tdefaultValue: 'email',\n\t\t\t\t\t\tdescription:  UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldDescription,\n\t\t\t\t\t\tisRequired:   true,\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'email',\n\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.userSelector.newUser.email\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: 'username',\n\t\t\t\t\t\t\t\ttext:  UncannyAutomator.i18n.userSelector.newUser.username\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t\toptionsFields.push( prioritizedField );\n\n\t\t\t\t\t// Get field container\n\t\t\t\t\tlet $prioritizedField = prioritizedField.getFormElement();\n\t\t\t\t\t$subOptionsContainer.append( $prioritizedField );\n\n\t\t\t\t\t// Append container\n\t\t\t\t\t$fields.append( $subOptionsContainer );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Save fields\n\t\tUncannyAutomator.recipe.userSelector.fields = optionsFields;\n\n\t\t// Add fields\n\t\t$container.append( $fields );\n\n\t\t// Create and add save and cancel buttons\n\t\tconst $buttonsContainer = $( `<div class=\"item-options__buttons\"></div>` );\n\n\t\t// Save button\n\t\tconst $saveButton = $( `<div class=\"uap-btn uap-btn--primary\">${ UncannyAutomator.i18n.save }</div>` );\n\t\tconst $cancelButton = $( `<div class=\"uap-btn uap-btn--secondary\">${ UncannyAutomator.i18n.cancel }</div>` );\n\n\t\t// Add listeners\n\t\t// On save\n\t\t$saveButton.on( 'click', () => {\n\t\t\t// Validate fields\n\t\t\t// Create default response\n\t\t\tlet areAllFieldsValid = true;\n\n\t\t\t// Create object to get all the fields values\n\t\t\tlet fieldsValues = {}\n\n\t\t\t// Iterate fields and validate them\n\t\t\toptionsFields.forEach(( Field ) => {\n\t\t\t\t// Get field validation\n\t\t\t\tconst isFieldValid = Field.validate().isValid;\n\n\t\t\t\t// Update global validation\n\t\t\t\tareAllFieldsValid = areAllFieldsValid && isFieldValid;\n\n\t\t\t\t// Check if the field is valid\n\t\t\t\tif ( isFieldValid ){\n\t\t\t\t\t// Save value\n\t\t\t\t\tfieldsValues[ Field.getAttributes().optionCode ] = Field.getValue();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Save values\n\t\t\tuserSelectorObject( 'update-fields', {\n\t\t\t\tsource: UncannyAutomator.recipe.userSelector.source,\n\t\t\t\tdata: fieldsValues\n\t\t\t});\n\n\t\t\t// Check if all fields are valid, otherwise\n\t\t\t// do nothing. The .validate() method will\n\t\t\t// render the errors\n\t\t\tif ( areAllFieldsValid ){\n\t\t\t\t// Add loading class to button\n\t\t\t\t$saveButton.addClass( 'uap-btn--primary uap-btn--loading uap-btn--disabled' );\n\n\t\t\t\t// Make request\n\t\t\t\trestCall( 'user-selector', {\n\t\t\t\t\trecipeId: UncannyAutomator.recipe.id,\n\t\t\t\t\tsource: UncannyAutomator.recipe.userSelector.source,\n\t\t\t\t\tdata: UncannyAutomator.recipe.userSelector.data[ UncannyAutomator.recipe.userSelector.source ]\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\t// On success\n\t\t\t\t\t// Set user selector as valid\n\t\t\t\t\tUncannyAutomator.recipe.userSelector.isValid = true;\n\n\t\t\t\t\t// Set step\n\t\t\t\t\tuserSelectorObject( 'set-step', {\n\t\t\t\t\t\tstep: 'show-sentence'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Render actions again\n\t\t\t\t\tnew Actions();\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\t// On error\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// On cancel\n\t\t$cancelButton.on( 'click', () => {\n\t\t\t// Delete fields information\n\t\t\t// userSelectorObject( 'reset-fields' );\n\n\t\t\t// Set step\n\t\t\tuserSelectorObject( 'set-step', {\n\t\t\t\tstep: 'select-source'\n\t\t\t});\n\n\t\t\t// Render actions again\n\t\t\tnew Actions();\n\t\t})\n\n\t\t// Add buttons\n\t\t$buttonsContainer.append( $saveButton );\n\t\t$buttonsContainer.append( $cancelButton );\n\t\t$container.append( $buttonsContainer );\n\n\t\treturn $container;\n\t}\n\n\tgetSentenceNodes(){\n\t\t// Create elements\n\t\tlet $optionsContainer = $( `\n\t\t\t<div class=\"user-selector user-selector--summary ${ UncannyAutomator.recipe.requiresUserData ? 'user-selector--show' : '' }\">\n\t\t\t\t<div class=\"item item--user-selector\">\n\t\t\t\t\t<div class=\"item__content\">\n\t\t\t\t\t\t<div class=\"item-options\">\n\t\t\t\t\t\t\t<div class=\"user-selector-summary\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t$optionsContainer.find( '.item' ).prepend( this.getHeaderNodes() );\n\n\t\t// Get container\n\t\tlet $summaryContainer = $optionsContainer.find( '.user-selector-summary' );\n\n\t\t// Create first row\n\t\tlet $sourceRow = $( `\n\t\t\t<div class=\"user-selector-summary-row\">\n\t\t\t\t<div class=\"user-selector-summary-row__icon\">\n\t\t\t\t\t<span class=\"uo-icon uo-icon--atom\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"user-selector-summary-row__content\"></div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Create token\n\t\tlet $sourceRowToken = $( `\n\t\t\t<div class=\"user-selector-summary-row__token\"></div>\n\t\t` );\n\t\t$sourceRow.find( '.user-selector-summary-row__content' ).append( $sourceRowToken );\n\n\t\t// If the source is \"existingUser\"\n\t\tif ( UncannyAutomator.recipe.userSelector.source == 'existingUser' ){\n\t\t\t// Then add the \"Existing user\" string\n\t\t\t$sourceRowToken.text( UncannyAutomator.i18n.userSelector.userType.existing );\n\t\t}\n\t\t// If it's \"newUser\"\n\t\telse if ( UncannyAutomator.recipe.userSelector.source == 'newUser' ){\n\t\t\t// Then add the \"New user\" string\n\t\t\t$sourceRowToken.text( UncannyAutomator.i18n.userSelector.userType.new );\n\t\t}\n\n\t\t// Listen clicks\n\t\t$sourceRowToken.on( 'click', () => {\n\t\t\t// Go to the first step.\n\t\t\t\n\t\t\t// Delete fields information\n\t\t\t// userSelectorObject( 'reset-fields' );\n\n\t\t\t// Set step\n\t\t\tuserSelectorObject( 'set-step', {\n\t\t\t\tstep: 'select-source'\n\t\t\t});\n\n\t\t\t// Render actions again\n\t\t\tnew Actions();\n\t\t});\n\n\t\t// Add to container\n\t\t$summaryContainer.append( $sourceRow );\n\n\t\t// Create first row\n\t\tlet $dataRow = $( `\n\t\t\t<div class=\"user-selector-summary-row\">\n\t\t\t\t<div class=\"user-selector-summary-row__icon\">\n\t\t\t\t\t<span class=\"uo-icon uo-icon--fingerprint\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"user-selector-summary-row__content\"></div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Create token\n\t\tlet $dataRowSentence;\n\n\t\tif ( UncannyAutomator.recipe.userSelector.source == 'existingUser' ){\n\t\t\t$dataRowSentence = $( `\n\t\t\t\t<div>\n\t\t\t\t${\n\t\t\t\t\tvsprintf(\n\t\t\t\t\t\tUncannyAutomator.i18n.userSelector.summary.matches,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t`<div class=\"user-selector-summary-row__token\">${ UncannyAutomator.i18n.userSelector.summary[ UncannyAutomator.recipe.userSelector.data.existingUser.uniqueField ] }</div>`,\n\t\t\t\t\t\t\t`<div class=\"user-selector-summary-row__token\">${ UncannyAutomator.recipe.userSelector.data.existingUser.uniqueFieldValue }</div>`\n\t\t\t\t\t\t]\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t</div>`\n\t\t\t);\n\t\t}\n\t\telse if ( UncannyAutomator.recipe.userSelector.source == 'newUser' ){\n\t\t\t$dataRowSentence = $( `\n\t\t\t\t<div>\n\t\t\t\t${\n\t\t\t\t\tvsprintf(\n\t\t\t\t\t\tUncannyAutomator.i18n.userSelector.summary.withEmail,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t`<div class=\"user-selector-summary-row__token\">${ UncannyAutomator.recipe.userSelector.data.newUser.email }</div>`\n\t\t\t\t\t\t]\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\t$dataRow.find( '.user-selector-summary-row__content' ).append( $dataRowSentence );\n\n\t\t// Listen clicks\n\t\t$dataRowSentence.find( '.user-selector-summary-row__token' ).on( 'click', () => {\n\t\t\t// Go to the second step.\n\t\t\t\n\t\t\t// Set step\n\t\t\tuserSelectorObject( 'set-step', {\n\t\t\t\tstep: 'set-options'\n\t\t\t});\n\n\t\t\t// Render actions again\n\t\t\tnew Actions();\n\t\t});\n\n\t\t// Add data row\n\t\t$summaryContainer.append( $dataRow );\n\n\t\t// Add fallback row\n\t\tlet $fallbackRow = $( `\n\t\t\t<div class=\"user-selector-summary-row\">\n\t\t\t\t<div class=\"user-selector-summary-row__icon\">\n\t\t\t\t\t<span class=\"uo-icon uo-icon--directions\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"user-selector-summary-row__content\"></div>\n\t\t\t</div>\n\t\t` );\n\n\t\tlet otherwiseText = '';\n\n\t\tif ( UncannyAutomator.recipe.userSelector.source == 'existingUser' ){\n\t\t\tif ( UncannyAutomator.recipe.userSelector.data.existingUser.fallback == 'create-new-user' ){\n\t\t\t\totherwiseText = UncannyAutomator.i18n.userSelector.summary.createNewUser;\n\t\t\t}\n\t\t\telse if ( UncannyAutomator.recipe.userSelector.data.existingUser.fallback == 'do-nothing' ){\n\t\t\t\totherwiseText = UncannyAutomator.i18n.userSelector.summary.doNothing;\n\t\t\t}\n\t\t}\n\t\telse if ( UncannyAutomator.recipe.userSelector.source == 'newUser' ){\n\t\t\tif ( UncannyAutomator.recipe.userSelector.data.newUser.fallback == 'select-existing-user' ){\n\t\t\t\totherwiseText = UncannyAutomator.i18n.userSelector.summary.selectExistingUser;\n\t\t\t}\n\t\t\telse if ( UncannyAutomator.recipe.userSelector.data.newUser.fallback == 'do-nothing' ){\n\t\t\t\totherwiseText = UncannyAutomator.i18n.userSelector.summary.doNothing;\n\t\t\t}\n\t\t}\n\n\t\tlet $fallbackRowSentence = $( `\n\t\t\t<div>\n\t\t\t${\n\t\t\t\tvsprintf(\n\t\t\t\t\tUncannyAutomator.i18n.userSelector.summary.otherwise,\n\t\t\t\t\t[\n\t\t\t\t\t\t`<div class=\"user-selector-summary-row__token\">${ otherwiseText }</div>`\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t}\n\t\t\t</div>`\n\t\t);\n\t\t$fallbackRow.find( '.user-selector-summary-row__content' ).append( $fallbackRowSentence );\n\n\t\t// Listen clicks\n\t\t$fallbackRow.find( '.user-selector-summary-row__token' ).on( 'click', () => {\n\t\t\t// Go to the second step.\n\n\t\t\t// Set step\n\t\t\tuserSelectorObject( 'set-step', {\n\t\t\t\tstep: 'set-options'\n\t\t\t});\n\n\t\t\t// Render actions again\n\t\t\tnew Actions();\n\t\t});\n\n\t\t// Add data row\n\t\t$summaryContainer.append( $fallbackRow );\n\n\t\t// Return nodes\n\t\treturn $optionsContainer;\n\t}\n\n\tgetHeaderNodes(){\n\t\t// Define title variable\n\t\tlet title;\n\n\t\t// Get title variable\n\t\tswitch ( UncannyAutomator.recipe.userSelector.step ){\n\t\t\tcase 'select-source':\n\t\t\tcase 'show-sentence':\n\t\t\t\t// Define title\n\t\t\t\ttitle = UncannyAutomator.i18n.userSelector.sentenceTitle;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'set-options':\n\t\t\t\t// Define title\n\t\t\t\ttitle = UncannyAutomator.i18n.userSelector.setOptions;\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Create output\n\t\tlet $output = $( `\n\t\t\t<div>\n\t\t\t\t<div class=\"item-actions\">\n\t\t\t\t\t<div class=\"item-actions__btn\">\n\t\t\t\t\t\t<i class=\"uo-icon uo-icon--ellipsis-h-alt\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"item-actions__dropdown\">\n\t\t\t\t\t\t<ul class=\"item-actions-dropdown__ul\">\n\t\t\t\t\t\t\t<a href=\"${ addUTMParameters( 'https://automatorplugin.com/knowledge-base/anonymous-recipes/#Introducing_the_User_Selector', {\n\t\t                        'medium':  'user_selector',\n\t\t                        'content': 'support_menu_link'\n\t\t                    }) }\" target=\"_blank\" class=\"item-actions-dropdown__action\">\n\t\t\t\t\t\t\t\t<span>${ UncannyAutomator.i18n.support }</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"item-icon\"></div>\n\t\t\t\t<div class=\"item-title uap-clear\">\n\t\t\t\t\t<div class=\"item-title__describe\">\n\t\t\t\t\t\t<div class=\"item-title__non-editable\">\n\t\t\t\t\t\t\t${ title }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Get item actions\n\t\tconst $itemActions = $output.find( '.item-actions' );\n\n\t\t// Add functionality to open and close the actions dropdown\n\t\t// Listen click on the three dots icon\n\t\t$output.find( '.item-actions__btn' ).on( 'click', () => {\n\t\t\t// Evaluate if it's open\n\t\t\tconst isOpen = $itemActions.hasClass( 'item-actions--open' );\n\n\t\t\t// Check if it's not open\n\t\t\tif ( ! isOpen ){\n\t\t\t\t// Open the dropdown\n\t\t\t\t$itemActions.addClass( 'item-actions--open' );\n\n\t\t\t\t// Listen clicks outside the dropdown\n\t\t\t\t$( document ).on( 'mouseup.uap-actions-click-outside', ( event ) => {\n\t\t\t\t\tif ( ! $itemActions.is( event.target ) && $itemActions.has( event.target ).length === 0 ){\n\t\t\t\t\t\t// Close dropdown\n\t\t\t\t\t\t$itemActions.removeClass( 'item-actions--open' );\n\n\t\t\t\t\t\t// Remove event listener to listen clicks outside the dropdown\n\t\t\t\t\t\t$( document ).off( 'mouseup.uap-actions-click-outside' );\n\t\t\t\t\t}\n\t\t\t\t});           \n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Close dropdown\n\t\t\t\t$itemActions.removeClass( 'item-actions--open' );\n\n\t\t\t\t// Remove event listener to listen clicks outside the dropdown\n\t\t\t\t$( document ).off( 'mouseup.uap-actions-click-outside' );\n\t\t\t}\n\t\t} );\n\n\t\t// Return output\n\t\treturn $output;\n\t}\n}\n\nexport default UserSelector;\n","import $ from 'jquery';\n\nimport {\n\tgetDOMElements\n}                              from '../common/utilities.js';\n\nimport ItemCreatorIntegrations from './integrations-grid.js';\n\nclass ItemCreatorAdd {\n\tconstructor( itemType ){\n\t\tlet $container    = $( '<div/>', { 'class': 'item item--start' }),\n\t\t\t$icon         = $( '<div/>', { 'class': 'item-icon' }),\n\t\t\t$containerBox = $( '<div/>', { 'class': 'item-title uap-clear' }),\n\t\t\t$button       = $( '<div/>', { 'class': 'uap-btn uap-btn--secondary uap-btn--small' });\n\n\t\t$containerBox.append( $button );\n\t\t$container.append( $icon );\n\t\t$container.append( $containerBox );\n\n\t\t// Add to the metabox\n\t\tlet $metabox = getDOMElements( 'metabox', {\n\t\t\ttype: itemType\n\t\t});\n\n\t\t$metabox.append( $container );\n\n\t\t// Add text depending of the itemType\n\t\tif ( itemType == 'trigger' ){\n\t\t\t$button.text( UncannyAutomator.i18n.trigger.add );\n\t\t}\n\n\t\tif ( itemType == 'action' ){\n\t\t\t$button.text( UncannyAutomator.i18n.action.add );\n\t\t}\n\n\t\t$button.on( 'click', () => new ItemCreatorIntegrations( itemType ) );\n\t}\n}\n\nexport default ItemCreatorAdd;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tisDefined,\n\tgetDOMElements,\n\trestCall,\n}                         from '../common/utilities.js';\n\nimport ItemHeaderMenu     from './action-menu.js';\nimport ItemHeaderIcon     from './integration-icon.js';\nimport ItemHeaderTag      from './integration-name.js';\nimport ItemHeaderSentence from './sentence.js';\n\nimport Field              from '../field/field.js';\n\nimport Actions            from './actions.js';\n\nclass Closures {\n\n\tconstructor( label ){\n\t\t// Create console group\n\t\t// console.group( 'Closures' );\n\n\t\t// Get metabox\n\t\tthis.elements = {\n\t\t\t$metabox: getDOMElements( 'metabox', { type: 'action' })\n\t\t}\n\n\t\t// Create closures. It's important to understand that we're going to create all the available closures, not only those already added to the item\n\t\t// That's why we create a separate file instead of using Item.js\n\t\t$.each( UncannyAutomator.closures, ( key, closure ) => this.createClosure( closure, label ) );\n\n\t\t// Close console group\n\t\t// console.groupEnd();\n\t}\n\n\tcreateClosure( closure, label ){\n\t\t// Variable to check later if this closure already was added to the recipe\n\t\tlet wasAdded = false;\n\n\t\t// Container\n\t\tlet $container = $( `\n\t\t\t<div class=\"metabox__footer metabox__closures\"></div>\n\t\t` );\n\n\t\t// Checkbox attributes. We're going to use this to create our checkbox later.\n\t\tlet checkboxAttributes = {\n\t\t\tlabel:              label,\n\t\t\tformElementClass:   'form-element--nomargin'\n\t\t}\n\n\t\t// Check if this closure already was added to the recipe\n\t\tlet closureInRecipe = this.getClosureByCodeFromItemsObject( closure.code );\n\n\t\tif ( isDefined( closureInRecipe ) ){\n\t\t\twasAdded = true;\n\n\t\t\tcheckboxAttributes.currentValue = true;\n\t\t\tcheckboxAttributes.itemid       = closureInRecipe.id;\n\n\t\t\t// Debug\n\t\t\t// console.groupCollapsed( vsprintf( 'ID: %s', [ closureInRecipe.id ] ) );\n\t\t\t// console.log( closureInRecipe );\n\t\t\t// console.groupEnd();\n\t\t}\n\n\t\t// Create checkbox\n\t\tlet checkboxField = new Field( 'checkbox', checkboxAttributes ),\n\t\t\t$checkbox      = checkboxField.getFormElement();\n\n\t\t// Bind changes\n\t\t$checkbox.on( 'change', function(){\n\t\t\tlet isChecked = checkboxField.getValue();\n\t\t\tcheckboxField.startLoadingAnimation();\n\n\t\t\t// Check if it's checked\n\t\t\tif ( isChecked ){\n\t\t\t\t// Add item to the recipe\n\t\t\t\trestCall( 'add', {\n\t\t\t\t\trecipePostID: UncannyAutomator.recipe.id,\n\t\t\t\t\taction:       'add-new-closure',\n\t\t\t\t\titem_code:    closure.code,\n\t\t\t\t\tdefault_meta: {\n\t\t\t\t\t\tintegration_name: UncannyAutomator.integrations[ closure.integration ].name,\n\t\t\t\t\t\tsentence:         closure.sentence\n\t\t\t\t\t}\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\tnew Actions();\n\n\t\t\t\t\t// Check if the ID of the new item is defined\n\t\t\t\t\tif ( isDefined( response.post_ID ) ){\n\t\t\t\t\t\t// Get item form element\n\t\t\t\t\t\tconst $newItem = getDOMElements( 'item', {\n\t\t\t\t\t\t\tid: response.post_ID\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Get first token and trigger a click\n\t\t\t\t\t\t$newItem.item.find( '.item-title__token:not(.item-title__token--filled)' ).first().trigger( 'click' );\n\t\t\t\t\t}\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t add the closure' );\n\n\t\t\t\t\t// Stop the loading animation\n\t\t\t\t\tcheckboxField.stopLoadingAnimation();\n\n\t\t\t\t\t// Change back the value of the checkbox\n\t\t\t\t\tcheckboxField.setValue( false, false );\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\trestCall( 'delete', {\n\t\t\t\t\tID: closureInRecipe.id\n\t\t\t\t}, () => {\n\t\t\t\t\tnew Actions();\n\t\t\t\t}, () => {\n\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t delete the closure' );\n\n\t\t\t\t\tnew Actions();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Append checkbox to the container\n\t\t$container.append( $checkbox );\n\n\t\t// Create toggle section\n\t\tlet $toggleContent = $( '<div/>', { 'class': 'uo-toggle uo-toggle--show' });\n\n\t\t// Check if it was already added. In that case show it\n\t\tif ( wasAdded ){\n\t\t\t$toggleContent.addClass( 'uo-toggle--show' );\n\n\t\t\tlet $item = $( '<div/>', {\n\t\t\t\t'class':   'item item--closure item--margintop',\n\t\t\t\t'data-id': closureInRecipe.id\n\t\t\t});\n\n\t\t\tlet $itemHeader = this.createHeader(\n\t\t\t\tUncannyAutomator.recipe.items[ closureInRecipe.id ].integrationCode,\n\t\t\t\t'closure',\n\t\t\t\tclosure.code,\n\t\t\t\tclosureInRecipe.id,\n\t\t\t);\n\n\t\t\t$item.append( $itemHeader );\n\n\t\t\tlet $itemContent = $( '<div/>', { 'class': 'item__content' });\n\t\t\t$item.append( $itemContent );\n\n\t\t\t$toggleContent.append( $item );\n\t\t}\n\t\n\t\t$container.append( $toggleContent );\n\n\t\t// Append everything to the metabox\n\t\tthis.elements.$metabox.append( $container );\n\t}\n\n\t/**\n\t * Creates item header\n\t * \n\t * @since 0.5\n\t *\n\t * @param {string}    integrationCode - The integration code\n\t * @param {string}    itemType - The item type: 'trigger', 'action' or 'closure'\n\t * @param {string}    itemCode - The code of the item\n\t * @param {int}       itemId - The ID of the item\n\t */\n\n\tcreateHeader( integrationCode, itemType, itemCode, itemId ){\n\t\tlet $container = $( '<div/>' ),\n\t\t\t$title     = $( '<div/>', { 'class': 'item-title uap-clear' });\n\n\t\tlet $actions = new ItemHeaderMenu( itemType, integrationCode, itemCode, itemId );\n\t\t$container.append( $actions );\n\n\t\tlet $icon    = new ItemHeaderIcon( integrationCode );\n\t\t$container.append( $icon );\n\t\t\n\t\tlet $itemTag = new ItemHeaderTag( integrationCode );\n\t\t$title.append( $itemTag );\n\n\t\tlet $titleSentence = new ItemHeaderSentence( itemType, integrationCode, itemCode, itemId );\n\t\t$title.append( $titleSentence );\n\n\t\t$container.append( $title );\n\n\t\treturn $container;\n\t}\n\n\tgetClosureByCodeFromItemsObject( code ){\n\t\tlet theItem;\n\n\t\t$.each( UncannyAutomator.recipe.items, function( itemID, item ){\n\t\t\tif ( item.itemCode == code ){\n\t\t\t\ttheItem = item;\n\t\t\t}\n\t\t})\n\n\t\treturn theItem;\n\t}\n}\n\nexport default Closures;","import $ from 'jquery';\n\nimport {\n\titemsObject,\n\tgetDOMElements,\n\tisEmpty,\n\tisDefined,\n\tfilterMeta,\n\tgetURLParameter,\n\tfilterMetaValue\n}                               from '../common/utilities.js';\n\nimport UserSelector             from '../user-selector/user-selector.js';\n\nimport MetaboxItems             from '../metabox/items.js';\nimport MetaboxFooter            from '../metabox/footer.js';\n\nimport ItemCreatorAdd           from './button-add-item.js';\nimport Closures                 from './closures.js';\nimport ItemCreatorIntegrations  from './integrations-grid.js';\n\nexport default class Actions {\n\n\t/**\n\t * Renders all the actions in the UI\n\t */\n\n\tconstructor(){\n\t   \n\t\t// Debugging: Create console group\n\t\t// console.group( 'Actions' );\n\n\t\t// Get and clear metabox\n\t\tlet $metabox = getDOMElements( 'metabox', { type: 'action' });\n\t\t$metabox.empty();\n\n\t\t// Check if we have to create the User Selector\n\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t// Create User Selector\n\t\t\tnew UserSelector();\n\t\t}\n\n\t\t// Get recipe actions\n\t\tlet actions = itemsObject( 'get', {\n\t\t\tfilter: {\n\t\t\t\titemType: 'action',\n\t\t\t}\n\t\t});\n\n\t\t// Check if it has actions\n\t\tif ( ! isEmpty( actions ) && isDefined( UncannyAutomator.wp ) && UncannyAutomator.wp ){\n\n\t\t\tlet instantActions = filterMeta( actions, 'async_mode', false );\n\t\t\tlet delayedActions = filterMetaValue( actions, 'async_mode', 'delay' );\n\t\t\tlet scheduledActions = filterMetaValue( actions, 'async_mode', 'schedule' );\n\n\t\t\tif ( ! isEmpty( delayedActions ) || ! isEmpty( scheduledActions ) ) {\n\t\t\t\tif ( ! isEmpty( instantActions ) ) {\n\t\t\t\t\t// Render non async actions\n\t\t\t\t\tnew MetaboxItems( 'action', instantActions );\n\t\t\t\t}\n\t\t\t\t   \n\t\t\t\t// Add Closures\n\t\t\t\t// Add action button\n\t\t\t\tnew MetaboxFooter( 'action' );\n\n\t\t\t\t// Check if we have to show the integrations on load\n\t\t\t\tif ( this.isContinuingIntegrationConnection() ){\n\t\t\t\t\t// Render the integrations list\n\t\t\t\t\tnew ItemCreatorIntegrations( 'action' );\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tnew Closures( UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly );\n\t\t\t\t\n\t\t\t\t // Render async actions\n\t\t\t\tnew MetaboxItems( 'action', delayedActions );\n\t\t\t\tnew MetaboxItems( 'action', scheduledActions );\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Render non-async actions\n\t\t\t\tnew MetaboxItems( 'action', instantActions );\n\n\t\t\t\t// Add action button\n\t\t\t\tnew MetaboxFooter( 'action' );\n\n\t\t\t\t// Check if we have to show the integrations on load\n\t\t\t\tif ( this.isContinuingIntegrationConnection() ){\n\t\t\t\t\t// Render the integrations list\n\t\t\t\t\tnew ItemCreatorIntegrations( 'action' );\n\t\t\t\t}\n\n\t\t\t\t// Add closures\n\t\t\t\tnew Closures( UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly );\n\t\t\t}\n\t\t} \n\t\telse if ( ! isEmpty( actions ) ) {\n\t\t\tnew MetaboxItems( 'action', actions );\n\n\t\t\t// Add action button\n\t\t\tnew MetaboxFooter( 'action' );\n\n\t\t\t// Check if we have to show the integrations on load\n\t\t\tif ( this.isContinuingIntegrationConnection() ){\n\t\t\t\t// Render the integrations list\n\t\t\t\tnew ItemCreatorIntegrations( 'action' );\n\t\t\t}\n\n\t\t\t// Add closures\n\t\t\tnew Closures( UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly );\n\t\t}\n\t\telse {\n\t\t\t// Render the first step of the item creator\n\t\t\tnew ItemCreatorAdd( 'action' );\n\n\t\t\t// Check if we have to show the integrations on load\n\t\t\tif ( this.isContinuingIntegrationConnection() ){\n\t\t\t\t// Render the integrations list\n\t\t\t\tnew ItemCreatorIntegrations( 'action' );\n\t\t\t}\n\t\t\t\n\t\t\t// Add closures\n\t\t\tnew Closures( UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly );\n\t\t}\n\n\t\t// Debugging: Close console group\n\t\t// console.groupEnd();\n\t}\n\n\tisContinuingIntegrationConnection(){\n\t\treturn getURLParameter( null, 'ua_connecting_integration' ) == 1 && getURLParameter( null, 'ua_connecting_integration_context' ) == 'action';\n\t}\n}","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tisDefined\n} from '../common/utilities.js';\n\nclass ItemHeaderIcon {\n\tconstructor( integrationCode ){\n\t\tthis.integrationCode = integrationCode;\n\n\t\treturn this.createItemIcon();\n\t}\n\n\t/**\n\t * Create item icon\n\t *\n\t * @since 0.5\n\t *\n\t * @return {object}   HTML with the item icon\n\t */\n\n\tcreateItemIcon(){\n\t\tlet container   = $( '<div/>', { 'class': 'item-icon' });\n\n\t\tif ( isDefined( UncannyAutomator.integrations[ this.integrationCode ] ) ){\n\t\t\t// Get integration by integrationCode\n\t\t\tlet integration = UncannyAutomator.integrations[ this.integrationCode ];\n\n\t\t\t// Create the variable where we're going to save the icon\n\t\t\tlet $icon;\n\n\t\t\t// Check if it has a svg image\n\t\t\tif ( isDefined( integration.icon_svg ) ){\n\t\t\t\t$icon = $( `<img src=\"${ integration.icon_svg }\" alt=\"${ integration.name }\">` );\n\t\t\t}\n\t\t\t// Check if it has a png image\n\t\t\telse if ( isDefined( integration.icon_32 ) && isDefined( integration.icon_64 ) ){\n\t\t\t\t$icon = $( `<img src=\"${ integration.icon_32 }\" srcset=\"${ vsprintf( '%s 1x, %s 2x', [ integration.icon_32, integration.icon_64 ]) }\" alt=\"${ integration.name }\">` );\n\t\t\t}\n\n\t\t\tcontainer.append( $icon );\n\t\t} \n\n\t\t// Return element\n\t\treturn container;\n\t}\n}\n\nexport default ItemHeaderIcon;","import $ from 'jquery';\n\nimport {\n\tisDefined\n} from '../common/utilities.js';\n\nclass ItemHeaderTag {\n\tconstructor( integrationId, integrationName = null ){\n\t\tthis.integrationId = integrationId;\n\t\tthis.integrationName = integrationName;\n\n\t\treturn this.createItemTag();\n\t}\n\n\t/**\n\t * Create item tag with the name of the integration\n\t *\n\t * @since 0.5\n\t * \n\t * @param {string}    integrationCode - The integration code\n\t *\n\t * @return {object}   HTML with the item tag\n\t */\n\n\tcreateItemTag(){\n\t\t// Get integration by integrationId\n\t\tlet integration = UncannyAutomator.integrations[ this.integrationId ];\n\n\t\t// Create tag element and set the integraiton name\n\t\tlet container   = $( '<div/>', { 'class': 'item-title__integration uap-clear' }),\n\t\t\ttag         = $( '<div/>', { 'class': 'item-title__tag' });\n\n\t\tif ( isDefined( integration ) ){\n\t\t\ttag.text( integration.name );\n\t\t}\n\t\telse {\n\t\t\ttag.text( this.integrationName );\n\t\t}\n\n\t\tcontainer.append( tag );\n\n\t\t// Return tag\n\t\treturn container;\n\t}\n}\n\nexport default ItemHeaderTag;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tgetItemsByIntegration,\n\tgetDOMElements,\n\trestCall,\n\tisDefined,\n\tisEmpty,\n\treplaceCurlyBraces,\n\taddParametersToURL,\n\taddUTMParameters,\n\topenInNewTab,\n\trecipeSetRequiresUser\n} from '../common/utilities.js';\n\nimport Modal          from '../common/modal.js';\n\nimport ItemCreatorIntegrations from './integrations-grid.js';\nimport ItemHeaderMenu          from './action-menu.js';\nimport ItemHeaderIcon          from './integration-icon.js';\nimport ItemHeaderTag           from './integration-name.js';\nimport Triggers \t           from './triggers.js';\nimport Actions \t\t           from './actions.js';\n\nclass ItemCreatorTaskSelector {\n\tconstructor( itemType, integrationID, $currentItem ){\n\t\tthis.itemType \t\t= itemType;\n\t\tthis.integrationID \t= integrationID;\n\t\tthis.$currentItem \t= $currentItem;\n\n\t\t// Render DOM elements\n\t\tthis.render();\n\t}\n\n\trender(){\n\t\t// Create $container\n\t\tthis.$container = $( `<div class=\"item\"></div>` );\n\t\tthis.$item = this.$container;\n\n\t\tthis.createHeader();\n\t\tthis.createItemsList();\n\t\tthis.removeConnectingIntegrationsParameters();\n\n\t\tthis.$currentItem.replaceWith( this.$container );\n\t}\n\n\tcreateHeader(){\n\t\tconst $header = $( `\n\t\t\t<div>\n\t\t\t\t<div class=\"item-title uap-clear\">\n\t\t\t\t\t<div class=\"item-title__describe\">\n\t\t\t\t\t\t<div class=\"item-title__non-editable\">\n\t\t\t\t\t\t\t${ this.itemType == 'trigger' ? UncannyAutomator.i18n.trigger.select : UncannyAutomator.i18n.action.select }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Add the item actions (the three dots)\n\t\tlet $itemActions = new ItemHeaderMenu( this.itemType );\n\t\t$header.append( $itemActions );\n\n\t\t// Add the item icon\n\t\tlet $itemIcon = new ItemHeaderIcon( this.integrationID );\n\t\t$header.append( $itemIcon );\n\n\t\t// Add the integration tag\n\t\tlet $integrationTag = new ItemHeaderTag( this.integrationID );\n\t\t$header.find( '.item-title' ).prepend( $integrationTag );\n\n\t\t// Append the header to the main container\n\t\tthis.$container.append( $header );\n\t}\n\n\tcreateItemsList(){\n\t\tlet items, searchPlaceholder, unlockItems;\n\n\t\t// Get data depending on the item type\n\t\tif ( this.itemType == 'trigger' ){\n\t\t\titems \t           = getItemsByIntegration( this.integrationID, 'triggers' );\n\t\t\tsearchPlaceholder  = UncannyAutomator.i18n.trigger.search;\n\t\t\tunlockItems        = UncannyAutomator.i18n.proOnly.unlockTriggers;\n\t\t}\n\t\telse if ( this.itemType == 'action' ){\n\t\t\titems              = getItemsByIntegration( this.integrationID, 'actions' );\n\t\t\tsearchPlaceholder  = UncannyAutomator.i18n.action.search;\n\t\t\tunlockItems        = UncannyAutomator.i18n.proOnly.unlockActions;\n\t\t}\n\n\t\t// Create the main container\n\t\tconst $container   = $( `\n\t\t\t<div class=\"item__content\">\n\t\t\t\t<div class=\"item-options item-options--nopadding item-options--noborder\">\n\t\t\t\t\t<div class=\"form-element\">\n\t\t\t\t\t\t<div class=\"item__task-selector\">\n\t\t\t\t\t\t\t<div class=\"item-task-selector__search\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tclass=\"item-task-selector__search-input\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"${ searchPlaceholder }\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"item-task-selector__options\">\n\t\t\t\t\t\t\t\t<div class=\"item-task-selector-options__group item-task-selector-options__group--available\"></div>\n\t\t\t\t\t\t\t\t<div class=\"item-task-selector-options__group item-task-selector-options__group--unavailable\">\n\t\t\t\t\t\t\t\t\t<div class=\"item-task-selector-options__group-items\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"item-task-selector__option item-task-selector__option--no-results item-task-selector__option--hide\">\n\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.noResults }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Get important elements\n\t\tconst $optionsContainer = $container.find( '.item-options' ),\n\t\t\t  $taskSelector     = $container.find( '.item__task-selector' ),\n\t\t\t  $searchField      = $container.find( '.item-task-selector__search-input' ),\n\t\t\t  $itemsList        = {\n\t\t\t\tcontainer: $container.find( '.item-task-selector__options' ),\n\t\t\t\tavailable: $container.find( '.item-task-selector-options__group--available' ),\n\t\t\t\tunavailable: {\n\t\t\t\t\tcontainer: $container.find( '.item-task-selector-options__group--unavailable' ),\n\t\t\t\t\tlist:      $container.find( '.item-task-selector-options__group-items' )\n\t\t\t\t},\n\t\t\t\tnoResults: $container.find( '.item-task-selector__option--no-results' )\n\t\t\t  };\n\n\t\t// Check if it has available items\n\t\tif ( items.hasAvailableItems ){\n\t\t\t// Sort available items\n\t\t\t// Move the ones that require user data to the bottom if the user has Automator free\n\t\t\t// and this is an anonymous recipe\n\t\t\tif (\n\t\t\t\t// Check if WP is ready\n\t\t\t\t( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp )\n\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\t&& UncannyAutomator.recipe.type == 'anonymous'\n\t\t\t){\n\t\t\t\tconst itemsThatRequireUserData     = [],\n\t\t\t\t\t  itemsThatDontRequireUserData = [];\n\n\t\t\t\titems.available.forEach(( item ) => {\n\t\t\t\t\tif ( item.requires_user ){\n\t\t\t\t\t\titemsThatRequireUserData.push( item );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\titemsThatDontRequireUserData.push( item );\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\titems.available = [ ...itemsThatDontRequireUserData, ...itemsThatRequireUserData ];\n\t\t\t}\n\n\t\t\t// Append available items to the list container\n\t\t\t$itemsList.available.append( items.available.map(( item ) => {\n\t\t\t\t// Check if it's a Pro item\n\t\t\t\tconst isPro = item.is_pro;\n\n\t\t\t\t// Check if the user can't add this action to this recipe\n\t\t\t\t// This happens if the action requires user data, but the user has Automator free\n\t\t\t\tconst cannotAddRequiresUserData = (\n\t\t\t\t\t// Check if WP is ready\n\t\t\t\t\t( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp )\n\t\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\t\t&& UncannyAutomator.recipe.type == 'anonymous'\n\t\t\t\t\t// Check if the action requires user data\n\t\t\t\t\t&& item.requires_user\n\t\t\t\t);\n\n\t\t\t\t// Create container\n\t\t\t\tconst $item = $( `\n\t\t\t\t\t<div class=\"item-task-selector__option ${ isPro ? 'item-task-selector__option--pro' : '' } ${ item.requires_user ? 'item-task-selector__option--requires-user' : '' } ${ cannotAddRequiresUserData ? 'item-task-selector__option-cannot-add' : '' }\"\n\t\t\t\t\t\tdata-search=\"${ item.select_option_name.toLowerCase().replace( /\\s+|{|}/g, '' ) }\">\n\t\t\t\t\t\t<div class=\"item-task-selector__option-sentence\">\n\t\t\t\t\t\t\t${ cannotAddRequiresUserData ? '<span class=\"uo-icon uo-icon--lock-alt\"></span>' : '' }\n\t\t\t\t\t\t\t${ replaceCurlyBraces( item.select_option_name, '<span class=\"item-task-selector__option-variable\">', '</span>' ) } ${ isPro ? `<span class=\"item-task-selector-option__badge\">${ UncannyAutomator.i18n.proOnly.pro }</span>` : '' }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"item-task-selector__option-properties\">\n\t\t\t\t\t\t\t${ UncannyAutomator.recipe.type == 'anonymous' && ! UncannyAutomator.recipe.requiresUserData && item.requires_user ? `<span class=\"item-task-selector-option__requires-user\">${ UncannyAutomator.i18n.needsUserData }</span>` : '' }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t` );\n\n\t\t\t\t// Listen clicks on the container\n\t\t\t\t$item.on( 'click', () => {\n\t\t\t\t\t// Add loading class to the parent container\n\t\t\t\t\t$taskSelector.addClass( 'item__task-selector--loading' );\n\n\t\t\t\t\t// Add loading class to the container\n\t\t\t\t\t$item.addClass( 'item-task-selector__option--loading' );\n\n\t\t\t\t\t// Get the correct request code\n\t\t\t\t\tconst restRequestCode = [ 'trigger', 'action' ].includes( this.itemType ) ? `add-new-${ this.itemType }` : '';\n\t\t\t\t\t\n\t\t\t\t\t// Save the value of the fields with default values\n\t\t\t\t\t// in the item meta\n\t\t\t\t\tlet defaultMeta = {}\n\t\t\t\t\t$.each( item.options, ( index, option ) => {\n\t\t\t\t\t\tif ( isDefined( option.default_value ) ){\n\t\t\t\t\t\t\tdefaultMeta[ option.option_code ] = option.default_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Check if the trigger is an anonymous trigger\n\t\t\t\t\tif ( item.type == 'anonymous' ){\n\t\t\t\t\t\t// Save the \"can_log_in_new_user\" value\n\t\t\t\t\t\tdefaultMeta.can_log_in_new_user = isDefined( item.can_log_in_new_user ) ? item.can_log_in_new_user : true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do REST call to add the item\n\t\t\t\t\tconst addItemREST = ( onSuccess, onFail ) => {\n\t\t\t\t\t\trestCall( 'add', {\n\t\t\t\t\t\t\trecipePostID: UncannyAutomator.recipe.id,\n\t\t\t\t\t\t\taction:       restRequestCode,\n\t\t\t\t\t\t\titem_code:    item.code,\n\t\t\t\t\t\t\tdefault_meta: $.extend( {}, defaultMeta, {\n\t\t\t\t\t\t\t\tintegration_name: UncannyAutomator.integrations[ this.integrationID ].name,\n\t\t\t\t\t\t\t\tsentence: \t\t  item.sentence\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}, ( response ) => {\n\t\t\t\t\t\t\t// Render both metaboxes again\n\t\t\t\t\t\t\t// This will close the options panel if it's opened\n\t\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t\t\tnew Actions();\n\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t\t\t\t\tnew Triggers();\n\n\t\t\t\t\t\t\t\t// Check if it's an anonymous recipe\n\t\t\t\t\t\t\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t\t\t\t\t\t\t// Render the Actions metabox again\n\t\t\t\t\t\t\t\t\t// We're doing this because we need to update the user selector\n\t\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( this.itemType == 'action' ){\n\t\t\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t*/\n\n\t\t\t\t\t\t\t// Check if the ID of the new item is defined\n\t\t\t\t\t\t\tif ( isDefined( response.post_ID ) ){\n\t\t\t\t\t\t\t\t// Get item form element\n\t\t\t\t\t\t\t\tconst $newItem = getDOMElements( 'item', {\n\t\t\t\t\t\t\t\t\tid: response.post_ID\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// Determine if the item is already valid\n\t\t\t\t\t\t\t\t// This will be true only if the new item doesn't have\n\t\t\t\t\t\t\t\t// options, or all the options have a default value\n\t\t\t\t\t\t\t\tconst isValid = UncannyAutomator.recipe.items[ response.post_ID ].isValid;\n\n\t\t\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\t\t\tif ( isValid ){\n\t\t\t\t\t\t\t\t\t// Check if the recipe is NOT live\n\t\t\t\t\t\t\t\t\tif ( ! UncannyAutomator.recipe.isLive ){\n\t\t\t\t\t\t\t\t\t\t// Set the item to live\n\t\t\t\t\t\t\t\t\t\t$newItem.item\n\t\t\t\t\t\t\t\t\t\t\t.find( '.item-status input[type=\"checkbox\"]' )\n\t\t\t\t\t\t\t\t\t\t\t.prop( 'checked', true )\n\t\t\t\t\t\t\t\t\t\t\t.trigger( 'change' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// Get first token and trigger a click\n\t\t\t\t\t\t\t\t\t// This will open the first group of options\n\t\t\t\t\t\t\t\t\t$newItem.item\n\t\t\t\t\t\t\t\t\t\t.find( '.item-title__token:not(.item-title__token--filled)' )\n\t\t\t\t\t\t\t\t\t\t.first()\n\t\t\t\t\t\t\t\t\t\t.trigger( 'click' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Check if the user defined a custom callback\n\t\t\t\t\t\t\tif ( isDefined( onSuccess ) ){\n\t\t\t\t\t\t\t\tonSuccess( response );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, ( response ) => {\n\t\t\t\t\t\t\tconsole.log( 'ERROR-TODO. Couldn\\'t add the item' );\n\n\t\t\t\t\t\t\t// Remove loading class to the parent container\n\t\t\t\t\t\t\t$taskSelector.removeClass( 'item__task-selector--loading' );\n\n\t\t\t\t\t\t\t// Remove loading class to the container\n\t\t\t\t\t\t\t$item.removeClass( 'item-task-selector__option--loading' );\n\n\t\t\t\t\t\t\t// Check if it's an invalid action\n\t\t\t\t\t\t\tif ( response.success == false ){\n\t\t\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Check if the user defined a custom callback\n\t\t\t\t\t\t\tif ( isDefined( onFail ) ){\n\t\t\t\t\t\t\t\tonFail( response );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t// Check if we have to show a modal to set a user before adding the item\n\t\t\t\t\tif ( \n\t\t\t\t\t\t// Check if the item that the user wants to add is an action\n\t\t\t\t\t\tthis.itemType == 'action'\n\t\t\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\t\t\t&& UncannyAutomator.recipe.type == 'anonymous' \n\t\t\t\t\t\t// Check if the recipe currently DOES NOT need user data\n\t\t\t\t\t\t// Otherwise, don't show the modal as the user already knows\n\t\t\t\t\t\t// the recipe needs user data\n\t\t\t\t\t\t&& ! UncannyAutomator.recipe.requiresUserData\n\t\t\t\t\t\t// Check if the action the user is trying to add requires user data\n\t\t\t\t\t\t&& item.requires_user\n\t\t\t\t\t){\n\t\t\t\t\t\t// Create modal\n\t\t\t\t\t\tlet modal;\n\n\t\t\t\t\t\t// Remove loading class to the parent container\n\t\t\t\t\t\t$taskSelector.removeClass( 'item__task-selector--loading' );\n\n\t\t\t\t\t\t// Remove loading class to the container\n\t\t\t\t\t\t$item.removeClass( 'item-task-selector__option--loading' );\n\n\t\t\t\t\t\t// Check if WP is ready\n\t\t\t\t\t\tif ( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp ){\n\t\t\t\t\t\t\tmodal = new Modal({\n\t\t\t\t\t\t\t\ttitle:   `${ UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.title } <span class=\"needs-user-data-modal-pro-badge\">${ UncannyAutomator.i18n.proOnly.pro }</span>`,\n\t\t\t\t\t\t\t\tcontent: `\n\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__title\">${ UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.mustRunOnUser }</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__sentence\">\n\t\t\t\t\t\t\t\t\t\t\t${ replaceCurlyBraces( item.select_option_name, '<span>', '</span>' ) }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__disclaimer\">\n\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"description\">${ vsprintf( UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.description, [ UncannyAutomator.i18n.uncannyAutomatorPro ] ) } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/pricing/', { 'medium': 'select_an_item', 'campaign': 'update_to_pro', 'content': 'requires_user_data',\n\t\t\t\t\t\t\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.upgradeNow } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a></div>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"description\">${ UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.upgradeLater } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/knowledge-base/creating-a-recipe/#Recipe_types', { 'medium': 'select_an_item', 'content': 'requires_user_data-learn-more',\n\t\t\t\t\t\t\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.learnMore } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a></div>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`,\n\t\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\t\t\t\t\t\tconfirm: UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.confirmButton,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tsize: 'large'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tmodal.setEvents({\n\t\t\t\t\t\t\t\tonConfirm: () => {\n\t\t\t\t\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\t\t\t// Open link in new tab\n\t\t\t\t\t\t\t\t\topenInNewTab( addUTMParameters( 'https://automatorplugin.com/pricing/', { 'medium': 'select_an_item', 'campaign': 'update_to_pro', 'content': 'requires_user_data',\n\t\t\t\t\t\t\t\t\t\t\t}) );\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonCancel: () => {\n\t\t\t\t\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Check if we should set the recipe to draft when the user adds the action\n\t\t\t\t\t\t\t// We're doing this because the user will need to fill the User Selector\n\t\t\t\t\t\t\tconst actionWillSetRecipeToDraft = UncannyAutomator.recipe.isLive;\n\n\t\t\t\t\t\t\tmodal = new Modal({\n\t\t\t\t\t\t\t\ttitle:   `${ UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.title } <span class=\"needs-user-data-modal-pro-badge needs-user-data-modal-pro-badge--gray\">${ UncannyAutomator.i18n.proOnly.pro }</span>`,\n\t\t\t\t\t\t\t\tcontent: `\n\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__title\">${ UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.content.mustRunOnUser }</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__sentence\">\n\t\t\t\t\t\t\t\t\t\t\t${ replaceCurlyBraces( item.select_option_name, '<span>', '</span>' ) }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"needs-user-data-modal__disclaimer\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"description\">${ UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.content.description }</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`,\n\t\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\t\t\t\t\t\tconfirm: UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.confirmButton,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tsize: 'large'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tmodal.setEvents({\n\t\t\t\t\t\t\t\tonConfirm: () => {\n\t\t\t\t\t\t\t\t\tlet modalElements = modal.getElements();\n\n\t\t\t\t\t\t\t\t\t// Add loading class to button\n\t\t\t\t\t\t\t\t\tmodalElements.modal.box.buttons.confirm.addClass( 'uap-btn--loading' ).prop( 'disabled', true );\n\n\t\t\t\t\t\t\t\t\t// Do an AJAX call to set the global recipe requires user\n\t\t\t\t\t\t\t\t\trecipeSetRequiresUser(\n\t\t\t\t\t\t\t\t\t\t// Set to true (requires user)\n\t\t\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t\t\t// On success\n\t\t\t\t\t\t\t\t\t\t( response ) => {\n\t\t\t\t\t\t\t\t\t\t\t// Do the request\n\t\t\t\t\t\t\t\t\t\t\taddItemREST(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t// On success, close and destroy the modal\n\t\t\t\t\t\t\t\t\t\t\t\tmodal.destroy();\n\n\n\t\t\t\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\t\t\t\t// On fail\n\t\t\t\t\t\t\t\t\t\t\t\t// Remove loading class to button\n\t\t\t\t\t\t\t\t\t\t\t\tmodalElements.modal.box.buttons.confirm.removeClass( 'uap-btn--loading' ).prop( 'disabled', false );\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t// On fail\n\t\t\t\t\t\t\t\t\t\t( response ) => {\n\t\t\t\t\t\t\t\t\t\t\t// Remove loading class to button\n\t\t\t\t\t\t\t\t\t\t\tmodalElements.modal.box.buttons.confirm.removeClass( 'uap-btn--loading' ).prop( 'disabled', false );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t// Do a call to set the recipe to draft\n\t\t\t\t\t\t\t\t\tif ( actionWillSetRecipeToDraft ){\n\t\t\t\t\t\t\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tonCancel: () => {\n\t\t\t\t\t\t\t\t\t// Close and destroy modal\n\t\t\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Do the request\n\t\t\t\t\t\taddItemREST();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Return the\n\t\t\t\treturn $item;\n\t\t\t}));\n\t\t}\n\t\telse {\n\t\t\t// Remove the available items container\n\t\t\t$itemsList.available.remove();\n\t\t}\n\n\t\t// Check if it has unavailable items\n\t\tif ( items.hasUnavailableItems ){\n\t\t\t// Append unavailable items to the list container\n\t\t\t$itemsList.unavailable.list.append( items.unavailable.map(( item ) => {\n\n\t\t\t\t// Create the UTM medium\n\t\t\t\tconst utm_medium = `unavailable_item-${ this.integrationID }-${ this.integrationID }_${ replaceCurlyBraces( item.name, '', '' ).toLowerCase().replace( /\\s+|{|}/g, '_' ) }`;\n\n\t\t\t\t// Create container\n\t\t\t\tconst $item = $( `\n\t\t\t\t\t<a href=\"${ addUTMParameters( 'https://automatorplugin.com/pricing/', {\n\t\t\t\t\t\t\t'medium':   'select_an_item',\n\t\t\t\t\t\t\t'campaign': 'update_to_pro',\n\t\t\t\t\t\t\t'content':  utm_medium,\n\t\t\t\t\t\t}) }\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\tclass=\"item-task-selector__option item-task-selector__option--pro\"\n\t\t\t\t\t\tdata-search=\"${ item.name.toLowerCase().replace( /\\s+|{|}/g, '' ) }\">\n\t\t\t\t\t\t<div class=\"item-task-selector__option-sentence\">\n\t\t\t\t\t\t\t<span class=\"uo-icon uo-icon--lock-alt\"></span>\n\t\t\t\t\t\t\t${ replaceCurlyBraces( item.name, '<span class=\"item-task-selector__option-variable\">', '</span>' ) }\n\t\t\t\t\t\t\t<span class=\"item-task-selector-option__badge\">${ UncannyAutomator.i18n.proOnly.pro }</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t` );\n\n\t\t\t\treturn $item;\n\t\t\t}));\n\t\t}\n\t\telse {\n\t\t\t// Remove the unavailable items container\n\t\t\t$itemsList.unavailable.container.remove();\n\t\t}\n\n\t\t// Get the list of items\n\t\tconst $items = $itemsList.container.find( '.item-task-selector__option:not(.item-task-selector__option--no-results)' );\n\n\t\t// Listen changes on the search field\n\t\t$searchField.on( 'input', () => {\n\t\t\t// Get the current value\n\t\t\tconst query = $searchField.val().toLowerCase().replace( /\\s+|{|}/g, '' );\n\n\t\t\t// Reset before searching\n\t\t\t$items.removeClass( 'item-task-selector__option--show item-task-selector__option--hide' );\n\n\t\t\t// Create variable to evaluate later if there were results\n\t\t\tlet hasResults = true;\n\n\t\t\t// Check if the query is not empty\n\t\t\tif ( ! isEmpty( query ) ){\n\t\t\t\t// If value it isn't empty then we have to check if there are going to be results, so false by default\n\t\t\t\thasResults = false;\n\n\t\t\t\t$.each( $items, ( index, item ) => {\n\t\t\t\t\tlet $item = $( item ),\n\t\t\t\t\t\ttext  = $item.data( 'search' );\n\n\t\t\t\t\tif ( text.search( query ) !== -1 ){\n\t\t\t\t\t\t$item.addClass( 'item-task-selector__option--show' );\n\n\t\t\t\t\t\t// At least one result, so true\n\t\t\t\t\t\thasResults = true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$item.addClass( 'item-task-selector__option--hide' );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Show and hide noResults\n\t\t\t$itemsList.noResults.removeClass( 'item-task-selector__option--hide item-task-selector__option--show' );\n\n\t\t\tif ( ! hasResults ){\n\t\t\t\t$itemsList.noResults.addClass( 'item-task-selector__option--show' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$itemsList.noResults.addClass( 'item-task-selector__option--hide' )\n\t\t\t}\n\t\t});\n\n\t\t// Append \"Cancel\" button\n\t\t$optionsContainer.append( this.createCancelButton() );\n\n\t\t// Append the header to the main container\n\t\tthis.$container.append( $container );\n\t}\n\n\tcreateCancelButton(){\n\t\tlet $cancelButton = $( '<div/>', { 'class': 'uap-btn uap-btn--secondary' }).text( UncannyAutomator.i18n.cancel );\n\n\t\t$cancelButton.on( 'click', () => {\n\t\t\tnew ItemCreatorIntegrations( this.itemType, this.$item );\n\t\t});\n\n\t\treturn $cancelButton;\n\t}\n\n\tremoveConnectingIntegrationsParameters(){\n\t\t// If the user is seeing this screen it's because the modal is closed,\n\t\t// or because the user already connected the integration\n\t\taddParametersToURL( window.location.href, {\n\t\t\tua_connecting_integration:    '',\n\t\t\tua_connecting_integration_id: '',\n\t\t\tua_connecting_integration_context: '',\n\t\t}, {\n\t\t\tsetAsURL: true,\n\t\t\trefresh: false\n\t\t});\n\t}\n}\n\nexport default ItemCreatorTaskSelector;\n","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tsortArrayOfObjectsAlphabetically,\n\taddParametersToURL,\n\taddUTMParameters,\n\tgetDOMElements,\n\tgetIntegrationIcon,\n\tfilterDeprecatedItems,\n\tgetURLParameter,\n\tisDefined,\n\tisEmpty,\n\topenCenteredWindow\n} from '../common/utilities.js';\n\nimport Modal                   from '../common/modal.js';\n\nimport ItemHeaderMenu          from './action-menu.js';\nimport ItemCreatorTaskSelector from './items-list.js';\n\nclass ItemCreatorIntegrations {\n\tconstructor( itemType, $currentItem ){\n\t\tthis.itemType     = itemType;\n\t\tthis.$currentItem = $currentItem;\n\t\tthis.integrations = [];\n\n\t\t// Render DOM elements\n\t\tthis.render();\n\n\t\t// Handle URL parameters to continue process of connecting an integration\n\t\tthis.handleContinueIntegrationConnection();\n\t}\n\n\trender(){\n\t\t// Create container\n\t\tlet container = $( '<div/>', { 'class': 'item' });\n\t\tthis.$item    = container;\n\n\t\tlet header       = this.createHeader(),\n\t\t\titemContent  = $( '<div/>', {'class': 'item__content' }),\n\t\t\tintegrations = this.createIntegrations(),\n\t\t\tdiscoverMore = this.createDiscoverMoreIntegrations();\n\n\t\tcontainer.append( header );\n\n\t\titemContent.append( integrations );\n\t\titemContent.append( discoverMore );\n\n\t\tcontainer.append( itemContent );\n\n\t\t// Check if the $item is defined, in that case we're going to replace the item element instead of creating a new one\n\t\tif ( isDefined( this.$currentItem ) ){\n\t\t\t// Empty container\n\t\t\tthis.$currentItem.replaceWith( container );\n\t\t}\n\t\telse {\n\t\t\t// Get last item and append next to it\n\t\t\tlet lastItem = getDOMElements( 'lastItem', {\n\t\t\t\ttype: this.itemType\n\t\t\t});\n\n\t\t\tif ( this.itemType == 'trigger' ){\n\t\t\t\t// Check if there is a last item\n\t\t\t\tif ( lastItem.length > 0 ){\n\t\t\t\t\tcontainer.insertAfter( lastItem );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Otherwise append the item to the metabox\n\t\t\t\t\tlet metabox = getDOMElements( 'metabox', {\n\t\t\t\t\t\ttype: this.itemType\n\t\t\t\t\t});\n\n\t\t\t\t\tmetabox.append( container );\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif ( this.itemType == 'action' ){\n\t\t\t\t// Check if there is at least one item\n\t\t\t\tlet items = getDOMElements( 'items', {\n\t\t\t\t\ttype: this.itemType\n\t\t\t\t});\n\n\t\t\t\tif ( items.length > 0 ){\n\t\t\t\t\t// Insert before the button\n\t\t\t\t\tcontainer.insertBefore( $('.add-action-btn') );\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Otherwise replace the itemCreatorAdd container with the new container\n\t\t\t\t\tlet metabox = getDOMElements( 'metabox', {\n\t\t\t\t\t\ttype: this.itemType\n\t\t\t\t\t});\n\n\t\t\t\t\tlet itemCreatorAdd = metabox.find( '.item.item--start' );\n\t\t\t\t\titemCreatorAdd.replaceWith( container );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateHeader(){\n\t\tlet header  = $( '<div/>' );\n\n\t\tlet icon           = $( '<div/>', { 'class': 'item-icon' }),\n\t\t\ttitleContainer = $( '<div/>', { 'class': 'item-title uap-clear' }),\n\t\t\ttitleContent   = $( '<div/>', { 'class': 'item-title__describe' }),\n\t\t\ttitle          = $( '<div/>', { 'class': 'item-title__non-editable' }).text( UncannyAutomator.i18n.integration.select );\n\n\t\tlet actions        = new ItemHeaderMenu( this.itemType );\n\t\theader.append( actions );\n\n\t\theader.append( icon );\n\n\t\ttitleContent.append( title );\n\t\ttitleContainer.append( titleContent );\n\t\theader.append( titleContainer );\n\n\t\treturn header;\n\t}\n\n\tcreateIntegrations(){\n\t\tlet container    = $( '<div/>', { 'class': 'item-integrations' });\n\n\t\t// Get non empty integrations\n\t\tthis.filterByNonEmptyIntegrations( this.itemType );\n\n\t\t// Order integrations alphabetically\n\t\tthis.sortIntegrationsAlphabetically(); \n\n\t\t// Iterate integrations\n\t\tthis.integrations.forEach(( integration ) => {\n\t\t\t// Get integration ID\n\t\t\tconst integrationID = integration.id;\n\n\t\t\t// Create integration element\n\t\t\tlet integrationElement = this.createIntegration( integrationID, integration );\n\n\t\t\t// Create default action on click\n\t\t\tlet onClick = () => {\n\t\t\t\tnew ItemCreatorTaskSelector( this.itemType, integrationID, this.$item );\n\t\t\t}\n\n\t\t\t// Before what's going to happen on click\n\t\t\t// Check if it's an API integration\n\t\t\tif ( isDefined( integration.connected ) ){\n\t\t\t\t// Get current step and change the callback accordingly\n\t\t\t\tswitch ( this.integrationModalCurrentStep( integration ) ){\n\t\t\t\t\t// Step 1\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tonClick = () => {\n\t\t\t\t\t\t\t// Set parameter to show the modal again in case the user reloads the page\n\t\t\t\t\t\t\taddParametersToURL( window.location.href, {\n\t\t\t\t\t\t\t\tua_connecting_integration: 1,\n\t\t\t\t\t\t\t\tua_connecting_integration_id: integrationID,\n\t\t\t\t\t\t\t\tua_connecting_integration_context: this.itemType\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tsetAsURL: true,\n\t\t\t\t\t\t\t\trefresh: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Show the modal to connect the integration\n\t\t\t\t\t\t\tthis.connectIntegrationModal( integrationID, integration, {\n\t\t\t\t\t\t\t\tcurrentStep: 1\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t// Step 2\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\t// -> Send to the settings page of the integration\n\t\t\t\t\t\tonClick = () => {\n\t\t\t\t\t\t\t// Set parameter to show the modal again in case the user reloads the page\n\t\t\t\t\t\t\taddParametersToURL( window.location.href, {\n\t\t\t\t\t\t\t\tua_connecting_integration: 1,\n\t\t\t\t\t\t\t\tua_connecting_integration_id: integrationID,\n\t\t\t\t\t\t\t\tua_connecting_integration_context: this.itemType\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tsetAsURL: true,\n\t\t\t\t\t\t\t\trefresh: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Show the modal to connect the integration\n\t\t\t\t\t\t\tthis.connectIntegrationModal( integrationID, integration, {\n\t\t\t\t\t\t\t\tcurrentStep: 2\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t// Step 3\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\t// Do nothing, leave the original callback,\n\t\t\t\t\t\t// which will just show the list of actiosn\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Bind\n\t\t\tintegrationElement.on( 'click', () => {\n\t\t\t\tonClick();\n\t\t\t});\n\n\t\t\t// Append\n\t\t\tcontainer.append( integrationElement );\n\t\t});\n\n\t\t// Return jQuery element\n\t\treturn container;\n\t}\n\n\tconnectIntegrationModal( integrationID, integration, options = {} ){\n\t\t// Extend the options\n\t\toptions = Object.assign({\n\t\t\tcurrentStep: 1\n\t\t}, options );\n\n\t\t// Connect API url\n\t\tconst connectApiUrl = addParametersToURL( UncannyAutomator.connectApiUrl, {\n\t\t\tredirect_url: addParametersToURL( UncannyAutomator.dashboardUrl, {\n\t\t\t\tua_close_window: 1\n\t\t\t})\n\t\t});\n\n\t\t// Check what should be the first step\n\t\tlet modalFirstStep = '';\n\n\t\t// Check if wp is ready\n\t\tif ( isDefined( UncannyAutomator.wp ) && UncannyAutomator.wp ){\n\t\t\tmodalFirstStep = `\n\t\t\t\t<div class=\"connect-integration-modal-step ${ options.currentStep > 1 ? 'connect-integration-modal-step--completed' : '' }\">\n\t\t\t\t\t<div class=\"connect-integration-modal-step__icon\">\n\t\t\t\t\t\t<span class=\"uo-icon uo-icon--check-circle\"></span>\n\t\t\t\t\t</div> \n\t\t\t\t\t<div class=\"connect-integration-modal-step__description\">\n\t\t\t\t\t\t<div class=\"connect-integration-modal-step__description-main\">\n\t\t\t\t\t\t\t<strong>1.</strong> ${ vsprintf( UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step1Pro, [ UncannyAutomator.i18n.uncannyAutomatorPro ] ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"connect-integration-modal-step__action\">\n\t\t\t\t\t\t<a id=\"connect-integration-modal-activate-license\" class=\"connect-integration-modal-step__action-anchor\">\n\t\t\t\t\t\t\t${ UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.activate } <span class=\"uo-icon uo-icon--arrow-circle-right\"></span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse {\n\t\t\tmodalFirstStep = `\n\t\t\t\t<div class=\"connect-integration-modal-step ${ options.currentStep > 1 ? 'connect-integration-modal-step--completed' : '' }\">\n\t\t\t\t\t<div class=\"connect-integration-modal-step__icon\">\n\t\t\t\t\t\t<span class=\"uo-icon uo-icon--smile-plus\"></span>\n\t\t\t\t\t</div> \n\t\t\t\t\t<div class=\"connect-integration-modal-step__description\">\n\t\t\t\t\t\t<div class=\"connect-integration-modal-step__description-main\">\n\t\t\t\t\t\t\t<strong>1.</strong> ${ vsprintf( UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step1, [ UncannyAutomator.i18n.uncannyAutomator ] ) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"connect-integration-modal-step__action\">\n\t\t\t\t\t\t<a id=\"connect-integration-modal-sign-up\" class=\"connect-integration-modal-step__action-anchor\">\n\t\t\t\t\t\t\t${ UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.signUp } <span class=\"uo-icon uo-icon--arrow-circle-right\"></span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\t// Create modal\n\t\tconst modal = new Modal({\n\t\t\ttitle:   `${ UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.connectIntegration }`,\n\t\t\tcontent: `\n\t\t\t\t<div class=\"connect-integration-modal\">\n\t\t\t\t\t<div class=\"connect-integration-modal-steps__counter\">\n\t\t\t\t\t\t${ vsprintf( UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.stepCounter, [ options.currentStep - 1, '2' ] ) }\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"connect-integration-modal-steps\">\n\t\t\t\t\t\t<div class=\"connect-integration-modal-steps__list\">\n\t\t\t\t\t\t\t${ modalFirstStep }\n\t\t\t\t\t\t\t<div class=\"connect-integration-modal-step ${ options.currentStep > 2 ? 'connect-integration-modal-step--completed' : '' } ${ options.currentStep == 1 ? 'connect-integration-modal-step--previous-not-completed' : '' }\">\n\t\t\t\t\t\t\t\t<div class=\"connect-integration-modal-step__icon\">\n\t\t\t\t\t\t\t\t\t<span class=\"uo-icon uo-icon--plug\"></span>\n\t\t\t\t\t\t\t\t</div> \n\t\t\t\t\t\t\t\t<div class=\"connect-integration-modal-step__description\">\n\t\t\t\t\t\t\t\t\t<div class=\"connect-integration-modal-step__description-main\">\n\t\t\t\t\t\t\t\t\t\t<strong>2.</strong> ${ vsprintf( UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step2, [ '<span class=\"connect-integration-modal-step-integration-name\">' + getIntegrationIcon( integrationID ).node.outerHTML + integration.name + '</span>', UncannyAutomator.i18n.uncannyAutomator ] ) }\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"connect-integration-modal-step__action\">\n\t\t\t\t\t\t\t\t\t<span ${ options.currentStep == 1 ? 'uap-tooltip=\"' + UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.completePrevious + '\"' : '' }>\n\t\t\t\t\t\t\t\t\t\t<a id=\"connect-integration-modal-connect-account\" class=\"connect-integration-modal-step__action-anchor\">\n\t\t\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.connectAccount } <span class=\"uo-icon uo-icon--arrow-circle-right\"></span>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tbuttons: {\n\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\tconfirm: null\n\t\t\t}\n\t\t}, {\n\t\t\tsize: 'extra-large'\n\t\t});\n\n\t\tmodal.setEvents({\n\t\t\tonCancel: () => {\n\t\t\t\t// Close and destroy modal\n\t\t\t\tmodal.destroy();\n\n\t\t\t\t// Remove the parameters that force the modal to be visible on load\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\taddParametersToURL( window.location.href, {\n\t\t\t\t\t\tua_connecting_integration:    '',\n\t\t\t\t\t\tua_connecting_integration_id: '',\n\t\t\t\t\t\tua_connecting_integration_context: '',\n\t\t\t\t\t}, {\n\t\t\t\t\t\tsetAsURL: true,\n\t\t\t\t\t\trefresh: false\n\t\t\t\t\t});\n\t\t\t\t}, 10 );\n\t\t\t},\n\t\t});\n\n\t\t// Add actions to the step buttons\n\t\tmodal.getElements().modal.container.find( '#connect-integration-modal-sign-up' )\n\t\t\t.on( 'click', ( event ) => {\n\t\t\t\t// Prevent default behavior\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t// Add loading animation\n\t\t\t\tevent.currentTarget.classList\n\t\t\t\t\t.add( 'connect-integration-modal-step__action-anchor--loading' );\n\n\t\t\t\t// Open URL on a new window\n\t\t\t\tconst newWindow = openCenteredWindow({\n\t\t\t\t\turl:   connectApiUrl,\n\t\t\t\t\tw:     550,\n\t\t\t\t\th:     600,\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t// Add actions to the step buttons\n\t\tmodal.getElements().modal.container.find( '#connect-integration-modal-activate-license' )\n\t\t\t.on( 'click', ( event ) => {\n\t\t\t\t// Prevent default behavior\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t// Add loading animation\n\t\t\t\tevent.currentTarget.classList\n\t\t\t\t\t.add( 'connect-integration-modal-step__action-anchor--loading' );\n\n\t\t\t\t// Open URL on a new window\n\t\t\t\tconst newWindow = openCenteredWindow({\n\t\t\t\t\turl:   UncannyAutomator.licenseUrl,\n\t\t\t\t\tw:     550,\n\t\t\t\t\th:     600,\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t// Check if the current step is the second step\n\t\tif ( options.currentStep == 2 ){\n\t\t\tmodal.getElements().modal.container.find( '#connect-integration-modal-connect-account' )\n\t\t\t\t.on( 'click', ( event ) => {\n\t\t\t\t\t// Prevent default behavior\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t// Add loading animation\n\t\t\t\t\tevent.currentTarget.classList\n\t\t\t\t\t\t.add( 'connect-integration-modal-step__action-anchor--loading' );\n\n\t\t\t\t\t// Open URL on a new window\n\t\t\t\t\tconst newWindow = openCenteredWindow({\n\t\t\t\t\t\turl:   addParametersToURL( integration.settings_url, {\n\t\t\t\t\t\t\tminimal: 1,\n\t\t\t\t\t\t\thide_settings_tabs: 1\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tw:     550,\n\t\t\t\t\t\th:     600,\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t}            \n\t}\n\n\thandleContinueIntegrationConnection(){\n\t\t// Check if the parameter is defined on page load\n\t\tif (\n\t\t\tgetURLParameter( null, 'ua_connecting_integration' ) == 1\n\t\t\t&& getURLParameter( null, 'ua_connecting_integration_context' ) == this.itemType\n\t\t){\n\t\t\t// Get the integration code\n\t\t\tconst integrationID = getURLParameter( null, 'ua_connecting_integration_id' );\n\n\t\t\t// Check if it's defined\n\t\t\tif ( ! isEmpty( integrationID ) ){\n\t\t\t\t// Get the integration data\n\t\t\t\tconst integration = UncannyAutomator.integrations[ integrationID ];\n\n\t\t\t\t// Check if the integration exists\n\t\t\t\tif ( isDefined( integration ) ){\n\t\t\t\t\t// Evaluate if we should show the modal\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Integration is an API integration\n\t\t\t\t\t\tisDefined( integration.connected )\n\t\t\t\t\t){\n\t\t\t\t\t\t// Get current step and render content accordingly\n\t\t\t\t\t\tswitch ( this.integrationModalCurrentStep( integration ) ){\n\t\t\t\t\t\t\t// Step 1\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t// Show the modal to connect the integration\n\t\t\t\t\t\t\t\t// 1st step not completed\n\t\t\t\t\t\t\t\tthis.connectIntegrationModal( integrationID, integration, {\n\t\t\t\t\t\t\t\t\tcurrentStep: 1\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t// Step 2\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t// Show the modal to connect the integration\n\t\t\t\t\t\t\t\tthis.connectIntegrationModal( integrationID, integration, {\n\t\t\t\t\t\t\t\t\tcurrentStep: 2\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t// Step 3\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t// Go to the list of items\n\t\t\t\t\t\t\t\tnew ItemCreatorTaskSelector( this.itemType, integrationID, this.$item );\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateIntegration( integrationID, integration ){\n\t\tlet container   = $( '<div/>', { 'class': 'item-integration' }),\n\t\t\tlogo        = $( '<div/>', { 'class': 'item-integration__logo' }),\n\t\t\tname        = $( '<div/>', { 'class': 'item-integration__name' });\n\n\t\t// Check if it's a Pro only integration\n\t\tif ( integration.isProOnly ){\n\t\t\t// Add a class to identify it\n\t\t\tcontainer.addClass( 'item-integration--pro' );\n\n\t\t\t// Add PRO tag\n\t\t\tcontainer.append( $( `\n\t\t\t\t<div class=\"item-integration__badge\">${ UncannyAutomator.i18n.proOnly.pro }</div>\n\t\t\t` ) );\n\t\t}\n\t\t\n\t\t// Check if the integration is not available\n\t\tif ( ! integration.isAvailable ){\n\t\t\t// Add a class to identify it\n\t\t\tcontainer.addClass( 'item-integration--unavailable item-integration--unavailable-requires-pro' );\n\n\t\t\t// Add tooltip\n\t\t\tcontainer.attr( 'uap-tooltip', vsprintf( UncannyAutomator.i18n.proOnly.requiresPro, [ UncannyAutomator.i18n.uncannyAutomatorPro ] ) );\n\t\t}\n\t\telse {\n\t\t\t// Check if it's an API integration\n\t\t\tif ( isDefined( integration.connected ) ){\n\t\t\t\t// Check if the user connected an automatorplugin.com account\n\t\t\t\tif ( UncannyAutomator.hasAccountConnected ){\n\t\t\t\t\t// Check if the current action is not available because the\n\t\t\t\t\t// user didn't connect an account to it\n\t\t\t\t\tif ( ! integration.connected ){\n\t\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\t\tcontainer.addClass( 'item-integration--unavailable item-integration--unavailable-integration-not-connected' );\n\n\t\t\t\t\t\t// Add tooltip\n\t\t\t\t\t\tcontainer.attr( 'uap-tooltip', vsprintf( UncannyAutomator.i18n.apiIntegrations.integrationNotConnected, [ integration.name ] ));\n\n\t\t\t\t\t\t// Add tag\n\t\t\t\t\t\tcontainer.append( $( `\n\t\t\t\t\t\t\t<div class=\"item-integration__badge item-integration__badge--warning\">${ UncannyAutomator.i18n.apiIntegrations.notConnected }</div>\n\t\t\t\t\t\t` ) );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\t\tcontainer.addClass( 'item-integration--available' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\tcontainer.addClass( 'item-integration--unavailable item-integration--unavailable-ap-account-not-connected' );\n\n\t\t\t\t\t// Add tooltip\n\t\t\t\t\tcontainer.attr( 'uap-tooltip', vsprintf( UncannyAutomator.i18n.apiIntegrations.integrationNotConnected, [ integration.name ] ));\n\n\t\t\t\t\t// Add tag\n\t\t\t\t\tcontainer.append( $( `\n\t\t\t\t\t\t<div class=\"item-integration__badge item-integration__badge--warning\">${ UncannyAutomator.i18n.apiIntegrations.notConnected }</div>\n\t\t\t\t\t` ) );\n\t\t\t\t} \n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Check if we're rendering this in the actions metabox\n\t\t\t\t// We're checking this because actions need some exceptions\n\t\t\t\tif ( this.itemType == 'action' ){\n\t\t\t\t\t// Check if the integration might have actions that are not available\n\t\t\t\t\t// because they require user data\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Check if WP is ready\n\t\t\t\t\t\t( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp )\n\t\t\t\t\t\t// Check if the recipe is anonymous\n\t\t\t\t\t\t&& UncannyAutomator.recipe.type == 'anonymous'\n\t\t\t\t\t){\n\t\t\t\t\t\t// Check if it has actions that DON'T require user data\n\t\t\t\t\t\tconst actionsThatDontRequireUserData = integration.items.actions.available.filter(( action ) => {\n\t\t\t\t\t\t\treturn action.requires_user == false;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif ( actionsThatDontRequireUserData.length == 0 ){\n\t\t\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\t\t\tcontainer.addClass( 'item-integration--unavailable item-integration--unavailable-requires-user-data' );\n\n\t\t\t\t\t\t\t// Add tooltip\n\t\t\t\t\t\t\tcontainer.attr( 'uap-tooltip', UncannyAutomator.i18n.apiIntegrations.allActionsRequireUserData );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\t\t\tcontainer.addClass( 'item-integration--available' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\t\tcontainer.addClass( 'item-integration--available' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Add a class to identify it\n\t\t\t\t\tcontainer.addClass( 'item-integration--available' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Create the variable where we're going to save the logo\n\t\tlet $logoImg;\n\n\t\t// Check if it has a svg image\n\t\tif ( isDefined( integration.icon_svg ) ){\n\t\t\t$logoImg = $( `<img src=\"${ integration.icon_svg }\" alt=\"${ integration.name }\">` );\n\t\t}\n\t\t// Check if it has a png image\n\t\telse if ( isDefined( integration.icon_32 ) && isDefined( integration.icon_64 ) ){\n\t\t\t$logoImg = $( `<img src=\"${ integration.icon_32 }\" srcset=\"${ vsprintf( '%s 1x, %s 2x', [ integration.icon_32, integration.icon_64 ]) }\" alt=\"${ integration.name }\">` );\n\t\t}\n\n\t\t// TO-DO\n\t\t// Improve UI/UX\n\t\t// Set integration name\n\t\tname.text( integration.name );\n\n\t\t// Append\n\t\tlogo.append( $logoImg );\n\t\tcontainer.append( logo );\n\t\tcontainer.append( name );\n\n\t\t// Return jQuery element\n\t\treturn container;\n\t}\n\n\tcreateDiscoverMoreIntegrations(){\n\t\treturn $( `\n\t\t\t<div class=\"item-content__description\">\n\t\t\t\t${ UncannyAutomator.recipe.type == 'anonymous' ? UncannyAutomator.i18n.integration.dontSeeTrigger : UncannyAutomator.i18n.integration.discoverMore } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/integrations/', {\n\t\t\t\t\t\t'medium':  'select_an_integration',\n\t\t\t\t\t\t'content': 'discover_more_integrations'\n\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.learnMore } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a>\n\t\t\t</div>\n\t\t` );\n\t}\n\n\tfilterByNonEmptyIntegrations( itemType ){\n\t\t// Check if it's a valid item type\n\t\tif ( [ 'trigger', 'action' ].includes( itemType ) ){\n\t\t\t// Get the integrations\n\t\t\tconst integrations = $.extend( true, {}, UncannyAutomator.integrations );\n\n\t\t\t// Iterate each integration\n\t\t\tObject.entries( integrations ).forEach(([ integrationID, integration ]) => {\n\t\t\t\t// Evaluate if it has the requested items by item type\n\t\t\t\tlet hasItems = false;\n\t\t\t\t// Also evaluate if it has available items\n\t\t\t\tlet isProOnly = false;\n\t\t\t\t// Also evaluate if it has available items\n\t\t\t\tlet isAvailable = false;\n\n\t\t\t\t// Remove deprecated items\n\t\t\t\tlet items;\n\n\t\t\t\tif ( itemType == 'trigger' ){\n\t\t\t\t\t// Get items\n\t\t\t\t\titems       = filterDeprecatedItems( integration.items.triggers );\n\n\t\t\t\t\thasItems    = items.hasTriggers;\n\t\t\t\t\tisAvailable = items.hasAvailableItems;\n\t\t\t\t\tisProOnly   = items.allItemsArePro;\n\t\t\t\t}\n\t\t\t\telse if ( itemType == 'action' ){\n\t\t\t\t\t// Get items\n\t\t\t\t\titems       = filterDeprecatedItems( integration.items.actions );\n\n\t\t\t\t\thasItems    = items.hasActions;\n\t\t\t\t\tisAvailable = items.hasAvailableItems;\n\t\t\t\t\tisProOnly   = items.allItemsArePro;\n\t\t\t\t}\n\n\t\t\t\t// Check if it has the requested items by item type\n\t\t\t\tif ( hasItems ){\n\t\t\t\t\t// Add integration to the list of integrations\n\t\t\t\t\tthis.integrations.push( $.extend({}, integration, {\n\t\t\t\t\t\tid:          integrationID,\n\t\t\t\t\t\tisAvailable: isAvailable,\n\t\t\t\t\t\tisProOnly:   isProOnly\n\t\t\t\t\t}) );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tsortIntegrationsAlphabetically(){\n\t\t// Sort the array of integrations using the integration name\n\t\tthis.integrations = sortArrayOfObjectsAlphabetically( this.integrations, 'name' );\n\t}\n\n\t/**\n\t * Validate what's the current step when connecting a premium integration\n\t *\n\t * Step 1. Connect ap.com account, or validate license\n\t * Step 2. Connect integration account\n\t * Step 3. Integration connected\n\t *\n\t * @since 3.1.2\n\t *\n\t * @param  {Object}  integration  An object from this.integrations with the integration data\n\t * \n\t * @return {Integer}              The current step\n\t */\n\tintegrationModalCurrentStep( integration = {} ){\n\t\tlet step;\n\n\t\tif (\n\t\t\t// Condition #1\n\t\t\t// User has Automator free\n\t\t\t// + ap.com account not connected\n\t\t\t(\n\t\t\t\t// Check if the user has Automator Free\n\t\t\t\t(\n\t\t\t\t\t! isDefined( UncannyAutomator.wp ) \n\t\t\t\t\t|| isDefined( UncannyAutomator.wp ) && ! UncannyAutomator.wp\n\t\t\t\t) \n\t\t\t\t&& \n\t\t\t\t// Check if the ap.com account is NOT connected\n\t\t\t\t! UncannyAutomator.hasAccountConnected\n\t\t\t)\n\t\t\t||\n\t\t\t// Condition #2\n\t\t\t// User has Automator Pro\n\t\t\t// + ap.com account not connected\n\t\t\t// + Pro license not valid\n\t\t\t(\n\t\t\t\t// Check if the user has Automator Pro\n\t\t\t\t(\n\t\t\t\t\tisDefined( UncannyAutomator.wp ) && UncannyAutomator.wp\n\t\t\t\t)\n\t\t\t\t&& \n\t\t\t\t// Check if the ap.com account is NOT connected\n\t\t\t\t! UncannyAutomator.hasAccountConnected\n\t\t\t\t&&\n\t\t\t\t// Check if the Pro license is not valid\n\t\t\t\t! UncannyAutomator.hasValidProLicense\n\t\t\t)\n\t\t){\n\t\t\t// Then, this is the first step\n\t\t\t// The user has to connect an ap.com account or validate the license\n\t\t\tstep = 1;\n\t\t}\n\t\telse if (\n\t\t\t// Condition #1\n\t\t\t// User has Automator free\n\t\t\t// + ap.com account connected\n\t\t\t(\n\t\t\t\t// Check if the user has Automator Free\n\t\t\t\t(\n\t\t\t\t\t! isDefined( UncannyAutomator.wp ) \n\t\t\t\t\t|| isDefined( UncannyAutomator.wp ) && ! UncannyAutomator.wp\n\t\t\t\t) \n\t\t\t\t&& \n\t\t\t\t// Check if the ap.com account is connected\n\t\t\t\tUncannyAutomator.hasAccountConnected\n\t\t\t)\n\t\t\t||\n\t\t\t// Condition #2\n\t\t\t// User has Automator Pro\n\t\t\t// + ap.com account connected OR pro license valid\n\t\t\t(\n\t\t\t\t// Check if the user has Automator Pro\n\t\t\t\t(\n\t\t\t\t\tisDefined( UncannyAutomator.wp ) && UncannyAutomator.wp\n\t\t\t\t)\n\t\t\t\t&& \n\t\t\t\t(\n\t\t\t\t\t// Check if the ap.com account is connected\n\t\t\t\t\tUncannyAutomator.hasAccountConnected\n\t\t\t\t\t||\n\t\t\t\t\t// Check if the Pro license is valid\n\t\t\t\t\tUncannyAutomator.hasValidProLicense\n\t\t\t\t)\n\t\t\t)\n\t\t){\n\t\t\t// Check if the premium integration still doesn't have an account connected\n\t\t\tif ( ! integration.connected ){\n\t\t\t\t// Then, this is the second step\n\t\t\t\t// The user has to connect the integration\n\t\t\t\tstep = 2;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Then, this is the third step\n\t\t\t\t// Everything needed is ready\n\t\t\t\tstep = 3;\n\t\t\t}\n\t\t}\n\n\t\treturn step;\n\t}\n}\n\nexport default ItemCreatorIntegrations;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tgetDOMElements,\n\trestCall,\n\tisDefined,\n\tisEmpty,\n\tparseStringWithTokens,\n\tgetCurrentFieldsValues\n} from '../common/utilities.js';\n\nimport Modal    from '../common/modal.js';\nimport Markdown from '../common/markdown.js';\n\nimport {\n\tvalidateItemFields,\n} from '../validation/validation.js';\n\nimport Triggers from './triggers.js';\nimport Actions  from './actions.js';\n\nclass ItemOptions {\n\tconstructor( itemId, optionId ){\n\t\tthis.itemId   = itemId;\n\t\tthis.optionId = optionId;\n\t\tthis.item \t  = UncannyAutomator.recipe.items[ itemId ];\n\n\t\t// Array to save the Field objects\n\t\tthis.fields   = this.item.options[ this.optionId ].fields;\n\t\t// Array to save the buttons\n\t\tthis.buttons  = this.item.options[ this.optionId ].buttons;\n\n\t\tthis.create();\n\n\t\t// AFTER we added the elements to the DOM let's call init \n\t\t// TokenSelector, TinyMCE and CodeMirror. We're going to call this in\n\t\t// ItemOptions.js because the TokenSelector, TinyMCE and \n\t\t// CodeMirror need the item in the DOM before changing it\n\t\t// Select2 and the URL checker are called in Field.js\n\t\tthis.initTokenSelector();\n\t\tthis.initTinyMCE();\n\t\tthis.initCodeMirror();\n\t}\n\n\tcreate(){\n\t\t// Container\n\t\tlet container = getDOMElements( 'item', {\n\t\t\tid: this.itemId\n\t\t}).contentContainer;\n\n\t\tlet itemOptions\t= $( '<div/>', { 'class': 'item-options' });\n\n\t\t// Buttons. We have to create these before the fields, but append after\n\t\tlet buttons = this.createButtons();\n\n\t\t// Fields\n\t\tlet fields = this.createFields();\n\t\tthis.fieldsContainer = fields;\n\t\titemOptions.append( fields );\n\n\t\t// Create notices container\n\t\tlet noticeContainer  = $( '<div/>', { 'class': 'item-options__notices' });\n\t\tthis.noticeContainer = noticeContainer;\n\t\titemOptions.append( noticeContainer );\n\n\t\t// Append buttons\n\t\titemOptions.append( buttons );\n\n\t\t// Append to the item\n\t\tcontainer.html( itemOptions );\n\t}\n\n\tcreateFields(){\n\t\tlet container = $( '<div/>', { 'class': 'item-options__group' });\n\n\t\t// Create fields\n\t\t$.each( this.fields, ( index, field ) => {\n\t\t\t// Get field type\n\t\t\tlet fieldType = field.getAttributes().fieldType;\n\n\t\t\t// Check if it's a repeater\n\t\t\tif ( fieldType == 'repeater' ){\n\t\t\t\t// Create the fields again first (to avoid showing unsaved changed)\n\t\t\t\tfield.createFields();\n\t\t\t}\n\n\t\t\t// Append the form element to the DOM\n\t\t\tfield.createFormElement();\n\t\t\tcontainer.append( field.getFormElement() );\n\n\t\t\t// Bind submit on Enter (for all except groups and textareas)\n\t\t\tif ( ! [ 'textarea', 'group', 'repeater' ].includes( fieldType ) ){\n\t\t\t\t// Get field element and bind 'keyup'\n\t\t\t\tfield.getField().on( 'keyup', ( event ) => {\n\t\t\t\t\t// Check if it's an enter\n\t\t\t\t\tif ( event.keyCode == 13 ){\n\t\t\t\t\t\t// Trigger a click on the Save Button\n\t\t\t\t\t\tthis.saveButton.trigger( 'click' );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Check if it's a group\n\t\t\telse if ( fieldType == 'group' ){\n\t\t\t\t// Iterate fields\n\t\t\t\tfield.fields.forEach(( field ) => {\n\t\t\t\t\t// Get the field type\n\t\t\t\t\tconst fieldType = field.getAttributes().fieldType;\n\n\t\t\t\t\t// Check if it's not a textarea\n\t\t\t\t\tif ( fieldType !== 'textarea' ){\n\t\t\t\t\t\t// Get field element and bind 'keyup'\n\t\t\t\t\t\tfield.getField().on( 'keyup', ( event ) => {\n\t\t\t\t\t\t\t// Check if it's an enter\n\t\t\t\t\t\t\tif ( event.keyCode == 13 ){\n\t\t\t\t\t\t\t\t// Trigger a click on the Save Button\n\t\t\t\t\t\t\t\tthis.saveButton.trigger( 'click' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if ( fieldType == 'repeater' ){\n\t\t\t\t// Iterate rows\n\t\t\t\tfield.fieldRows.forEach(( row, index ) => {\n\t\t\t\t\t// Iterate each row\n\t\t\t\t\trow.forEach(( Field, index ) => {\n\t\t\t\t\t\t// Get field element and bind 'keyup'\n\t\t\t\t\t\tField.getField().on( 'keyup', ( event ) => {\n\t\t\t\t\t\t\t// Check if it's an enter\n\t\t\t\t\t\t\tif ( event.keyCode == 13 ){\n\t\t\t\t\t\t\t\t// Trigger a click on the Save Button\n\t\t\t\t\t\t\t\tthis.saveButton.trigger( 'click' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tcreateButtons(){\n\t\t// Buttons\n\t\tlet container \t  \t = $( '<div/>', { 'class': 'item-options__buttons' });\n\n\t\t// Actions buttons\n\t\tlet automatorButtons = $( '<div/>', { 'class': 'item-options__automator-buttons' }),\n\t\t\tdeveloperButtons = $( '<div/>', { 'class': 'item-options__developer-buttons' });\n\n\t\tlet saveButton \t  \t = $( '<div/>', { 'class': 'uap-btn uap-btn--primary' }),\n\t\t\tcancelButton  \t = $( '<div/>', { 'class': 'uap-btn uap-btn--secondary' }).text( UncannyAutomator.i18n.cancel );\n\n\t\tif ( this.item.itemType == 'trigger' ){\n\t\t\tsaveButton.text( UncannyAutomator.i18n.save );\n\t\t}\n\n\t\tif ( this.item.itemType == 'action' ){\n\t\t\tsaveButton.text( UncannyAutomator.i18n.save );\n\t\t}\n\n\t\tif ( this.item.itemType == 'closure' ){\n\t\t\tsaveButton.text( UncannyAutomator.i18n.save );\n\t\t}\n\n\t\tthis.saveButton = saveButton;\n\n\t\tautomatorButtons.append( saveButton );\n\t\tautomatorButtons.append( cancelButton );\n\n\t\t// Check developer defined buttons\n\t\t$.each( this.buttons, ( index, button ) => {\n\t\t\t// Create button\n\t\t\tconst $buttonElement = $( '<div/>', { 'class': 'uap-btn' }).text( button.text );\n\n\t\t\t// Check if we have to add a custom class to the button\n\t\t\tif ( isDefined( button.css_classes ) ){\n\t\t\t\t// Add classes\n\t\t\t\t$buttonElement.addClass( button.css_classes );\n\t\t\t}\n\n\t\t\t// Check if it has a defined onClick function\n\t\t\tlet doOnClick = () => {};\n\t\t\tif ( isDefined( button.on_click ) ){\n\t\t\t\t// Try to overwrite empty function\n\t\t\t\ttry {\n\t\t\t\t\t// Try to convert the string to function, but first remove the <script> tags and trim the string\n\t\t\t\t\tdoOnClick = eval( `(${ button.on_click.replace( '<script>', '' ).replace( '</script>', '' ).trim() })` ); \n\t\t\t\t} catch ( e ){\n\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\tconsole.warning( button.on_click );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Listen clicks on the button\n\t\t\t$buttonElement.on( 'click', () => {\n\t\t\t\t// Invoke callback\n\t\t\t\tdoOnClick(\n\t\t\t\t\t// button\n\t\t\t\t\t$buttonElement,\n\t\t\t\t\t// data\n\t\t\t\t\t{\n\t\t\t\t\t\titem:      this.item,\n\t\t\t\t\t\tvalues:    getCurrentFieldsValues( this.itemId ),\n\t\t\t\t\t},\n\t\t\t\t\t// modules\n\t\t\t\t\t(function(){\n\t\t\t\t\t\t// Get required modules\n\t\t\t\t\t\tlet modules = {};\n\n\t\t\t\t\t\t// Check if the developer wants custom modules\n\t\t\t\t\t\tif ( isDefined( button.modules ) ){\n\t\t\t\t\t\t\t// Check if we have to add the modal module\n\t\t\t\t\t\t\tif ( button.modules.includes( 'modal' ) ){\n\t\t\t\t\t\t\t\t// Include modal\n\t\t\t\t\t\t\t\tmodules.Modal = Modal;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( button.modules.includes( 'markdown' ) ){\n\t\t\t\t\t\t\t\t// Include Markdown\n\t\t\t\t\t\t\t\tmodules.Markdown = Markdown;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Return modules\n\t\t\t\t\t\treturn modules;\n\t\t\t\t\t})()\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t// Add button to the container\n\t\t\tdeveloperButtons.append( $buttonElement );\n\t\t});\n\n\t\tcontainer.append( automatorButtons );\n\t\tcontainer.append( developerButtons );\n\n\t\tsaveButton.on( 'click', () => {\n\t\t\t// Verify form\n\t\t\tlet formValidation = validateItemFields( this.fieldsContainer );\n\n\t\t\t// Check if it's valid\n\t\t\tif ( formValidation.isValid ){\n\t\t\t\t// Disable button and show loading animation\n\t\t\t\tsaveButton.addClass( 'uap-btn--loading uap-btn--disabled' );\n\n\t\t\t\t// The REST call wants:\n\t\t\t\t// - The item ID\n\t\t\t\t// - The option code (the one from the token, the main one)\n\t\t\t\t// - The value. If there is more than one then a serialized object\n\t\t\t\tlet itemId \t\t= this.itemId,\n\t\t\t\t\toptionCode \t= this.optionId,\n\t\t\t\t\toptionValue = this.getOptionValue();\n\n\t\t\t\t// Get a temporary item sentence\n\t\t\t\t// This must use values that are not yet saved in the meta of the item\n\t\t\t\tconst itemSentence = parseStringWithTokens( this.item, this.item.meta.sentence, $.extend({}, this.item.meta, getCurrentFieldsValues( this.itemId ) ) );\n\n\t\t\t\t// Get the item sentence HTML\n\t\t\t\tlet itemSentenceHTML;\n\t\t\t\ttry {\n\t\t\t\t\titemSentenceHTML = itemSentence.html.get(0).outerHTML;\n\t\t\t\t} catch ( e ){\n\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trestCall( 'update', {\n\t\t\t\t\titemId:       itemId,\n\t\t\t\t\toptionCode:   optionCode,\n\t\t\t\t\toptionValue:  optionValue,\n\t\t\t\t\tsentence_human_readable: itemSentence.brackets,\n\t\t\t\t\tsentence_human_readable_html: itemSentenceHTML\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\t// Trigger \"saved\" on all item fields\n\t\t\t\t\tthis.fields.forEach(( Field ) => {\n\t\t\t\t\t\tField.getFormElement().trigger( 'saved' );\n\t\t\t\t\t});\n\n\t\t\t\t\tif ( this.item.itemType == 'trigger' ){\n\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.item.itemType == 'action' || this.item.itemType == 'closure' ){\n\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Determine if the item is already valid\n\t\t\t\t\t// This will be true only if the new item doesn't have\n\t\t\t\t\t// options, or all the options have a default value\n\t\t\t\t\tconst isValid = UncannyAutomator.recipe.items[ this.item.id ].isValid;\n\n\t\t\t\t\t// Get item form element\n\t\t\t\t\tconst $item = getDOMElements( 'item', {\n\t\t\t\t\t\tid: this.item.id\n\t\t\t\t\t});\n\n\t\t\t\t\t// Check if it's valid\n\t\t\t\t\tif ( isValid ){\n\t\t\t\t\t\t// Check if the recipe is NOT live\n\t\t\t\t\t\tif ( ! UncannyAutomator.recipe.isLive ){\n\t\t\t\t\t\t\t// Check if the ITEM isn't already live\n\t\t\t\t\t\t\t// Otherwise, we don't have to trigger it again\n\t\t\t\t\t\t\tif ( ! this.item.isLive ){\n\t\t\t\t\t\t\t\t// Set the item to live\n\t\t\t\t\t\t\t\t$item.item\n\t\t\t\t\t\t\t\t\t.find( '.item-status input[type=\"checkbox\"]' )\n\t\t\t\t\t\t\t\t\t.prop( 'checked', true )\n\t\t\t\t\t\t\t\t\t.trigger( 'change' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Get first token and trigger a click\n\t\t\t\t\t\t// This will open the first group of options\n\t\t\t\t\t\t$item.item\n\t\t\t\t\t\t\t.find( '.item-title__token:not(.item-title__token--filled)' )\n\t\t\t\t\t\t\t.first()\n\t\t\t\t\t\t\t.trigger( 'click' );\n\t\t\t\t\t}\n\t\t\t\t}, ( response ) => {\n\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t save the options of the item' );\n\n\t\t\t\t\t// Reset UI\n\t\t\t\t\tif ( this.item.itemType == 'trigger' ){\n\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.item.itemType == 'action' || this.item.itemType == 'closure' ){\n\t\t\t\t\t\tnew Actions();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Try to open the options again\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Get the item elements\n\t\t\t\t\t\tgetDOMElements( 'item', {\n\t\t\t\t\t\t\tid: this.itemId\n\t\t\t\t\t\t})\n\t\t\t\t\t\t// Get the main container\n\t\t\t\t\t\t.item\n\t\t\t\t\t\t// Find the token in the sentence\n\t\t\t\t\t\t.find( `.item-title__token[data-options-id=\"${ optionCode }\"]` )\n\t\t\t\t\t\t// Trigger a click\n\t\t\t\t\t\t.trigger( 'click' ); \n\t\t\t\t\t} catch ( e ){\n\t\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tcancelButton.on( 'click', () => {\n\t\t\t// Reset UI\n\t\t\tif ( this.item.itemType == 'trigger' ){\n\t\t\t\tnew Triggers();\n\t\t\t}\n\n\t\t\tif ( this.item.itemType == 'action' || this.item.itemType == 'closure' ){\n\t\t\t\tnew Actions();\n\t\t\t}\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tinitTokenSelector(){\n\t\t$.each( this.fields, ( index, field ) => {\n\t\t\t// Get the field type\n\t\t\tfield.initTokenSelector();\t\t\n\t\t});\n\t}\n\n\tinitTinyMCE(){\n\t\t$.each( this.fields, ( index, field ) => {\n\t\t\t// Get the field type\n\t\t\tif ( field.getAttributes().fieldType == 'textarea' ){\n\t\t\t\t// TinyMCE will be initialized only if it's a textarea and supportsTinyMCE is true\n\t\t\t\tfield.initTinyMCE();\n\t\t\t}\t\t\t\n\t\t});\n\t}\n\n\tinitCodeMirror(){\n\t\t$.each( this.fields, ( index, field ) => {\n\t\t\t// Get the field type\n\t\t\tfield.initCodeMirror();\n\t\t});\n\t}\n\n\t/**\n\t * Get the value that we have to send to the REST call\n\t *\n\t * @since 0.5\n\t */\n\n\tgetOptionValue(){\n\t\tlet response = {},\n\t\t\thasSelect = false,\n\t\t\thasRepeater = false;\n\n\t\t$.each( this.fields, ( index, field ) => {\n\t\t\tlet id \t  = field.getAttributes().optionCode,\n\t\t\t\tvalue = field.getValue();\n\n\t\t\tif ( [ 'select', 'radio' ].includes( field.getAttributes().fieldType ) ){\n\t\t\t\t// Has select\n\t\t\t\thasSelect = true;\n\n\t\t\t\t// Check if it's a multiselect\n\t\t\t\t// Then save the value as a JSON string, don't save it\n\t\t\t\t// as an array\n\t\t\t\tif ( field.getAttributes().supportsMultipleValues ){\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvalue = JSON.stringify( value );\n\t\t\t\t\t} catch ( e ){\n\t\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Save readable value\n\t\t\t\tresponse[ vsprintf( '%s_readable', [ id ] ) ] = field.getReadableValue();\n\n\t\t\t\t// Check if we have to save the custom value (only for selects)\n\t\t\t\tconst customValue = field.getSelectCustomValue();\n\t\t\t\tif ( value == 'automator_custom_value' ){\n\t\t\t\t\tresponse[ vsprintf( '%s_custom', [ id ] ) ] = customValue;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( field.getAttributes().fieldType == 'repeater' ){\n\t\t\t\t// Has repeater\n\t\t\t\thasRepeater = true;\n\t\t\t\t\n\t\t\t\t// Convert data to a JSON string\n\t\t\t\tvalue = JSON.stringify( value );\n\t\t\t}\n\n\t\t\tresponse[ id ] = value;\n\t\t});\n\n\t\tif ( ! hasRepeater && ! hasSelect && Object.keys( response ).length == 1 ){\n\t\t\t// One field\n\t\t\tresponse = response[ Object.keys( response )[ 0 ] ];\n\t\t}\n\n\t\treturn response;\n\t}\n}\n\nexport default ItemOptions;","import $ from 'jquery';\n\nimport {\n\trestCall,\n\tgetGlobalItem,\n\tgetDOMElements,\n\tparseStringWithTokens,\n\tisEmpty,\n\tisDefined,\n\treplaceCurlyBraces\n} from '../common/utilities.js';\n\nimport Modal       from '../common/modal.js';\n\nimport Field       from '../field/field.js';\n\nimport ItemOptions from './options.js';\nimport Triggers    from './triggers.js';\nimport Actions     from './actions.js';\n\nimport {\n\tvalidateItem\n} from '../validation/validation';\n\nimport RecipeNotices from '../recipe/notices';\n\nclass ItemHeaderSentence {\n\tconstructor( itemType, integrationID, itemCode, itemId ){\n\t\tthis.itemType = itemType;\n\t\tthis.integrationID = integrationID;\n\t\tthis.itemCode = itemCode;\n\t\tthis.itemId   = itemId;\n\t\tthis.item     = UncannyAutomator.recipe.items[ itemId ];\n\n\t\treturn this.createItemSentence( itemType, itemCode, itemId );\n\t}\n\n\t/**\n\t * Create item sentence + status toggle\n\t * \n\t * @since 0.5     \n\t *\n\t * @return {object}   jQuery DOM object with the item sentence + status toggle\n\t */\n\n\tcreateItemSentence( itemType, itemCode, itemId ){\n\t\t// Get information about the global item\n\t\tlet globalItem = getGlobalItem( this.integrationID, itemType, itemCode );\n\t\tthis.globalItem = globalItem;\n\n\t\t// Get sentence\n\t\tlet itemSentence;\n\n\t\tif ( ! this.item.isMissing ){\n\t\t\titemSentence = getGlobalItem( this.integrationID, this.item.itemType, this.item.itemCode ).sentence;\n\t\t}\n\t\telse {\n\t\t\titemSentence = this.item.sentence;\n\t\t}\n\n\t\titemSentence = parseStringWithTokens(\n\t\t\tthis.item,\n\t\t\titemSentence,\n\t\t\tUncannyAutomator.recipe.items[ this.itemId ].meta,\n\t\t\ttrue\n\t\t);\n\n\t\tif ( ! this.item.isMissing ){\n\t\t\t// Listen clicks on tokens\n\t\t\titemSentence.elements.token.on( 'click', ( event ) => {\n\t\t\t\t// Get token element\n\t\t\t\tconst $token = $( event.currentTarget );\n\n\t\t\t\t// Remove \"open\" class from al items\n\t\t\t\titemSentence.elements.token.removeClass( 'item-title__token--open' );\n\t\t\t\t// Add \"open\" class to the clicked token\n\t\t\t\t$token.addClass( 'item-title__token--open' );\n\n\t\t\t\t// Add \"open\" class to the item\n\t\t\t\tconst $item = $token.parents('.item');\n\t\t\t\t$item.addClass( 'item--open' );\n\t\t\t\t\n\t\t\t\t$item.trigger( 'automator:item:open', $item.hasClass( 'item--open' ) );\n\n\t\t\t\t// Get options ID\n\t\t\t\tlet optionsID = $token.data( 'options-id' );\n\n\t\t\t\t// Get option group\n\t\t\t\tlet optionGroupDOM = getDOMElements( 'optionGroup', {\n\t\t\t\t\titemID:  itemId,\n\t\t\t\t\tgroupID: optionsID,\n\t\t\t\t});\n\n\t\t\t\t// Create and show\n\t\t\t\tnew ItemOptions( itemId, optionsID );\n\t\t\t});\n\t\t}\n\t\t\t\n\t\t// Create DOM elements\n\t\tlet container = $( '<div/>', { 'class': 'item-title__describe-container' }),\n\t\t\tstatus    = $( '<div/>', { 'class': 'item-status' });\n\n\t\tcontainer.append( itemSentence.html.addClass( 'item-title__describe' ) );\n\n\t\t// Create toggle. We're using Field. Read Field.js comments for more information\n\t\tvar itemToggle = new Field( 'checkbox', {\n\t\t\tcolor: 'green',\n\t\t\talign: 'right',\n\t\t\ttoggle: {\n\t\t\t\ton:  UncannyAutomator.i18n.status.liveRecipeItem,\n\t\t\t\toff: UncannyAutomator.i18n.status.draftRecipeItem,\n\t\t\t},\n\t\t\tcurrentValue: UncannyAutomator.recipe.items[ itemId ].isLive\n\t\t});\n\n\t\tlet itemStatusToggle = itemToggle.getFormElement();\n\t\t\tstatus.append( itemStatusToggle );\n\t\t\tcontainer.append( status );\n\n\t\tif ( ! this.item.isMissing ){\n\t\t\titemStatusToggle.on( 'automator:field:change', function(){\n\t\t\t\tlet makeLive = itemToggle.getValue();\n\t\t\t\tvar isValidItem = true; // True by default, will change to false is it's invalid\n\n\t\t\t\t// Check if the user wants to make it live\n\t\t\t\tif ( makeLive ){\n\t\t\t\t\t// Validate\n\t\t\t\t\tlet validation = validateItem( itemId );\n\t\t\t\t\tisValidItem = validation.isValid; \n\t\t\t\t}\n\n\t\t\t\t// Do AJAX\n\t\t\t\t// Show loading animation\n\t\t\t\titemToggle.startLoadingAnimation();\n\n\t\t\t\tif ( isValidItem ){\n\t\t\t\t\t// Set post status\n\t\t\t\t\tlet post_status = makeLive ? 'publish' : 'draft';\n\n\t\t\t\t\t// Check if they want to make an item draft in a live recipe\n\t\t\t\t\tif ( ! makeLive && UncannyAutomator.recipe.isLive ){\n\t\t\t\t\t\t// Create modal box\n\t\t\t\t\t\t// Read Modal.js comments for more information\n\t\t\t\t\t\tlet modal = new Modal({\n\t\t\t\t\t\t\ttitle:       UncannyAutomator.i18n.confirmationModal.title,\n\t\t\t\t\t\t\twarning:     replaceCurlyBraces( UncannyAutomator.i18n.confirmationModal.statusWarning, '<strong>', '</strong>' ),\n\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\t\t\t\t\tconfirm: UncannyAutomator.i18n.confirm,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmodal.setEvents({\n\t\t\t\t\t\t\tafterSetEvents: function(){\n\t\t\t\t\t\t\t\tmodal.show();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonConfirm: function(){\n\t\t\t\t\t\t\t\tlet elements        = modal.getElements();\n\t\t\t\t\t\t\t\tlet confirmButton   = elements.modal.box.buttons.confirm;\n\n\t\t\t\t\t\t\t\t// Add loading class to button\n\t\t\t\t\t\t\t\tconfirmButton.addClass( 'uap-btn--loading' ).prop( 'disabled', true );\n\n\t\t\t\t\t\t\t\t// Start loading animation on toggle\n\t\t\t\t\t\t\t\titemToggle.startLoadingAnimation();\n\n\t\t\t\t\t\t\t\t// Get the item sentence HTML\n\t\t\t\t\t\t\t\tlet itemSentenceHTML;\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\titemSentenceHTML = itemSentence.html.get(0).outerHTML;\n\t\t\t\t\t\t\t\t} catch ( e ){\n\t\t\t\t\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trestCall( 'change_post_status', {\n\t\t\t\t\t\t\t\t\tpost_ID:      itemId,\n\t\t\t\t\t\t\t\t\tpost_status:  post_status,\n\t\t\t\t\t\t\t\t\tsentence_human_readable: itemSentence.brackets,\n\t\t\t\t\t\t\t\t\tsentence_human_readable_html: itemSentenceHTML\n\t\t\t\t\t\t\t\t}, function(){\n\t\t\t\t\t\t\t\t\t// On success\n\t\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\t\t\t// Refresh UI\n\t\t\t\t\t\t\t\t\tnew Triggers();\n\t\t\t\t\t\t\t\t\tnew Actions();\n\n\t\t\t\t\t\t\t\t\t// Show error\n\t\t\t\t\t\t\t\t\tnew RecipeNotices();\n\n\t\t\t\t\t\t\t\t\t// Check if the recipe is still valid, if it isn't then make the recipe draft\n\t\t\t\t\t\t\t\t\tif ( ! UncannyAutomator.recipe.isValid ){\n\t\t\t\t\t\t\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, function(){\n\t\t\t\t\t\t\t\t\t// On fail\n\t\t\t\t\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t set the item status' );\n\n\t\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\t\tmodal.destroy();\n\n\t\t\t\t\t\t\t\t\t// Remove loading animation, data didn't change\n\t\t\t\t\t\t\t\t\titemToggle.stopLoadingAnimation();\n\n\t\t\t\t\t\t\t\t\t// Revert user change\n\t\t\t\t\t\t\t\t\titemToggle.setValue( ! makeLive, false );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonCancel: function(){\n\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t\t\t// Revert user change\n\t\t\t\t\t\t\t\titemToggle.setValue( ! makeLive, false );\n\n\t\t\t\t\t\t\t\t// Stop loading animation in the toggle\n\t\t\t\t\t\t\t\titemToggle.stopLoadingAnimation();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tafterHide: function(){\n\t\t\t\t\t\t\t\tmodal.destroy();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Get the item sentence HTML\n\t\t\t\t\t\tlet itemSentenceHTML;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\titemSentenceHTML = itemSentence.html.get(0).outerHTML;\n\t\t\t\t\t\t} catch ( e ){\n\t\t\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t// Is valid, make live\n\t\t\t\t\t\trestCall( 'change_post_status', {\n\t\t\t\t\t\t\tpost_ID:      itemId,\n\t\t\t\t\t\t\tpost_status:  post_status,\n\t\t\t\t\t\t\tsentence_human_readable: itemSentence.brackets,\n\t\t\t\t\t\t\tsentence_human_readable_html: itemSentenceHTML\n\t\t\t\t\t\t}, function(){\n\t\t\t\t\t\t\t// On sucess\n\t\t\t\t\t\t\t// Update object\n\n\t\t\t\t\t\t\t// Refresh UI\n\t\t\t\t\t\t\t// Debugging! don't re-render the UI\n\t\t\t\t\t\t\t// new Triggers();\n\t\t\t\t\t\t\t// new Actions();\n\n\t\t\t\t\t\t\t// Remove loading animation, data didn't change\n\t\t\t\t\t\t\titemToggle.stopLoadingAnimation();\n\n\t\t\t\t\t\t\t// Show error\n\t\t\t\t\t\t\tnew RecipeNotices();\n\t\t\t\t\t\t}, function(){\n\t\t\t\t\t\t\t// On fail\n\t\t\t\t\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t set the item status' );\n\n\t\t\t\t\t\t\t// Remove loading animation, data didn't change\n\t\t\t\t\t\t\titemToggle.stopLoadingAnimation();\n\n\t\t\t\t\t\t\t// Revert user change\n\t\t\t\t\t\t\titemToggle.setValue( ! makeLive, false );\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// JS won't take more than some milliseconds to do this, so we're going to wait one second just for the user to understand what's happening\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t// Remove loading animation\n\t\t\t\t\t\titemToggle.stopLoadingAnimation();\n\n\t\t\t\t\t\t// Revert user change\n\t\t\t\t\t\titemToggle.setValue( false, false );\n\t\t\t\t\t}, 1000 );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn container;\n\t}\n}\n\nexport default ItemHeaderSentence;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\tgetDOMElements,\n\tisDefined\n} from '../common/utilities.js';\n\nclass MetaboxNotice {\n\tconstructor( itemType, noticeType, noticeMessage ){\n\t\tthis.itemType \t\t= itemType;\n\t\tthis.noticeType \t= noticeType;\n\t\tthis.noticeMessage \t= noticeMessage;\n\n\t\t// Create notice\n\t\tthis.create();\n\t}\n\n\tcreate(){\n\t\t// Append to the metabox\n\t\tlet metabox = getDOMElements( 'metabox', {\n\t\t\ttype: this.itemType\n\t\t});\n\n\t\t// Get notice\n\t\tlet notice = this.createNotice();\n\n\t\t// Append to the metabox\n\t\tmetabox.append( notice );\n\t}\n\n\tcreateNotice(){\n\t\tlet container = $( '<div/>', { 'class': 'metabox__notice' });\n\n\t\tif ( isDefined( this.noticeType ) ){\n\t\t\tcontainer.addClass( vsprintf( 'metabox__notice--%s', [ this.noticeType ] ) );\n\t\t}\n\n\t\tcontainer.html( this.noticeMessage );\n\t\treturn container;\n\t}\n}\n\nexport default MetaboxNotice;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\titemsObject,\n\tgetDOMElements,\n\tisEmpty,\n\tisDefined,\n\tgetURLParameter\n} from '../common/utilities.js';\n\nimport ItemCreatorIntegrations  from './integrations-grid.js';\n\nimport MetaboxNotice            from '../metabox/notices.js';\nimport MetaboxItems             from '../metabox/items.js';\nimport MetaboxFooter            from '../metabox/footer.js';\n\nclass Triggers {\n\tconstructor(){\n\t\t// Create console group\n\t\t// console.group( 'Triggers' );\n\n\t\t// Get and clear metabox\n\t\tlet metabox = getDOMElements( 'metabox', { type: 'trigger' });\n\t\tmetabox.empty();\n\n\t\t// Get recipe triggers\n\t\tlet triggers = itemsObject( 'get', {\n\t\t\tfilter: {\n\t\t\t\titemType: 'trigger'\n\t\t\t}\n\t\t});\n\n\t\t// Check if it has triggers\n\t\tif ( ! isEmpty( triggers ) ){\n\t\t\t// Render items\n\t\t\tnew MetaboxItems( 'trigger', triggers );\n\n\t\t\t// Create metabox footer\n\t\t\tnew MetaboxFooter( 'trigger' );\n\n\t\t\t// Check if we have to show the integrations on load\n\t\t\tif ( this.isContinuingIntegrationConnection() ){\n\t\t\t\t// Render the integrations list\n\t\t\t\tnew ItemCreatorIntegrations( 'trigger' );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tnew ItemCreatorIntegrations( 'trigger' );\n\n\t\t\t// Create metabox footer\n\t\t\tnew MetaboxFooter( 'trigger' );\n\t\t}\n\n\t\t// Close console group\n\t\t// console.groupEnd();\n\t}\n\n\tisContinuingIntegrationConnection(){\n\t\treturn getURLParameter( null, 'ua_connecting_integration' ) == 1 && getURLParameter( null, 'ua_connecting_integration_context' ) == 'trigger';\n\t}\n}\n\nexport default Triggers;","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\titemsObject,\n\tgetDOMElements,\n\tisEmpty,\n\tisDefined,\n\taddUTMParameters\n} from '../common/utilities';\n\nimport ItemCreatorIntegrations from '../item/integrations-grid.js';\nimport Triggers                from '../item/triggers';\nimport Actions                 from '../item/actions';\n\nimport MetaboxItems            from './items';\n\nclass MetaboxFooter {\n\n\tconstructor( itemType ){\n\t\tthis.itemType = itemType;\n\n\t\tif ( this.shouldCreateMetaboxFooter() ){\n\t\t\tthis.createFooter();\n\t\t}\n\t}\n\n\tshouldCreateMetaboxFooter(){\n\t\t// Check if we should create the metabox\n\t\t// For the triggers we're going to create it always,\n\t\t// but for the actions we're going to create only if there is at least one action\n\n\t\tlet create = false;\n\n\t\tif ( this.itemType == 'trigger' ){\n\t\t\t// Get triggers\n\t\t\tlet recipeActions = itemsObject( 'get', {\n\t\t\t\tfilter: {\n\t\t\t\t\titemType: 'trigger'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Check if has triggers\n\t\t\tlet hasTriggers = ! isEmpty( recipeActions );\n\n\t\t\t// Create metabox if hasTriggers\n\t\t\tif ( ( hasTriggers || ( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp ) ) || UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t\tcreate = true;\n\t\t\t}\n\t\t}\n\n\t\tif ( this.itemType == 'action' ){\n\t\t\t// Get actions\n\t\t\tlet recipeActions = itemsObject( 'get', {\n\t\t\t\tfilter: {\n\t\t\t\t\titemType: 'action'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Check if has actions\n\t\t\tlet hasActions = ! isEmpty( recipeActions );\n\n\t\t\t// Create metabox if hasActions\n\t\t\tif ( hasActions ){\n\t\t\t\tcreate = true;\n\t\t\t}\n\t\t}\n\n\t\treturn create;\n\t}\n\n\tcreateFooter(){\n\t\t// Create error container\n\t\tlet container  = $( '<div/>', { 'class': 'metabox__footer' });\n\n\t\t// \"Add another\" button\n\t\tlet addAnother = $( '<div/>', { 'class': 'uap-btn uap-btn--secondary' });\n\n\t\t// Add button, but don't add it in the triggers metabox for anonymous recipes\n\t\tif ( this.itemType == 'action' || ( this.itemType == 'trigger' && UncannyAutomator.recipe.type == 'user' ) ){\n\t\t\t// Append \"Add another\" button\n\t\t\tcontainer.append( addAnother );\n\t\t}\n\n\t\tif ( this.itemType == 'trigger' ){\n\t\t\t// Do only for \"user\" recipes\n\t\t\tif ( UncannyAutomator.recipe.type == 'user' ){\n\t\t\t\t// Set text to the \"Add Another\" button\n\t\t\t\taddAnother.text( UncannyAutomator.i18n.trigger.addAnother );\n\t\t\t}\n\n\t\t\t// Do only for \"anonymous\" recipes\n\t\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ){\n\t\t\t\t// Create and append anonymous notice\n\t\t\t\tlet $anonymousNotice = this.createAnonymousNotice();\n\t\t\t\tcontainer.append( $anonymousNotice );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.itemType == 'action' ){\n\t\t\t// Set text to the \"Add Another\" button\n\t\t\taddAnother.text( UncannyAutomator.i18n.action.addAnother );\n\t\t\tcontainer.addClass('add-action-btn');\n\t\t}\n\n\t\t// Bind button\n\t\tif ( ( this.itemType == 'trigger' && UncannyAutomator.recipe.type == 'user' ) || this.itemType == 'action' ){\n\t\t\t// Listen clicks to the \"Add another\" button\n\t\t\taddAnother.on( 'click', () => {\n\t\t\t\t// Multiple triggers are only allowed in the pro version\n\t\t\t\t// So we're only doing this for actions\n\t\t\t\tnew ItemCreatorIntegrations( this.itemType );\n\t\t\t});\n\t\t}\n\n\t\t// Append to the metabox\n\t\tlet metabox = getDOMElements( 'metabox', {\n\t\t\ttype: this.itemType\n\t\t})\n\n\t\tmetabox.append( container );\n\t}\n\n\tcreateAnonymousNotice(){\n\t\tlet $notice = $( `\n\t\t\t<div class=\"description\">\n\t\t\t\t${ UncannyAutomator.i18n.recipeType.everyoneOnlyOneTrigger } <a href=\"${ addUTMParameters( 'https://automatorplugin.com/knowledge-base/managing-triggers/', {\n\t\t\t\t\t\t'medium':  'anonymous_recipe_one_trigger',\n\t\t\t\t\t\t'content': 'learn_more'\n\t\t\t\t\t}) }\" target=\"_blank\">${ UncannyAutomator.i18n.learnMore } <span class=\"uo-icon uo-icon--external-link-alt\"></span></a>\n\t\t\t</div>\n\t\t` );\n\n\t\treturn $notice;\n\t}\n}\n\nexport default MetaboxFooter;","import $ from 'jquery';\n\nimport {\n\trestCall\n} from '../common/utilities.js';\n\nimport Field    from '../field/field.js';\n\nimport Modal    from '../common/modal.js';\n\nimport Actions  from './actions.js';\n\nclass ItemHeaderAsync {\n\n\tbuttonContainer;\n\tbutton;\n\tbuttonIcon;\n\n\tremoveButton;\n\n\tasyncModeField;\n\tasyncModeHTML;\n\n\tdelayNumberField;\n\tdelayNumberHTML;\n\n\tdelayUnitField;\n\tdelayUnitHTML;\n\n\tscheduleDateField;\n\tscheduleDateHTML;\n\n\tscheduleTimeField;\n\tscheduleTimeHTML;\n\n\tscheduleNoticeHTML;\n\n\tmodal;\n\n\t/**\n\t * Create item actions\n\t *\n\t * @since 0.5\n\t *\n\t * @return jQuery DOM element with the item actions\n\t */\n\n\tconstructor( itemType, integrationID, itemCode, itemId ){\n\t\tthis.itemType      = itemType;\n\t\tthis.integrationID = integrationID;\n\t\tthis.itemCode      = itemCode;\n\t\tthis.itemId        = itemId;\n\t\tthis.item          = UncannyAutomator.recipe.items[ itemId ];\n\t\tthis.asyncMode     = this.item.meta.async_mode;\n\n\t\tif ( UncannyAutomator.proVersion.startsWith( \"2\" ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.createAsyncButton();\n\t\t\n\t}\n\n\thasSchedule() {\n\t\tif ( ! this.asyncMode ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( this.asyncMode == 'delay' ) {\n\t\t\treturn this.item.meta.async_delay_number && this.item.meta.async_delay_unit;\n\t\t}\n\n\t\tif ( this.asyncMode == 'schedule' ) {\n\t\t\treturn this.item.meta.async_schedule_time && this.item.meta.async_schedule_date;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetButtonText() {\n\t\tif ( this.hasSchedule() ) {\n\t\t\tlet text = UncannyAutomator.i18n.action.asyncActions[this.asyncMode];\n\t\t\ttext += ' ';\n\t\t\ttext += '<strong>' + this.item.meta.async_sentence + '</strong>';\n\t\t\treturn  text;\n\t\t}\n\t\treturn UncannyAutomator.i18n.action.asyncActions.delay;\n\t}\n\n\tcreateAsyncButton(){\n\n\t\t// Create elements\n\t\tthis.buttonContainer     = $( '<div/>', { 'class': 'item-async' } );\n\t\tthis.button           = $( '<div/>', { 'class': 'item-async__btn' } );\n\t\tthis.buttonIcon       = $( '<i/>', { 'class': 'uo-icon uo-icon--clock' } );\n\n\t\tthis.button.html( this.getButtonText() );\n\t\tthis.button.prepend( this.buttonIcon );\n\n\t\tthis.buttonContainer.append( this.button );\n\n\t\tif ( this.hasSchedule() ) {\n\t\t\tthis.createRemoveButton();\n\t\t}\n\n\t\tif ( this.isNew() ) {\n\t\t\tthis.createBadge( UncannyAutomator.i18n.action.asyncActions.new );\n\t\t}\n\n\t\t// Listen clicks to the open button\n\t\tthis.button.on( 'click', () => {\n\t\t\tif ( ! this.buttonContainer.hasClass(\"disabled\") ) {\n\t\t\t\tthis.showModal();\n\t\t\t}\n\t\t} );\n\n\t\tthis.buttonContainer.on('automator:asyncButton:maybeDisable', (e, disable) => {\n\t\t\tlet buttonContainer = $( e.currentTarget );\n\n\t\t\tif ( disable ) {\n\t\t\t\tbuttonContainer.attr( 'uap-tooltip', UncannyAutomator.i18n.action.asyncActions.pleaseSave );\n\t\t\t\tbuttonContainer.attr( 'uap-flow', 'down' );\n\t\t\t\tbuttonContainer.addClass('disabled');\n\t\t\t} else {\n\t\t\t\tbuttonContainer.removeAttr( 'uap-tooltip' );\n\t\t\t\tbuttonContainer.removeClass('disabled');\n\t\t\t}\n\n\t\t});\n\n\t\treturn this.buttonContainer;\n\t}\n\n\tenable() {\n\t\tthis.button.removeAttr('uap-tooltip');\n\t\tthis.button.removeAttr('disabled');\n\t}\n\n\tisNew() {\n\t\t// TODO When to hide this?\n\t\treturn true;\n\t}\n\n\tcreateBadge( label ) {\n\t\tthis.buttonBadge = $( '<span/>', { 'class': 'async-button__badge' } );\n\t\tthis.buttonBadge.text( label );\n\t\tthis.button.append( this.buttonBadge );\n\t}\n\n\tcreateRemoveButton() {\n\t\tthis.removeButton = $( '<span/>', { 'class': 'async-remove' } );\n\t\tthis.removeButtonIcon = $( '<i/>', { 'class': 'uo-icon uo-icon--times' } );\n\n\t\tthis.removeButton.text( UncannyAutomator.i18n.action.asyncActions.remove ) \n\t\tthis.removeButton.on( 'click', () => {\n\t\t\tthis.removeSchedule();\n\t\t});\n\t\tthis.removeButton.prepend( this.removeButtonIcon );\n\t\tthis.buttonContainer.append( this.removeButton );\n\t}\n\n\tcreateModalContent() {\n\t\t// Create the content for the modal\n\t\tlet modalContent = $( `<div/>`, { 'class': 'async-action-modal' } );\n\n\t\tthis.asyncModeHTML = this.createAsyncModeHTML();\n\n\t\tthis.asyncModeHTML.find( \".form-radio__container:first\" ).after( this.createDelayOptions() );\n\t\tthis.asyncModeHTML.find( \".form-radio__container:last\" ).after( this.createScheduleOptions() );\n\n\t\tthis.attachModeChangeEvent();\n\t\n\t\t// Add the field\n\t\tmodalContent.append( this.asyncModeHTML );\n\n\t\tif ( this.hasSchedule() ) {\n\t\t\tlet modalNoticeHTML = $( '<div/>', { 'class': 'async-notice async-notice__blue' } );\n\t\t\tlet modalNoticeIcon = $( '<i/>', { 'class': 'uo-icon uo-icon--exclamation-triangle' } );\n\t\t\tmodalNoticeHTML.append( modalNoticeIcon );\n\t\t\tmodalNoticeHTML.append( UncannyAutomator.i18n.action.asyncActions.modal.scheduleNotice2 );\n\t\t\tmodalContent.append( modalNoticeHTML );\n\t\t} \n\n\t\treturn modalContent;\n\t}\n\n\tshowModal() {\n\n\t\tlet confirmButtonText = UncannyAutomator.i18n.action.asyncActions.modal.confirm;\n\n\t\tif ( this.hasSchedule() && this.asyncMode == 'schedule' ) {\n\t\t\tconfirmButtonText = UncannyAutomator.i18n.action.asyncActions.schedule;\n\t\t}\n\n\t\t// Show a modal\n\t\tthis.modal = new Modal( {\n\t\t\ttitle: UncannyAutomator.i18n.action.asyncActions.modal.title,\n\t\t\tcontent: this.createModalContent(),\n\t\t\tbuttons: {\n\t\t\t\tcancel:  UncannyAutomator.i18n.cancel,\n\t\t\t\tconfirm: confirmButtonText,\n\t\t\t}\n\t\t}, {\n\t\t\tsize: 'large',\n\t\t\tcustomClass: 'async-action'\n\t\t} );\n\n\t\tthis.modalEvents();\n\t}\n\n\tmodalEvents() {\n\t\tthis.modal.setEvents( {\n\t\t\tafterSetEvents: () => {\n\t\t\t\t\n\t\t\t\tthis.modal.show();\n\t\t\t},\n\t\t\tonConfirm: () => {\n\t\t\t\tthis.submitModal();\n\t\t\t\t\n\t\t\t},\n\t\t\tafterHide: () => {\n\t\t\t\tthis.modal.destroy();\n\t\t\t}\n\t\t} );\n\t}\n\n\tsubmitModal() {\n\t\tlet elements        = this.modal.getElements();\n\t\tlet confirmButton   = elements.modal.box.buttons.confirm;\n\n\t\t// Add loading class to button\n\t\tconfirmButton.addClass( 'uap-btn--loading' ).prop( 'disabled', true );\n\n\t\tif ( ! this.validateForm().isValid ) {\n\t\t\tconfirmButton.removeClass( 'uap-btn--loading' ).prop( 'disabled', false );\n\t\t\treturn;\n\t\t}\n\n\t\tlet asyncMode = this.asyncModeField.getValue();\n\t\tlet delayNumber = this.delayNumberField.getValue();\n\t\tlet delayUnit = this.delayUnitField.getValue();\n\t\tlet scheduleTime = this.scheduleTimeField.getValue();\n\t\tlet scheduleDate = this.scheduleDateField.getValue();\n\n\n\t\tlet sentence;\n\n\t\tif ( asyncMode == 'delay' ) {\n\t\t\tsentence = this.delaySentence();\n\t\t} else {\n\t\t\tsentence = this.scheduleSentence();\n\t\t}\n\t\t\n\t\tthis.saveSchedule( asyncMode, delayNumber, delayUnit, scheduleTime, scheduleDate, sentence )\n\t\t\n\t}\n\n\tdelaySeconds() {\n\t\tlet delayUnit = this.delayUnitField.getValue();\n\t\tlet delayNumber = this.delayNumberField.getValue();\n\t\tlet multiplier;\n\n\t\tswitch ( delayUnit ) {\n\t\t\tcase 'seconds':\n\t\t\t\tmultiplier = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'minutes':\n\t\t\t\tmultiplier = 60;\n\t\t\t\tbreak;\n\t\t\tcase 'hours':\n\t\t\t\tmultiplier = 60 * 60;\n\t\t\t\tbreak;\n\t\t\tcase 'days':\n\t\t\t\tmultiplier = 60 * 60 * 24;\n\t\t\t\tbreak;    \n\t\t\tcase 'years':\n\t\t\t\tmultiplier = 60 * 60 * 24 * 365;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmultiplier = 1;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn delayNumber * multiplier; \n\t}\n\n\tdelaySentence() {\n\t\tlet unit = this.delayUnitField.getValue();\n\n\t\tif ( this.delayNumberField.getValue() == 1 ) {\n\t\t\tunit = unit.slice(0, -1);\n\t\t}\n\n\t\treturn '' + this.delayNumberField.getValue() + ' ' + UncannyAutomator.i18n.action.asyncActions.modal[unit].toLowerCase();\n\t}\n\n\tscheduleSeconds() {\n\t\treturn Date.parse( this.scheduleDateField.getValue() + ' ' + this.scheduleTimeField.getValue() );\n\t}\n\n\tscheduleSentence() {\n\t\treturn this.scheduleDateField.getValue() + ' @ ' + this.scheduleTimeField.getValue();\n\t}\n\n\tsaveSchedule( asyncMode, delayNumber = null, delayUnit = null, scheduleTime = null, scheduleDate = null, sentence = null ) {\n\t\t// Do call and hide\n\t\trestCall( 'schedule_action', {\n\t\t\t'recipeId': UncannyAutomator.recipe.id,\n\t\t\t'actionId': this.itemId,\n\t\t\t'asyncMode': asyncMode,\n\t\t\t'delayNumber': delayNumber,\n\t\t\t'delayUnit': delayUnit,\n\t\t\t'scheduleTime': scheduleTime,\n\t\t\t'scheduleDate': scheduleDate,\n\t\t\t'scheduleSentence': sentence\n\t\t}, () => {\n\t\t\t// Destroy modal\n\t\t\tthis.modal.destroy();\n\t\t\t\n\t\t\tnew Actions();\n\n\t\t\t// Check if the recipe is still valid, if it isn't then make the recipe draft\n\t\t\tif ( ! UncannyAutomator.recipe.isValid ){\n\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t}\n\t\t}, () => {\n\t\t\t// Destroy modal\n\t\t\tthis.modal.destroy();\n\n\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t schedule the item' );\n\n\t\t\tnew Actions();\n\t\t\t\n\t\t});\n\t}\n\n\tremoveSchedule() {\n\t\tthis.removeButtonIcon.removeClass('uo-icon--times');\n\t\tthis.removeButtonIcon.addClass('uo-icon--loading uo-icon--rotate');\n\t\t// Do call and hide\n\t\trestCall( 'remove_schedule', {\n\t\t\t'recipeId': UncannyAutomator.recipe.id,\n\t\t\t'actionId': this.itemId,\n\t\t}, () => {\n\t\t\n\t\t\tnew Actions();\n\n\t\t\t// Check if the recipe is still valid, if it isn't then make the recipe draft\n\t\t\tif ( ! UncannyAutomator.recipe.isValid ){\n\t\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tconsole.log( ' ERROR-TODO. Couldn\\'t schedule the item' );\n\n\t\t\tnew Actions();\n\t\t\t\n\t\t});\n\t}\n\n\tcreateTimeZone() {\n\n\t\tlet timeZoneLink = $( '<a/>', {\n\t\t\t'href':  UncannyAutomator.i18n.action.asyncActions.modal.timezoneLink,\n\t\t\t'target': '_blank'\n\t\t})\n\n\t\tlet timeZoneHelpIcon = $( '<i/>', { 'class': 'uo-icon uo-icon--question-circle' });\n\n\t\tlet timeZoneDesc = $( '<span/>', { 'class': 'schedule-fields__description' }).html( '<strong>' + UncannyAutomator.i18n.action.asyncActions.modal.timezone + '</strong>: ' + UncannyAutomator.i18n.action.asyncActions.modal.timezoneString );\n\n\t\ttimeZoneLink.append( timeZoneHelpIcon );\n\n\t\ttimeZoneDesc.append( timeZoneLink );\n\n\t\treturn timeZoneDesc;\n\n\t}\n\n\tcreateAsyncModeHTML() {\n\t\t// Create the radio field\n\t\tthis.asyncModeField = new Field( 'radio', {\n\t\t\titemType: 'action',\n\t\t\toptionCode: 'schedule_type',\n\t\t\tname: 'schedule-type',\n\t\t\tisRequired: true,\n\t\t\tcurrentValue: this.asyncMode ? this.asyncMode : 'delay',\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tvalue: 'delay',\n\t\t\t\t\ttext: UncannyAutomator.i18n.action.asyncActions.delay\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 'schedule',\n\t\t\t\t\ttext: UncannyAutomator.i18n.action.asyncActions.schedule\n\t\t\t\t}\n\t\t\t]\n\n\t\t}); \n\n\t\treturn this.asyncModeField.createFormElement().addClass( 'schedule-type-radio' );\n\t}\n\n\tattachModeChangeEvent() {\n\t\t// Attach an event and change the confirm button text according to selection\n\t\tthis.asyncModeHTML.on( \"automator:field:change\", () => {\n\t\t\tlet selectedAsyncMode = this.asyncModeField.getValue();\n\t\t\tlet text, showNotice;\n\t\t\t\n\t\t\tif ( selectedAsyncMode == 'schedule' ) {\n\t\t\t\ttext = UncannyAutomator.i18n.action.asyncActions.schedule;\n\t\t\t} else {\n\t\t\t\ttext = UncannyAutomator.i18n.action.asyncActions.modal.confirm;\n\t\t\t}\n\n\t\t\tif ( ! this.hasSchedule() ) {\n\t\t\t\tif ( selectedAsyncMode == 'schedule' ) {\n\t\t\t\t\tthis.scheduleNoticeHTML.removeClass( 'hidden' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.scheduleNoticeHTML.addClass( 'hidden' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.modal.elements.modal.box.buttons.confirm.text( text );\n\t\t});\n\t}\n\n\tcreateScheduleOptions() {\n\n\t\tlet scheduleOptions = $( `<div/>`, { 'class': 'schedule-options' } );\n\n\t\tlet scheduleDesc = $( '<span/>', { 'class': 'async-mode__description' } ).text( UncannyAutomator.i18n.action.asyncActions.modal.scheduleDesc );\n\n\t\tlet scheduleFields = $( '<div/>', { 'class': 'schedule-fields' } );\n\n\t\tif ( ! this.hasSchedule() ) {\n\t\t\tthis.scheduleNoticeHTML = $( '<div/>', { 'class': 'schedule-notice hidden' } );\n\t\t\tlet scheduleNoticeIcon = $( '<i/>', { 'class': 'uo-icon uo-icon--question-circle' } );\n\t\t\tthis.scheduleNoticeHTML.text( UncannyAutomator.i18n.action.asyncActions.modal.scheduleNotice1 );\n\t\t\t\n\t\t\tthis.scheduleNoticeHTML.addClass( 'schedule-notice__yellow' );\n\t\t} \n\n\t\tscheduleOptions.append( scheduleDesc );\n\n\t\tscheduleFields.append( this.createScheduleDateHTML() );\n\n\t\tscheduleFields.append( this.createScheduleTimeHTML() );\n\n\t\tscheduleOptions.append( scheduleFields );\n\t   \n\t\tscheduleOptions.append( this.createTimeZone() );\n\n\t\tscheduleOptions.append( this.scheduleNoticeHTML );\n\n\t\treturn scheduleOptions;\n\t}\n\n\tcreateDelayOptions() {\n\t\tlet delayOptions = $( `<div/>`, { 'class': 'delay-options' } );\n\n\t\tlet delayDesc = $( '<span/>', { 'class': 'async-mode__description' } ).text( UncannyAutomator.i18n.action.asyncActions.modal.delayDesc );\n\n\t\tlet delayFields = $( '<div/>', { 'class': 'delay-fields' } );\n\n\n\t\tthis.delayNumberHTML = this.createDelayNumberHTML();\n\n\t\tthis.delayUnitHTML = this.createDelayUnitHTML();\n\t\t\n\t\tlet delayFieldsDesc = $( '<span/>', { 'class': 'delay-fields__description' } ).text( UncannyAutomator.i18n.action.asyncActions.modal.after );\n\n\n\n\t\tdelayFields.append( this.delayNumberHTML );\n\n\t\tdelayFields.append( this.delayUnitHTML );\n\n\t\tdelayFields.append( delayFieldsDesc );\n\n\n\t\tdelayOptions.append( delayDesc );\n\n\t\tdelayOptions.append( delayFields );\n\n\n\t\treturn delayOptions;\n\t}\n\n\tcreateDelayNumberHTML() {\n\n\t\tthis.delayNumberField = new Field( 'int', {\n\t\t\titemType: 'action',\n\t\t\toptionCode: 'delay-number',\n\t\t\tisRequired: true,\n\t\t\tplaceholder: '10',\n\t\t\tsupportsTokens: false,\n\t\t\tcurrentValue: this.item.meta.async_delay_number ? this.item.meta.async_delay_number : ''\n\t\t},\n\t\ttrue,\n\t\tthis.validateDelayNumber );\n\n\t\t// Create form element\n\t\tconst $delayNumberField = this.delayNumberField.createFormElement();\n\n\t\t$delayNumberField.addClass( 'delay-fields__number' );\n\n\t\t// Init Codemirror\n\t\tthis.delayNumberField.initCodeMirror();\n\n\t\treturn $delayNumberField;\n\t}\n\n\tcreateDelayUnitHTML() {\n\n\t\tthis.delayUnitField = new Field( 'select', {\n\t\t\titemType: 'action',\n\t\t\toptionCode: 'delay-unit',\n\t\t\tcurrentValue: this.item.meta.async_delay_unit ? this.item.meta.async_delay_unit : 'minutes',\n\t\t\tcustomClass: 'hide-this',\n\t\t\tisRequired: true,\n\t\t\toptions: [\n\t\t\t\t{\n\t\t\t\t\tvalue: 'seconds',\n\t\t\t\t\ttext:  UncannyAutomator.i18n.action.asyncActions.modal.seconds\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 'minutes',\n\t\t\t\t\ttext:  UncannyAutomator.i18n.action.asyncActions.modal.minutes\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 'hours',\n\t\t\t\t\ttext:  UncannyAutomator.i18n.action.asyncActions.modal.hours\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 'days',\n\t\t\t\t\ttext:  UncannyAutomator.i18n.action.asyncActions.modal.days\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tvalue: 'years',\n\t\t\t\t\ttext:  UncannyAutomator.i18n.action.asyncActions.modal.years\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\n\t\treturn this.delayUnitField.createFormElement().addClass( 'delay-fields__unit' );\n\t}\n\n\tcreateScheduleDateHTML() {\n\t\t// Create value field\n\t\tthis.scheduleDateField = new Field( 'date', {\n\t\t\titemType: 'action',\n\t\t\toptionCode: 'schedule-date',\n\t\t\tisRequired: true,\n\t\t\tplaceholder: UncannyAutomator.i18n.action.asyncActions.modal.today,\n\t\t\tdateFormat: UncannyAutomator.i18n.action.asyncActions.modal.dateFormat,\n\t\t\tsupportsTokens: false,\n\t\t\tcurrentValue: this.item.meta.async_schedule_date ? this.item.meta.async_schedule_date : '',\n\t\t\tplaceholder: UncannyAutomator.i18n.format.date.selectDate\n\t\t});\n\n\t\t// Create form element\n\t\tconst $scheduleDateField = this.scheduleDateField.createFormElement();\n\n\t\t$scheduleDateField.addClass( 'schedule-fields__date' );\n\n\t\t// Init Codemirror\n\t\tthis.scheduleDateField.initCodeMirror();\n\n\t\treturn $scheduleDateField;\n\t}\n\n\tcreateScheduleTimeHTML() {\n\t\t// Create value field\n\t\tthis.scheduleTimeField = new Field( 'time', {\n\t\t\titemType: 'action',\n\t\t\toptionCode: 'schedule-time',\n\t\t\tisRequired: true,\n\t\t\tplaceholder:\"11:00 AM\",\n\t\t\ttimeFormat: \"h:i K\",\n\t\t\ttimeAltFormat: \"h:i K\",\n\t\t\tsupportsTokens: false,\n\t\t\tcurrentValue: this.item.meta.async_schedule_time ? this.item.meta.async_schedule_time : '',\n\t\t\tplaceholder: UncannyAutomator.i18n.format.date.selectTime\n\t\t});\n\n\t\t// Create form element\n\t\tconst $scheduleTimeField = this.scheduleTimeField.createFormElement();\n\n\t\t$scheduleTimeField.addClass( 'schedule-fields__time' )\n\n\t\t// Init Codemirror\n\t\tthis.scheduleTimeField.initCodeMirror();\n\n\t\treturn $scheduleTimeField;\n\t}\n\n\tvalidateForm() {\n\n\t\tlet asyncMode = this.asyncModeField.getValue();\n\n\t\tlet validSchedule;\n\t\t\n\t\tswitch ( asyncMode ) {\n\t\t\tcase 'schedule':\n\t\t\t\tvalidSchedule = this.validateScheduleFields();\n\t\t\t\tbreak;\n\t\t\tcase 'delay':\n\t\t\t\t\n\t\t\t\tvalidSchedule = this.delayNumberField.validate();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvalidSchedule = { isValid: false, message: UncannyAutomator.i18n.action.asyncActions.modal.validation.unsupported }\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( ! validSchedule.isValid ) {\n\t\t\treturn validSchedule;\n\t\t}\n\n\t\treturn { isValid: true };\n\t}\n\n\tvalidateScheduleFields() {\n\t\tlet validSchedule = this.scheduleDateField.validate();\n\n\t\tif ( validSchedule.isValid ) {\n\t\t\tvalidSchedule =  this.scheduleTimeField.validate();\n\t\t}\n\t   \n\t\treturn validSchedule;\n\t}\n\n\tvalidateDelayNumber( value, simulate_int ) {\n\n\t\tif ( value < 1 ) {\n\t\t\treturn { isValid: false, message: UncannyAutomator.i18n.action.asyncActions.modal.validation.positiveNumber }\n\t\t}   \n\n\t\treturn { isValid: true };\n\t}\n}\n\nexport default ItemHeaderAsync;\n","import $ from 'jquery';\n\nimport {\n\tgetDOMElements,\n\tisEmpty,\n\tisDefined\n} from '../common/utilities.js';\n\nimport ItemHeaderMenu     from '../item/action-menu.js';\nimport ItemHeaderIcon     from '../item/integration-icon.js';\nimport ItemHeaderTag      from '../item/integration-name.js';\nimport ItemHeaderAsync    from '../item/button-schedule.js';\nimport ItemHeaderSentence from '../item/sentence.js';\n\nclass MetaboxItems {\n\tconstructor( itemType, items ){\n\t\t$.each( items, ( itemId, item ) => {\n\t\t\tif ( itemType == item.itemType ){\n\t\t\t\t// Create item\n\t\t\t\tlet item = this.createItem( itemId );\n\n\t\t\t\t// Append to the metabox\n\t\t\t\tlet metabox = getDOMElements( 'metabox', {\n\t\t\t\t\ttype: itemType\n\t\t\t\t});\n\n\t\t\t\tmetabox.append( item );\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateItem( itemId ){\n\t\t// Get item data\n\t\tlet item = UncannyAutomator.recipe.items[ itemId ];\n\n\t\t// Create container\n\t\tlet container = $( '<div/>', {\n\t\t\t'class':   'item',\n\t\t\t'data-id': itemId\n\t\t});\n\n\t\tif ( item.isMissing ){\n\t\t\tcontainer.addClass( 'item--missing' );\n\t\t}\n\n\t\tif ( item.meta.async_mode ){\n\t\t\tcontainer.addClass( 'item--hasSchedule' );\n\t\t}\n\n\t\t// Replace tokens in the CSS\n\t\tif ( ! isEmpty( item.inlineCss ) ){\n\t\t\titem.inlineCss = item.inlineCss.replace( /{{item_id}}/g, itemId );\n\n\t\t\t// Add inline inlineCss\n\t\t\tcontainer.prepend( item.inlineCss );\n\t\t}\n\n\t\t// Create header\n\t\tlet header = this.createHeader(\n\t\t\titem.integrationCode,\n\t\t\titem.itemType,\n\t\t\titem.itemCode,\n\t\t\titemId,\n\t\t);\n\n\t\tlet notice = this.createNotice( item );\n\n\t\tcontainer.append( header );\n\t\tcontainer.append( notice );\n\n\t\tcontainer.on( 'automator:item:open', (e, open) => {\n\t\t\tlet asyncButtons = container.find('.item-async');\n\t\t\t$( asyncButtons[0] ).trigger( 'automator:asyncButton:maybeDisable', open );           \n\t\t})\n\n\t\treturn container;\n\t}\n\n\t/**\n\t * Creates item header\n\t * \n\t * @since 0.5\n\t *\n\t * @param {string}    integrationCode - The integration code\n\t * @param {string}    itemType - The item type: 'trigger', 'action' or 'closure'\n\t * @param {string}    itemCode - The code of the item\n\t * @param {int}       itemId - The ID of the item\n\t */\n\n\tcreateHeader( integrationCode, itemType, itemCode, itemId ){\n\t\tlet container = $( '<div/>' ),\n\t\t\ttitle     = $( '<div/>', { 'class': 'item-title uap-clear' });\n\n\t\t// Get item data\n\t\tlet item = UncannyAutomator.recipe.items[ itemId ];\n\n\t\t// If the item is missing remove the integrationCode\n\t\t// We don't want to show the integration icon\n\t\tif ( item.isMissing ){\n\t\t\tintegrationCode = null;\n\t\t}\n\t\t\n\t\tlet actions = new ItemHeaderMenu( itemType, integrationCode, itemCode, itemId );\n\t\tcontainer.append( actions );\n\n\t\tlet icon    = new ItemHeaderIcon( integrationCode );\n\t\tcontainer.append( icon );\n\n\t\t// Integration name for missing items\n\t\tlet integrationName = item.integrationName;\n\t\t\n\t\tlet itemTag = new ItemHeaderTag( integrationCode, integrationName );\n\t\ttitle.append( itemTag );\n\n\t\tlet titleSentence = new ItemHeaderSentence( itemType, integrationCode, itemCode, itemId );\n\t\ttitle.append( titleSentence );\n\t\tcontainer.append( title );\n\n\t\tlet itemContent = $( '<div/>', { 'class': 'item__content' });\n\t\tcontainer.append( itemContent );\n\n\t\tif ( itemType == 'action' && isDefined( UncannyAutomator.wp ) && UncannyAutomator.wp ) {\n\t\t\tlet asyncButton = new ItemHeaderAsync( itemType, integrationCode, itemCode, itemId, container );\n\n\t\t\tcontainer.append( asyncButton );\n\t\t}\n\n\t\treturn container;\n\t}\n\n\t/**\n\t * Create item notice\n\t *\n\t * @since 0.6\n\t *\n\t */\n\n\tcreateNotice( item ){\n\t\tlet container;\n\n\t\tif ( item.isMissing ){\n\t\t\tcontainer = $( '<div/>', { 'class': 'item-notice' });\n\t\t\tcontainer.text( UncannyAutomator.i18n.itemMissing );\n\t\t}\n\n\t\treturn container;\n\t}\n}\n\nexport default MetaboxItems;","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport { addUTMParameters, isEmpty, restCall } from '../common/utilities.js';\n\nimport RecipeNotices from '../recipe/notices.js';\n\nimport Field from '../field/field.js';\n\nclass Publish {\n\tconstructor() {\n\t\t// Get metabox element\n\t\tthis.elements = {\n\t\t\tmetabox: $( '#uo-automator-publish-metabox' ),\n\t\t\ttimesPerUser: {\n\t\t\t\teditLink: null,\n\t\t\t\thiddenBox: null,\n\t\t\t\tsaveButton: null,\n\t\t\t\tcancelButton: null,\n\t\t\t\tendPoint: 'recipe_completions_allowed',\n\t\t\t},\n\t\t\ttimesPerRecipe: {\n\t\t\t\teditLink: null,\n\t\t\t\thiddenBox: null,\n\t\t\t\tsaveButton: null,\n\t\t\t\tcancelButton: null,\n\t\t\t\tendPoint: 'recipe_max_completions_allowed',\n\t\t\t},\n\t\t\ttoggle: null,\n\t\t};\n\n\t\t// Create new metabox\n\t\tthis.createMetabox();\n\t}\n\n\tcreateMetabox() {\n\t\tconst container = $( '<div/>', { id: 'uap-publish-metabox' } ),\n\t\t\tcontent = $( '<div/>', { class: 'metabox__content' } ),\n\t\t\tfooter = $( '<div/>', { class: 'metabox__footer' } );\n\n\t\t// Check if we have to add the times per user row\n\t\tif ( UncannyAutomator.recipe.type != 'anonymous' ) {\n\t\t\t// Times per user row\n\t\t\tconst timesRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\t\ttimesRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\t\ttimesRowIconBox = $( '<span/>', { class: 'publish-row__icon' } ),\n\t\t\t\ttimesRowIcon = $( '<i/>', { class: 'uo-icon uo-icon--repeat-alt' } ),\n\t\t\t\ttimesRowName = $( '<span/>', { class: 'publish-row__name' } ).text(\n\t\t\t\t\tUncannyAutomator.i18n.publish.timesPerUser\n\t\t\t\t);\n\n\t\t\t// Change value of numbers of times from -1 to empty\n\t\t\tUncannyAutomator.recipe.publish.timesPerUser =\n\t\t\t\tUncannyAutomator.recipe.publish.timesPerUser == -1 ? '' : UncannyAutomator.recipe.publish.timesPerUser;\n\t\t\tconst timesValue = isEmpty( UncannyAutomator.recipe.publish.timesPerUser )\n\t\t\t\t? UncannyAutomator.i18n.publish.unlimited\n\t\t\t\t: UncannyAutomator.recipe.publish.timesPerUser;\n\n\t\t\tconst timesRowValue = $( '<span/>', { class: 'publish-row__value' } ).text( timesValue ),\n\t\t\t\ttimesRowEdit = $( '<span/>', { class: 'publish-row__edit' } ).text( UncannyAutomator.i18n.edit ),\n\t\t\t\ttimesRowHidden = $( '<div/>', { class: 'publish-row__hidden' } ),\n\t\t\t\ttimesRowHiddenBox = $( '<div/>', { class: 'publish-row__settings' } );\n\n\t\t\tthis.elements.timesPerUser.editLink = timesRowEdit;\n\t\t\tthis.elements.timesPerUser.hiddenBox = timesRowHidden;\n\n\t\t\tconst timesRowField = new Field(\n\t\t\t\t'int',\n\t\t\t\t{\n\t\t\t\t\tcurrentValue: UncannyAutomator.recipe.publish.timesPerUser,\n\t\t\t\t\tdescription: UncannyAutomator.i18n.publish.leaveEmpty,\n\t\t\t\t\tplaceholder: UncannyAutomator.i18n.publish.unlimited,\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t\t( value ) => {\n\t\t\t\t\t// Custom validation function\n\t\t\t\t\t// Create response object\n\t\t\t\t\tconst response = {\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t\tmessage: '',\n\t\t\t\t\t};\n\n\t\t\t\t\t// Check if the number is 1 or bigger\n\t\t\t\t\tif ( value >= 1 ) {\n\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresponse.message = UncannyAutomator.i18n.publish.oneOrBigger;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Return response\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.timesField = timesRowField;\n\n\t\t\tconst timesRowButtons = $( '<div/>', { class: 'publish-row__buttons' } ),\n\t\t\t\ttimesRowSaveBtn = $( '<div/>', { class: 'uap-btn uap-btn--primary' } ).text(\n\t\t\t\t\tUncannyAutomator.i18n.save\n\t\t\t\t),\n\t\t\t\ttimesRowCancelBtn = $( '<div/>', { class: 'uap-btn uap-btn--secondary' } ).text(\n\t\t\t\t\tUncannyAutomator.i18n.cancel\n\t\t\t\t);\n\n\t\t\tthis.elements.timesPerUser.saveButton = timesRowSaveBtn;\n\t\t\tthis.elements.timesPerUser.cancelButton = timesRowCancelBtn;\n\n\t\t\ttimesRowButtons.append( timesRowSaveBtn );\n\t\t\ttimesRowButtons.append( timesRowCancelBtn );\n\n\t\t\ttimesRowHiddenBox.append( timesRowField.getFormElement() );\n\t\t\ttimesRowHiddenBox.append( timesRowButtons );\n\t\t\ttimesRowHidden.append( timesRowHiddenBox );\n\n\t\t\ttimesRowIconBox.append( timesRowIcon );\n\t\t\ttimesRowVisible.append( timesRowIconBox );\n\t\t\ttimesRowVisible.append( timesRowName );\n\t\t\ttimesRowVisible.append( timesRowValue );\n\t\t\ttimesRowVisible.append( timesRowEdit );\n\n\t\t\ttimesRow.append( timesRowVisible );\n\t\t\ttimesRow.append( timesRowHidden );\n\n\t\t\tcontent.append( timesRow );\n\t\t}\n\n\t\tconst timesPerRecipe = this.timesPerRecipe();\n\t\tcontent.append( timesPerRecipe );\n\n\t\t// Recipe type\n\t\tconst recipeTypeRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\trecipeTypeRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\trecipeTypeRowIconBox = $( '<span/>', { class: 'publish-row__icon' } ),\n\t\t\trecipeTypeRowIcon = $( '<i/>', { class: 'uo-icon uo-icon--user-astronaut' } ),\n\t\t\trecipeTypeRowName = $( '<span/>', { class: 'publish-row__name' } ).text(\n\t\t\t\tUncannyAutomator.i18n.publish.recipeType\n\t\t\t),\n\t\t\trecipeTypeRowValue = $( '<span/>', { class: 'publish-row__value' } ),\n\t\t\trecipeTypeLearnMore = $( `\n\t\t\t\t<a href=\"${ addUTMParameters( 'https://automatorplugin.com/knowledge-base/creating-a-recipe/', {\n\t\t\t\t\tmedium: 'publish_metabox',\n\t\t\t\t\tcontent: 'recipe_type_question_icon',\n\t\t\t\t} ) }\" class=\"publish-row__learn-more\" target=\"_blank\"><span class=\"uo-icon uo-icon--question-circle\"></span></a>\n\t\t\t` );\n\n\t\tif ( UncannyAutomator.recipe.type == 'user' ) {\n\t\t\trecipeTypeRowValue.text( UncannyAutomator.i18n.recipeType.userRecipeName );\n\t\t}\n\n\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ) {\n\t\t\trecipeTypeRowValue.text( UncannyAutomator.i18n.recipeType.everyoneRecipeName );\n\t\t}\n\n\t\trecipeTypeRowIconBox.append( recipeTypeRowIcon );\n\t\trecipeTypeRowVisible.append( recipeTypeRowIconBox );\n\t\trecipeTypeRowVisible.append( recipeTypeRowName );\n\t\trecipeTypeRowVisible.append( recipeTypeRowValue );\n\t\trecipeTypeRowVisible.append( recipeTypeLearnMore );\n\t\trecipeTypeRow.append( recipeTypeRowVisible );\n\n\t\tcontent.append( recipeTypeRow );\n\n\t\t// Created on row\n\t\tconst createdRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\tcreatedRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\tcreatedRowIconBox = $( '<span/>', { class: 'publish-row__icon' } ),\n\t\t\tcreatedRowIcon = $( '<i/>', { class: 'uo-icon uo-icon--calendar-alt' } ),\n\t\t\tcreatedRowName = $( '<span/>', { class: 'publish-row__name' } ).text(\n\t\t\t\tUncannyAutomator.i18n.publish.createdOn\n\t\t\t),\n\t\t\tcreatedRowValue = $( '<span/>', { class: 'publish-row__value' } ).text(\n\t\t\t\tUncannyAutomator.recipe.publish.createdOn\n\t\t\t);\n\n\t\tcreatedRowIconBox.append( createdRowIcon );\n\t\tcreatedRowVisible.append( createdRowIconBox );\n\t\tcreatedRowVisible.append( createdRowName );\n\t\tcreatedRowVisible.append( createdRowValue );\n\t\tcreatedRow.append( createdRowVisible );\n\n\t\tcontent.append( createdRow );\n\n\t\t// Recipe runs row\n\t\tlet recipeRunTimeVal = UncannyAutomator.recipe.publish.recipeRunTimes;\n\t\tlet recipeRunTimeUrlVal = $( '<a/>', {\n\t\t\tclass: 'publish-row__recipe-runs',\n\t\t\ttarget: '_blank',\n\t\t\thref: UncannyAutomator.recipe.publish.recipeRunTimesUrl.replace( /&amp;/g, '&' ),\n\t\t} ).text( UncannyAutomator.recipe.publish.recipeRunTimesViewLogs );\n\n\t\tconst recipeRunTimesRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\trecipeRunTimesRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\trecipeRunTimesRowIconBox = $( '<span/>', { class: 'publish-row__icon' } ),\n\t\t\trecipeRunTimesRowIcon = $( '<i/>', { class: 'uo-icon uo-icon--repeat-alt' } ),\n\t\t\trecipeRunTimesRowName = $( '<span/>', { class: 'publish-row__name' } ).text(\n\t\t\t\tUncannyAutomator.i18n.publish.recipeRunTimes\n\t\t\t);\n\n\n\t\trecipeRunTimesRowIconBox.append( recipeRunTimesRowIcon );\n\t\trecipeRunTimesRowVisible.append( recipeRunTimesRowIconBox );\n\t\trecipeRunTimesRowVisible.append( recipeRunTimesRowName );\n\t\trecipeRunTimesRowVisible.append( $( '<span/>', { class: 'publish-row__value' } ).text( recipeRunTimeVal ) );\n\t\tif( recipeRunTimeVal > 0 ){\n\t\t\trecipeRunTimesRowVisible.append( recipeRunTimeUrlVal );\n\t\t}\n\t\trecipeRunTimesRow.append( recipeRunTimesRowVisible );\n\n\t\tcontent.append( recipeRunTimesRow );\n\n\t\t// Copy/Duplicate Recipe\n\t\tconst copyRecipeRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\tcopyRecipeRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\tcopyRecipeRowName = $( '<a/>', {\n\t\t\t\tclass: 'publish-row__copy-to-draft button button-secondary',\n\t\t\t\thref: UncannyAutomator.recipe.publish.copyToDraft.replace( /&amp;/g, '&' ),\n\t\t\t} ).text( UncannyAutomator.i18n.publish.copyRecipe );\n\n\t\tcopyRecipeRowVisible.append( copyRecipeRowName );\n\t\tcopyRecipeRow.append( copyRecipeRowVisible );\n\n\t\tcontent.append( copyRecipeRow );\n\n\t\t// Footer\n\n\t\tconst footerRow = $( '<div/>', { class: 'publish-footer__row uap-clear' } ),\n\t\t\tfooterRowLeft = $( '<div/>', { class: 'publish-footer__left' } ),\n\t\t\tfooterMoveToDraft = $( '<a/>', {\n\t\t\t\tclass: 'publish-footer__move-to-draft',\n\t\t\t\thref: UncannyAutomator.recipe.publish.moveToTrash.replace( /&amp;/g, '&' ),\n\t\t\t} ).text( UncannyAutomator.i18n.proOnly.moveToTrash ),\n\t\t\tfooterRowRight = $( '<div/>', { class: 'publish-footer__right' } );\n\n\t\tconst recipeStatusToggle = new Field( 'checkbox', {\n\t\t\tcolor: 'gutenberg',\n\t\t\talign: 'right',\n\t\t\ttoggle: {\n\t\t\t\ton: UncannyAutomator.i18n.status.liveRecipe,\n\t\t\t\toff: UncannyAutomator.i18n.status.draftRecipe,\n\t\t\t},\n\t\t\tcurrentValue: UncannyAutomator.recipe.isLive,\n\t\t} );\n\n\t\t// Save toggle Field in main object\n\t\tUncannyAutomator.recipe.publish.statusToggle = recipeStatusToggle;\n\n\t\tconst recipeStatusToggleDOM = recipeStatusToggle.getFormElement();\n\t\tthis.recipeStatusToggle = recipeStatusToggle;\n\n\t\tthis.elements.toggle = recipeStatusToggleDOM;\n\n\t\tfooterRowLeft.append( footerMoveToDraft );\n\t\tfooterRowRight.append( recipeStatusToggleDOM );\n\t\tfooterRow.append( footerRowLeft );\n\t\tfooterRow.append( footerRowRight );\n\n\t\tfooter.append( footerRow );\n\n\t\t// Append main elements to the metabox\n\t\tcontainer.append( content );\n\t\tcontainer.append( footer );\n\n\t\t// Render metabox\n\t\tthis.elements.metabox.html( container );\n\n\t\t// Render errors\n\t\tnew RecipeNotices();\n\n\t\t// Bind\n\t\tthis.bind();\n\n\t\t// Validate status\n\t\tthis.validateStatus();\n\t}\n\n\ttimesPerRecipe() {\n\t\t// Times per recipe row\n\t\tconst timesRecipeRow = $( '<div/>', { class: 'publish-row' } ),\n\t\t\ttimesRecipeRowVisible = $( '<div/>', { class: 'publish-row__visible' } ),\n\t\t\ttimesRecipeRowIconBox = $( '<span/>', { class: 'publish-row__icon' } ),\n\t\t\ttimesRecipeRowIcon = $( '<i/>', { class: 'uo-icon uo-icon--stopwatch-20' } ),\n\t\t\ttimesRecipeRowName = $( '<span/>', { class: 'publish-row__name' } ).text(\n\t\t\t\tUncannyAutomator.i18n.publish.timesPerRecipe\n\t\t\t);\n\n\t\t// Change value of numbers of times from -1 to empty\n\t\tUncannyAutomator.recipe.publish.timesPerRecipe =\n\t\t\tUncannyAutomator.recipe.publish.timesPerRecipe == -1 ? '' : UncannyAutomator.recipe.publish.timesPerRecipe;\n\t\tconst timesRecipeValue = isEmpty( UncannyAutomator.recipe.publish.timesPerRecipe )\n\t\t\t? UncannyAutomator.i18n.publish.unlimited\n\t\t\t: UncannyAutomator.recipe.publish.timesPerRecipe;\n\n\t\tconst timesRecipeRowValue = $( '<span/>', { class: 'publish-row__value' } ).text( timesRecipeValue ),\n\t\t\ttimesRecipeRowEdit = $( '<span/>', { class: 'publish-row__edit' } ).text( UncannyAutomator.i18n.edit ),\n\t\t\ttimesRecipeRowHidden = $( '<div/>', { class: 'publish-row__hidden' } ),\n\t\t\ttimesRecipeRowHiddenBox = $( '<div/>', { class: 'publish-row__settings' } );\n\n\t\tthis.elements.timesPerRecipe.editLink = timesRecipeRowEdit;\n\t\tthis.elements.timesPerRecipe.hiddenBox = timesRecipeRowHidden;\n\n\t\tconst timesRecipeRowField = new Field(\n\t\t\t'int',\n\t\t\t{\n\t\t\t\tcurrentValue: UncannyAutomator.recipe.publish.timesPerRecipe,\n\t\t\t\tdescription: UncannyAutomator.i18n.publish.leaveEmpty,\n\t\t\t\tplaceholder: UncannyAutomator.i18n.publish.unlimited,\n\t\t\t},\n\t\t\ttrue,\n\t\t\t( value ) => {\n\t\t\t\t// Custom validation function\n\t\t\t\t// Create response object\n\t\t\t\tconst response = {\n\t\t\t\t\tisValid: false,\n\t\t\t\t\tmessage: '',\n\t\t\t\t};\n\n\t\t\t\t// Check if the number is 1 or bigger\n\t\t\t\tif ( value >= 1 ) {\n\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t} else {\n\t\t\t\t\tresponse.message = UncannyAutomator.i18n.publish.oneOrBigger;\n\t\t\t\t}\n\n\t\t\t\t// Return response\n\t\t\t\treturn response;\n\t\t\t}\n\t\t);\n\n\t\tthis.timesRecipeField = timesRecipeRowField;\n\n\t\tconst timesRecipeRowButtons = $( '<div/>', { class: 'publish-row__buttons' } ),\n\t\t\ttimesRecipeRowSaveBtn = $( '<div/>', { class: 'uap-btn uap-btn--primary' } ).text(\n\t\t\t\tUncannyAutomator.i18n.save\n\t\t\t),\n\t\t\ttimesRecipeRowCancelBtn = $( '<div/>', { class: 'uap-btn uap-btn--secondary' } ).text(\n\t\t\t\tUncannyAutomator.i18n.cancel\n\t\t\t);\n\n\t\tthis.elements.timesPerRecipe.saveButton = timesRecipeRowSaveBtn;\n\t\tthis.elements.timesPerRecipe.cancelButton = timesRecipeRowCancelBtn;\n\n\t\ttimesRecipeRowButtons.append( timesRecipeRowSaveBtn );\n\t\ttimesRecipeRowButtons.append( timesRecipeRowCancelBtn );\n\n\t\ttimesRecipeRowHiddenBox.append( timesRecipeRowField.getFormElement() );\n\t\ttimesRecipeRowHiddenBox.append( timesRecipeRowButtons );\n\t\ttimesRecipeRowHidden.append( timesRecipeRowHiddenBox );\n\n\t\ttimesRecipeRowIconBox.append( timesRecipeRowIcon );\n\t\ttimesRecipeRowVisible.append( timesRecipeRowIconBox );\n\t\ttimesRecipeRowVisible.append( timesRecipeRowName );\n\t\ttimesRecipeRowVisible.append( timesRecipeRowValue );\n\t\ttimesRecipeRowVisible.append( timesRecipeRowEdit );\n\n\t\ttimesRecipeRow.append( timesRecipeRowVisible );\n\t\ttimesRecipeRow.append( timesRecipeRowHidden );\n\n\t\treturn timesRecipeRow;\n\t}\n\n\tvalidateStatus() {\n\t\t// We're going to use this method to check if the recipe is live but it's invalid\n\t\tif ( UncannyAutomator.recipe.isLive && ! UncannyAutomator.recipe.isValid ) {\n\t\t\t// Make Draft\n\t\t\tUncannyAutomator.recipe.publish.statusToggle.setValue( false );\n\t\t}\n\t}\n\n\tvalidateTimesPerFields( $element, $fieldValue, $timeField ) {\n\t\t// Times per user, click on \"Edit\"\n\t\t$element.editLink.on( 'click', () => {\n\t\t\t// Slide toggle\n\t\t\t$element.hiddenBox.slideToggle( 300 );\n\t\t} );\n\n\t\t// Times per user, click on \"Cancel\"\n\t\t$element.cancelButton.on( 'click', () => {\n\t\t\t// Slide toggle\n\t\t\t$element.hiddenBox.slideToggle( 300, () => {\n\t\t\t\t// Reset UI\n\t\t\t\tnew Publish();\n\t\t\t} );\n\t\t} );\n\n\t\t// Timer per user, click on \"Save\"\n\t\t$element.saveButton.on( 'click', () => {\n\t\t\t// Validate input\n\t\t\tconst validation = $timeField.validate();\n\n\t\t\t// Check if it's valid. Otherwise do nothing. Field.js will show an error\n\t\t\tif ( validation.isValid ) {\n\t\t\t\t// Add loading class to save button\n\t\t\t\t$element.saveButton.addClass( 'uap-btn--loading uap-btn--disabled' );\n\n\t\t\t\t// Get value. We have to check if it's empty and change it to -1\n\t\t\t\tlet numberOfTimes = $timeField.getValue();\n\n\t\t\t\tif ( isEmpty( numberOfTimes ) ) {\n\t\t\t\t\tnumberOfTimes = -1;\n\t\t\t\t}\n\n\t\t\t\trestCall(\n\t\t\t\t\t$element.endPoint,\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\tpost_ID: UncannyAutomator.recipe.id,\n\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\trecipe_completions_allowed: numberOfTimes,\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\t// Update JS object\n\t\t\t\t\t\tif ( $element.endPoint == 'recipe_completions_allowed' ) {\n\t\t\t\t\t\t\tUncannyAutomator.recipe.publish.timesPerUser = numberOfTimes;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tUncannyAutomator.recipe.publish.timesPerRecipe = numberOfTimes;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// $fieldValue = numberOfTimes;\n\t\t\t\t\t\t// Slide toggle fields container and refresh the Publish UI\n\t\t\t\t\t\t$element.hiddenBox.slideToggle( 300, () => {\n\t\t\t\t\t\t\t// Reset UI\n\t\t\t\t\t\t\tnew Publish();\n\t\t\t\t\t\t} );\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.error( \"Couldn't save times per user\" );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Revert changes\n\t\t\t\t\t\t$timeField.setValue( $fieldValue );\n\n\t\t\t\t\t\t// Remove the loading class to save button\n\t\t\t\t\t\t$element.saveButton.removeClass( 'uap-btn--loading uap-btn--disabled' );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t\t// Get field element and bind 'keyup'\n\t\t$timeField.getField().on( 'keyup', ( event ) => {\n\t\t\t// Check if it's an enter\n\t\t\tif ( event.keyCode == 13 ) {\n\t\t\t\t// Trigger a click on the Save Button\n\t\t\t\t$element.saveButton.trigger( 'click' );\n\t\t\t}\n\t\t} );\n\t}\n\n\tbind() {\n\t\t// Check if we have to add the event listeners to the \"times per user\" row\n\t\tif ( UncannyAutomator.recipe.type != 'anonymous' ) {\n\t\t\t// Times per user, click on \"Edit\"\n\t\t\tthis.validateTimesPerFields(\n\t\t\t\tthis.elements.timesPerUser,\n\t\t\t\tUncannyAutomator.recipe.publish.timesPerUser,\n\t\t\t\tthis.timesField\n\t\t\t);\n\t\t}\n\n\t\t// Validate Recipe max times\n\t\tthis.validateTimesPerFields(\n\t\t\tthis.elements.timesPerRecipe,\n\t\t\tUncannyAutomator.recipe.publish.timesPerRecipe,\n\t\t\tthis.timesRecipeField\n\t\t);\n\t\t// Status change\n\t\tthis.elements.toggle.on( 'automator:field:change', () => {\n\t\t\t// Set loading status\n\t\t\tthis.recipeStatusToggle.startLoadingAnimation();\n\n\t\t\t// Set post status\n\t\t\tconst makeLive = this.recipeStatusToggle.getValue(),\n\t\t\t\tpostStatus = makeLive ? 'publish' : 'draft';\n\n\t\t\t// Check if can make it live\n\t\t\t// const recipeTriggers = itemsObject( 'get', {\n\t\t\t// \t\tfilter: {\n\t\t\t// \t\t\titemType: 'trigger',\n\t\t\t// \t\t},\n\t\t\t// \t} );\n\n\t\t\tconst canMakeLive = true;\n\n\t\t\t// Check if the user is trying to make the recipe live\n\t\t\tif ( canMakeLive && ( ! makeLive || ( makeLive && UncannyAutomator.recipe.isValid ) ) ) {\n\t\t\t\trestCall(\n\t\t\t\t\t'change_post_status',\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\tpost_ID: UncannyAutomator.recipe.id,\n\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\tpost_status: postStatus,\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\t// Update main object\n\t\t\t\t\t\tUncannyAutomator.recipe.isLive = makeLive;\n\n\t\t\t\t\t\t// Reset the UI\n\t\t\t\t\t\tnew Publish();\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\t\tconsole.error( \"Couldn't set the recipe status\" );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Revert user change\n\t\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t\t// Stop loading animation\n\t\t\t\t\t\t\tthis.recipeStatusToggle.stopLoadingAnimation();\n\n\t\t\t\t\t\t\t// Revert value\n\t\t\t\t\t\t\tthis.recipeStatusToggle.setValue( false, false );\n\t\t\t\t\t\t}, 1000 );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tif ( ! canMakeLive ) {\n\t\t\t\t\t// Set error message\n\t\t\t\t\tUncannyAutomator.recipe.message.error = vsprintf( UncannyAutomator.i18n.proOnly.proToPublish, [\n\t\t\t\t\t\tUncannyAutomator.i18n.uncannyAutomatorPro,\n\t\t\t\t\t] );\n\t\t\t\t}\n\n\t\t\t\t// Set error mode\n\t\t\t\tUncannyAutomator.recipe.errorMode = true;\n\n\t\t\t\t// Show error\n\t\t\t\tnew RecipeNotices();\n\n\t\t\t\t// Revert user change\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t// Stop loading animation\n\t\t\t\t\tthis.recipeStatusToggle.stopLoadingAnimation();\n\n\t\t\t\t\t// Revert value\n\t\t\t\t\tthis.recipeStatusToggle.setValue( false, false );\n\t\t\t\t}, 1000 );\n\t\t\t}\n\t\t} );\n\t}\n}\n\nexport default Publish;\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { isEmpty } from '../common/utilities.js';\n\nclass RecipeNotices {\n\tconstructor() {\n\t\t// Get main element\n\t\tthis.elements = {\n\t\t\tcontainer: $( '#uo-uap-notices' ),\n\t\t};\n\n\t\t// Check if the container exists\n\t\t// If not, then create it\n\t\tif ( this.elements.container.length == 0 ) {\n\t\t\tthis.createContainer();\n\t\t\tthis.elements.container = $( '#uo-uap-notices' );\n\t\t}\n\n\t\t// Empty the container\n\t\tthis.emptyContainer();\n\n\t\t// Create warning\n\t\tthis.createWarning();\n\n\t\t// Check if error mode is enabled\n\t\tif ( UncannyAutomator.recipe.errorMode ) {\n\t\t\t// Create error\n\t\t\tthis.createError();\n\t\t}\n\t}\n\n\temptyContainer() {\n\t\tthis.elements.container.empty();\n\t}\n\n\tcreateContainer() {\n\t\t/* Create notice containers */\n\t\tconst noticeContainer = $( '<div/>', { id: 'uo-uap-notices', class: 'uap' } );\n\t\t$( '#uap-publish-metabox' ).prepend( noticeContainer );\n\t}\n\n\tcreateError() {\n\t\t// Check if we have to create the notice\n\t\tif ( ! isEmpty( UncannyAutomator.recipe.message.error ) ) {\n\t\t\t// Create error container\n\t\t\tconst notice = $( '<div/>', { class: 'uo-notice uo-notice--error' } ).text(\n\t\t\t\tUncannyAutomator.recipe.message.error\n\t\t\t);\n\n\t\t\tthis.elements.container.append( notice );\n\t\t}\n\t}\n\n\tcreateWarning() {\n\t\t// Check if we have to create the notice\n\t\tif ( ! isEmpty( UncannyAutomator.recipe.message.warning ) ) {\n\t\t\tconst notice = $( '<div/>', { class: 'uo-notice uo-notice--warning' } ).text(\n\t\t\t\tUncannyAutomator.recipe.message.warning\n\t\t\t);\n\n\t\t\tthis.elements.container.append( notice );\n\t\t}\n\t}\n}\n\nexport default RecipeNotices;\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { restCall, isEmpty } from '../common/utilities.js';\n\nclass RecipeTypeSelector {\n\tconstructor( doWhenReady ) {\n\t\t// Save callbacks\n\t\tthis.doWhenReady = doWhenReady;\n\n\t\t// Render\n\t\tthis.render();\n\n\t\t// Get elements\n\t\tthis.getElements();\n\n\t\t// Listen to the form submission\n\t\tthis.listenSubmission();\n\t}\n\n\trender() {\n\t\t// Create HTML\n\t\tconst $recipeTypeSelector = $( `\n\t\t\t<div class=\"uap\">\n\t\t\t\t<div id=\"uap-type-selector\" class=\"uap-type-selector\">\n\t\t\t\t\t<div class=\"uap-type-selector__box\">\n\t\t\t\t\t\t<form id=\"uap-type-selector-form\" class=\"uap-type-selector__form\">\n\t\t\t\t\t\t\t<div class=\"uap-type-selector__title\">\n\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.title }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"uap-type-selector__content\">\n\t\t\t\t\t\t\t\t<div class=\"uap-type-selector__types\">\n\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type uap-type-selector-type--user\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"uap-type-selector-type__hidden-field\" type=\"radio\" name=\"uap-recipe-type\" value=\"user\" id=\"uap-recipe-type-user\">\n\t\t\t\t\t\t\t\t\t\t<label class=\"uap-type-selector-type__label\" for=\"uap-recipe-type-user\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__container\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__icon-img uap-type-selector-type__icon-img--user\"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__title\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.userRecipeName }\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__description\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.userRecipeDescription }\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type uap-type-selector-type--anonymous\">\n\t\t\t\t\t\t\t\t\t\t<input class=\"uap-type-selector-type__hidden-field\" type=\"radio\" name=\"uap-recipe-type\" value=\"anonymous\" id=\"uap-recipe-type-anonymous\">\n\t\t\t\t\t\t\t\t\t\t<label class=\"uap-type-selector-type__label\" for=\"uap-recipe-type-anonymous\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__container\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__icon-img uap-type-selector-type__icon-img--anonymous\"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__title\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.everyoneRecipeName }\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"uap-type-selector-type__description\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.everyoneRecipeDescription }\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"uap-type-selector__warning\">\n\t\t\t\t\t\t\t\t${ UncannyAutomator.i18n.recipeType.cantChangeLaterNotice }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"uap-type-selector__buttons\">\n\t\t\t\t\t\t\t\t<button type=\"submit\" id=\"uap-type-selector-submit-button\" class=\"uap-btn uap-btn--primary\">${ UncannyAutomator.i18n.confirm }</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Append container to the body\n\t\t$( 'body' ).append( $recipeTypeSelector );\n\t}\n\n\tgetElements() {\n\t\t// Get elements\n\t\tthis.$elements = {\n\t\t\tcontainer: $( '#uap-type-selector' ),\n\t\t\tform: $( '#uap-type-selector-form' ),\n\t\t\twarning: $( '#uap-type-selector .uap-type-selector__warning' ),\n\t\t\tsubmitButton: $( '#uap-type-selector-submit-button' ),\n\t\t};\n\t}\n\n\tlistenSubmission() {\n\t\t// Listen submission\n\t\tthis.$elements.form.on( 'submit', ( event ) => {\n\t\t\t// Prevent default\n\t\t\tevent.preventDefault();\n\n\t\t\t// Get recipe type\n\t\t\tconst recipeType = this.$elements.form.find( 'input[name=\"uap-recipe-type\"]:checked' ).val();\n\n\t\t\t// Check if it's defined and it's a valid value\n\t\t\tif ( ! isEmpty( recipeType ) ) {\n\t\t\t\t// Check if it has a valid value\n\t\t\t\tif ( [ 'user', 'anonymous' ].includes( recipeType ) ) {\n\t\t\t\t\t// Save recipe type\n\t\t\t\t\tthis.saveRecipeType( recipeType );\n\t\t\t\t} else {\n\t\t\t\t\t// The user is trying save a different value\n\t\t\t\t\tthis.showError( UncannyAutomator.i18n.recipeType.errorTryingToSaveOtherValue );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// The user didn't select an option\n\t\t\t\tthis.showError( UncannyAutomator.i18n.recipeType.errorDidNotSelectType );\n\t\t\t}\n\t\t} );\n\t}\n\n\tsaveRecipeType( recipeType ) {\n\t\t// Define endpoint\n\t\tconst endpoint = 'change_post_recipe_type';\n\n\t\t// Define data to send\n\t\tconst data = {\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tpost_ID: UncannyAutomator.recipe.id,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\trecipe_type: recipeType,\n\t\t};\n\n\t\t// Add loading animation to the button\n\t\tthis.$elements.submitButton.addClass( 'uap-btn--loading uap-btn--disabled' );\n\n\t\t// Do a REST call to save the recipe type\n\t\trestCall(\n\t\t\tendpoint,\n\t\t\tdata,\n\t\t\t( response ) => {\n\t\t\t\t// Check if it was successful\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t// Remove container\n\t\t\t\t\t// We should render everything again and\n\t\t\t\t\t// add a conditional to not render the elements\n\t\t\t\t\tthis.$elements.container.remove();\n\n\t\t\t\t\t// Save in main object\n\t\t\t\t\tUncannyAutomator.recipe.type = recipeType;\n\n\t\t\t\t\t// Get the container of the title\n\t\t\t\t\tconst $triggersMetaboxTitle = $( '#uo-recipe-triggers-meta-box-ui h2.hndle.ui-sortable-handle' );\n\n\t\t\t\t\t// Create the title of triggers metabox\n\t\t\t\t\tlet triggersMetaboxTitle = UncannyAutomator.i18n.trigger.userTriggers;\n\t\t\t\t\tif ( UncannyAutomator.recipe.type == 'anonymous' ) {\n\t\t\t\t\t\ttriggersMetaboxTitle = UncannyAutomator.i18n.trigger.everyoneTrigger;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Change text the title container\n\t\t\t\t\t$triggersMetaboxTitle.text( triggersMetaboxTitle );\n\n\t\t\t\t\t// Call callbacks\n\t\t\t\t\tthis.doWhenReady( recipeType );\n\t\t\t\t} else {\n\t\t\t\t\t// Show error\n\t\t\t\t\tthis.showError( UncannyAutomator.i18n.recipeType.errorSomethingWentWrong );\n\t\t\t\t}\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( \"Couldn't save the recipe type\" );\n\t\t\t\t}\n\n\t\t\t\t// Remove loading class\n\t\t\t\tthis.$elements.submitButton.removeClass( 'uap-btn--loading uap-btn--disabled' );\n\n\t\t\t\t// Show error message\n\t\t\t\tthis.showError( UncannyAutomator.i18n.recipeType.errorSomethingWentWrong );\n\t\t\t}\n\t\t);\n\t}\n\n\tshowError( errorMessage ) {\n\t\t// Create error\n\t\tconst $error = $( `\n\t\t\t<div class=\"uap-type-selector__error\">\n\t\t\t\t${ errorMessage }\n\t\t\t</div>\n\t\t` );\n\n\t\t// Check if the container already has an error container\n\t\tconst $oldErrorContainer = this.$elements.container.find( '.uap-type-selector__error' );\n\t\tif ( $oldErrorContainer.length > 0 ) {\n\t\t\t$oldErrorContainer.remove();\n\t\t}\n\n\t\t// Add error container\n\t\t$error.insertAfter( this.$elements.warning );\n\n\t\t// Add class to shake\n\t\tsetTimeout( () => {\n\t\t\t$error.addClass( 'uap-type-selector__error--shake' );\n\t\t}, 10 );\n\t}\n}\n\nexport default RecipeTypeSelector;\n","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\titemsObject,\n\tgetGlobalItem,\n\tparseStringWithTokens,\n\tisEmpty,\n\tisDefined,\n\tisObject\n} from '../common/utilities.js';\n\nexport default class Tokens {\n\tconstructor( itemType, fieldType = 'text', options = {} ){\n\t\t// Save data\n\t\tthis.saveData( itemType, fieldType, options );\n\n\t\t// Get data\n\t\tthis.getData();\n\t}\n\n\tsaveData( itemType, fieldType, options ){\n\t\tthis.itemType  = itemType;\n\t\tthis.fieldType = fieldType;\n\n\t\tthis.options = Object.assign( {\n\t\t\tincludeGroupName:   true,\n\t\t\tincludeGroupIcon:   true,\n\t\t\tincludeGroupTokens: true,\n\t\t}, options );\n\n\t\tthis.tokensRegEx = new RegExp( /\\{\\{(.*?)\\}\\}/gm );\n\n\t\t// Exclude tokens inside HTML attributes\n\t\t// <a href=\"{{a}}\">{{b}}</a> will return only {{b}}\n\t\tthis.tokensRegExNoAttributes = new RegExp( /[^\\=\"]\\{\\{(.*?)\\}\\}[^\\\"]/gm );\n\n\t\tthis.tokensThatRequireUser = [];\n\t}\n\n\tgetData(){\n\t\t// Get all tokens\n\t\tthis.tokens = this.getAllTokens();\n\t}\n\n\t/**\n\t * Get all the tokens that can be used a given item\n\t * These are also going to be filtered by the fieldType\n\t *\n\t * @since 3.0\n\t * \n\t * @return Array  Groups of tokens\n\t */\n\tgetAllTokens(){\n\t\tlet tokensList = [];\n\n\t\t// Get the common tokens\n\t\tconst commonTokens = this.getCommonTokens();\n\t\t// Add tokens to the main array\n\t\tif ( commonTokens.tokens.length > 0 ){\n\t\t\ttokensList.push( commonTokens );\n\t\t}\n\n\t\t// Get the advanced tokens\n\t\tconst advancedTokens = this.getAdvancedTokens();\n\t\t// Add tokens to the main array\n\t\tif ( advancedTokens.tokens.length > 0 ){\n\t\t\ttokensList.push( advancedTokens );\n\t\t}\n\n\t\t// Get the items tokens\n\t\tconst itemsTokens = this.getItemsTokens();\n\t\t// Add tokens to the main array\n\t\ttokensList = [ ...tokensList, ...itemsTokens ];\n\n\t\treturn tokensList;\n\t}\n\n\t/**\n\t * Get all the common tokens that can be used a given item\n\t * These tokens are independent of the items in the recipe\n\t * They are hardcoded, and vary depending on the characteristics\n\t * of the recipe itself (for example, if the recipe is anon or logged-in)\n\t * These are also going to be filtered by the fieldType\n\t *\n\t * @since 3.0\n\t * \n\t * @return Object  Group of tokens\n\t */\n\tgetCommonTokens(){\n\t\t// Create common tokens\n\t\tconst commonTokens = {\n\t\t\tid:     'common',\n\t\t}\n\n\t\t// Add the name\n\t\tif ( this.options.includeGroupName ){\n\t\t\tcommonTokens.name = UncannyAutomator.i18n.tokens.global.common;\n\t\t}\n\n\t\t// Add the icon\n\t\tif ( this.options.includeGroupIcon ){\n\t\t\tcommonTokens.icon = $( `\n\t\t\t\t<i class=\"uo-icon uo-icon--bolt\"></i>\n\t\t\t` );\n\t\t}\n\n\t\t// Add the tokens\n\t\tif ( this.options.includeGroupTokens ){\n\t\t\tcommonTokens.tokens = [\n\t\t\t\t{\n\t\t\t\t\tid:   'site_name',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.siteName,\n\t\t\t\t\tcacheable: true\n\t\t\t\t},\n\t\t\t];\n\n\t\t\t// Check if it's a field in a trigger or user-selector section,\n\t\t\t// in an anonymous recipe then don't add user related tokens\n\t\t\tif ( \n\t\t\t\t! ( \n\t\t\t\t\tUncannyAutomator.recipe.type == 'anonymous' \n\t\t\t\t\t&& ( this.itemType == 'trigger' || this.itemType == 'user-selector' )\n\t\t\t\t)\n\t\t\t){\n\t\t\t\t// Add user related tokens\n\t\t\t\tcommonTokens.tokens.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_id',\n\t\t\t\t\t\ttype: 'int',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userID,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_username',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userUsername,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_firstname',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userFirstName,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_lastname',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userLastName,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_email',\n\t\t\t\t\t\ttype: 'email',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userEmail,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'user_displayname',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userDisplay,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid:   'reset_pass_link',\n\t\t\t\t\t\ttype: 'url',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userResetPassLink,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Add other common tokens\n\t\t\tcommonTokens.tokens.push(\n\t\t\t\t{\n\t\t\t\t\tid:   'admin_email',\n\t\t\t\t\ttype: 'email',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.adminEmail,\n\t\t\t\t\tcacheable: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid:   'site_url',\n\t\t\t\t\ttype: 'url',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.siteUrl,\n\t\t\t\t\tcacheable: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid:   'recipe_name',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.recipeName,\n\t\t\t\t\tcacheable: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid:   'current_date',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.currentDate,\n\t\t\t\t\tcacheable: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid:   'current_time',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.currentTime,\n\t\t\t\t\tcacheable: true\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// Filter tokens\n\t\t\t// commonTokens.tokens = this.filterTokensByType( commonTokens.tokens, this.fieldType );\n\t\t}\n\n\t\t// Check what tokens require user data\n\t\tcommonTokens.tokens.forEach(( token ) => {\n\t\t\t// Check if it requires user data\n\t\t\tif ( token.requiresUser ){\n\t\t\t\tthis.tokensThatRequireUser.push( token.id );\n\t\t\t}\n\t\t});\n\n\t\treturn commonTokens;\n\t}\n\n\t/**\n\t * Get all the advanced tokens that can be used a given item\n\t * These tokens are independent of the items in the recipe\n\t * They are hardcoded, and vary depending on the characteristics\n\t * of the recipe itself (for example, if the recipe is anon or logged-in)\n\t * These are also going to be filtered by the fieldType\n\t *\n\t * @since 3.0\n\t * \n\t * @return Object  Group of tokens\n\t */\n\tgetAdvancedTokens(){\n\t\t// Create common tokens\n\t\tconst advancedTokens = {\n\t\t\tid:     'advanced',\n\t\t\ttokens: []\n\t\t}\n\n\t\t// Add the name\n\t\tif ( this.options.includeGroupName ){\n\t\t\tadvancedTokens.name = UncannyAutomator.i18n.tokens.global.advanced;\n\t\t}\n\n\t\t// Add the icon\n\t\tif ( this.options.includeGroupIcon ){\n\t\t\tadvancedTokens.icon = $( `\n\t\t\t\t<i class=\"uo-icon uo-icon--bolt\"></i>\n\t\t\t` );\n\t\t}\n\n\t\t// Add the tokens\n\t\tif ( this.options.includeGroupTokens ){\n\t\t\t// Check if it's a field in a trigger or user-selector section,\n\t\t\t// in an anonymous recipe then don't add user related tokens\n\t\t\tif (\n\t\t\t\t! ( \n\t\t\t\t\tUncannyAutomator.recipe.type == 'anonymous' \n\t\t\t\t\t&& ( this.itemType == 'trigger' || this.itemType == 'user-selector' ) \n\t\t\t\t)\n\t\t\t){\n\t\t\t\tadvancedTokens.tokens.push({\n\t\t\t\t\tid:   'USERMETA:KEY',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.userMetaKey,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequiresUser: true,\n\t\t\t\t});\n\n\t\t\t\tif ( \n\t\t\t\t\tisDefined( UncannyAutomator.wp ) \n\t\t\t\t\t&& '1' === UncannyAutomator.wp\n\t\t\t\t){\n\t\t\t\t\tadvancedTokens.tokens.push({\n\t\t\t\t\t\tid:   'AUTOLOGINLINK',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tname:  UncannyAutomator.i18n.tokens.global.autoLoginLink,\n\t\t\t\t\t\tcacheable: true,\n\t\t\t\t\t\trequiresUser: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Filter tokens\n\t\t\t// advancedTokens.tokens = this.filterTokensByType( advancedTokens.tokens, this.fieldType );\n\t\t}\n\n\t\t// Check what tokens require user data\n\t\tadvancedTokens.tokens.forEach(( token ) => {\n\t\t\t// Check if it requires user data\n\t\t\tif ( token.requiresUser ){\n\t\t\t\tthis.tokensThatRequireUser.push( token.id );\n\t\t\t}\n\t\t});\n\n\t\treturn advancedTokens;\n\t}\n\n\t/**\n\t * Get all the item tokens that can be used a given item\n\t * This method just iterates all the items and calls \"getItemTokens\"\n\t * to get the tokens of each item in the recipe\n\t *\n\t * @since 3.0\n\t * \n\t * @return Object  Groups of tokens\n\t */\n\tgetItemsTokens(){\n\t\tlet itemsTokens = [];\n\n\t\t// Get all the recipe items, by item type\n\t\t// If this.itemType is not defined, all items are going to be returned\n\t\tlet items = UncannyAutomator.recipe.items;\n\t\tif ( isDefined( this.itemType ) ){\n\t\t\t// Remove all the items, we're going to filter them\n\t\t\titems = {};\n\n\t\t\tif ( [ 'action', 'closure', 'user-selector' ].includes( this.itemType ) ){\n\t\t\t\titems = $.extend( {}, items, itemsObject( 'get', {\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\titemType: 'trigger'\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tif ( this.itemType == 'closure' ){\n\t\t\t\titems = $.extend( {}, items, itemsObject( 'get', {\n\t\t\t\t\tfilter: {\n\t\t\t\t\t\titemType: 'action'\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\t// Iterate items\n\t\tObject.entries( items ).forEach( ( [ itemID, item ] ) => {\n\t\t\t// Get the item tokens\n\t\t\tconst itemTokens = this.getItemTokens( item );\n\n\t\t\t// Check if it has tokens\n\t\t\tif ( \n\t\t\t\titemTokens.tokens.length > 0\n\t\t\t\t|| ! this.options.includeGroupTokens\n\t\t\t){\n\t\t\t\titemsTokens.push( itemTokens );\n\t\t\t}\n\t\t});\n\n\t\treturn itemsTokens;\n\t}\n\n\t/**\n\t * Get all the tokens generated by a given item\n\t * The tokens added by this method can be divided into two groups:\n\t * - Automatic tokens: These are created using the fields of\n\t *   the trigger/action. For example, if the item has a dropdown\n\t *   to select a page, with the label \"Page\", then this method will\n\t *   create a text token called \"Page\".\n\t * - Custom dynamic tokens: These are created dynamically with PHP.\n\t *   For example, a trigger that lets you select a Gravity Form would\n\t *   have the fields as tokens.\n\t *\n\t * @since 3.0\n\t * \n\t * @param  Object  item  The item\n\t * \n\t * @return Object         Groups of tokens\n\t */\n\tgetItemTokens( item ){\n\t\t// Create the tokens group\n\t\tlet tokensGroup = {\n\t\t\tid:             item.itemCode,\n\t\t\tintegrationId:  item.integrationCode,\n\t\t}\n\n\t\t// Add the name\n\t\tif ( this.options.includeGroupName ){\n\t\t\t// Get the name of the groups of tokens\n\t\t\t// For this, we will use the item sentence\n\t\t\tlet itemSentence = item.sentence;\n\t\t\tif ( ! item.isMissing ){\n\t\t\t\titemSentence = getGlobalItem( item.integrationCode, item.itemType, item.itemCode ).sentence;\n\t\t\t}\n\n\t\t\t// Get or create the parsed item sentence\n\t\t\ttokensGroup.name = parseStringWithTokens(\n\t\t\t\titem, \n\t\t\t\titemSentence, \n\t\t\t\tUncannyAutomator.recipe.items[ item.id ].meta\n\t\t\t).html;\n\t\t}\n\n\t\t// Add the icon\n\t\tif ( this.options.includeGroupIcon ){\n\t\t\t// Create the icon\n\t\t\tlet $icon;\n\n\t\t\tif ( isDefined( UncannyAutomator.integrations[ item.integrationCode ] ) ){\n\t\t\t\t// Search for an icon\n\t\t\t\tconst integration = UncannyAutomator.integrations[ item.integrationCode ];\n\n\t\t\t\t// Check if it has a svg image\n\t\t\t\tif ( isDefined( integration.icon_svg ) ){\n\t\t\t\t\t$icon = $( `\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tsrc=\"${ integration.icon_svg }\" \n\t\t\t\t\t\t\talt=\"${ integration.name }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t` );\n\t\t\t\t}\n\t\t\t\t// Check if it has a png image\n\t\t\t\telse if ( isDefined( integration.icon_16 ) && isDefined( integration.icon_32 ) ){\n\t\t\t\t\t$icon = $( `\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tsrc=\"${ integration.icon_16 }\" \n\t\t\t\t\t\t\tsrcset=\"${ vsprintf( '%s 1x, %s 2x', [ integration.icon_16, integration.icon_32 ]) }\"\n\t\t\t\t\t\t\talt=\"${ integration.name }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t` );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add the icon\n\t\t\ttokensGroup.icon = $icon;\n\t\t}\n\n\t\t// Add the tokens\n\t\tif ( this.options.includeGroupTokens ){\n\t\t\tlet itemTokens = [];\n\n\t\t\t// FIELD tokens\n\t\t\t// Create tokens using the fields\n\t\t\t// Iterate the groups of options\n\t\t\tObject.entries( item.options ).forEach( ( [ optionsGroupID, optionsGroup ] ) => {\n\t\t\t\t// Iterate each field\n\t\t\t\toptionsGroup.fields.forEach( ( Field ) => {\n\t\t\t\t\t// Get the field attributes\n\t\t\t\t\tconst fieldAttributes = Field.getAttributes();\n\n\t\t\t\t\t// Check the field type\n\t\t\t\t\t// Check if it's a repeater field\n\t\t\t\t\t// Check the field type\n\t\t\t\t\tif ( fieldAttributes.fieldType == 'repeater' ){\n\t\t\t\t\t\t// Iterate the rows\n\t\t\t\t\t\tField.fieldRows.forEach(( row, index ) => {\n\t\t\t\t\t\t\t// Get the row index\n\t\t\t\t\t\t\tconst rowIndex = index;\n\n\t\t\t\t\t\t\t// Iterate the row fields\n\t\t\t\t\t\t\trow.forEach(( Field ) => {\n\t\t\t\t\t\t\t\t// Add field\n\t\t\t\t\t\t\t\titemTokens.push({\n\t\t\t\t\t\t\t\t\t// Create the token\n\t\t\t\t\t\t\t\t\t// ITEM_ID : ITEM_CODE : REPEATER_FIELD_ID : ROW_INDEX : FIELD_ID\n\t\t\t\t\t\t\t\t\tid:      `${ item.id }:${ item.itemCode }:${ fieldAttributes.optionCode }:${ rowIndex }:${ Field.getAttributes().optionCode }`,\n\t\t\t\t\t\t\t\t\t// Field name:\n\t\t\t\t\t\t\t\t\t// REPEATER_FIELD_NAME - \"Row\" ROW_INDEX - FIELD_NAME\n\t\t\t\t\t\t\t\t\tname:    `${ fieldAttributes.tokenName } - ${ vsprintf( UncannyAutomator.i18n.rowNumber, [ ( rowIndex + 1 ) ] ) } - ${ Field.getAttributes().tokenName }`,\n\t\t\t\t\t\t\t\t\ttype:    Field.getAttributes().fieldType == 'select' || Field.getAttributes().fieldType == 'textarea' ? 'text' : Field.getAttributes().fieldType,\n\t\t\t\t\t\t\t\t\tvalue:   Field.getValue(),\n\t\t\t\t\t\t\t\t\tfieldId: Field.getAttributes().optionCode,\n\t\t\t\t\t\t\t\t\titemID:  item.id,\n\t\t\t\t\t\t\t\t\tcacheable: false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if ( fieldAttributes.fieldType == 'group' ){\n\t\t\t\t\t\t// Nothing here yet\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Check if it has custom field tokens, also called\n\t\t\t\t\t\t// \"relevant tokens\"\n\t\t\t\t\t\tif ( \n\t\t\t\t\t\t\tisDefined( fieldAttributes.customFieldTokens )\n\t\t\t\t\t\t\t&& isObject( fieldAttributes.customFieldTokens )\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\t// Iterate the relevant tokens\n\t\t\t\t\t\t\tObject.entries( fieldAttributes.customFieldTokens ).forEach(( [ tokenId, tokenName ] ) => {\n\t\t\t\t\t\t\t\titemTokens.push({\n\t\t\t\t\t\t\t\t\tid:       `${ item.id }:${ item.itemCode }:${ tokenId }`,\n\t\t\t\t\t\t\t\t\tname:      tokenName,\n\t\t\t\t\t\t\t\t\ttype:      fieldAttributes.fieldType == 'select' || fieldAttributes.fieldType == 'textarea' ? 'text' : fieldAttributes.fieldType,\n\t\t\t\t\t\t\t\t\tvalue:     Field.getValue(),\n\t\t\t\t\t\t\t\t\tfieldId:   fieldAttributes.optionCode,\n\t\t\t\t\t\t\t\t\titemID:    item.id,\n\t\t\t\t\t\t\t\t\tcacheable: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Create a token using the field label\n\t\t\t\t\t\t\titemTokens.push({\n\t\t\t\t\t\t\t\tid:      `${ item.id }:${ item.itemCode }:${ fieldAttributes.optionCode }`,\n\t\t\t\t\t\t\t\tname:    fieldAttributes.tokenName,\n\t\t\t\t\t\t\t\ttype:    fieldAttributes.fieldType == 'select' || fieldAttributes.fieldType == 'textarea' ? 'text' : fieldAttributes.fieldType,\n\t\t\t\t\t\t\t\tvalue:   Field.getValue(),\n\t\t\t\t\t\t\t\tfieldId: fieldAttributes.optionCode,\n\t\t\t\t\t\t\t\titemID:  item.id,\n\t\t\t\t\t\t\t\tcacheable: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Custom ITEM tokens\n\t\t\t// These are dynamic tokens, for example, the fields of a form\n\t\t\titem.tokens.forEach(( token ) => {\n\t\t\t\titemTokens.push({\n\t\t\t\t\tid:   `${ item.id }:${ token.tokenIdentifier }:${ token.tokenId }`,\n\t\t\t\t\tname: token.tokenName,\n\t\t\t\t\ttype: isDefined( token.tokenType ) ? token.tokenType : 'text',\n\t\t\t\t\titemID: item.id,\n\t\t\t\t\tcacheable: true\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Add the tokens to the group\n\t\t\ttokensGroup.tokens = itemTokens;\n\n\t\t\t// Filter tokens using a custom function (if it has one)\n\t\t\tif ( ! isEmpty( item.filterTokens ) ){\n\t\t\t\t// Try to overwrite empty function\n\t\t\t\ttry {\n\t\t\t\t\t// Try to convert the string to function, but first remove the <script> tags and trim the string\n\t\t\t\t\tconst filterTokens = eval( `(${ item.filterTokens.replace( '<script>', '' ).replace( '</script>', '' ).trim() })` ); \n\n\t\t\t\t\t// Filter the tokens\n\t\t\t\t\titemTokens = filterTokens( tokensGroup, item );\n\t\t\t\t} catch ( e ){\n\t\t\t\t\t// Continue regardless of error\n\t\t\n\t\t\t\t\t// Output error if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.warning( e );\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.log( item.filterTokens );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Filter tokens with the global filter\n\t\t\t// This will filter the tokens by type\n\t\t\t/*\n\t\t\ttokensGroup.tokens = this.filterTokensByType(\n\t\t\t\ttokensGroup.tokens,\n\t\t\t\tthis.fieldType\n\t\t\t);\n\t\t\t*/\n\t\t}\n\n\t\t// Add the group of tokens\n\t\treturn tokensGroup;\n\t}\n\n\t/**\n\t * Filters the tokens based on the field type\n\t *\n\t * @since  3.0\n\t * \n\t * @param  Array  tokens  The tokens to be filtered\n\t * \n\t * @return Array  tokens  The tokens, filtered\n\t */\n\tfilterTokensByType( tokens ){\n\t\t// Check if the field type is defined\n\t\t// Otherwise, don't filter the tokens\n\t\tif ( isDefined( this.fieldType ) ){\n\t\t\t// Check if it's NOT a text, textarea or url field\n\t\t\t// We don't have to filter tokens for those\n\t\t\tif ( ! [ 'text', 'textarea', 'url' ].includes( this.fieldType ) ){\n\t\t\t\t// Iterate the tokens\n\t\t\t\ttokens = tokens.filter(( token ) => {\n\t\t\t\t\t// Get the token type\n\t\t\t\t\tlet tokenType = token.type;\n\n\t\t\t\t\t// Check if the field is a \"float\" field. In that case,\n\t\t\t\t\t// promote all the \"int\" tokens to \"float\". All integers\n\t\t\t\t\t// are floats\n\t\t\t\t\tif ( \n\t\t\t\t\t\tthis.fieldType == 'float' \n\t\t\t\t\t\t&& tokenType == 'int'\n\t\t\t\t\t){\n\t\t\t\t\t\ttokenType = 'float';\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if the token type matches the field type\n\t\t\t\t\treturn this.fieldType == tokenType;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn tokens;\n\t}\n\n\t/**\n\t * Creates a DOM node with the token data\n\t *\n\t * @since  3.0\n\t * \n\t * @param  String  tokenID  A token ID\n\t * \n\t * @return String           The HTML\n\t */\n\tcreateTokenDOMNode( tokenID ){\n\t\t// Default response\n\t\tlet $tokenNode = null;\n\n\t\t// Get more information about the token\n\t\tconst token = this.getTokenDataByID( tokenID );\n\n\t\t// Check if the token is valid\n\t\tif ( isDefined( token ) ){\n\t\t\t// Check if we already created this element\n\t\t\tif ( isDefined( UncannyAutomator.cache.tokens[ token.id ] ) ){\n\t\t\t\t$tokenNode = UncannyAutomator.cache.tokens[ token.id ];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Create the token node\n\t\t\t\t// VanillaJS because of the performance, this might be heavy\n\t\t\t\t$tokenNode = document.createElement( 'span' );\n\t\t\t\t$tokenNode.classList.add( 'uap-token' );\n\n\t\t\t\t// Insert the icon\n\t\t\t\t$tokenNode.appendChild( token.group.icon[0].cloneNode() );\n\n\t\t\t\t// Insert the name\n\t\t\t\tconst $tokenName = document.createElement( 'span' );\n\t\t\t\t$tokenName.classList.add( 'uap-token__name' );\n\t\t\t\t$tokenName.innerHTML = token.name;\n\t\t\t\t$tokenNode.appendChild( $tokenName );\n\n\t\t\t\t// Check if we can save the token in the cache\n\t\t\t\tif ( token.cacheable ){\n\t\t\t\t\t// Save node in the cache\n\t\t\t\t\tUncannyAutomator.cache.tokens[ token.id ] = $tokenNode;\n\t\t\t\t}\t\n\t\t\t}\n\n\t\t\t// Clone the node\n\t\t\t$tokenNode = $tokenNode.cloneNode( true );\n\t\t}\n\t\telse {\n\t\t\t// Create the token node\n\t\t\t// VanillaJS because of the performance, this might be heavy\n\t\t\t$tokenNode = document.createElement( 'span' );\n\t\t\t$tokenNode.classList.add( 'uap-token', 'uap-token--invalid' );\n\n\t\t\t// Insert the icon\n\t\t\tconst $tokenIcon = document.createElement( 'i' );\n\t\t\t$tokenIcon.classList.add( 'uo-icon', 'uo-icon--exclamation' );\n\t\t\t$tokenNode.appendChild( $tokenIcon );\n\n\t\t\t// Insert the name\n\t\t\tconst $tokenName = document.createElement( 'span' );\n\t\t\t$tokenName.classList.add( 'uap-token__name' );\n\t\t\t$tokenName.innerHTML = tokenID;\n\t\t\t$tokenNode.appendChild( $tokenName );\n\t\t}\n\n\t\treturn $tokenNode;\n\t}\n\n\t/**\n\t * Returns more data about a token by just using the token ID\n\t *\n\t * @since  3.0\n\t * \n\t * @param  String  tokenID  A token ID\n\t * \n\t * @return Object           [description]\n\t */\n\tgetTokenDataByID( tokenID = '' ){\n\t\t// Create a copy of the parameter\n\t\t// We might change the parameter value later\n\t\tconst originalTokenID = tokenID;\n\n\t\t// Default response\n\t\tlet token = null;\n\n\t\t// Add exception for special tokens\n\t\tif ( tokenID.startsWith( 'USERMETA:' ) ){\n\t\t\t// Change the token ID so we can get the required data\n\t\t\ttokenID = 'USERMETA:KEY';\n\t\t}\n\n\t\t// Check if the tokenID is not empty\n\t\tif ( ! isEmpty( tokenID ) ){\n\t\t\t// Iterate the groups of tokens\n\t\t\tthis.tokens.some(( tokensGroup ) => {\n\t\t\t\t// Get the token using the tokenID\n\t\t\t\ttoken = tokensGroup.tokens.reduce(( locatedToken, currentToken ) => {\n\t\t\t\t\treturn currentToken.id == tokenID ? currentToken : locatedToken;\n\t\t\t\t}, null );\n\n\t\t\t\t// Check if we found a token\n\t\t\t\tif ( isDefined( token ) ){\n\t\t\t\t\t// Add more data to the token\n\t\t\t\t\ttoken.group = {\n\t\t\t\t\t\tid:   tokensGroup.id,\n\t\t\t\t\t\tname: tokensGroup.name,\n\t\t\t\t\t\ticon: tokensGroup.icon,\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Add exception for special tokens\n\t\tif ( isDefined( token ) && tokenID.startsWith( 'USERMETA:' ) ){\n\t\t\t// Clone the token, don't modify the original\n\t\t\ttoken = $.extend( true, {}, token );\n\n\t\t\t// Get the key the user wants to get\n\t\t\tconst key  = originalTokenID.replace( 'USERMETA:', '' );\n\n\t\t\t// Change ID of the token\n\t\t\ttoken.id   = token.id.replace( 'KEY', key );\n\n\t\t\t// Change name of the token\n\t\t\ttoken.name = vsprintf( UncannyAutomator.i18n.tokens.global.userMetaKeyTemplate, [ key ] ); \n\t\t}\n\n\t\treturn token;\n\t}\n\n\t/**\n\t * Render text that has tokens\n\t *\n\t * @since 3.0\n\t * \n\t * @param  String   textWithTokens  The text\n\t * @return Node                     Node with the text + tokens rendered\n\t */\n\trenderTextWithTokens( textWithTokens, options = {}){\n\t\t// Get the options\n\t\toptions = Object.assign({\n\t\t\ttemplate: '',\n\t\t\tparseTokensInAttributes: true\n\t\t}, options );\n\n\t\t// Check if it has a template\n\t\tconst hasTemplate = ! isEmpty( options.template );\n\n\t\t// Create the container\n\t\tconst $container = document.createElement( 'span' );\n\n\t\t// Replace the tokens in the text with tokens\n\t\ttextWithTokens = textWithTokens.replace(\n\t\t\t// Get the correct regex\n\t\t\toptions.parseTokensInAttributes ? this.tokensRegEx : this.tokensRegExNoAttributes,\n\t\t\t// Replace the content\n\t\t\t( fullMatch, token ) => {\n\t\t\t\t// Get token node\n\t\t\t\tconst $token = this.createTokenDOMNode( token );\n\n\t\t\t\t// Get the token node HTML\n\t\t\t\tlet tokenHTML = $token.outerHTML;\n\n\t\t\t\t// Check if we have to add a wrapper to it\n\t\t\t\tif ( hasTemplate ){\n\t\t\t\t\t// Add the variable data to the template\n\t\t\t\t\ttokenHTML = vsprintf( options.template, [\n\t\t\t\t\t\ttokenHTML,\n\t\t\t\t\t\ttoken\n\t\t\t\t\t]);\n\t\t\t\t}\n\n\t\t\t\t// Replace the content with the HTML of the token node\n\t\t\t\t// Verify that we're only replacing the content inside {{}},\n\t\t\t\t// and that we're not removing any other characters\n\t\t\t\treturn fullMatch.replace( `{{${ token }}}`, tokenHTML );\n\t\t\t}\n\t\t);\n\n\t\t// Add the text, now with the tokens rendered, to the container\n\t\t$container.innerHTML = textWithTokens;\n\n\t\treturn $container;\n\t}\n}","import $ from 'jquery';\n\n// Import sprintf-js\nconst vsprintf = require( 'sprintf-js' ).vsprintf;\n\nimport {\n\titemsObject,\n\tisString,\n\tisEmpty,\n\tisDefined,\n\tinArray,\n\tgetDOMElements,\n\tgetFieldTypes,\n\trestCall\n} from '../common/utilities.js';\n\nimport Publish from '../publish/publish.js';\n\nimport Tokens from '../tokens/tokens.js';\n\n/**\n * Validate form using the global object UncannyAutomator.recipe, which contains\n * all the recipe items \n *\n * @since 0.3\n *\n * @return {object}\n * @return {boolean}  response.canSubmit - TRUE if the recipe is valid\n */\n\nexport function validateRecipe(){\n\t// Set response object\n\tlet response = {\n\t\tcanSubmit: UncannyAutomator.recipe.isValid\n\t}\n\t\n\t// Check if the recipe is not valid\n\tif ( ! UncannyAutomator.recipe.isValid ){\n\n\t\t// Enable error mode\n\t\t// UncannyAutomator.recipe.errorMode = true;\n\n\t\t// Iterate each item\n\t\t$.each( UncannyAutomator.recipe.items, function( itemID, itemData ){\n\n\t\t\t// Validate each item\n\t\t\tvalidateItem( itemID );\n\t\t});\n\t}\n\n\treturn response;\n}\n\n/**\n * Validate item using the itemID\n *\n * @since 0.4\n *\n * @param  {int} \t  itemID - ID of the item\n * @param  {object}   [$item] - jQuery object of the item. Necessary only if itemID is undefined\n *\n * @return {object}\n * @return {boolean}  response.isValid - TRUE if the item is valid\n */\n\nexport function validateItem( itemID, $item = null ){\n\t// Create response object\n\tlet response = {\n\t\tisValid: false\n\t}\n\n\t// Check if the itemID is defined\n\tif ( isDefined( itemID ) ){\n\t\t// Get item\n\t\tlet item = UncannyAutomator.recipe.items[ itemID ];\n\n\t\t// Check if the item exists, otherwise do nothing, isValid will be false (because of the default value)\n\t\tif ( ! item.isMissing && ! isEmpty( item ) ){\n\t\t\t// Save result\n\t\t\tresponse.isValid = item.isValid;\n\n\t\t\t// Check if this item is invalid\n\t\t\tif ( ! item.isValid ){\n\n\t\t\t\t// Get DOM element of the item\n\t\t\t\tlet itemElement = getDOMElements( 'item', {\n\t\t\t\t\tid: itemID\n\t\t\t\t}).item;\n\n\t\t\t\t// Add CSS class to it\n\t\t\t\titemElement.addClass( 'item--error' );\n\n\t\t\t\t// Iterate each group of fields\n\t\t\t\t$.each( item.options, function( optionsGroupID, optionsGroupData ){\n\n\t\t\t\t\t// Check if a group of fields is invalid\n\t\t\t\t\tif ( ! optionsGroupData.isValid ){\n\n\t\t\t\t\t\t// Get DOM elements of the container with all the fields\n\t\t\t\t\t\tlet optionsGroupElements = getDOMElements( 'optionGroup', {\n\t\t\t\t\t\t\titemID: \titemID,\n\t\t\t\t\t\t\tgroupID: \toptionsGroupID\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Add error classes\n\t\t\t\t\t\toptionsGroupElements.tokenInSentence.addClass( 'item-title__token--error item-title__token--error-shake' );\n\t\t\t\t\t\toptionsGroupElements.fieldsContainer.addClass( 'item-options__group--error' );\n\t\t\t\t\t\toptionsGroupElements.optionsContainer.addClass( 'item-options--error' );\n\n\t\t\t\t\t\t// Remove \"shake\" class from tokenInSentence so the element can shake if the user clicks again\n\t\t\t\t\t\tsetTimeout( function(){\n\t\t\t\t\t\t\toptionsGroupElements.tokenInSentence.removeClass( 'item-title__variable--error-shake' );\n\t\t\t\t\t\t}, 1000 );\n\n\t\t\t\t\t\t// Show errors in the UI for each invalid field\n\t\t\t\t\t\tif ( isDefined( optionsGroupElements.optionsContainer ) ){\n\n\t\t\t\t\t\t\t// Validate the form of the group of fields. Check validateItemFields comments for more information.\n\t\t\t\t\t\t\tvalidateItemFields( optionsGroupElements.optionsContainer );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\t// ID is not defined, the item doesn't have an ID yet\n\t\tresponse.isValid = false;\n\n\t\t// Check if $item is defined \n\t\tif ( ! isEmpty( $item ) ){\n\t\t\t\n\t\t}\n\t\telse {\n\t\t\tconsole.error( 'Neither itemID nor the $item are defined. One of them must be defined.' );\t\n\t\t}\n\t}\n\n\t// Return response\n\treturn response;\n}\n\n/**\n * Validate form using a DOM element that contains the fields\n * \n * @since 0.1\n *\n * @param {object}\t form - jQuery DOM element that contains the fields\n *\n * @return {object}\n * @return {boolean}  response.isValid - TRUE if the form is valid\n */\n\nexport function validateItemFields( form, validateChildren = false ){\n\t// Create response object\n\tlet response = {\n\t\tisValid: false\n\t}\n\n\t// Get all fields, input, textareas and selects\n\tlet fields = form.find( `\n\t\tinput.form-element__input[data-is-child-field=\"${ validateChildren ? 'true' : 'false' }\"],\n\t\ttextarea.form-element__textarea[data-is-child-field=\"${ validateChildren ? 'true' : 'false' }\"],\n\t\tselect.form-element__select[data-is-child-field=\"${ validateChildren ? 'true' : 'false' }\"],\n\t\t.form-checkbox input,\n\t\t.form-radio` );\n\n\t// Set the variable that will be used to decide if the form is valid or not\n\t// It's true by default, but it will changed to false if at least one field has an error\n\tlet isFormValid = true;\n\n\t// Go through all fields\n\tfields.each(function(){\n\t\t// Save $(this) jQuery element (from the each loop) in the field variable\n\t\t// form-element__input, form-element__textarea or form-element__select\n\t\tlet field = $( this );\n\n\t\t// Get field type\n\t\tlet fieldType = field.data( 'type' );\n\n\t\t// Define field data\n\t\tlet fieldData = {}\n\n\t\t// Check if it's a radio\n\t\tif ( field.hasClass( 'form-radio' ) ){\n\t\t\t// Overwrite field type\n\t\t\tfieldType = 'radio';\n\n\t\t\t// Get one of the radios\n\t\t\tlet radioInput     = field.find( 'input' ).first();\n\n\t\t\t// Get value of the selected radio (if there is any)\n\t\t\tlet selectedRadio  = field.find( 'input:checked' ),\n\t\t\t\tradioValue     = selectedRadio.length > 0 ? selectedRadio.val() : '';\n\n\t\t\t// Create object with the data that will be used in the verification process\n\t\t\tfieldData = {\n\t\t\t\tfield_type: \t\t 'radio',\n\t\t\t\tvalue: \t\t\t\t radioValue,\n\t\t\t\tattributes: {\n\t\t\t\t\tsupportsTokens:  radioInput.data( 'supportstokens' ),\n\t\t\t\t\trequired: \t\t radioInput.data( 'required' ),\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Check if it's a select\n\t\telse if ( field.hasClass( 'form-element__select' ) ){\n\t\t\tfieldData = {\n\t\t\t\tfield_type: \t\t 'select',\n\t\t\t\tvalue: \t\t\t\t field.val(),\n\t\t\t\tattributes: {\n\t\t\t\t\tsupportsTokens:      field.data( 'supportstokens' ),\n\t\t\t\t\trequired: \t\t     field.data( 'required' ),\n\t\t\t\t\tsupportsCustomValue: field.data( 'supports-custom-value' ),\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// Create object with the data that will be used in the verification process\n\t\t\tfieldData = {\n\t\t\t\tfield_type: \t\t field.data( 'type' ),\n\t\t\t\tvalue: \t\t\t\t field.val(),\n\t\t\t\tattributes: {\n\t\t\t\t\tsupportsTokens:  field.data( 'supportstokens' ),\n\t\t\t\t\trequired: \t\t field.data( 'required' ),\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check if it's a checkbox and overwrite the value\n\t\tif ( fieldData.field_type == 'checkbox' ){\n\t\t\tfieldData.value = field.is( ':checked' );\n\t\t}\n\n\t\t// Check if the field is required, the value is undefined but has a default value in the settings\n\t\t/*\n\t\tif ( fieldData.attributes.required && ! isDefined( fieldData.value ) && isDefined( fieldData.defaultValue ) ){\n\t\t\t// Set default value as value\n\t\t\tfieldData.value = fieldData.attributes.defaultValue;\n\t\t}\n\t\t*/\n\n\t\t// Validate form. Read validateField comments for more information\n\t\tlet fieldValidation = validateField( field, fieldData.field_type, fieldData.value, fieldData.attributes );\n\n\t\t// Check if the field is invalid\n\t\tif ( ! fieldValidation.isValid ){\n\t\t\tisFormValid = false;\n\n\t\t\t// Add error class to form container\n\t\t\tform.addClass( 'item-options--error' );\n\t\t}\n\t});\n\n\tresponse.isValid = isFormValid;\n\n\treturn response;\n}\n\n/**\n * Validates the value of a field.\n * Supports all field types\n *\n * Only supports one token. The object is prepared to support more than one, we only have to remove the if statement\n * that checks the number of tokens per string. This functionality will be change in another version\n *\n * @since 0.1\n *\n * @param {object} \t\tfield - jQuery object of the field used to add CSS classes. Use null if you just want to get the validation response\n * @param {string} \t\tfieldType - A valid field type\n * @param {string} \t\tvalue - The value of the field.\n * @param {object}   \tattributes - Object with some of the field attributes\n * @param {boolean} \tattributes.supportsTokens - TRUE if the field should support tokens\n * @param {boolean} \tattributes.required - TRUE if the field is required\n * @param {object} \t\t[customValidationFunction] Just in case you want to add a custom validation function. Must return an object with two properties { isValid: {boolean}, message: {string} }\n *\n * @return {object}\n * @return {boolean} \tresponse.isValid - TRUE if the field is valid\n * @return {string}  \tresponse.message - Message showing the reason the field is invalid\n */\n\nexport function validateField( field, fieldType, value, attributes = { supportsTokens: false, required: false }, customValidationFunction ){\n\t// Create response object\n\tlet response = {\n\t\tisValid: false,\n\t\tmessage: '',\n\t}\n\n\t// Define valid field types\n\tlet fieldTypes = getFieldTypes();\n\n\t// Set messages\n\tlet messages = {\n\t\tselect: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.select.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.select.invalid,\n\t\t},\n\t\ttext: {\n\t\t\tempty:   UncannyAutomator.i18n.validation.field.text.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.text.invalid,\n\t\t},\n\t\ttextarea: {\n\t\t\tempty:   UncannyAutomator.i18n.validation.field.textarea.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.textarea.invalid,\n\t\t},\n\t\tint: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.int.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.int.invalid,\n\t\t\tmultipleTokens: UncannyAutomator.i18n.validation.field.int.multipleTokens,\n\t\t},\n\t\tfloat: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.float.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.float.invalid,\n\t\t\tmultipleTokens: UncannyAutomator.i18n.validation.field.float.multipleTokens,\n\t\t},\n\t\temail: {\n\t\t\tempty:   UncannyAutomator.i18n.validation.field.email.empty,\n\t\t\tsingle:  {\n\t\t\t\tinvalid: UncannyAutomator.i18n.validation.field.email.single.invalid,\n\t\t\t\tmultipleTokens: UncannyAutomator.i18n.validation.field.email.single.multipleTokens,\n\t\t\t},\n\t\t\tmultiple: {\n\t\t\t\tinvalid: UncannyAutomator.i18n.validation.field.email.multiple.invalid,\n\t\t\t\tmultipleTokens: UncannyAutomator.i18n.validation.field.email.multiple.multipleTokens,\n\t\t\t}\t\n\t\t},\n\t\turl: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.url.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.url.invalid,\n\t\t},\n\t\tcheckbox: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.checkbox.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.checkbox.invalid,\n\t\t},\n\t\tradio: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.radio.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.radio.invalid,\n\t\t},\n\t\tdate: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.date.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.date.invalid,\n\t\t},\n\t\ttime: {\n\t\t\tempty: \t UncannyAutomator.i18n.validation.field.time.empty,\n\t\t\tinvalid: UncannyAutomator.i18n.validation.field.time.invalid,\n\t\t},\n\t\tinvalidType: UncannyAutomator.i18n.validation.field.invalidType,\n\t}\n\n\t// Fix TinyMCE issue, where adding content dynamically doesn't update the textarea value\n\ttry {\n\t\tif ( fieldType == 'textarea' && ! isEmpty( field ) && field.is( ':not(:visible)' ) ){\n\t\t\tlet $formElement = field.closest( '.form-element' );\n\n\t\t\t$formElement.find( '.switch-html' )\n\t\t\t\t.trigger( 'click' );\n\n\t\t\tvalue = field.val();\n\n\t\t\t$formElement.find( '.switch-tmce' )\n\t\t\t\t.trigger( 'click' );\n\n\t\t}\n\t} catch ( e ){\n\t\t// Continue regardless of error\n\t\t\n\t\t// Output error if the developer mode is enabled\n\t\tif ( UncannyAutomator.dev.developerMode ){\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warning( e );\n\t\t}\n\t}\n\n\t// Check if it's a valid field type\n\tif ( inArray( fieldType, fieldTypes ) ){\n\t\t// Check if it's a checkbox and sanitaze the current value\n\t\tif ( fieldType == 'checkbox' && ! isEmpty( value ) ){\n\t\t\t// Check if the value is \"true\" or \"false\"\n\t\t\tif ( [ 'true', 'false' ].includes( value ) ){\n\t\t\t\t// Make it a boolean\n\t\t\t\tvalue = value == 'true' ? true : false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if it's a required field and it's empty.\n\t\t// Show \"empty\" error\n\t\tif ( attributes.required && ( isEmpty( value ) || fieldType == 'checkbox' && value === false ) ){\n\t\t\tresponse.message = messages[ fieldType ].empty;\n\t\t}\n\t\t// Check if it isn't a required field and it's empty.\n\t\t// We don't have to validate it\n\t\telse if ( ! attributes.required && isEmpty( value ) ){\n\t\t\tresponse.isValid = true;\n\t\t}\n\t\t// The field has a value\n\t\telse if ( value != '' ){\n\t\t\t// This variable will be used multiple times in the following code. Let's define it here.\n\t\t\tlet tokensInString;\n\n\t\t\t// Check what's our field type.\n\t\t\tswitch ( fieldType ){\n\n\t\t\t\tcase 'select':\n\t\t\t\t\tresponse.isValid = true; \n\n\t\t\t\t\t// Check if the value is a custom value, if so, validate it\n\t\t\t\t\tif ( attributes.supportsCustomValue && value == 'automator_custom_value' ){\n\t\t\t\t\t\t// Get the child field\n\t\t\t\t\t\tconst $childrenFields = field.closest( '.form-element' ).find( '.form-element-children' );\n\n\t\t\t\t\t\t// Check if we found it\n\t\t\t\t\t\tif ( $childrenFields.length == 1 ){\n\t\t\t\t\t\t\t// Validate it and pass the result to the parent\n\t\t\t\t\t\t\tresponse.isValid = validateItemFields( $childrenFields, true ).isValid;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( response.isValid && isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'text':\n\t\t\t\tcase 'textarea':\n\t\t\t\t\tresponse.isValid = true;\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'int':\n\t\t\t\t\t// Regular expression to check if it's a valid int number\n\t\t\t\t\t// https://regex101.com/r/Gz3RvN/4\n\t\t\t\t\tlet int_regex = new RegExp(/^([+-]?[1-9]\\d*|0)$/gm);\n\n\t\t\t\t\t// Get tokens. Read getTokensFromString comments for more information\n\t\t\t\t\ttokensInString = getTokensFromString( value );\n\n\t\t\t\t\t// Create variable to simulate int (replace tokens)\n\t\t\t\t\tlet simulate_int;\n\n\t\t\t\t\t// Check if the string has tokens (and if it should support them)\n\t\t\t\t\tif ( attributes.supportsTokens && tokensInString.hasTokens ){\n\t\t\t\t\t\t// Check if the string has only one token. As we said before, this can be easily changed in future versions\n\t\t\t\t\t\tif ( tokensInString.tokens.length == 1 ){\n\t\t\t\t\t\t\t// If it has ONE token, and the field support it, then let's just make the data valid\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// We only support one token for now. Show multiple tokens error.\n\t\t\t\t\t\t\tresponse.message = messages.int.multipleTokens;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Doesn't have tokens, so we only have to perform the regular expression test\n\t\t\t\t\t\tif ( int_regex.test( value ) ){\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Show \"invalid\" message\n\t\t\t\t\t\t\tresponse.message = messages.int.invalid;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Custom validation. Check if it's valid, if it isn't then do nothing\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( response.isValid && isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value, simulate_int );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'float':\n\t\t\t\t\t// Regular expression to check if it's a valid float number\n\t\t\t\t\t// https://regex101.com/r/KDLmre/2/\n\t\t\t\t\tlet float_regex = new RegExp(/^[+-]?((\\d+(\\.|\\,)?\\d*)|(\\.\\d+))$/gm);\n\n\t\t\t\t\t// Get tokens. Read getTokensFromString comments for more information\n\t\t\t\t\ttokensInString = getTokensFromString( value );\n\n\t\t\t\t\t// Create variable to simulate the float (replace tokens)\n\t\t\t\t\tlet simulate_float;\n\n\t\t\t\t\t// Check if the string has tokens (and if it should support them)\n\t\t\t\t\tif ( attributes.supportsTokens && tokensInString.hasTokens ){\n\t\t\t\t\t\t// Check if the string has only one token. As we said before, this can be easily changed in future versions\n\t\t\t\t\t\tif ( tokensInString.tokens.length == 1 ){\n\t\t\t\t\t\t\t// If it has ONE token, and the field support it, then let's just make the data valid\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// We only support one token for now. Show multiple tokens error.\n\t\t\t\t\t\t\tresponse.message = messages.float.multipleTokens;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Doesn't have tokens, so we only have to perform the regular expression test\n\t\t\t\t\t\tif ( float_regex.test( value ) ){\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Show \"invalid\" message\n\t\t\t\t\t\t\tresponse.message = messages.float.invalid;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Custom validation. Check if it's valid, if it isn't then do nothing\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( response.isValid && isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value, simulate_float );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'email':\n\t\t\t\t\t// Regular expression to check if it's a valid email address\n\t\t\t\t\t// https://regex101.com/r/ThUWEz/1/\n\t\t\t\t\tlet email_regex = new RegExp(/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/);\n\n\t\t\t\t\t// Create array with all the emails we have to validate\n\t\t\t\t\t// We're going to check if the user is trying to validate more than one searching for a comma in the input value\n\t\t\t\t\t// In that case, we're going to split the value and get an array with emails, otherwise we're going to create an array with one element: the input value\n\t\t\t\t\t// Doing that we can use the same code for both cases\n\t\t\t\t\tlet emails = [];\n\n\t\t\t\t\t// Check if the user wants to validate multiple emails\n\t\t\t\t\tif ( value.includes( ',' ) ){\n\t\t\t\t\t\temails = value.split( ',' );\n\n\t\t\t\t\t\t// Remove whitespace from both sides of each email, just in case the user wrote \", \" or \" ,\" instead of \",\"\n\t\t\t\t\t\t$.each( emails, function( index, email ){\n\t\t\t\t\t\t\temails[ index ] = email.trim();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Add value, but remove whitespace from both sides before\n\t\t\t\t\t\temails.push( value.trim() );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Get tokens. Read getTokensFromString comments for more information\n\t\t\t\t\ttokensInString = getTokensFromString( value );\n\n\t\t\t\t\t// Create variable to simulate the email (replace tokens)\n\t\t\t\t\tlet simulate_email;\n\t\t\t\t\t\n\t\t\t\t\t// We're going to use this variable to validate all the emails in a loop. TRUE by default, FALSE if at least one of them fails.\n\t\t\t\t\tlet allEmailsAreValid = true;\n\n\t\t\t\t\t// Create variable used to know if there is more than one email\n\t\t\t\t\tlet hasMultipleEmails = emails.length > 1;\n\n\t\t\t\t\t// Check if the string has tokens\n\t\t\t\t\tif ( attributes.supportsTokens && tokensInString.hasTokens ){\n\t\t\t\t\t\t// Create variable to check if the error was due to multiple variables\n\t\t\t\t\t\tlet hasMultipleVariables = false;\n\n\t\t\t\t\t\t// Iterate each email\n\t\t\t\t\t\t$.each( emails, function( index, email ){\n\t\t\t\t\t\t\t// Get tokens from this specific email\n\t\t\t\t\t\t\ttokensInString = getTokensFromString( email );\n\n\t\t\t\t\t\t\t// Check if the string has only one token. As we said before, this can be easily changed in future versions\n\t\t\t\t\t\t\tif ( tokensInString.tokens.length <= 1 ){\n\t\t\t\t\t\t\t\t// If it has ONE token, and the field support it, then let's just make the data valid\n\t\t\t\t\t\t\t\t// In this case, we have to do nothing\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Change value of hasMultipleVariables. We're going to use this to show a \"Multiple Tokens\" error\n\t\t\t\t\t\t\t\thasMultipleVariables = true;\n\n\t\t\t\t\t\t\t\t// Return false, we don't have to continue checking\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Check result of iteration\n\t\t\t\t\t\tif ( allEmailsAreValid && ! hasMultipleVariables ){\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif ( hasMultipleVariables ){\n\t\t\t\t\t\t\t\t// We only support one token for now. Show multiple tokens error.\n\t\t\t\t\t\t\t\tif ( hasMultipleEmails ){\n\t\t\t\t\t\t\t\t\tresponse.message = messages.email.multiple.multipleTokens;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tresponse.message = messages.email.single.multipleTokens;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Show \"invalid\" message\n\t\t\t\t\t\t\t\tif ( hasMultipleEmails ){\n\t\t\t\t\t\t\t\t\tresponse.message = messages.email.multiple.invalid;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tresponse.message = messages.email.single.invalid;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Doesn't have tokens, so we only have to perform the regular expression test in each email\n\t\t\t\t\t\t$.each( emails, function( index, email ){\n\t\t\t\t\t\t\t// Do regex\n\t\t\t\t\t\t\tif ( ! email_regex.test( email ) ){\n\t\t\t\t\t\t\t\t// If one is valid, all are invalid\n\t\t\t\t\t\t\t\tallEmailsAreValid = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Check result of iteration\n\t\t\t\t\t\tif ( allEmailsAreValid ){\n\t\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t// Show \"invalid\" message\n\t\t\t\t\t\t\tif ( hasMultipleEmails ){\n\t\t\t\t\t\t\t\tresponse.message = messages.email.multiple.invalid;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tresponse.message = messages.email.single.invalid;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Custom validation. Check if it's valid, if it isn't then do nothing\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( response.isValid && isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value, simulate_email );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'url':\n\t\t\t\t\t// This will try to return a valid URL, but can fail, so we have to verify. Read parseURL comments for more information\n\t\t\t\t\tlet validateURL = parseURL( value, attributes );\n\n\t\t\t\t\t// Check if the URL is valid\n\t\t\t\t\tif ( validateURL.isValid ){\n\t\t\t\t\t\tresponse.isValid = true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Show \"invalid\" message\n\t\t\t\t\t\tresponse.message = messages.invalidType;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Custom validation. Check if it's valid, if it isn't then do nothing\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( response.isValid && isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value, validateURL.simulatedURL );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\tresponse.isValid = true;\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radio':\n\t\t\t\t\tresponse.isValid = true;\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\t// TODO validation\n\t\t\t\tcase 'date':\n\t\t\t\t\tresponse.isValid = true;\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO validation\n\t\t\t\tcase 'time':\n\t\t\t\t\tresponse.isValid = true;\n\n\t\t\t\t\t// Check if we have to do a custom validation\n\t\t\t\t\tif ( isDefined( customValidationFunction ) ){\n\t\t\t\t\t\t// Do custom validation\n\t\t\t\t\t\tlet customValidation = customValidationFunction( value );\n\t\t\t\t\t\t// Check if it's valid\n\t\t\t\t\t\tresponse.isValid = customValidation.isValid;\n\n\t\t\t\t\t\t// If it isn't then add message\n\t\t\t\t\t\tif ( ! customValidation.isValid ){\n\t\t\t\t\t\t\tresponse.message = customValidation.message;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// The field type doesn't match\n\t\t\t\t\tresponse.isValid = false;\n\t\t\t\t\tresponse.message = '';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tresponse.message = messages[ 'invalidType' ];\n\t}\n\n\t// Add CSS classes to elements showing or hiding the error state\n\t// .form-element will have form-element--success or form-element--error classes\n\t// The message will be shown in the .form-element__error element\n\tif ( ! isEmpty( field ) ){\n\t\tlet $container = field.closest( '.form-element' );\n\t\tlet $error_container = $container.find( '.form-element__error' ).filter(function(){\n\t\t\treturn $( this ).closest( '.form-element' ).is( $container );\n\t\t});\n\n\t\tif ( ! response.isValid ){\n\t\t\t$container.removeClass( 'form-element--success' );\n\t\t\t$container.addClass( 'form-element--error' );\n\t\t}\n\t\telse {\n\t\t\t$container.removeClass( 'form-element--error' );\n\t\t\t$container.addClass( 'form-element--success' );\n\t\t}\n\n\t\tif ( response.message != '' ){\n\t\t\t$error_container.addClass( 'form-element__error--show' );\n\t\t\t$error_container.text( response.message );\n\t\t}\n\t\telse {\n\t\t\t$error_container.removeClass( 'form-element__error--show' );\n\t\t\t$error_container.text('');\n\t\t}\n\n\t}\n\n\treturn response;\n}\n\n/**\n * Get all the valid tokens from a string.\n * It compares the tokens in the string with the valid tokens in the system and only returns the valid ones.\n * Ex: \"Lorem ipsum {{valid_token}} dolor {{invalid_token}}\" returns tokens = [ 'valid_token' ]\n *\n * @since 0.1\n *\n * @param  {string} \tstring - A normal string with tokens (or not, response.tokens will return an empty array, that's all)\n *\n * @return {object}\n * @return {boolean} \tresponse.hasTokens - TRUE if there is at least one token\n * @return {array} \t\tresponse.tokens - Array with all the tokens on the string\n */\n\nexport function getTokensFromString( string ){\n\t// Create response object\n\tlet response = {\n\t\thasTokens: false,\n\t\ttokens: [],\n\t};\n\n\t// Regex to find text between double curly brackets\n\t// https://regex101.com/r/TecqPq/1\n\tlet regex = new RegExp(/\\{\\{(.*?)\\}\\}/gm);\n\t\n\t// Get all valid tokens. Read getTokens comments for more information\n\tlet allTokens = new Tokens( null, null, {\n\t\tincludeGroupName: false,\n\t\tincludeGroupIcon: false,\n\t}).tokens;\n\n\t// Check if the string attribute is defined\n\tif ( isDefined( string ) ){\n\t\t// Check if the string attribute is empty, in that case just ignore it\n\t\tif ( ! isEmpty( string ) ){\n\t\t\t// Check if the token is a string, if not, convert it\n\t\t\tif ( ! isString( string ) ){\n\t\t\t\tstring = string.toString();\n\t\t\t}\n\n\t\t\t// Create array that will store the tokens\n\t\t\tlet tokens = [];\n\n\t\t\t// Perform the regex check.\n\t\t\tlet match;\n\t\t\twhile ( ( match = regex.exec( string ) ) !== null ){\n\t\t\t\tlet matchedToken = match[ 1 ];\n\n\t\t\t\t// Check if it's an \"smart\" token. Those where you can modify the ID of it and get different data.\n\t\t\t\tif ( \n\t\t\t\t\tmatchedToken.startsWith( 'USERMETA:' )\n\t\t\t\t\t|| matchedToken.startsWith( 'POSTMETA:' )\n\t\t\t\t){\n\t\t\t\t\t// Push the token as valid\n\t\t\t\t\ttokens.push( matchedToken );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Check if the token is defined in the main tokens object, if it's is then it's a valid token and we have to add it to the tokens array\n\t\t\t\t\t$.each( allTokens, ( index, tokenGroup ) => {\n\t\t\t\t\t\t$.each( tokenGroup.tokens, ( index, token ) => {\n\t\t\t\t\t\t\tif ( matchedToken == token.id ){\n\t\t\t\t\t\t\t\ttokens.push( token );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tresponse.tokens = tokens;\n\n\t\t\t// Check if the string has at least one token\n\t\t\tif ( response.tokens.length > 0 ){\n\t\t\t\tresponse.hasTokens = true;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\t// Show error in the console\n\t\tconsole.error( 'Undefined string attribute' );\n\t}\n\n\treturn response;\n}\n\n/**\n * Replace tokens in a string with dummy valid values to check if it's valid.\n * This is a simple way to validate if strings like {{site_url}} is a valid URL.\n * There is going to be another validation in the backend before doing actions\n * Ex: {{site_url}}/relative_path gets converted to https://example.com/relative_path\n *\n * @since 0.1\n *\n * @param  {string} string - A normal string with tokens (or not, the returned string will be the same, that's all)\n *\n * @return {string}\tThe new string with dummy data\n */\n\nexport function replaceTokensInString( string ){\n\t// Create variable that will hold the new string\n\t// The default value is the original string. We are going to check if the string has tokens,\n\t// and if it doesn't then we just return the same original string\n\tlet output = string;\n\n\t// Get tokens. Read getTokensFromString comments for more information\n\tlet tokensInString = getTokensFromString( string );\n\n\t// Check if this string has tokens\n\tif ( tokensInString.hasTokens ){\n\n\t\t// Iterate through each token\n\t\t$.each( tokensInString.tokens, function( index, token ){\n\t\t\t// Remember that each token has a token group id and a token id\n\t\t\t// For example, in {{WORDPRESS_1:order_id}} WORDPRESS_1 is the token group id and order_id is the token id\n\t\t\t// We have the token group id and the token id in different object properties, and we need to create the original (complete) token string again\n\n\t\t\t// Escape regex characters\n\t\t\tlet regexCondition = token.id.replace( /[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&' );\n\n\t\t\t// Create tokenCode variable, this will store the first part (token group id)\n\t\t\tregexCondition = vsprintf( '{{%s}}', [ regexCondition ] );\n\n\t\t\t// Create regular expression to find all appearances of the token in the string\n\t\t\t// https://regex101.com/r/AWKmKp/1\n\t\t\tlet regex = new RegExp( regexCondition, 'g' );\n\n\t\t\t// Use regex to replace all appaerences with a dummy value\n\t\t\toutput = output.replace( regex, function( full_match, group ){\n\t\t\t\t// Get dummy value using the fieldType. Read getExampleValueByFieldType comments for more information\n\n\t\t\t\treturn getExampleValueByFieldType( token.type );\n\t\t\t});\n\t\t});\n\t}\n\n\treturn output;\n}\n\n/**\n * Get a dummy value given a fieldType\n * This function is useful for validation functions. We don't know in the recipe creating process if a token will store a correct value,\n * but we can use the token type to check if an email, url, int, float or other field type values are valid when they include a token.\n * For example, using this function we can know that {{site_url}}/profile/?user_id={{user_id}} is a valid url\n * \n * @since 0.1\n * \n * @param {string} \tfieldType - A valid field type\n *\n * @return {string} A valid dummy value for that field type\n */\n\nexport function getExampleValueByFieldType( fieldType ){\n\tlet value = '';\n\n\tswitch( fieldType ){\n\n\t\tcase 'select':\n\t\t\tvalue = 'option';\n\t\t\tbreak;\n\n\t\tcase 'text':\n\t\t\tvalue = 'lorem-ipsum';\n\t\t\tbreak;\n\n\t\tcase 'textarea':\n\t\t\tvalue = '<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum finibus eros nunc, et posuere libero posuere a. Nam viverra mattis finibus. Aenean purus lorem, mollis vel ullamcorper ac</p>';\n\t\t\tbreak;\n\n\t\tcase 'int':\n\t\t\tvalue = 1;\n\t\t\tbreak;\n\n\t\tcase 'float':\n\t\t\tvalue = 1.1;\n\t\t\tbreak;\n\n\t\tcase 'url':\n\t\t\tvalue = 'https://example.com';\n\t\t\tbreak;\n\n\t\tcase 'email':\n\t\t\tvalue = 'example@example.com';\n\t\t\tbreak;\n\n\t\tcase 'checkbox':\n\t\t\tvalue = true;\n\t\t\tbreak;\n\n\t\tcase 'radio':\n\t\t\tvalue = 'option';\n\t\t\tbreak;\n\n\t\tcase 'date':\n\t\t\tvalue = '2021-12-31';\n\t\t\tbreak;\n\n\t\tcase '':\n\t\t\tvalue = '01:00 PM';\n\t\t\tbreak;\n\t}\n\n\treturn value;\n}\n\n/**\n * Convert an invalid url into a valid one.\n * This function checks if the url is valid, if it is then it returns the url without modifying it, but if it is not then adds\n * the {{site_url}} before the string. It also checks if the string starts with / or not to recognize relative paths\n * Examples:\n * string \t\t\t\t=> {{site_url}}/string\n * /string \t\t\t\t=> {{site_url}}/string\n * https://google.com \t=> https://google.com\n * {{non_url_token}} \t=> {{site_url}}/{{non_url_token}}\n * /?id={{id}} \t\t\t=> {{site_url}}/?id={{id}}\n * \n * @since 0.1\n *\n * @param {string} \t\turl - The url\n * @param {object} \t\tattributes - URL attributes\n * @param {boolean} \tattributes.supportsTokens - TRUE if the URL should support tokens\n *\n * @return {object}\n * @return {boolean} \tresponse.changed - TRUE if the returned URL is different from the original one\n * @return {boolean} \tresponse.isValid - TRUE if the URL is valid\n * @return {string} \tresponse.newURL - New valid URL. If the URL was already valid then it just have the original URL\n * @return {string} \tresponse.simulatedURL - Simulated URL\n */\n\nexport function parseURL( url, attributes = { supportsTokens: false } ){\n\t// Create response object\n\tlet response = {\n\t\tchanged: false,\n\t\tisValid: false,\n\t\tnewURL: null,\n\t\tsimulatedURL: null\n\t}\n\n\t// Replace all spaces with %20\n\turl = url.replace( / /g, '%20' );\n\n\t// Create regular expression to be used to check if an URL is valid\n\t// https://regex101.com/r/0TFlPM/1/\n\tlet regexURL = new RegExp( \"^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?\" );\n\n\t// Get tokens. Read getTokensFromString comments for more information\n\tlet tokensInValue = getTokensFromString( url );\n\n\t// Create variable that will store the new URL. The default value is the original URL because we're going to compare\n\t// this variable with the \"url\" variable. If both are the same then we know that the original value wasn't modified and it was already valid\n\tlet newURL = url;\n\n\t// Check if it supports tokens and has tokens\n\tif ( attributes.supportsTokens && tokensInValue.hasTokens ){\n\t\t// Replace tokens in string with dummy values. Read replaceTokensInString comments for more information\n\t\tlet simulate_url = replaceTokensInString( url );\n\t\tresponse.simulatedURL = simulate_url;\n\n\t\t// Check if it's a valid URL\n\t\tif ( regexURL.test( simulate_url ) ){\n\t\t\tresponse.isValid = true;\n\t\t}\n\t\telse {\n\t\t\t// It's not valid, so now we have to create a valid one\n\t\t\t// Check if it starts with /\n\t\t\tif ( url[0] == '/' ){\n\t\t\t\t// In that case we only have to prepend the site URL to it\n\t\t\t\tnewURL = UncannyAutomator.siteURL + url;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// If it doesn't start with / then add it\n\t\t\t\tnewURL = UncannyAutomator.siteURL + '/' + url;\n\t\t\t}\n\n\t\t\t// Check if it's a valid URL now\n\t\t\tif ( regexURL.test( newURL ) ){\n\t\t\t\tresponse.isValid = true;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\t// URL without tokens, check if it's a valid\n\t\tif ( regexURL.test( url ) ){\n\t\t\tresponse.isValid = true;\n\t\t}\n\t\telse {\n\t\t\t// It's not valid, so now we have to create a valid one\n\t\t\t// Check if it starts with /\n\t\t\tif ( url[0] == '/' ){\n\t\t\t\t// In that case we only have to prepend the site URL to it\n\t\t\t\tnewURL = UncannyAutomator.siteURL + url;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// If it doesn't start with / then add it\n\t\t\t\tnewURL = UncannyAutomator.siteURL + '/' + url;\n\t\t\t}\n\n\t\t\t// Check if it's a valid URL now\n\t\t\tif ( regexURL.test( newURL ) ){\n\t\t\t\tresponse.isValid = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tresponse.newURL = newURL;\n\n\t// Check if the newURL it's the same as the original URL. \n\t// If both are the same then we know that the original value wasn't modified and it was already valid\n\tif ( response.newURL != url ){\n\t\tresponse.changed = true;\n\t}\n\n\treturn response;\n}\n\n/**\n * jQuery plugin used to validate the URL fields while user writes a value (input event)\n * If the value is not valid then it shows to the user how the URL is going to be converted\n * in the plugin to make it valid. Check parseURL comments to learn more about how a URL can be changed.\n *\n * @since 0.1\n *\n * @return {object} jQuery Object\n */\n\n(function ($){\n\t$.fn.checkURL = function ( options ){\n\t\treturn this.each( function (){\n\t\t\t// Just for version 0.1 and 0.2 we are not fixing the URL, instead we're only checking if the original value is a valid URL\n\t\t\t// This has to be uncommented\n\n\t\t\t// Get current jQuery object\n\t\t\tlet $this = $(this);\n\n\t\t\t// Overwrite default settings with the ones given by the user\n\t\t\tlet settings = $.extend({\n\t\t\t\t'preURL': 'Final URL: '\n\t\t\t}, options);\n\n\t\t\t// Create object with useful jQuery objects\n\t\t\tlet elements = {\n\t\t\t\tcontainer:  $this,\n\t\t\t\tinput: \t\t$this.find( '.form-element__input' ),\n\t\t\t}\n\n\t\t\t// Get input attributes\n\t\t\tlet input_attributes = {\n\t\t\t\trequired: \t\t\telements.input.data( 'required' ),\n\t\t\t\tsupportsTokens: \telements.input.data( 'supportstokens' )\n\t\t\t}\n\n\t\t\t// Create DOM elements that will show the final URL to the user\n\t\t\tlet validationNotice = $( '<div/>', { 'class': 'form-input-url-notice' });\n\t\t\tlet validationNoticeHeader = $( '<div/>', { 'class': 'form-input-url-notice__header' });\n\t\t\tlet validationNoticeURL = $( '<div/>', { 'class': 'form-input-url-notice__url' });\n\n\t\t\tvalidationNoticeHeader.text( settings.preURL );\n\t\t\tvalidationNoticeHeader.appendTo( validationNotice );\n\t\t\tvalidationNoticeURL.appendTo( validationNotice );\n\t\t\tvalidationNotice.appendTo( elements.container );\n\n\t\t\t// Function to check if the URL is valid\n\t\t\tfunction validate( value ){\n\t\t\t\tlet url = parseURL( value, input_attributes );\n\n\t\t\t\t// If the URL is different then show the \"Final URL\" container\n\t\t\t\tif ( value != '' && url.isValid && url.changed ){\n\t\t\t\t\tvalidationNotice.addClass( 'form-input-url-notice--show' );\n\t\t\t\t\tvalidationNoticeURL.text( url.newURL );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvalidationNotice.removeClass( 'form-input-url-notice--show' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check on page load to verify if the default value will be converted\n\t\t\tif ( elements.input.val() != '' ){\n\t\t\t\tvalidate( elements.input.val() );\n\t\t\t}\n\n\t\t\t// Bind input event and invoke validate\n\t\t\telements.container.on( 'automator:field:change', function(){\n\t\t\t\tvalidate( elements.input.val() );\n\t\t\t});\n\n\t\t\treturn this;\n\t\t});\n\t}\n}(jQuery));\n\n/**\n * Call checkURL jQuery plugin in each URL field\n *\n * @since 0.1\n *\n * @param {...objects} \tfields - jQuery objects \n *\n * @return {object} jQuery object\n */\n\nexport function initURLChecker( fields ){\n\tfields.checkURL();\n}","\"use strict\";\nif (typeof Object.assign !== \"function\") {\n    Object.assign = function (target, ...args) {\n        if (!target) {\n            throw TypeError(\"Cannot convert undefined or null to object\");\n        }\n        for (const source of args) {\n            if (source) {\n                Object.keys(source).forEach((key) => (target[key] = source[key]));\n            }\n        }\n        return target;\n    };\n}\n","/*\n * HTML5Sortable package\n * https://github.com/lukasoppermann/html5sortable\n *\n * Maintained by Lukas Oppermann <lukas@vea.re>\n *\n * Released under the MIT license.\n */\n'use strict';\n\n/**\n * Get or set data on element\n * @param {HTMLElement} element\n * @param {string} key\n * @param {any} value\n * @return {*}\n */\nfunction addData(element, key, value) {\n    if (value === undefined) {\n        return element && element.h5s && element.h5s.data && element.h5s.data[key];\n    }\n    else {\n        element.h5s = element.h5s || {};\n        element.h5s.data = element.h5s.data || {};\n        element.h5s.data[key] = value;\n    }\n}\n/**\n * Remove data from element\n * @param {HTMLElement} element\n */\nfunction removeData(element) {\n    if (element.h5s) {\n        delete element.h5s.data;\n    }\n}\n\n/* eslint-env browser */\n/**\n * Filter only wanted nodes\n * @param {NodeList|HTMLCollection|Array} nodes\n * @param {String} selector\n * @returns {Array}\n */\nvar filter = (function (nodes, selector) {\n    if (!(nodes instanceof NodeList || nodes instanceof HTMLCollection || nodes instanceof Array)) {\n        throw new Error('You must provide a nodeList/HTMLCollection/Array of elements to be filtered.');\n    }\n    if (typeof selector !== 'string') {\n        return Array.from(nodes);\n    }\n    return Array.from(nodes).filter(function (item) { return item.nodeType === 1 && item.matches(selector); });\n});\n\n/* eslint-env browser */\n/* eslint-disable no-use-before-define */\nvar stores = new Map();\n/* eslint-enable no-use-before-define */\n/**\n * Stores data & configurations per Sortable\n * @param {Object} config\n */\nvar Store = /** @class */ (function () {\n    function Store() {\n        this._config = new Map(); // eslint-disable-line no-undef\n        this._placeholder = undefined; // eslint-disable-line no-undef\n        this._data = new Map(); // eslint-disable-line no-undef\n    }\n    Object.defineProperty(Store.prototype, \"config\", {\n        /**\n         * get the configuration map of a class instance\n         * @method config\n         * @return {object}\n         */\n        get: function () {\n            // transform Map to object\n            var config = {};\n            this._config.forEach(function (value, key) {\n                config[key] = value;\n            });\n            // return object\n            return config;\n        },\n        /**\n         * set the configuration of a class instance\n         * @method config\n         * @param {object} config object of configurations\n         */\n        set: function (config) {\n            if (typeof config !== 'object') {\n                throw new Error('You must provide a valid configuration object to the config setter.');\n            }\n            // combine config with default\n            var mergedConfig = Object.assign({}, config);\n            // add config to map\n            this._config = new Map(Object.entries(mergedConfig));\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * set individual configuration of a class instance\n     * @method setConfig\n     * @param  key valid configuration key\n     * @param  value any value\n     * @return void\n     */\n    Store.prototype.setConfig = function (key, value) {\n        if (!this._config.has(key)) {\n            throw new Error(\"Trying to set invalid configuration item: \" + key);\n        }\n        // set config\n        this._config.set(key, value);\n    };\n    /**\n     * get an individual configuration of a class instance\n     * @method getConfig\n     * @param  key valid configuration key\n     * @return any configuration value\n     */\n    Store.prototype.getConfig = function (key) {\n        if (!this._config.has(key)) {\n            throw new Error(\"Invalid configuration item requested: \" + key);\n        }\n        return this._config.get(key);\n    };\n    Object.defineProperty(Store.prototype, \"placeholder\", {\n        /**\n         * get the placeholder for a class instance\n         * @method placeholder\n         * @return {HTMLElement|null}\n         */\n        get: function () {\n            return this._placeholder;\n        },\n        /**\n         * set the placeholder for a class instance\n         * @method placeholder\n         * @param {HTMLElement} placeholder\n         * @return {void}\n         */\n        set: function (placeholder) {\n            if (!(placeholder instanceof HTMLElement) && placeholder !== null) {\n                throw new Error('A placeholder must be an html element or null.');\n            }\n            this._placeholder = placeholder;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * set an data entry\n     * @method setData\n     * @param {string} key\n     * @param {any} value\n     * @return {void}\n     */\n    Store.prototype.setData = function (key, value) {\n        if (typeof key !== 'string') {\n            throw new Error('The key must be a string.');\n        }\n        this._data.set(key, value);\n    };\n    /**\n     * get an data entry\n     * @method getData\n     * @param {string} key an existing key\n     * @return {any}\n     */\n    Store.prototype.getData = function (key) {\n        if (typeof key !== 'string') {\n            throw new Error('The key must be a string.');\n        }\n        return this._data.get(key);\n    };\n    /**\n     * delete an data entry\n     * @method deleteData\n     * @param {string} key an existing key\n     * @return {boolean}\n     */\n    Store.prototype.deleteData = function (key) {\n        if (typeof key !== 'string') {\n            throw new Error('The key must be a string.');\n        }\n        return this._data.delete(key);\n    };\n    return Store;\n}());\n/**\n * @param {HTMLElement} sortableElement\n * @returns {Class: Store}\n */\nvar store = (function (sortableElement) {\n    // if sortableElement is wrong type\n    if (!(sortableElement instanceof HTMLElement)) {\n        throw new Error('Please provide a sortable to the store function.');\n    }\n    // create new instance if not avilable\n    if (!stores.has(sortableElement)) {\n        stores.set(sortableElement, new Store());\n    }\n    // return instance\n    return stores.get(sortableElement);\n});\n\n/**\n * @param {Array|HTMLElement} element\n * @param {Function} callback\n * @param {string} event\n */\nfunction addEventListener(element, eventName, callback) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            addEventListener(element[i], eventName, callback);\n        }\n        return;\n    }\n    element.addEventListener(eventName, callback);\n    store(element).setData(\"event\" + eventName, callback);\n}\n/**\n * @param {Array<HTMLElement>|HTMLElement} element\n * @param {string} eventName\n */\nfunction removeEventListener(element, eventName) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            removeEventListener(element[i], eventName);\n        }\n        return;\n    }\n    element.removeEventListener(eventName, store(element).getData(\"event\" + eventName));\n    store(element).deleteData(\"event\" + eventName);\n}\n\n/**\n * @param {Array<HTMLElement>|HTMLElement} element\n * @param {string} attribute\n * @param {string} value\n */\nfunction addAttribute(element, attribute, value) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            addAttribute(element[i], attribute, value);\n        }\n        return;\n    }\n    element.setAttribute(attribute, value);\n}\n/**\n * @param {Array|HTMLElement} element\n * @param {string} attribute\n */\nfunction removeAttribute(element, attribute) {\n    if (element instanceof Array) {\n        for (var i = 0; i < element.length; ++i) {\n            removeAttribute(element[i], attribute);\n        }\n        return;\n    }\n    element.removeAttribute(attribute);\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {Object}\n */\nvar offset = (function (element) {\n    if (!element.parentElement || element.getClientRects().length === 0) {\n        throw new Error('target element must be part of the dom');\n    }\n    var rect = element.getClientRects()[0];\n    return {\n        left: rect.left + window.pageXOffset,\n        right: rect.right + window.pageXOffset,\n        top: rect.top + window.pageYOffset,\n        bottom: rect.bottom + window.pageYOffset\n    };\n});\n\n/**\n * Creates and returns a new debounced version of the passed function which will postpone its execution until after wait milliseconds have elapsed\n * @param {Function} func to debounce\n * @param {number} time to wait before calling function with latest arguments, 0 - no debounce\n * @returns {function} - debounced function\n */\nvar debounce = (function (func, wait) {\n    if (wait === void 0) { wait = 0; }\n    var timeout;\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        clearTimeout(timeout);\n        timeout = setTimeout(function () {\n            func.apply(void 0, args);\n        }, wait);\n    };\n});\n\n/* eslint-env browser */\n/**\n * Get position of the element relatively to its sibling elements\n * @param {HTMLElement} element\n * @returns {number}\n */\nvar getIndex = (function (element, elementList) {\n    if (!(element instanceof HTMLElement) || !(elementList instanceof NodeList || elementList instanceof HTMLCollection || elementList instanceof Array)) {\n        throw new Error('You must provide an element and a list of elements.');\n    }\n    return Array.from(elementList).indexOf(element);\n});\n\n/* eslint-env browser */\n/**\n * Test whether element is in DOM\n * @param {HTMLElement} element\n * @returns {boolean}\n */\nvar isInDom = (function (element) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('Element is not a node element.');\n    }\n    return element.parentNode !== null;\n});\n\n/* eslint-env browser */\n/**\n * Insert node before or after target\n * @param {HTMLElement} referenceNode - reference element\n * @param {HTMLElement} newElement - element to be inserted\n * @param {String} position - insert before or after reference element\n */\nvar insertNode = function (referenceNode, newElement, position) {\n    if (!(referenceNode instanceof HTMLElement) || !(referenceNode.parentElement instanceof HTMLElement)) {\n        throw new Error('target and element must be a node');\n    }\n    referenceNode.parentElement.insertBefore(newElement, (position === 'before' ? referenceNode : referenceNode.nextElementSibling));\n};\n/**\n * Insert before target\n * @param {HTMLElement} target\n * @param {HTMLElement} element\n */\nvar insertBefore = function (target, element) { return insertNode(target, element, 'before'); };\n/**\n * Insert after target\n * @param {HTMLElement} target\n * @param {HTMLElement} element\n */\nvar insertAfter = function (target, element) { return insertNode(target, element, 'after'); };\n\n/* eslint-env browser */\n/**\n * Filter only wanted nodes\n * @param {HTMLElement} sortableContainer\n * @param {Function} customSerializer\n * @returns {Array}\n */\nvar serialize = (function (sortableContainer, customItemSerializer, customContainerSerializer) {\n    if (customItemSerializer === void 0) { customItemSerializer = function (serializedItem, sortableContainer) { return serializedItem; }; }\n    if (customContainerSerializer === void 0) { customContainerSerializer = function (serializedContainer) { return serializedContainer; }; }\n    // check for valid sortableContainer\n    if (!(sortableContainer instanceof HTMLElement) || !sortableContainer.isSortable === true) {\n        throw new Error('You need to provide a sortableContainer to be serialized.');\n    }\n    // check for valid serializers\n    if (typeof customItemSerializer !== 'function' || typeof customContainerSerializer !== 'function') {\n        throw new Error('You need to provide a valid serializer for items and the container.');\n    }\n    // get options\n    var options = addData(sortableContainer, 'opts');\n    var item = options.items;\n    // serialize container\n    var items = filter(sortableContainer.children, item);\n    var serializedItems = items.map(function (item) {\n        return {\n            parent: sortableContainer,\n            node: item,\n            html: item.outerHTML,\n            index: getIndex(item, items)\n        };\n    });\n    // serialize container\n    var container = {\n        node: sortableContainer,\n        itemCount: serializedItems.length\n    };\n    return {\n        container: customContainerSerializer(container),\n        items: serializedItems.map(function (item) { return customItemSerializer(item, sortableContainer); })\n    };\n});\n\n/* eslint-env browser */\n/**\n * create a placeholder element\n * @param {HTMLElement} sortableElement a single sortable\n * @param {string|undefined} placeholder a string representing an html element\n * @param {string} placeholderClasses a string representing the classes that should be added to the placeholder\n */\nvar makePlaceholder = (function (sortableElement, placeholder, placeholderClass) {\n    var _a;\n    if (placeholderClass === void 0) { placeholderClass = 'sortable-placeholder'; }\n    if (!(sortableElement instanceof HTMLElement)) {\n        throw new Error('You must provide a valid element as a sortable.');\n    }\n    // if placeholder is not an element\n    if (!(placeholder instanceof HTMLElement) && placeholder !== undefined) {\n        throw new Error('You must provide a valid element as a placeholder or set ot to undefined.');\n    }\n    // if no placeholder element is given\n    if (placeholder === undefined) {\n        if (['UL', 'OL'].includes(sortableElement.tagName)) {\n            placeholder = document.createElement('li');\n        }\n        else if (['TABLE', 'TBODY'].includes(sortableElement.tagName)) {\n            placeholder = document.createElement('tr');\n            // set colspan to always all rows, otherwise the item can only be dropped in first column\n            placeholder.innerHTML = '<td colspan=\"100\"></td>';\n        }\n        else {\n            placeholder = document.createElement('div');\n        }\n    }\n    // add classes to placeholder\n    if (typeof placeholderClass === 'string') {\n        (_a = placeholder.classList).add.apply(_a, placeholderClass.split(' '));\n    }\n    return placeholder;\n});\n\n/* eslint-env browser */\n/**\n * Get height of an element including padding\n * @param {HTMLElement} element an dom element\n */\nvar getElementHeight = (function (element) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('You must provide a valid dom element');\n    }\n    // get calculated style of element\n    var style = window.getComputedStyle(element);\n    // get only height if element has box-sizing: border-box specified\n    if (style.getPropertyValue('box-sizing') === 'border-box') {\n        return parseInt(style.getPropertyValue('height'), 10);\n    }\n    // pick applicable properties, convert to int and reduce by adding\n    return ['height', 'padding-top', 'padding-bottom']\n        .map(function (key) {\n        var int = parseInt(style.getPropertyValue(key), 10);\n        return isNaN(int) ? 0 : int;\n    })\n        .reduce(function (sum, value) { return sum + value; });\n});\n\n/* eslint-env browser */\n/**\n * Get width of an element including padding\n * @param {HTMLElement} element an dom element\n */\nvar getElementWidth = (function (element) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('You must provide a valid dom element');\n    }\n    // get calculated style of element\n    var style = window.getComputedStyle(element);\n    // pick applicable properties, convert to int and reduce by adding\n    return ['width', 'padding-left', 'padding-right']\n        .map(function (key) {\n        var int = parseInt(style.getPropertyValue(key), 10);\n        return isNaN(int) ? 0 : int;\n    })\n        .reduce(function (sum, value) { return sum + value; });\n});\n\n/* eslint-env browser */\n/**\n * get handle or return item\n * @param {Array<HTMLElement>} items\n * @param {string} selector\n */\nvar getHandles = (function (items, selector) {\n    if (!(items instanceof Array)) {\n        throw new Error('You must provide a Array of HTMLElements to be filtered.');\n    }\n    if (typeof selector !== 'string') {\n        return items;\n    }\n    return items\n        // remove items without handle from array\n        .filter(function (item) {\n        return item.querySelector(selector) instanceof HTMLElement ||\n            (item.shadowRoot && item.shadowRoot.querySelector(selector) instanceof HTMLElement);\n    })\n        // replace item with handle in array\n        .map(function (item) {\n        return item.querySelector(selector) || (item.shadowRoot && item.shadowRoot.querySelector(selector));\n    });\n});\n\n/**\n * @param {Event} event\n * @returns {HTMLElement}\n */\nvar getEventTarget = (function (event) {\n    return (event.composedPath && event.composedPath()[0]) || event.target;\n});\n\n/* eslint-env browser */\n/**\n * defaultDragImage returns the current item as dragged image\n * @param {HTMLElement} draggedElement - the item that the user drags\n * @param {object} elementOffset - an object with the offsets top, left, right & bottom\n * @param {Event} event - the original drag event object\n * @return {object} with element, posX and posY properties\n */\nvar defaultDragImage = function (draggedElement, elementOffset, event) {\n    return {\n        element: draggedElement,\n        posX: event.pageX - elementOffset.left,\n        posY: event.pageY - elementOffset.top\n    };\n};\n/**\n * attaches an element as the drag image to an event\n * @param {Event} event - the original drag event object\n * @param {HTMLElement} draggedElement - the item that the user drags\n * @param {Function} customDragImage - function to create a custom dragImage\n * @return void\n */\nvar setDragImage = (function (event, draggedElement, customDragImage) {\n    // check if event is provided\n    if (!(event instanceof Event)) {\n        throw new Error('setDragImage requires a DragEvent as the first argument.');\n    }\n    // check if draggedElement is provided\n    if (!(draggedElement instanceof HTMLElement)) {\n        throw new Error('setDragImage requires the dragged element as the second argument.');\n    }\n    // set default function of none provided\n    if (!customDragImage) {\n        customDragImage = defaultDragImage;\n    }\n    // check if setDragImage method is available\n    if (event.dataTransfer && event.dataTransfer.setDragImage) {\n        // get the elements offset\n        var elementOffset = offset(draggedElement);\n        // get the dragImage\n        var dragImage = customDragImage(draggedElement, elementOffset, event);\n        // check if custom function returns correct values\n        if (!(dragImage.element instanceof HTMLElement) || typeof dragImage.posX !== 'number' || typeof dragImage.posY !== 'number') {\n            throw new Error('The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].');\n        }\n        // needs to be set for HTML5 drag & drop to work\n        event.dataTransfer.effectAllowed = 'copyMove';\n        // Firefox requires it to use the event target's id for the data\n        event.dataTransfer.setData('text/plain', getEventTarget(event).id);\n        // set the drag image on the event\n        event.dataTransfer.setDragImage(dragImage.element, dragImage.posX, dragImage.posY);\n    }\n});\n\n/**\n * Check if curList accepts items from destList\n * @param {sortable} destination the container an item is move to\n * @param {sortable} origin the container an item comes from\n */\nvar listsConnected = (function (destination, origin) {\n    // check if valid sortable\n    if (destination.isSortable === true) {\n        var acceptFrom = store(destination).getConfig('acceptFrom');\n        // check if acceptFrom is valid\n        if (acceptFrom !== null && acceptFrom !== false && typeof acceptFrom !== 'string') {\n            throw new Error('HTML5Sortable: Wrong argument, \"acceptFrom\" must be \"null\", \"false\", or a valid selector string.');\n        }\n        if (acceptFrom !== null) {\n            return acceptFrom !== false && acceptFrom.split(',').filter(function (sel) {\n                return sel.length > 0 && origin.matches(sel);\n            }).length > 0;\n        }\n        // drop in same list\n        if (destination === origin) {\n            return true;\n        }\n        // check if lists are connected with connectWith\n        if (store(destination).getConfig('connectWith') !== undefined && store(destination).getConfig('connectWith') !== null) {\n            return store(destination).getConfig('connectWith') === store(origin).getConfig('connectWith');\n        }\n    }\n    return false;\n});\n\n/**\n * default configurations\n */\nvar defaultConfiguration = {\n    items: null,\n    // deprecated\n    connectWith: null,\n    // deprecated\n    disableIEFix: null,\n    acceptFrom: null,\n    copy: false,\n    placeholder: null,\n    placeholderClass: 'sortable-placeholder',\n    draggingClass: 'sortable-dragging',\n    hoverClass: false,\n    dropTargetContainerClass: false,\n    debounce: 0,\n    throttleTime: 100,\n    maxItems: 0,\n    itemSerializer: undefined,\n    containerSerializer: undefined,\n    customDragImage: null,\n    orientation: 'vertical'\n};\n\n/**\n * make sure a function is only called once within the given amount of time\n * @param {Function} fn the function to throttle\n * @param {number} threshold time limit for throttling\n */\n// must use function to keep this context\nfunction throttle (fn, threshold) {\n    var _this = this;\n    if (threshold === void 0) { threshold = 250; }\n    // check function\n    if (typeof fn !== 'function') {\n        throw new Error('You must provide a function as the first argument for throttle.');\n    }\n    // check threshold\n    if (typeof threshold !== 'number') {\n        throw new Error('You must provide a number as the second argument for throttle.');\n    }\n    var lastEventTimestamp = null;\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var now = Date.now();\n        if (lastEventTimestamp === null || now - lastEventTimestamp >= threshold) {\n            lastEventTimestamp = now;\n            fn.apply(_this, args);\n        }\n    };\n}\n\n/* eslint-env browser */\n/**\n * enable or disable hoverClass on mouseenter/leave if container Items\n * @param {sortable} sortableContainer a valid sortableContainer\n * @param {boolean} enable enable or disable event\n */\nvar enableHoverClass = (function (sortableContainer, enable) {\n    if (typeof store(sortableContainer).getConfig('hoverClass') === 'string') {\n        var hoverClasses_1 = store(sortableContainer).getConfig('hoverClass').split(' ');\n        // add class on hover\n        if (enable === true) {\n            addEventListener(sortableContainer, 'mousemove', throttle(function (event) {\n                // check of no mouse button was pressed when mousemove started == no drag\n                if (event.buttons === 0) {\n                    filter(sortableContainer.children, store(sortableContainer).getConfig('items')).forEach(function (item) {\n                        var _a, _b;\n                        if (item === event.target || item.contains(event.target)) {\n                            (_a = item.classList).add.apply(_a, hoverClasses_1);\n                        }\n                        else {\n                            (_b = item.classList).remove.apply(_b, hoverClasses_1);\n                        }\n                    });\n                }\n            }, store(sortableContainer).getConfig('throttleTime')));\n            // remove class on leave\n            addEventListener(sortableContainer, 'mouseleave', function () {\n                filter(sortableContainer.children, store(sortableContainer).getConfig('items')).forEach(function (item) {\n                    var _a;\n                    (_a = item.classList).remove.apply(_a, hoverClasses_1);\n                });\n            });\n            // remove events\n        }\n        else {\n            removeEventListener(sortableContainer, 'mousemove');\n            removeEventListener(sortableContainer, 'mouseleave');\n        }\n    }\n});\n\n/* eslint-env browser */\n/*\n * variables global to the plugin\n */\nvar dragging;\nvar draggingHeight;\nvar draggingWidth;\n/*\n * Keeps track of the initialy selected list, where 'dragstart' event was triggered\n * It allows us to move the data in between individual Sortable List instances\n */\n// Origin List - data from before any item was changed\nvar originContainer;\nvar originIndex;\nvar originElementIndex;\nvar originItemsBeforeUpdate;\n// Previous Sortable Container - we dispatch as sortenter event when a\n// dragged item enters a sortableContainer for the first time\nvar previousContainer;\n// Destination List - data from before any item was changed\nvar destinationItemsBeforeUpdate;\n/**\n * remove event handlers from items\n * @param {Array|NodeList} items\n */\nvar removeItemEvents = function (items) {\n    removeEventListener(items, 'dragstart');\n    removeEventListener(items, 'dragend');\n    removeEventListener(items, 'dragover');\n    removeEventListener(items, 'dragenter');\n    removeEventListener(items, 'drop');\n    removeEventListener(items, 'mouseenter');\n    removeEventListener(items, 'mouseleave');\n};\n// Remove container events\nvar removeContainerEvents = function (originContainer, previousContainer) {\n    if (originContainer) {\n        removeEventListener(originContainer, 'dragleave');\n    }\n    if (previousContainer && (previousContainer !== originContainer)) {\n        removeEventListener(previousContainer, 'dragleave');\n    }\n};\n/**\n * getDragging returns the current element to drag or\n * a copy of the element.\n * Is Copy Active for sortable\n * @param {HTMLElement} draggedItem - the item that the user drags\n * @param {HTMLElement} sortable a single sortable\n */\nvar getDragging = function (draggedItem, sortable) {\n    var ditem = draggedItem;\n    if (store(sortable).getConfig('copy') === true) {\n        ditem = draggedItem.cloneNode(true);\n        addAttribute(ditem, 'aria-copied', 'true');\n        draggedItem.parentElement.appendChild(ditem);\n        ditem.style.display = 'none';\n        ditem.oldDisplay = draggedItem.style.display;\n    }\n    return ditem;\n};\n/**\n * Remove data from sortable\n * @param {HTMLElement} sortable a single sortable\n */\nvar removeSortableData = function (sortable) {\n    removeData(sortable);\n    removeAttribute(sortable, 'aria-dropeffect');\n};\n/**\n * Remove data from items\n * @param {Array<HTMLElement>|HTMLElement} items\n */\nvar removeItemData = function (items) {\n    removeAttribute(items, 'aria-grabbed');\n    removeAttribute(items, 'aria-copied');\n    removeAttribute(items, 'draggable');\n    removeAttribute(items, 'role');\n};\n/**\n * find sortable from element. travels up parent element until found or null.\n * @param {HTMLElement} element a single sortable\n * @param {Event} event - the current event. We need to pass it to be able to\n * find Sortable whith shadowRoot (document fragment has no parent)\n */\nfunction findSortable(element, event) {\n    if (event.composedPath) {\n        return event.composedPath().find(function (el) { return el.isSortable; });\n    }\n    while (element.isSortable !== true) {\n        element = element.parentElement;\n    }\n    return element;\n}\n/**\n * Dragging event is on the sortable element. finds the top child that\n * contains the element.\n * @param {HTMLElement} sortableElement a single sortable\n * @param {HTMLElement} element is that being dragged\n */\nfunction findDragElement(sortableElement, element) {\n    var options = addData(sortableElement, 'opts');\n    var items = filter(sortableElement.children, options.items);\n    var itemlist = items.filter(function (ele) {\n        return ele.contains(element) || (ele.shadowRoot && ele.shadowRoot.contains(element));\n    });\n    return itemlist.length > 0 ? itemlist[0] : element;\n}\n/**\n * Destroy the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar destroySortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts') || {};\n    var items = filter(sortableElement.children, opts.items);\n    var handles = getHandles(items, opts.handle);\n    // disable adding hover class\n    enableHoverClass(sortableElement, false);\n    // remove event handlers & data from sortable\n    removeEventListener(sortableElement, 'dragover');\n    removeEventListener(sortableElement, 'dragenter');\n    removeEventListener(sortableElement, 'dragstart');\n    removeEventListener(sortableElement, 'dragend');\n    removeEventListener(sortableElement, 'drop');\n    // remove event data from sortable\n    removeSortableData(sortableElement);\n    // remove event handlers & data from items\n    removeEventListener(handles, 'mousedown');\n    removeItemEvents(items);\n    removeItemData(items);\n    removeContainerEvents(originContainer, previousContainer);\n    // clear sortable flag\n    sortableElement.isSortable = false;\n};\n/**\n * Enable the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar enableSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = filter(sortableElement.children, opts.items);\n    var handles = getHandles(items, opts.handle);\n    addAttribute(sortableElement, 'aria-dropeffect', 'move');\n    addData(sortableElement, '_disabled', 'false');\n    addAttribute(handles, 'draggable', 'true');\n    // enable hover class\n    enableHoverClass(sortableElement, true);\n    // @todo: remove this fix\n    // IE FIX for ghost\n    // can be disabled as it has the side effect that other events\n    // (e.g. click) will be ignored\n    if (opts.disableIEFix === false) {\n        var spanEl = (document || window.document).createElement('span');\n        if (typeof spanEl.dragDrop === 'function') {\n            addEventListener(handles, 'mousedown', function () {\n                if (items.indexOf(this) !== -1) {\n                    this.dragDrop();\n                }\n                else {\n                    var parent = this.parentElement;\n                    while (items.indexOf(parent) === -1) {\n                        parent = parent.parentElement;\n                    }\n                    parent.dragDrop();\n                }\n            });\n        }\n    }\n};\n/**\n * Disable the sortable\n * @param {HTMLElement} sortableElement a single sortable\n */\nvar disableSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = filter(sortableElement.children, opts.items);\n    var handles = getHandles(items, opts.handle);\n    addAttribute(sortableElement, 'aria-dropeffect', 'none');\n    addData(sortableElement, '_disabled', 'true');\n    addAttribute(handles, 'draggable', 'false');\n    removeEventListener(handles, 'mousedown');\n    enableHoverClass(sortableElement, false);\n};\n/**\n * Reload the sortable\n * @param {HTMLElement} sortableElement a single sortable\n * @description events need to be removed to not be double bound\n */\nvar reloadSortable = function (sortableElement) {\n    var opts = addData(sortableElement, 'opts');\n    var items = filter(sortableElement.children, opts.items);\n    var handles = getHandles(items, opts.handle);\n    addData(sortableElement, '_disabled', 'false');\n    // remove event handlers from items\n    removeItemEvents(items);\n    removeContainerEvents(originContainer, previousContainer);\n    removeEventListener(handles, 'mousedown');\n    // remove event handlers from sortable\n    removeEventListener(sortableElement, 'dragover');\n    removeEventListener(sortableElement, 'dragenter');\n    removeEventListener(sortableElement, 'drop');\n};\n/**\n * Public sortable object\n * @param {Array|NodeList} sortableElements\n * @param {object|string} options|method\n */\nfunction sortable(sortableElements, options) {\n    // get method string to see if a method is called\n    var method = String(options);\n    options = options || {};\n    // check if the user provided a selector instead of an element\n    if (typeof sortableElements === 'string') {\n        sortableElements = document.querySelectorAll(sortableElements);\n    }\n    // if the user provided an element, return it in an array to keep the return value consistant\n    if (sortableElements instanceof HTMLElement) {\n        sortableElements = [sortableElements];\n    }\n    sortableElements = Array.prototype.slice.call(sortableElements);\n    if (/serialize/.test(method)) {\n        return sortableElements.map(function (sortableContainer) {\n            var opts = addData(sortableContainer, 'opts');\n            return serialize(sortableContainer, opts.itemSerializer, opts.containerSerializer);\n        });\n    }\n    sortableElements.forEach(function (sortableElement) {\n        if (/enable|disable|destroy/.test(method)) {\n            return sortable[method](sortableElement);\n        }\n        // log deprecation\n        ['connectWith', 'disableIEFix'].forEach(function (configKey) {\n            if (Object.prototype.hasOwnProperty.call(options, configKey) && options[configKey] !== null) {\n                console.warn(\"HTML5Sortable: You are using the deprecated configuration \\\"\" + configKey + \"\\\". This will be removed in an upcoming version, make sure to migrate to the new options when updating.\");\n            }\n        });\n        // merge options with default options\n        options = Object.assign({}, defaultConfiguration, store(sortableElement).config, options);\n        // init data store for sortable\n        store(sortableElement).config = options;\n        // set options on sortable\n        addData(sortableElement, 'opts', options);\n        // property to define as sortable\n        sortableElement.isSortable = true;\n        // reset sortable\n        reloadSortable(sortableElement);\n        // initialize\n        var listItems = filter(sortableElement.children, options.items);\n        // create element if user defined a placeholder element as a string\n        var customPlaceholder;\n        if (options.placeholder !== null && options.placeholder !== undefined) {\n            var tempContainer = document.createElement(sortableElement.tagName);\n            if (options.placeholder instanceof HTMLElement) {\n                tempContainer.appendChild(options.placeholder);\n            }\n            else {\n                tempContainer.innerHTML = options.placeholder;\n            }\n            customPlaceholder = tempContainer.children[0];\n        }\n        // add placeholder\n        store(sortableElement).placeholder = makePlaceholder(sortableElement, customPlaceholder, options.placeholderClass);\n        addData(sortableElement, 'items', options.items);\n        if (options.acceptFrom) {\n            addData(sortableElement, 'acceptFrom', options.acceptFrom);\n        }\n        else if (options.connectWith) {\n            addData(sortableElement, 'connectWith', options.connectWith);\n        }\n        enableSortable(sortableElement);\n        addAttribute(listItems, 'role', 'option');\n        addAttribute(listItems, 'aria-grabbed', 'false');\n        /*\n         Handle drag events on draggable items\n         Handle is set at the sortableElement level as it will bubble up\n         from the item\n         */\n        addEventListener(sortableElement, 'dragstart', function (e) {\n            // ignore dragstart events\n            var target = getEventTarget(e);\n            if (target.isSortable === true) {\n                return;\n            }\n            e.stopImmediatePropagation();\n            if ((options.handle && !target.matches(options.handle)) || target.getAttribute('draggable') === 'false') {\n                return;\n            }\n            var sortableContainer = findSortable(target, e);\n            var dragItem = findDragElement(sortableContainer, target);\n            // grab values\n            originItemsBeforeUpdate = filter(sortableContainer.children, options.items);\n            originIndex = originItemsBeforeUpdate.indexOf(dragItem);\n            originElementIndex = getIndex(dragItem, sortableContainer.children);\n            originContainer = sortableContainer;\n            // add transparent clone or other ghost to cursor\n            setDragImage(e, dragItem, options.customDragImage);\n            // cache selsection & add attr for dragging\n            draggingHeight = getElementHeight(dragItem);\n            draggingWidth = getElementWidth(dragItem);\n            dragItem.classList.add(options.draggingClass);\n            dragging = getDragging(dragItem, sortableContainer);\n            addAttribute(dragging, 'aria-grabbed', 'true');\n            // dispatch sortstart event on each element in group\n            sortableContainer.dispatchEvent(new CustomEvent('sortstart', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging,\n                    originalTarget: target\n                }\n            }));\n        });\n        /*\n         We are capturing targetSortable before modifications with 'dragenter' event\n        */\n        addEventListener(sortableElement, 'dragenter', function (e) {\n            var target = getEventTarget(e);\n            var sortableContainer = findSortable(target, e);\n            if (sortableContainer && sortableContainer !== previousContainer) {\n                destinationItemsBeforeUpdate = filter(sortableContainer.children, addData(sortableContainer, 'items'))\n                    .filter(function (item) { return item !== store(sortableElement).placeholder; });\n                if (options.dropTargetContainerClass) {\n                    sortableContainer.classList.add(options.dropTargetContainerClass);\n                }\n                sortableContainer.dispatchEvent(new CustomEvent('sortenter', {\n                    detail: {\n                        origin: {\n                            elementIndex: originElementIndex,\n                            index: originIndex,\n                            container: originContainer\n                        },\n                        destination: {\n                            container: sortableContainer,\n                            itemsBeforeUpdate: destinationItemsBeforeUpdate\n                        },\n                        item: dragging,\n                        originalTarget: target\n                    }\n                }));\n                addEventListener(sortableContainer, 'dragleave', function (e) {\n                    // TODO: rename outTarget to be more self-explanatory\n                    // e.fromElement for very old browsers, similar to relatedTarget\n                    var outTarget = e.relatedTarget || e.fromElement;\n                    if (!e.currentTarget.contains(outTarget)) {\n                        if (options.dropTargetContainerClass) {\n                            sortableContainer.classList.remove(options.dropTargetContainerClass);\n                        }\n                        sortableContainer.dispatchEvent(new CustomEvent('sortleave', {\n                            detail: {\n                                origin: {\n                                    elementIndex: originElementIndex,\n                                    index: originIndex,\n                                    container: sortableContainer\n                                },\n                                item: dragging,\n                                originalTarget: target\n                            }\n                        }));\n                    }\n                });\n            }\n            previousContainer = sortableContainer;\n        });\n        /*\n         * Dragend Event - https://developer.mozilla.org/en-US/docs/Web/Events/dragend\n         * Fires each time dragEvent end, or ESC pressed\n         * We are using it to clean up any draggable elements and placeholders\n         */\n        addEventListener(sortableElement, 'dragend', function (e) {\n            if (!dragging) {\n                return;\n            }\n            dragging.classList.remove(options.draggingClass);\n            addAttribute(dragging, 'aria-grabbed', 'false');\n            if (dragging.getAttribute('aria-copied') === 'true' && addData(dragging, 'dropped') !== 'true') {\n                dragging.remove();\n            }\n            if (dragging.oldDisplay !== undefined) {\n                dragging.style.display = dragging.oldDisplay;\n                delete dragging.oldDisplay;\n            }\n            var visiblePlaceholder = Array.from(stores.values()).map(function (data) { return data.placeholder; })\n                .filter(function (placeholder) { return placeholder instanceof HTMLElement; })\n                .filter(isInDom)[0];\n            if (visiblePlaceholder) {\n                visiblePlaceholder.remove();\n            }\n            // dispatch sortstart event on each element in group\n            sortableElement.dispatchEvent(new CustomEvent('sortstop', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging\n                }\n            }));\n            previousContainer = null;\n            dragging = null;\n            draggingHeight = null;\n            draggingWidth = null;\n        });\n        /*\n         * Drop Event - https://developer.mozilla.org/en-US/docs/Web/Events/drop\n         * Fires when valid drop target area is hit\n         */\n        addEventListener(sortableElement, 'drop', function (e) {\n            if (!listsConnected(sortableElement, dragging.parentElement)) {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n            addData(dragging, 'dropped', 'true');\n            // get the one placeholder that is currently visible\n            var visiblePlaceholder = Array.from(stores.values()).map(function (data) {\n                return data.placeholder;\n            })\n                // filter only HTMLElements\n                .filter(function (placeholder) { return placeholder instanceof HTMLElement; })\n                // only elements in DOM\n                .filter(isInDom)[0];\n            if (visiblePlaceholder) {\n                visiblePlaceholder.replaceWith(dragging);\n                // to avoid flickering restoring element display immediately after replacing placeholder\n                if (dragging.oldDisplay !== undefined) {\n                    dragging.style.display = dragging.oldDisplay;\n                    delete dragging.oldDisplay;\n                }\n            }\n            else {\n                // set the dropped value to 'false' to delete copied dragging at the time of 'dragend'\n                addData(dragging, 'dropped', 'false');\n                return;\n            }\n            /*\n             * Fires Custom Event - 'sortstop'\n             */\n            sortableElement.dispatchEvent(new CustomEvent('sortstop', {\n                detail: {\n                    origin: {\n                        elementIndex: originElementIndex,\n                        index: originIndex,\n                        container: originContainer\n                    },\n                    item: dragging\n                }\n            }));\n            var placeholder = store(sortableElement).placeholder;\n            var originItems = filter(originContainer.children, options.items)\n                .filter(function (item) { return item !== placeholder; });\n            var destinationContainer = this.isSortable === true ? this : this.parentElement;\n            var destinationItems = filter(destinationContainer.children, addData(destinationContainer, 'items'))\n                .filter(function (item) { return item !== placeholder; });\n            var destinationElementIndex = getIndex(dragging, Array.from(dragging.parentElement.children)\n                .filter(function (item) { return item !== placeholder; }));\n            var destinationIndex = getIndex(dragging, destinationItems);\n            if (options.dropTargetContainerClass) {\n                destinationContainer.classList.remove(options.dropTargetContainerClass);\n            }\n            /*\n             * When a list item changed container lists or index within a list\n             * Fires Custom Event - 'sortupdate'\n             */\n            if (originElementIndex !== destinationElementIndex || originContainer !== destinationContainer) {\n                sortableElement.dispatchEvent(new CustomEvent('sortupdate', {\n                    detail: {\n                        origin: {\n                            elementIndex: originElementIndex,\n                            index: originIndex,\n                            container: originContainer,\n                            itemsBeforeUpdate: originItemsBeforeUpdate,\n                            items: originItems\n                        },\n                        destination: {\n                            index: destinationIndex,\n                            elementIndex: destinationElementIndex,\n                            container: destinationContainer,\n                            itemsBeforeUpdate: destinationItemsBeforeUpdate,\n                            items: destinationItems\n                        },\n                        item: dragging\n                    }\n                }));\n            }\n        });\n        var debouncedDragOverEnter = debounce(function (sortableElement, element, pageX, pageY) {\n            if (!dragging) {\n                return;\n            }\n            // set placeholder height if forcePlaceholderSize option is set\n            if (options.forcePlaceholderSize) {\n                store(sortableElement).placeholder.style.height = draggingHeight + 'px';\n                store(sortableElement).placeholder.style.width = draggingWidth + 'px';\n            }\n            // if element the draggedItem is dragged onto is within the array of all elements in list\n            // (not only items, but also disabled, etc.)\n            if (Array.from(sortableElement.children).indexOf(element) > -1) {\n                var thisHeight = getElementHeight(element);\n                var thisWidth = getElementWidth(element);\n                var placeholderIndex = getIndex(store(sortableElement).placeholder, element.parentElement.children);\n                var thisIndex = getIndex(element, element.parentElement.children);\n                // Check if `element` is bigger than the draggable. If it is, we have to define a dead zone to prevent flickering\n                if (thisHeight > draggingHeight || thisWidth > draggingWidth) {\n                    // Dead zone?\n                    var deadZoneVertical = thisHeight - draggingHeight;\n                    var deadZoneHorizontal = thisWidth - draggingWidth;\n                    var offsetTop = offset(element).top;\n                    var offsetLeft = offset(element).left;\n                    if (placeholderIndex < thisIndex &&\n                        ((options.orientation === 'vertical' && pageY < offsetTop) ||\n                            (options.orientation === 'horizontal' && pageX < offsetLeft))) {\n                        return;\n                    }\n                    if (placeholderIndex > thisIndex &&\n                        ((options.orientation === 'vertical' && pageY > offsetTop + thisHeight - deadZoneVertical) ||\n                            (options.orientation === 'horizontal' && pageX > offsetLeft + thisWidth - deadZoneHorizontal))) {\n                        return;\n                    }\n                }\n                if (dragging.oldDisplay === undefined) {\n                    dragging.oldDisplay = dragging.style.display;\n                }\n                if (dragging.style.display !== 'none') {\n                    dragging.style.display = 'none';\n                }\n                // To avoid flicker, determine where to position the placeholder\n                // based on where the mouse pointer is relative to the elements\n                // vertical center.\n                var placeAfter = false;\n                try {\n                    var elementMiddleVertical = offset(element).top + element.offsetHeight / 2;\n                    var elementMiddleHorizontal = offset(element).left + element.offsetWidth / 2;\n                    placeAfter = (options.orientation === 'vertical' && (pageY >= elementMiddleVertical)) ||\n                        (options.orientation === 'horizontal' && (pageX >= elementMiddleHorizontal));\n                }\n                catch (e) {\n                    placeAfter = placeholderIndex < thisIndex;\n                }\n                if (placeAfter) {\n                    insertAfter(element, store(sortableElement).placeholder);\n                }\n                else {\n                    insertBefore(element, store(sortableElement).placeholder);\n                }\n                // get placeholders from all stores & remove all but current one\n                Array.from(stores.values())\n                    // remove empty values\n                    .filter(function (data) { return data.placeholder !== undefined; })\n                    // foreach placeholder in array if outside of current sorableContainer -> remove from DOM\n                    .forEach(function (data) {\n                    if (data.placeholder !== store(sortableElement).placeholder) {\n                        data.placeholder.remove();\n                    }\n                });\n            }\n            else {\n                // get all placeholders from store\n                var placeholders = Array.from(stores.values())\n                    .filter(function (data) { return data.placeholder !== undefined; })\n                    .map(function (data) {\n                    return data.placeholder;\n                });\n                // check if element is not in placeholders\n                if (placeholders.indexOf(element) === -1 && sortableElement === element && !filter(element.children, options.items).length) {\n                    placeholders.forEach(function (element) { return element.remove(); });\n                    element.appendChild(store(sortableElement).placeholder);\n                }\n            }\n        }, options.debounce);\n        // Handle dragover and dragenter events on draggable items\n        var onDragOverEnter = function (e) {\n            var element = e.target;\n            var sortableElement = element.isSortable === true ? element : findSortable(element, e);\n            element = findDragElement(sortableElement, element);\n            if (!dragging || !listsConnected(sortableElement, dragging.parentElement) || addData(sortableElement, '_disabled') === 'true') {\n                return;\n            }\n            var options = addData(sortableElement, 'opts');\n            if (parseInt(options.maxItems) && filter(sortableElement.children, addData(sortableElement, 'items')).length > parseInt(options.maxItems) && dragging.parentElement !== sortableElement) {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n            e.dataTransfer.dropEffect = store(sortableElement).getConfig('copy') === true ? 'copy' : 'move';\n            debouncedDragOverEnter(sortableElement, element, e.pageX, e.pageY);\n        };\n        addEventListener(listItems.concat(sortableElement), 'dragover', onDragOverEnter);\n        addEventListener(listItems.concat(sortableElement), 'dragenter', onDragOverEnter);\n    });\n    return sortableElements;\n}\nsortable.destroy = function (sortableElement) {\n    destroySortable(sortableElement);\n};\nsortable.enable = function (sortableElement) {\n    enableSortable(sortableElement);\n};\nsortable.disable = function (sortableElement) {\n    disableSortable(sortableElement);\n};\n/* START.TESTS_ONLY */\nsortable.__testing = {\n    // add internal methods here for testing purposes\n    data: addData,\n    removeItemEvents: removeItemEvents,\n    removeItemData: removeItemData,\n    removeSortableData: removeSortableData,\n    removeContainerEvents: removeContainerEvents\n};\n\nmodule.exports = sortable;\n","/*!\n * Select2 4.1.0-rc.0\n * https://select2.github.io\n *\n * Released under the MIT license\n * https://github.com/select2/select2/blob/master/LICENSE.md\n */\n;(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['jquery'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    // Node/CommonJS\n    module.exports = function (root, jQuery) {\n      if (jQuery === undefined) {\n        // require('jQuery') returns a factory that requires window to\n        // build a jQuery instance, we normalize how we use modules\n        // that require this pattern but the window provided is a noop\n        // if it's defined (how jquery works)\n        if (typeof window !== 'undefined') {\n          jQuery = require('jquery');\n        }\n        else {\n          jQuery = require('jquery')(root);\n        }\n      }\n      factory(jQuery);\n      return jQuery;\n    };\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n} (function (jQuery) {\n  // This is needed so we can catch the AMD loader configuration and use it\n  // The inner file should be wrapped (by `banner.start.js`) in a function that\n  // returns the AMD loader references.\n  var S2 =(function () {\n  // Restore the Select2 AMD loader so it can be used\n  // Needed mostly in the language files, where the loader is not inserted\n  if (jQuery && jQuery.fn && jQuery.fn.select2 && jQuery.fn.select2.amd) {\n    var S2 = jQuery.fn.select2.amd;\n  }\nvar S2;(function () { if (!S2 || !S2.requirejs) {\nif (!S2) { S2 = {}; } else { require = S2; }\n/**\n * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.\n * Released under MIT license, http://github.com/requirejs/almond/LICENSE\n */\n//Going sloppy to avoid 'use strict' string cost, but strict practices should\n//be followed.\n/*global setTimeout: false */\n\nvar requirejs, require, define;\n(function (undef) {\n    var main, req, makeMap, handlers,\n        defined = {},\n        waiting = {},\n        config = {},\n        defining = {},\n        hasOwn = Object.prototype.hasOwnProperty,\n        aps = [].slice,\n        jsSuffixRegExp = /\\.js$/;\n\n    function hasProp(obj, prop) {\n        return hasOwn.call(obj, prop);\n    }\n\n    /**\n     * Given a relative module name, like ./something, normalize it to\n     * a real name that can be mapped to a path.\n     * @param {String} name the relative name\n     * @param {String} baseName a real name that the name arg is relative\n     * to.\n     * @returns {String} normalized name\n     */\n    function normalize(name, baseName) {\n        var nameParts, nameSegment, mapValue, foundMap, lastIndex,\n            foundI, foundStarMap, starI, i, j, part, normalizedBaseParts,\n            baseParts = baseName && baseName.split(\"/\"),\n            map = config.map,\n            starMap = (map && map['*']) || {};\n\n        //Adjust any relative paths.\n        if (name) {\n            name = name.split('/');\n            lastIndex = name.length - 1;\n\n            // If wanting node ID compatibility, strip .js from end\n            // of IDs. Have to do this here, and not in nameToUrl\n            // because node allows either .js or non .js to map\n            // to same file.\n            if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {\n                name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, '');\n            }\n\n            // Starts with a '.' so need the baseName\n            if (name[0].charAt(0) === '.' && baseParts) {\n                //Convert baseName to array, and lop off the last part,\n                //so that . matches that 'directory' and not name of the baseName's\n                //module. For instance, baseName of 'one/two/three', maps to\n                //'one/two/three.js', but we want the directory, 'one/two' for\n                //this normalization.\n                normalizedBaseParts = baseParts.slice(0, baseParts.length - 1);\n                name = normalizedBaseParts.concat(name);\n            }\n\n            //start trimDots\n            for (i = 0; i < name.length; i++) {\n                part = name[i];\n                if (part === '.') {\n                    name.splice(i, 1);\n                    i -= 1;\n                } else if (part === '..') {\n                    // If at the start, or previous value is still ..,\n                    // keep them so that when converted to a path it may\n                    // still work when converted to a path, even though\n                    // as an ID it is less than ideal. In larger point\n                    // releases, may be better to just kick out an error.\n                    if (i === 0 || (i === 1 && name[2] === '..') || name[i - 1] === '..') {\n                        continue;\n                    } else if (i > 0) {\n                        name.splice(i - 1, 2);\n                        i -= 2;\n                    }\n                }\n            }\n            //end trimDots\n\n            name = name.join('/');\n        }\n\n        //Apply map config if available.\n        if ((baseParts || starMap) && map) {\n            nameParts = name.split('/');\n\n            for (i = nameParts.length; i > 0; i -= 1) {\n                nameSegment = nameParts.slice(0, i).join(\"/\");\n\n                if (baseParts) {\n                    //Find the longest baseName segment match in the config.\n                    //So, do joins on the biggest to smallest lengths of baseParts.\n                    for (j = baseParts.length; j > 0; j -= 1) {\n                        mapValue = map[baseParts.slice(0, j).join('/')];\n\n                        //baseName segment has  config, find if it has one for\n                        //this name.\n                        if (mapValue) {\n                            mapValue = mapValue[nameSegment];\n                            if (mapValue) {\n                                //Match, update name to the new value.\n                                foundMap = mapValue;\n                                foundI = i;\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if (foundMap) {\n                    break;\n                }\n\n                //Check for a star map match, but just hold on to it,\n                //if there is a shorter segment match later in a matching\n                //config, then favor over this star map.\n                if (!foundStarMap && starMap && starMap[nameSegment]) {\n                    foundStarMap = starMap[nameSegment];\n                    starI = i;\n                }\n            }\n\n            if (!foundMap && foundStarMap) {\n                foundMap = foundStarMap;\n                foundI = starI;\n            }\n\n            if (foundMap) {\n                nameParts.splice(0, foundI, foundMap);\n                name = nameParts.join('/');\n            }\n        }\n\n        return name;\n    }\n\n    function makeRequire(relName, forceSync) {\n        return function () {\n            //A version of a require function that passes a moduleName\n            //value for items that may need to\n            //look up paths relative to the moduleName\n            var args = aps.call(arguments, 0);\n\n            //If first arg is not require('string'), and there is only\n            //one arg, it is the array form without a callback. Insert\n            //a null so that the following concat is correct.\n            if (typeof args[0] !== 'string' && args.length === 1) {\n                args.push(null);\n            }\n            return req.apply(undef, args.concat([relName, forceSync]));\n        };\n    }\n\n    function makeNormalize(relName) {\n        return function (name) {\n            return normalize(name, relName);\n        };\n    }\n\n    function makeLoad(depName) {\n        return function (value) {\n            defined[depName] = value;\n        };\n    }\n\n    function callDep(name) {\n        if (hasProp(waiting, name)) {\n            var args = waiting[name];\n            delete waiting[name];\n            defining[name] = true;\n            main.apply(undef, args);\n        }\n\n        if (!hasProp(defined, name) && !hasProp(defining, name)) {\n            throw new Error('No ' + name);\n        }\n        return defined[name];\n    }\n\n    //Turns a plugin!resource to [plugin, resource]\n    //with the plugin being undefined if the name\n    //did not have a plugin prefix.\n    function splitPrefix(name) {\n        var prefix,\n            index = name ? name.indexOf('!') : -1;\n        if (index > -1) {\n            prefix = name.substring(0, index);\n            name = name.substring(index + 1, name.length);\n        }\n        return [prefix, name];\n    }\n\n    //Creates a parts array for a relName where first part is plugin ID,\n    //second part is resource ID. Assumes relName has already been normalized.\n    function makeRelParts(relName) {\n        return relName ? splitPrefix(relName) : [];\n    }\n\n    /**\n     * Makes a name map, normalizing the name, and using a plugin\n     * for normalization if necessary. Grabs a ref to plugin\n     * too, as an optimization.\n     */\n    makeMap = function (name, relParts) {\n        var plugin,\n            parts = splitPrefix(name),\n            prefix = parts[0],\n            relResourceName = relParts[1];\n\n        name = parts[1];\n\n        if (prefix) {\n            prefix = normalize(prefix, relResourceName);\n            plugin = callDep(prefix);\n        }\n\n        //Normalize according\n        if (prefix) {\n            if (plugin && plugin.normalize) {\n                name = plugin.normalize(name, makeNormalize(relResourceName));\n            } else {\n                name = normalize(name, relResourceName);\n            }\n        } else {\n            name = normalize(name, relResourceName);\n            parts = splitPrefix(name);\n            prefix = parts[0];\n            name = parts[1];\n            if (prefix) {\n                plugin = callDep(prefix);\n            }\n        }\n\n        //Using ridiculous property names for space reasons\n        return {\n            f: prefix ? prefix + '!' + name : name, //fullName\n            n: name,\n            pr: prefix,\n            p: plugin\n        };\n    };\n\n    function makeConfig(name) {\n        return function () {\n            return (config && config.config && config.config[name]) || {};\n        };\n    }\n\n    handlers = {\n        require: function (name) {\n            return makeRequire(name);\n        },\n        exports: function (name) {\n            var e = defined[name];\n            if (typeof e !== 'undefined') {\n                return e;\n            } else {\n                return (defined[name] = {});\n            }\n        },\n        module: function (name) {\n            return {\n                id: name,\n                uri: '',\n                exports: defined[name],\n                config: makeConfig(name)\n            };\n        }\n    };\n\n    main = function (name, deps, callback, relName) {\n        var cjsModule, depName, ret, map, i, relParts,\n            args = [],\n            callbackType = typeof callback,\n            usingExports;\n\n        //Use name if no relName\n        relName = relName || name;\n        relParts = makeRelParts(relName);\n\n        //Call the callback to define the module, if necessary.\n        if (callbackType === 'undefined' || callbackType === 'function') {\n            //Pull out the defined dependencies and pass the ordered\n            //values to the callback.\n            //Default to [require, exports, module] if no deps\n            deps = !deps.length && callback.length ? ['require', 'exports', 'module'] : deps;\n            for (i = 0; i < deps.length; i += 1) {\n                map = makeMap(deps[i], relParts);\n                depName = map.f;\n\n                //Fast path CommonJS standard dependencies.\n                if (depName === \"require\") {\n                    args[i] = handlers.require(name);\n                } else if (depName === \"exports\") {\n                    //CommonJS module spec 1.1\n                    args[i] = handlers.exports(name);\n                    usingExports = true;\n                } else if (depName === \"module\") {\n                    //CommonJS module spec 1.1\n                    cjsModule = args[i] = handlers.module(name);\n                } else if (hasProp(defined, depName) ||\n                           hasProp(waiting, depName) ||\n                           hasProp(defining, depName)) {\n                    args[i] = callDep(depName);\n                } else if (map.p) {\n                    map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});\n                    args[i] = defined[depName];\n                } else {\n                    throw new Error(name + ' missing ' + depName);\n                }\n            }\n\n            ret = callback ? callback.apply(defined[name], args) : undefined;\n\n            if (name) {\n                //If setting exports via \"module\" is in play,\n                //favor that over return value and exports. After that,\n                //favor a non-undefined return value over exports use.\n                if (cjsModule && cjsModule.exports !== undef &&\n                        cjsModule.exports !== defined[name]) {\n                    defined[name] = cjsModule.exports;\n                } else if (ret !== undef || !usingExports) {\n                    //Use the return value from the function.\n                    defined[name] = ret;\n                }\n            }\n        } else if (name) {\n            //May just be an object definition for the module. Only\n            //worry about defining if have a module name.\n            defined[name] = callback;\n        }\n    };\n\n    requirejs = require = req = function (deps, callback, relName, forceSync, alt) {\n        if (typeof deps === \"string\") {\n            if (handlers[deps]) {\n                //callback in this case is really relName\n                return handlers[deps](callback);\n            }\n            //Just return the module wanted. In this scenario, the\n            //deps arg is the module name, and second arg (if passed)\n            //is just the relName.\n            //Normalize module name, if it contains . or ..\n            return callDep(makeMap(deps, makeRelParts(callback)).f);\n        } else if (!deps.splice) {\n            //deps is a config object, not an array.\n            config = deps;\n            if (config.deps) {\n                req(config.deps, config.callback);\n            }\n            if (!callback) {\n                return;\n            }\n\n            if (callback.splice) {\n                //callback is an array, which means it is a dependency list.\n                //Adjust args if there are dependencies\n                deps = callback;\n                callback = relName;\n                relName = null;\n            } else {\n                deps = undef;\n            }\n        }\n\n        //Support require(['a'])\n        callback = callback || function () {};\n\n        //If relName is a function, it is an errback handler,\n        //so remove it.\n        if (typeof relName === 'function') {\n            relName = forceSync;\n            forceSync = alt;\n        }\n\n        //Simulate async callback;\n        if (forceSync) {\n            main(undef, deps, callback, relName);\n        } else {\n            //Using a non-zero value because of concern for what old browsers\n            //do, and latest browsers \"upgrade\" to 4 if lower value is used:\n            //http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#dom-windowtimers-settimeout:\n            //If want a value immediately, use require('id') instead -- something\n            //that works in almond on the global level, but not guaranteed and\n            //unlikely to work in other AMD implementations.\n            setTimeout(function () {\n                main(undef, deps, callback, relName);\n            }, 4);\n        }\n\n        return req;\n    };\n\n    /**\n     * Just drops the config on the floor, but returns req in case\n     * the config return value is used.\n     */\n    req.config = function (cfg) {\n        return req(cfg);\n    };\n\n    /**\n     * Expose module registry for debugging and tooling\n     */\n    requirejs._defined = defined;\n\n    define = function (name, deps, callback) {\n        if (typeof name !== 'string') {\n            throw new Error('See almond README: incorrect module build, no module name');\n        }\n\n        //This module may not have dependencies\n        if (!deps.splice) {\n            //deps is not an array, so probably means\n            //an object literal or factory function for\n            //the value. Adjust args.\n            callback = deps;\n            deps = [];\n        }\n\n        if (!hasProp(defined, name) && !hasProp(waiting, name)) {\n            waiting[name] = [name, deps, callback];\n        }\n    };\n\n    define.amd = {\n        jQuery: true\n    };\n}());\n\nS2.requirejs = requirejs;S2.require = require;S2.define = define;\n}\n}());\nS2.define(\"almond\", function(){});\n\n/* global jQuery:false, $:false */\nS2.define('jquery',[],function () {\n  var _$ = jQuery || $;\n\n  if (_$ == null && console && console.error) {\n    console.error(\n      'Select2: An instance of jQuery or a jQuery-compatible library was not ' +\n      'found. Make sure that you are including jQuery before Select2 on your ' +\n      'web page.'\n    );\n  }\n\n  return _$;\n});\n\nS2.define('select2/utils',[\n  'jquery'\n], function ($) {\n  var Utils = {};\n\n  Utils.Extend = function (ChildClass, SuperClass) {\n    var __hasProp = {}.hasOwnProperty;\n\n    function BaseConstructor () {\n      this.constructor = ChildClass;\n    }\n\n    for (var key in SuperClass) {\n      if (__hasProp.call(SuperClass, key)) {\n        ChildClass[key] = SuperClass[key];\n      }\n    }\n\n    BaseConstructor.prototype = SuperClass.prototype;\n    ChildClass.prototype = new BaseConstructor();\n    ChildClass.__super__ = SuperClass.prototype;\n\n    return ChildClass;\n  };\n\n  function getMethods (theClass) {\n    var proto = theClass.prototype;\n\n    var methods = [];\n\n    for (var methodName in proto) {\n      var m = proto[methodName];\n\n      if (typeof m !== 'function') {\n        continue;\n      }\n\n      if (methodName === 'constructor') {\n        continue;\n      }\n\n      methods.push(methodName);\n    }\n\n    return methods;\n  }\n\n  Utils.Decorate = function (SuperClass, DecoratorClass) {\n    var decoratedMethods = getMethods(DecoratorClass);\n    var superMethods = getMethods(SuperClass);\n\n    function DecoratedClass () {\n      var unshift = Array.prototype.unshift;\n\n      var argCount = DecoratorClass.prototype.constructor.length;\n\n      var calledConstructor = SuperClass.prototype.constructor;\n\n      if (argCount > 0) {\n        unshift.call(arguments, SuperClass.prototype.constructor);\n\n        calledConstructor = DecoratorClass.prototype.constructor;\n      }\n\n      calledConstructor.apply(this, arguments);\n    }\n\n    DecoratorClass.displayName = SuperClass.displayName;\n\n    function ctr () {\n      this.constructor = DecoratedClass;\n    }\n\n    DecoratedClass.prototype = new ctr();\n\n    for (var m = 0; m < superMethods.length; m++) {\n      var superMethod = superMethods[m];\n\n      DecoratedClass.prototype[superMethod] =\n        SuperClass.prototype[superMethod];\n    }\n\n    var calledMethod = function (methodName) {\n      // Stub out the original method if it's not decorating an actual method\n      var originalMethod = function () {};\n\n      if (methodName in DecoratedClass.prototype) {\n        originalMethod = DecoratedClass.prototype[methodName];\n      }\n\n      var decoratedMethod = DecoratorClass.prototype[methodName];\n\n      return function () {\n        var unshift = Array.prototype.unshift;\n\n        unshift.call(arguments, originalMethod);\n\n        return decoratedMethod.apply(this, arguments);\n      };\n    };\n\n    for (var d = 0; d < decoratedMethods.length; d++) {\n      var decoratedMethod = decoratedMethods[d];\n\n      DecoratedClass.prototype[decoratedMethod] = calledMethod(decoratedMethod);\n    }\n\n    return DecoratedClass;\n  };\n\n  var Observable = function () {\n    this.listeners = {};\n  };\n\n  Observable.prototype.on = function (event, callback) {\n    this.listeners = this.listeners || {};\n\n    if (event in this.listeners) {\n      this.listeners[event].push(callback);\n    } else {\n      this.listeners[event] = [callback];\n    }\n  };\n\n  Observable.prototype.trigger = function (event) {\n    var slice = Array.prototype.slice;\n    var params = slice.call(arguments, 1);\n\n    this.listeners = this.listeners || {};\n\n    // Params should always come in as an array\n    if (params == null) {\n      params = [];\n    }\n\n    // If there are no arguments to the event, use a temporary object\n    if (params.length === 0) {\n      params.push({});\n    }\n\n    // Set the `_type` of the first object to the event\n    params[0]._type = event;\n\n    if (event in this.listeners) {\n      this.invoke(this.listeners[event], slice.call(arguments, 1));\n    }\n\n    if ('*' in this.listeners) {\n      this.invoke(this.listeners['*'], arguments);\n    }\n  };\n\n  Observable.prototype.invoke = function (listeners, params) {\n    for (var i = 0, len = listeners.length; i < len; i++) {\n      listeners[i].apply(this, params);\n    }\n  };\n\n  Utils.Observable = Observable;\n\n  Utils.generateChars = function (length) {\n    var chars = '';\n\n    for (var i = 0; i < length; i++) {\n      var randomChar = Math.floor(Math.random() * 36);\n      chars += randomChar.toString(36);\n    }\n\n    return chars;\n  };\n\n  Utils.bind = function (func, context) {\n    return function () {\n      func.apply(context, arguments);\n    };\n  };\n\n  Utils._convertData = function (data) {\n    for (var originalKey in data) {\n      var keys = originalKey.split('-');\n\n      var dataLevel = data;\n\n      if (keys.length === 1) {\n        continue;\n      }\n\n      for (var k = 0; k < keys.length; k++) {\n        var key = keys[k];\n\n        // Lowercase the first letter\n        // By default, dash-separated becomes camelCase\n        key = key.substring(0, 1).toLowerCase() + key.substring(1);\n\n        if (!(key in dataLevel)) {\n          dataLevel[key] = {};\n        }\n\n        if (k == keys.length - 1) {\n          dataLevel[key] = data[originalKey];\n        }\n\n        dataLevel = dataLevel[key];\n      }\n\n      delete data[originalKey];\n    }\n\n    return data;\n  };\n\n  Utils.hasScroll = function (index, el) {\n    // Adapted from the function created by @ShadowScripter\n    // and adapted by @BillBarry on the Stack Exchange Code Review website.\n    // The original code can be found at\n    // http://codereview.stackexchange.com/q/13338\n    // and was designed to be used with the Sizzle selector engine.\n\n    var $el = $(el);\n    var overflowX = el.style.overflowX;\n    var overflowY = el.style.overflowY;\n\n    //Check both x and y declarations\n    if (overflowX === overflowY &&\n        (overflowY === 'hidden' || overflowY === 'visible')) {\n      return false;\n    }\n\n    if (overflowX === 'scroll' || overflowY === 'scroll') {\n      return true;\n    }\n\n    return ($el.innerHeight() < el.scrollHeight ||\n      $el.innerWidth() < el.scrollWidth);\n  };\n\n  Utils.escapeMarkup = function (markup) {\n    var replaceMap = {\n      '\\\\': '&#92;',\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '/': '&#47;'\n    };\n\n    // Do not try to escape the markup if it's not a string\n    if (typeof markup !== 'string') {\n      return markup;\n    }\n\n    return String(markup).replace(/[&<>\"'\\/\\\\]/g, function (match) {\n      return replaceMap[match];\n    });\n  };\n\n  // Cache objects in Utils.__cache instead of $.data (see #4346)\n  Utils.__cache = {};\n\n  var id = 0;\n  Utils.GetUniqueElementId = function (element) {\n    // Get a unique element Id. If element has no id,\n    // creates a new unique number, stores it in the id\n    // attribute and returns the new id with a prefix.\n    // If an id already exists, it simply returns it with a prefix.\n\n    var select2Id = element.getAttribute('data-select2-id');\n\n    if (select2Id != null) {\n      return select2Id;\n    }\n\n    // If element has id, use it.\n    if (element.id) {\n      select2Id = 'select2-data-' + element.id;\n    } else {\n      select2Id = 'select2-data-' + (++id).toString() +\n        '-' + Utils.generateChars(4);\n    }\n\n    element.setAttribute('data-select2-id', select2Id);\n\n    return select2Id;\n  };\n\n  Utils.StoreData = function (element, name, value) {\n    // Stores an item in the cache for a specified element.\n    // name is the cache key.\n    var id = Utils.GetUniqueElementId(element);\n    if (!Utils.__cache[id]) {\n      Utils.__cache[id] = {};\n    }\n\n    Utils.__cache[id][name] = value;\n  };\n\n  Utils.GetData = function (element, name) {\n    // Retrieves a value from the cache by its key (name)\n    // name is optional. If no name specified, return\n    // all cache items for the specified element.\n    // and for a specified element.\n    var id = Utils.GetUniqueElementId(element);\n    if (name) {\n      if (Utils.__cache[id]) {\n        if (Utils.__cache[id][name] != null) {\n          return Utils.__cache[id][name];\n        }\n        return $(element).data(name); // Fallback to HTML5 data attribs.\n      }\n      return $(element).data(name); // Fallback to HTML5 data attribs.\n    } else {\n      return Utils.__cache[id];\n    }\n  };\n\n  Utils.RemoveData = function (element) {\n    // Removes all cached items for a specified element.\n    var id = Utils.GetUniqueElementId(element);\n    if (Utils.__cache[id] != null) {\n      delete Utils.__cache[id];\n    }\n\n    element.removeAttribute('data-select2-id');\n  };\n\n  Utils.copyNonInternalCssClasses = function (dest, src) {\n    var classes;\n\n    var destinationClasses = dest.getAttribute('class').trim().split(/\\s+/);\n\n    destinationClasses = destinationClasses.filter(function (clazz) {\n      // Save all Select2 classes\n      return clazz.indexOf('select2-') === 0;\n    });\n\n    var sourceClasses = src.getAttribute('class').trim().split(/\\s+/);\n\n    sourceClasses = sourceClasses.filter(function (clazz) {\n      // Only copy non-Select2 classes\n      return clazz.indexOf('select2-') !== 0;\n    });\n\n    var replacements = destinationClasses.concat(sourceClasses);\n\n    dest.setAttribute('class', replacements.join(' '));\n  };\n\n  return Utils;\n});\n\nS2.define('select2/results',[\n  'jquery',\n  './utils'\n], function ($, Utils) {\n  function Results ($element, options, dataAdapter) {\n    this.$element = $element;\n    this.data = dataAdapter;\n    this.options = options;\n\n    Results.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(Results, Utils.Observable);\n\n  Results.prototype.render = function () {\n    var $results = $(\n      '<ul class=\"select2-results__options\" role=\"listbox\"></ul>'\n    );\n\n    if (this.options.get('multiple')) {\n      $results.attr('aria-multiselectable', 'true');\n    }\n\n    this.$results = $results;\n\n    return $results;\n  };\n\n  Results.prototype.clear = function () {\n    this.$results.empty();\n  };\n\n  Results.prototype.displayMessage = function (params) {\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    this.clear();\n    this.hideLoading();\n\n    var $message = $(\n      '<li role=\"alert\" aria-live=\"assertive\"' +\n      ' class=\"select2-results__option\"></li>'\n    );\n\n    var message = this.options.get('translations').get(params.message);\n\n    $message.append(\n      escapeMarkup(\n        message(params.args)\n      )\n    );\n\n    $message[0].className += ' select2-results__message';\n\n    this.$results.append($message);\n  };\n\n  Results.prototype.hideMessages = function () {\n    this.$results.find('.select2-results__message').remove();\n  };\n\n  Results.prototype.append = function (data) {\n    this.hideLoading();\n\n    var $options = [];\n\n    if (data.results == null || data.results.length === 0) {\n      if (this.$results.children().length === 0) {\n        this.trigger('results:message', {\n          message: 'noResults'\n        });\n      }\n\n      return;\n    }\n\n    data.results = this.sort(data.results);\n\n    for (var d = 0; d < data.results.length; d++) {\n      var item = data.results[d];\n\n      var $option = this.option(item);\n\n      $options.push($option);\n    }\n\n    this.$results.append($options);\n  };\n\n  Results.prototype.position = function ($results, $dropdown) {\n    var $resultsContainer = $dropdown.find('.select2-results');\n    $resultsContainer.append($results);\n  };\n\n  Results.prototype.sort = function (data) {\n    var sorter = this.options.get('sorter');\n\n    return sorter(data);\n  };\n\n  Results.prototype.highlightFirstItem = function () {\n    var $options = this.$results\n      .find('.select2-results__option--selectable');\n\n    var $selected = $options.filter('.select2-results__option--selected');\n\n    // Check if there are any selected options\n    if ($selected.length > 0) {\n      // If there are selected options, highlight the first\n      $selected.first().trigger('mouseenter');\n    } else {\n      // If there are no selected options, highlight the first option\n      // in the dropdown\n      $options.first().trigger('mouseenter');\n    }\n\n    this.ensureHighlightVisible();\n  };\n\n  Results.prototype.setClasses = function () {\n    var self = this;\n\n    this.data.current(function (selected) {\n      var selectedIds = selected.map(function (s) {\n        return s.id.toString();\n      });\n\n      var $options = self.$results\n        .find('.select2-results__option--selectable');\n\n      $options.each(function () {\n        var $option = $(this);\n\n        var item = Utils.GetData(this, 'data');\n\n        // id needs to be converted to a string when comparing\n        var id = '' + item.id;\n\n        if ((item.element != null && item.element.selected) ||\n            (item.element == null && selectedIds.indexOf(id) > -1)) {\n          this.classList.add('select2-results__option--selected');\n          $option.attr('aria-selected', 'true');\n        } else {\n          this.classList.remove('select2-results__option--selected');\n          $option.attr('aria-selected', 'false');\n        }\n      });\n\n    });\n  };\n\n  Results.prototype.showLoading = function (params) {\n    this.hideLoading();\n\n    var loadingMore = this.options.get('translations').get('searching');\n\n    var loading = {\n      disabled: true,\n      loading: true,\n      text: loadingMore(params)\n    };\n    var $loading = this.option(loading);\n    $loading.className += ' loading-results';\n\n    this.$results.prepend($loading);\n  };\n\n  Results.prototype.hideLoading = function () {\n    this.$results.find('.loading-results').remove();\n  };\n\n  Results.prototype.option = function (data) {\n    var option = document.createElement('li');\n    option.classList.add('select2-results__option');\n    option.classList.add('select2-results__option--selectable');\n\n    var attrs = {\n      'role': 'option'\n    };\n\n    var matches = window.Element.prototype.matches ||\n      window.Element.prototype.msMatchesSelector ||\n      window.Element.prototype.webkitMatchesSelector;\n\n    if ((data.element != null && matches.call(data.element, ':disabled')) ||\n        (data.element == null && data.disabled)) {\n      attrs['aria-disabled'] = 'true';\n\n      option.classList.remove('select2-results__option--selectable');\n      option.classList.add('select2-results__option--disabled');\n    }\n\n    if (data.id == null) {\n      option.classList.remove('select2-results__option--selectable');\n    }\n\n    if (data._resultId != null) {\n      option.id = data._resultId;\n    }\n\n    if (data.title) {\n      option.title = data.title;\n    }\n\n    if (data.children) {\n      attrs.role = 'group';\n      attrs['aria-label'] = data.text;\n\n      option.classList.remove('select2-results__option--selectable');\n      option.classList.add('select2-results__option--group');\n    }\n\n    for (var attr in attrs) {\n      var val = attrs[attr];\n\n      option.setAttribute(attr, val);\n    }\n\n    if (data.children) {\n      var $option = $(option);\n\n      var label = document.createElement('strong');\n      label.className = 'select2-results__group';\n\n      this.template(data, label);\n\n      var $children = [];\n\n      for (var c = 0; c < data.children.length; c++) {\n        var child = data.children[c];\n\n        var $child = this.option(child);\n\n        $children.push($child);\n      }\n\n      var $childrenContainer = $('<ul></ul>', {\n        'class': 'select2-results__options select2-results__options--nested',\n        'role': 'none'\n      });\n\n      $childrenContainer.append($children);\n\n      $option.append(label);\n      $option.append($childrenContainer);\n    } else {\n      this.template(data, option);\n    }\n\n    Utils.StoreData(option, 'data', data);\n\n    return option;\n  };\n\n  Results.prototype.bind = function (container, $container) {\n    var self = this;\n\n    var id = container.id + '-results';\n\n    this.$results.attr('id', id);\n\n    container.on('results:all', function (params) {\n      self.clear();\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('results:append', function (params) {\n      self.append(params.data);\n\n      if (container.isOpen()) {\n        self.setClasses();\n      }\n    });\n\n    container.on('query', function (params) {\n      self.hideMessages();\n      self.showLoading(params);\n    });\n\n    container.on('select', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('unselect', function () {\n      if (!container.isOpen()) {\n        return;\n      }\n\n      self.setClasses();\n\n      if (self.options.get('scrollAfterSelect')) {\n        self.highlightFirstItem();\n      }\n    });\n\n    container.on('open', function () {\n      // When the dropdown is open, aria-expended=\"true\"\n      self.$results.attr('aria-expanded', 'true');\n      self.$results.attr('aria-hidden', 'false');\n\n      self.setClasses();\n      self.ensureHighlightVisible();\n    });\n\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expended=\"false\"\n      self.$results.attr('aria-expanded', 'false');\n      self.$results.attr('aria-hidden', 'true');\n      self.$results.removeAttr('aria-activedescendant');\n    });\n\n    container.on('results:toggle', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      $highlighted.trigger('mouseup');\n    });\n\n    container.on('results:select', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      if ($highlighted.length === 0) {\n        return;\n      }\n\n      var data = Utils.GetData($highlighted[0], 'data');\n\n      if ($highlighted.hasClass('select2-results__option--selected')) {\n        self.trigger('close', {});\n      } else {\n        self.trigger('select', {\n          data: data\n        });\n      }\n    });\n\n    container.on('results:previous', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      var $options = self.$results.find('.select2-results__option--selectable');\n\n      var currentIndex = $options.index($highlighted);\n\n      // If we are already at the top, don't move further\n      // If no options, currentIndex will be -1\n      if (currentIndex <= 0) {\n        return;\n      }\n\n      var nextIndex = currentIndex - 1;\n\n      // If none are highlighted, highlight the first\n      if ($highlighted.length === 0) {\n        nextIndex = 0;\n      }\n\n      var $next = $options.eq(nextIndex);\n\n      $next.trigger('mouseenter');\n\n      var currentOffset = self.$results.offset().top;\n      var nextTop = $next.offset().top;\n      var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextTop - currentOffset < 0) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n\n    container.on('results:next', function () {\n      var $highlighted = self.getHighlightedResults();\n\n      var $options = self.$results.find('.select2-results__option--selectable');\n\n      var currentIndex = $options.index($highlighted);\n\n      var nextIndex = currentIndex + 1;\n\n      // If we are at the last option, stay there\n      if (nextIndex >= $options.length) {\n        return;\n      }\n\n      var $next = $options.eq(nextIndex);\n\n      $next.trigger('mouseenter');\n\n      var currentOffset = self.$results.offset().top +\n        self.$results.outerHeight(false);\n      var nextBottom = $next.offset().top + $next.outerHeight(false);\n      var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;\n\n      if (nextIndex === 0) {\n        self.$results.scrollTop(0);\n      } else if (nextBottom > currentOffset) {\n        self.$results.scrollTop(nextOffset);\n      }\n    });\n\n    container.on('results:focus', function (params) {\n      params.element[0].classList.add('select2-results__option--highlighted');\n      params.element[0].setAttribute('aria-selected', 'true');\n    });\n\n    container.on('results:message', function (params) {\n      self.displayMessage(params);\n    });\n\n    if ($.fn.mousewheel) {\n      this.$results.on('mousewheel', function (e) {\n        var top = self.$results.scrollTop();\n\n        var bottom = self.$results.get(0).scrollHeight - top + e.deltaY;\n\n        var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;\n        var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();\n\n        if (isAtTop) {\n          self.$results.scrollTop(0);\n\n          e.preventDefault();\n          e.stopPropagation();\n        } else if (isAtBottom) {\n          self.$results.scrollTop(\n            self.$results.get(0).scrollHeight - self.$results.height()\n          );\n\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      });\n    }\n\n    this.$results.on('mouseup', '.select2-results__option--selectable',\n      function (evt) {\n      var $this = $(this);\n\n      var data = Utils.GetData(this, 'data');\n\n      if ($this.hasClass('select2-results__option--selected')) {\n        if (self.options.get('multiple')) {\n          self.trigger('unselect', {\n            originalEvent: evt,\n            data: data\n          });\n        } else {\n          self.trigger('close', {});\n        }\n\n        return;\n      }\n\n      self.trigger('select', {\n        originalEvent: evt,\n        data: data\n      });\n    });\n\n    this.$results.on('mouseenter', '.select2-results__option--selectable',\n      function (evt) {\n      var data = Utils.GetData(this, 'data');\n\n      self.getHighlightedResults()\n          .removeClass('select2-results__option--highlighted')\n          .attr('aria-selected', 'false');\n\n      self.trigger('results:focus', {\n        data: data,\n        element: $(this)\n      });\n    });\n  };\n\n  Results.prototype.getHighlightedResults = function () {\n    var $highlighted = this.$results\n    .find('.select2-results__option--highlighted');\n\n    return $highlighted;\n  };\n\n  Results.prototype.destroy = function () {\n    this.$results.remove();\n  };\n\n  Results.prototype.ensureHighlightVisible = function () {\n    var $highlighted = this.getHighlightedResults();\n\n    if ($highlighted.length === 0) {\n      return;\n    }\n\n    var $options = this.$results.find('.select2-results__option--selectable');\n\n    var currentIndex = $options.index($highlighted);\n\n    var currentOffset = this.$results.offset().top;\n    var nextTop = $highlighted.offset().top;\n    var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);\n\n    var offsetDelta = nextTop - currentOffset;\n    nextOffset -= $highlighted.outerHeight(false) * 2;\n\n    if (currentIndex <= 2) {\n      this.$results.scrollTop(0);\n    } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {\n      this.$results.scrollTop(nextOffset);\n    }\n  };\n\n  Results.prototype.template = function (result, container) {\n    var template = this.options.get('templateResult');\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    var content = template(result, container);\n\n    if (content == null) {\n      container.style.display = 'none';\n    } else if (typeof content === 'string') {\n      container.innerHTML = escapeMarkup(content);\n    } else {\n      $(container).append(content);\n    }\n  };\n\n  return Results;\n});\n\nS2.define('select2/keys',[\n\n], function () {\n  var KEYS = {\n    BACKSPACE: 8,\n    TAB: 9,\n    ENTER: 13,\n    SHIFT: 16,\n    CTRL: 17,\n    ALT: 18,\n    ESC: 27,\n    SPACE: 32,\n    PAGE_UP: 33,\n    PAGE_DOWN: 34,\n    END: 35,\n    HOME: 36,\n    LEFT: 37,\n    UP: 38,\n    RIGHT: 39,\n    DOWN: 40,\n    DELETE: 46\n  };\n\n  return KEYS;\n});\n\nS2.define('select2/selection/base',[\n  'jquery',\n  '../utils',\n  '../keys'\n], function ($, Utils, KEYS) {\n  function BaseSelection ($element, options) {\n    this.$element = $element;\n    this.options = options;\n\n    BaseSelection.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(BaseSelection, Utils.Observable);\n\n  BaseSelection.prototype.render = function () {\n    var $selection = $(\n      '<span class=\"select2-selection\" role=\"combobox\" ' +\n      ' aria-haspopup=\"true\" aria-expanded=\"false\">' +\n      '</span>'\n    );\n\n    this._tabindex = 0;\n\n    if (Utils.GetData(this.$element[0], 'old-tabindex') != null) {\n      this._tabindex = Utils.GetData(this.$element[0], 'old-tabindex');\n    } else if (this.$element.attr('tabindex') != null) {\n      this._tabindex = this.$element.attr('tabindex');\n    }\n\n    $selection.attr('title', this.$element.attr('title'));\n    $selection.attr('tabindex', this._tabindex);\n    $selection.attr('aria-disabled', 'false');\n\n    this.$selection = $selection;\n\n    return $selection;\n  };\n\n  BaseSelection.prototype.bind = function (container, $container) {\n    var self = this;\n\n    var resultsId = container.id + '-results';\n\n    this.container = container;\n\n    this.$selection.on('focus', function (evt) {\n      self.trigger('focus', evt);\n    });\n\n    this.$selection.on('blur', function (evt) {\n      self._handleBlur(evt);\n    });\n\n    this.$selection.on('keydown', function (evt) {\n      self.trigger('keypress', evt);\n\n      if (evt.which === KEYS.SPACE) {\n        evt.preventDefault();\n      }\n    });\n\n    container.on('results:focus', function (params) {\n      self.$selection.attr('aria-activedescendant', params.data._resultId);\n    });\n\n    container.on('selection:update', function (params) {\n      self.update(params.data);\n    });\n\n    container.on('open', function () {\n      // When the dropdown is open, aria-expanded=\"true\"\n      self.$selection.attr('aria-expanded', 'true');\n      self.$selection.attr('aria-owns', resultsId);\n\n      self._attachCloseHandler(container);\n    });\n\n    container.on('close', function () {\n      // When the dropdown is closed, aria-expanded=\"false\"\n      self.$selection.attr('aria-expanded', 'false');\n      self.$selection.removeAttr('aria-activedescendant');\n      self.$selection.removeAttr('aria-owns');\n\n      self.$selection.trigger('focus');\n\n      self._detachCloseHandler(container);\n    });\n\n    container.on('enable', function () {\n      self.$selection.attr('tabindex', self._tabindex);\n      self.$selection.attr('aria-disabled', 'false');\n    });\n\n    container.on('disable', function () {\n      self.$selection.attr('tabindex', '-1');\n      self.$selection.attr('aria-disabled', 'true');\n    });\n  };\n\n  BaseSelection.prototype._handleBlur = function (evt) {\n    var self = this;\n\n    // This needs to be delayed as the active element is the body when the tab\n    // key is pressed, possibly along with others.\n    window.setTimeout(function () {\n      // Don't trigger `blur` if the focus is still in the selection\n      if (\n        (document.activeElement == self.$selection[0]) ||\n        ($.contains(self.$selection[0], document.activeElement))\n      ) {\n        return;\n      }\n\n      self.trigger('blur', evt);\n    }, 1);\n  };\n\n  BaseSelection.prototype._attachCloseHandler = function (container) {\n\n    $(document.body).on('mousedown.select2.' + container.id, function (e) {\n      var $target = $(e.target);\n\n      var $select = $target.closest('.select2');\n\n      var $all = $('.select2.select2-container--open');\n\n      $all.each(function () {\n        if (this == $select[0]) {\n          return;\n        }\n\n        var $element = Utils.GetData(this, 'element');\n\n        $element.select2('close');\n      });\n    });\n  };\n\n  BaseSelection.prototype._detachCloseHandler = function (container) {\n    $(document.body).off('mousedown.select2.' + container.id);\n  };\n\n  BaseSelection.prototype.position = function ($selection, $container) {\n    var $selectionContainer = $container.find('.selection');\n    $selectionContainer.append($selection);\n  };\n\n  BaseSelection.prototype.destroy = function () {\n    this._detachCloseHandler(this.container);\n  };\n\n  BaseSelection.prototype.update = function (data) {\n    throw new Error('The `update` method must be defined in child classes.');\n  };\n\n  /**\n   * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n   * object.\n   *\n   * @return {true} if the instance is not disabled.\n   * @return {false} if the instance is disabled.\n   */\n  BaseSelection.prototype.isEnabled = function () {\n    return !this.isDisabled();\n  };\n\n  /**\n   * Helper method to abstract the \"disabled\" state of this object.\n   *\n   * @return {true} if the disabled option is true.\n   * @return {false} if the disabled option is false.\n   */\n  BaseSelection.prototype.isDisabled = function () {\n    return this.options.get('disabled');\n  };\n\n  return BaseSelection;\n});\n\nS2.define('select2/selection/single',[\n  'jquery',\n  './base',\n  '../utils',\n  '../keys'\n], function ($, BaseSelection, Utils, KEYS) {\n  function SingleSelection () {\n    SingleSelection.__super__.constructor.apply(this, arguments);\n  }\n\n  Utils.Extend(SingleSelection, BaseSelection);\n\n  SingleSelection.prototype.render = function () {\n    var $selection = SingleSelection.__super__.render.call(this);\n\n    $selection[0].classList.add('select2-selection--single');\n\n    $selection.html(\n      '<span class=\"select2-selection__rendered\"></span>' +\n      '<span class=\"select2-selection__arrow\" role=\"presentation\">' +\n        '<b role=\"presentation\"></b>' +\n      '</span>'\n    );\n\n    return $selection;\n  };\n\n  SingleSelection.prototype.bind = function (container, $container) {\n    var self = this;\n\n    SingleSelection.__super__.bind.apply(this, arguments);\n\n    var id = container.id + '-container';\n\n    this.$selection.find('.select2-selection__rendered')\n      .attr('id', id)\n      .attr('role', 'textbox')\n      .attr('aria-readonly', 'true');\n    this.$selection.attr('aria-labelledby', id);\n    this.$selection.attr('aria-controls', id);\n\n    this.$selection.on('mousedown', function (evt) {\n      // Only respond to left clicks\n      if (evt.which !== 1) {\n        return;\n      }\n\n      self.trigger('toggle', {\n        originalEvent: evt\n      });\n    });\n\n    this.$selection.on('focus', function (evt) {\n      // User focuses on the container\n    });\n\n    this.$selection.on('blur', function (evt) {\n      // User exits the container\n    });\n\n    container.on('focus', function (evt) {\n      if (!container.isOpen()) {\n        self.$selection.trigger('focus');\n      }\n    });\n  };\n\n  SingleSelection.prototype.clear = function () {\n    var $rendered = this.$selection.find('.select2-selection__rendered');\n    $rendered.empty();\n    $rendered.removeAttr('title'); // clear tooltip on empty\n  };\n\n  SingleSelection.prototype.display = function (data, container) {\n    var template = this.options.get('templateSelection');\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    return escapeMarkup(template(data, container));\n  };\n\n  SingleSelection.prototype.selectionContainer = function () {\n    return $('<span></span>');\n  };\n\n  SingleSelection.prototype.update = function (data) {\n    if (data.length === 0) {\n      this.clear();\n      return;\n    }\n\n    var selection = data[0];\n\n    var $rendered = this.$selection.find('.select2-selection__rendered');\n    var formatted = this.display(selection, $rendered);\n\n    $rendered.empty().append(formatted);\n\n    var title = selection.title || selection.text;\n\n    if (title) {\n      $rendered.attr('title', title);\n    } else {\n      $rendered.removeAttr('title');\n    }\n  };\n\n  return SingleSelection;\n});\n\nS2.define('select2/selection/multiple',[\n  'jquery',\n  './base',\n  '../utils'\n], function ($, BaseSelection, Utils) {\n  function MultipleSelection ($element, options) {\n    MultipleSelection.__super__.constructor.apply(this, arguments);\n  }\n\n  Utils.Extend(MultipleSelection, BaseSelection);\n\n  MultipleSelection.prototype.render = function () {\n    var $selection = MultipleSelection.__super__.render.call(this);\n\n    $selection[0].classList.add('select2-selection--multiple');\n\n    $selection.html(\n      '<ul class=\"select2-selection__rendered\"></ul>'\n    );\n\n    return $selection;\n  };\n\n  MultipleSelection.prototype.bind = function (container, $container) {\n    var self = this;\n\n    MultipleSelection.__super__.bind.apply(this, arguments);\n\n    var id = container.id + '-container';\n    this.$selection.find('.select2-selection__rendered').attr('id', id);\n\n    this.$selection.on('click', function (evt) {\n      self.trigger('toggle', {\n        originalEvent: evt\n      });\n    });\n\n    this.$selection.on(\n      'click',\n      '.select2-selection__choice__remove',\n      function (evt) {\n        // Ignore the event if it is disabled\n        if (self.isDisabled()) {\n          return;\n        }\n\n        var $remove = $(this);\n        var $selection = $remove.parent();\n\n        var data = Utils.GetData($selection[0], 'data');\n\n        self.trigger('unselect', {\n          originalEvent: evt,\n          data: data\n        });\n      }\n    );\n\n    this.$selection.on(\n      'keydown',\n      '.select2-selection__choice__remove',\n      function (evt) {\n        // Ignore the event if it is disabled\n        if (self.isDisabled()) {\n          return;\n        }\n\n        evt.stopPropagation();\n      }\n    );\n  };\n\n  MultipleSelection.prototype.clear = function () {\n    var $rendered = this.$selection.find('.select2-selection__rendered');\n    $rendered.empty();\n    $rendered.removeAttr('title');\n  };\n\n  MultipleSelection.prototype.display = function (data, container) {\n    var template = this.options.get('templateSelection');\n    var escapeMarkup = this.options.get('escapeMarkup');\n\n    return escapeMarkup(template(data, container));\n  };\n\n  MultipleSelection.prototype.selectionContainer = function () {\n    var $container = $(\n      '<li class=\"select2-selection__choice\">' +\n        '<button type=\"button\" class=\"select2-selection__choice__remove\" ' +\n        'tabindex=\"-1\">' +\n          '<span aria-hidden=\"true\">&times;</span>' +\n        '</button>' +\n        '<span class=\"select2-selection__choice__display\"></span>' +\n      '</li>'\n    );\n\n    return $container;\n  };\n\n  MultipleSelection.prototype.update = function (data) {\n    this.clear();\n\n    if (data.length === 0) {\n      return;\n    }\n\n    var $selections = [];\n\n    var selectionIdPrefix = this.$selection.find('.select2-selection__rendered')\n      .attr('id') + '-choice-';\n\n    for (var d = 0; d < data.length; d++) {\n      var selection = data[d];\n\n      var $selection = this.selectionContainer();\n      var formatted = this.display(selection, $selection);\n\n      var selectionId = selectionIdPrefix + Utils.generateChars(4) + '-';\n\n      if (selection.id) {\n        selectionId += selection.id;\n      } else {\n        selectionId += Utils.generateChars(4);\n      }\n\n      $selection.find('.select2-selection__choice__display')\n        .append(formatted)\n        .attr('id', selectionId);\n\n      var title = selection.title || selection.text;\n\n      if (title) {\n        $selection.attr('title', title);\n      }\n\n      var removeItem = this.options.get('translations').get('removeItem');\n\n      var $remove = $selection.find('.select2-selection__choice__remove');\n\n      $remove.attr('title', removeItem());\n      $remove.attr('aria-label', removeItem());\n      $remove.attr('aria-describedby', selectionId);\n\n      Utils.StoreData($selection[0], 'data', selection);\n\n      $selections.push($selection);\n    }\n\n    var $rendered = this.$selection.find('.select2-selection__rendered');\n\n    $rendered.append($selections);\n  };\n\n  return MultipleSelection;\n});\n\nS2.define('select2/selection/placeholder',[\n\n], function () {\n  function Placeholder (decorated, $element, options) {\n    this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\n\n    decorated.call(this, $element, options);\n  }\n\n  Placeholder.prototype.normalizePlaceholder = function (_, placeholder) {\n    if (typeof placeholder === 'string') {\n      placeholder = {\n        id: '',\n        text: placeholder\n      };\n    }\n\n    return placeholder;\n  };\n\n  Placeholder.prototype.createPlaceholder = function (decorated, placeholder) {\n    var $placeholder = this.selectionContainer();\n\n    $placeholder.html(this.display(placeholder));\n    $placeholder[0].classList.add('select2-selection__placeholder');\n    $placeholder[0].classList.remove('select2-selection__choice');\n\n    var placeholderTitle = placeholder.title ||\n      placeholder.text ||\n      $placeholder.text();\n\n    this.$selection.find('.select2-selection__rendered').attr(\n      'title',\n      placeholderTitle\n    );\n\n    return $placeholder;\n  };\n\n  Placeholder.prototype.update = function (decorated, data) {\n    var singlePlaceholder = (\n      data.length == 1 && data[0].id != this.placeholder.id\n    );\n    var multipleSelections = data.length > 1;\n\n    if (multipleSelections || singlePlaceholder) {\n      return decorated.call(this, data);\n    }\n\n    this.clear();\n\n    var $placeholder = this.createPlaceholder(this.placeholder);\n\n    this.$selection.find('.select2-selection__rendered').append($placeholder);\n  };\n\n  return Placeholder;\n});\n\nS2.define('select2/selection/allowClear',[\n  'jquery',\n  '../keys',\n  '../utils'\n], function ($, KEYS, Utils) {\n  function AllowClear () { }\n\n  AllowClear.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    if (this.placeholder == null) {\n      if (this.options.get('debug') && window.console && console.error) {\n        console.error(\n          'Select2: The `allowClear` option should be used in combination ' +\n          'with the `placeholder` option.'\n        );\n      }\n    }\n\n    this.$selection.on('mousedown', '.select2-selection__clear',\n      function (evt) {\n        self._handleClear(evt);\n    });\n\n    container.on('keypress', function (evt) {\n      self._handleKeyboardClear(evt, container);\n    });\n  };\n\n  AllowClear.prototype._handleClear = function (_, evt) {\n    // Ignore the event if it is disabled\n    if (this.isDisabled()) {\n      return;\n    }\n\n    var $clear = this.$selection.find('.select2-selection__clear');\n\n    // Ignore the event if nothing has been selected\n    if ($clear.length === 0) {\n      return;\n    }\n\n    evt.stopPropagation();\n\n    var data = Utils.GetData($clear[0], 'data');\n\n    var previousVal = this.$element.val();\n    this.$element.val(this.placeholder.id);\n\n    var unselectData = {\n      data: data\n    };\n    this.trigger('clear', unselectData);\n    if (unselectData.prevented) {\n      this.$element.val(previousVal);\n      return;\n    }\n\n    for (var d = 0; d < data.length; d++) {\n      unselectData = {\n        data: data[d]\n      };\n\n      // Trigger the `unselect` event, so people can prevent it from being\n      // cleared.\n      this.trigger('unselect', unselectData);\n\n      // If the event was prevented, don't clear it out.\n      if (unselectData.prevented) {\n        this.$element.val(previousVal);\n        return;\n      }\n    }\n\n    this.$element.trigger('input').trigger('change');\n\n    this.trigger('toggle', {});\n  };\n\n  AllowClear.prototype._handleKeyboardClear = function (_, evt, container) {\n    if (container.isOpen()) {\n      return;\n    }\n\n    if (evt.which == KEYS.DELETE || evt.which == KEYS.BACKSPACE) {\n      this._handleClear(evt);\n    }\n  };\n\n  AllowClear.prototype.update = function (decorated, data) {\n    decorated.call(this, data);\n\n    this.$selection.find('.select2-selection__clear').remove();\n    this.$selection[0].classList.remove('select2-selection--clearable');\n\n    if (this.$selection.find('.select2-selection__placeholder').length > 0 ||\n        data.length === 0) {\n      return;\n    }\n\n    var selectionId = this.$selection.find('.select2-selection__rendered')\n      .attr('id');\n\n    var removeAll = this.options.get('translations').get('removeAllItems');\n\n    var $remove = $(\n      '<button type=\"button\" class=\"select2-selection__clear\" tabindex=\"-1\">' +\n        '<span aria-hidden=\"true\">&times;</span>' +\n      '</button>'\n    );\n    $remove.attr('title', removeAll());\n    $remove.attr('aria-label', removeAll());\n    $remove.attr('aria-describedby', selectionId);\n    Utils.StoreData($remove[0], 'data', data);\n\n    this.$selection.prepend($remove);\n    this.$selection[0].classList.add('select2-selection--clearable');\n  };\n\n  return AllowClear;\n});\n\nS2.define('select2/selection/search',[\n  'jquery',\n  '../utils',\n  '../keys'\n], function ($, Utils, KEYS) {\n  function Search (decorated, $element, options) {\n    decorated.call(this, $element, options);\n  }\n\n  Search.prototype.render = function (decorated) {\n    var searchLabel = this.options.get('translations').get('search');\n    var $search = $(\n      '<span class=\"select2-search select2-search--inline\">' +\n        '<textarea class=\"select2-search__field\"'+\n        ' type=\"search\" tabindex=\"-1\"' +\n        ' autocorrect=\"off\" autocapitalize=\"none\"' +\n        ' spellcheck=\"false\" role=\"searchbox\" aria-autocomplete=\"list\" >' +\n        '</textarea>' +\n      '</span>'\n    );\n\n    this.$searchContainer = $search;\n    this.$search = $search.find('textarea');\n\n    this.$search.prop('autocomplete', this.options.get('autocomplete'));\n    this.$search.attr('aria-label', searchLabel());\n\n    var $rendered = decorated.call(this);\n\n    this._transferTabIndex();\n    $rendered.append(this.$searchContainer);\n\n    return $rendered;\n  };\n\n  Search.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    var resultsId = container.id + '-results';\n    var selectionId = container.id + '-container';\n\n    decorated.call(this, container, $container);\n\n    self.$search.attr('aria-describedby', selectionId);\n\n    container.on('open', function () {\n      self.$search.attr('aria-controls', resultsId);\n      self.$search.trigger('focus');\n    });\n\n    container.on('close', function () {\n      self.$search.val('');\n      self.resizeSearch();\n      self.$search.removeAttr('aria-controls');\n      self.$search.removeAttr('aria-activedescendant');\n      self.$search.trigger('focus');\n    });\n\n    container.on('enable', function () {\n      self.$search.prop('disabled', false);\n\n      self._transferTabIndex();\n    });\n\n    container.on('disable', function () {\n      self.$search.prop('disabled', true);\n    });\n\n    container.on('focus', function (evt) {\n      self.$search.trigger('focus');\n    });\n\n    container.on('results:focus', function (params) {\n      if (params.data._resultId) {\n        self.$search.attr('aria-activedescendant', params.data._resultId);\n      } else {\n        self.$search.removeAttr('aria-activedescendant');\n      }\n    });\n\n    this.$selection.on('focusin', '.select2-search--inline', function (evt) {\n      self.trigger('focus', evt);\n    });\n\n    this.$selection.on('focusout', '.select2-search--inline', function (evt) {\n      self._handleBlur(evt);\n    });\n\n    this.$selection.on('keydown', '.select2-search--inline', function (evt) {\n      evt.stopPropagation();\n\n      self.trigger('keypress', evt);\n\n      self._keyUpPrevented = evt.isDefaultPrevented();\n\n      var key = evt.which;\n\n      if (key === KEYS.BACKSPACE && self.$search.val() === '') {\n        var $previousChoice = self.$selection\n          .find('.select2-selection__choice').last();\n\n        if ($previousChoice.length > 0) {\n          var item = Utils.GetData($previousChoice[0], 'data');\n\n          self.searchRemoveChoice(item);\n\n          evt.preventDefault();\n        }\n      }\n    });\n\n    this.$selection.on('click', '.select2-search--inline', function (evt) {\n      if (self.$search.val()) {\n        evt.stopPropagation();\n      }\n    });\n\n    // Try to detect the IE version should the `documentMode` property that\n    // is stored on the document. This is only implemented in IE and is\n    // slightly cleaner than doing a user agent check.\n    // This property is not available in Edge, but Edge also doesn't have\n    // this bug.\n    var msie = document.documentMode;\n    var disableInputEvents = msie && msie <= 11;\n\n    // Workaround for browsers which do not support the `input` event\n    // This will prevent double-triggering of events for browsers which support\n    // both the `keyup` and `input` events.\n    this.$selection.on(\n      'input.searchcheck',\n      '.select2-search--inline',\n      function (evt) {\n        // IE will trigger the `input` event when a placeholder is used on a\n        // search box. To get around this issue, we are forced to ignore all\n        // `input` events in IE and keep using `keyup`.\n        if (disableInputEvents) {\n          self.$selection.off('input.search input.searchcheck');\n          return;\n        }\n\n        // Unbind the duplicated `keyup` event\n        self.$selection.off('keyup.search');\n      }\n    );\n\n    this.$selection.on(\n      'keyup.search input.search',\n      '.select2-search--inline',\n      function (evt) {\n        // IE will trigger the `input` event when a placeholder is used on a\n        // search box. To get around this issue, we are forced to ignore all\n        // `input` events in IE and keep using `keyup`.\n        if (disableInputEvents && evt.type === 'input') {\n          self.$selection.off('input.search input.searchcheck');\n          return;\n        }\n\n        var key = evt.which;\n\n        // We can freely ignore events from modifier keys\n        if (key == KEYS.SHIFT || key == KEYS.CTRL || key == KEYS.ALT) {\n          return;\n        }\n\n        // Tabbing will be handled during the `keydown` phase\n        if (key == KEYS.TAB) {\n          return;\n        }\n\n        self.handleSearch(evt);\n      }\n    );\n  };\n\n  /**\n   * This method will transfer the tabindex attribute from the rendered\n   * selection to the search box. This allows for the search box to be used as\n   * the primary focus instead of the selection container.\n   *\n   * @private\n   */\n  Search.prototype._transferTabIndex = function (decorated) {\n    this.$search.attr('tabindex', this.$selection.attr('tabindex'));\n    this.$selection.attr('tabindex', '-1');\n  };\n\n  Search.prototype.createPlaceholder = function (decorated, placeholder) {\n    this.$search.attr('placeholder', placeholder.text);\n  };\n\n  Search.prototype.update = function (decorated, data) {\n    var searchHadFocus = this.$search[0] == document.activeElement;\n\n    this.$search.attr('placeholder', '');\n\n    decorated.call(this, data);\n\n    this.resizeSearch();\n    if (searchHadFocus) {\n      this.$search.trigger('focus');\n    }\n  };\n\n  Search.prototype.handleSearch = function () {\n    this.resizeSearch();\n\n    if (!this._keyUpPrevented) {\n      var input = this.$search.val();\n\n      this.trigger('query', {\n        term: input\n      });\n    }\n\n    this._keyUpPrevented = false;\n  };\n\n  Search.prototype.searchRemoveChoice = function (decorated, item) {\n    this.trigger('unselect', {\n      data: item\n    });\n\n    this.$search.val(item.text);\n    this.handleSearch();\n  };\n\n  Search.prototype.resizeSearch = function () {\n    this.$search.css('width', '25px');\n\n    var width = '100%';\n\n    if (this.$search.attr('placeholder') === '') {\n      var minimumWidth = this.$search.val().length + 1;\n\n      width = (minimumWidth * 0.75) + 'em';\n    }\n\n    this.$search.css('width', width);\n  };\n\n  return Search;\n});\n\nS2.define('select2/selection/selectionCss',[\n  '../utils'\n], function (Utils) {\n  function SelectionCSS () { }\n\n  SelectionCSS.prototype.render = function (decorated) {\n    var $selection = decorated.call(this);\n\n    var selectionCssClass = this.options.get('selectionCssClass') || '';\n\n    if (selectionCssClass.indexOf(':all:') !== -1) {\n      selectionCssClass = selectionCssClass.replace(':all:', '');\n\n      Utils.copyNonInternalCssClasses($selection[0], this.$element[0]);\n    }\n\n    $selection.addClass(selectionCssClass);\n\n    return $selection;\n  };\n\n  return SelectionCSS;\n});\n\nS2.define('select2/selection/eventRelay',[\n  'jquery'\n], function ($) {\n  function EventRelay () { }\n\n  EventRelay.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n    var relayEvents = [\n      'open', 'opening',\n      'close', 'closing',\n      'select', 'selecting',\n      'unselect', 'unselecting',\n      'clear', 'clearing'\n    ];\n\n    var preventableEvents = [\n      'opening', 'closing', 'selecting', 'unselecting', 'clearing'\n    ];\n\n    decorated.call(this, container, $container);\n\n    container.on('*', function (name, params) {\n      // Ignore events that should not be relayed\n      if (relayEvents.indexOf(name) === -1) {\n        return;\n      }\n\n      // The parameters should always be an object\n      params = params || {};\n\n      // Generate the jQuery event for the Select2 event\n      var evt = $.Event('select2:' + name, {\n        params: params\n      });\n\n      self.$element.trigger(evt);\n\n      // Only handle preventable events if it was one\n      if (preventableEvents.indexOf(name) === -1) {\n        return;\n      }\n\n      params.prevented = evt.isDefaultPrevented();\n    });\n  };\n\n  return EventRelay;\n});\n\nS2.define('select2/translation',[\n  'jquery',\n  'require'\n], function ($, require) {\n  function Translation (dict) {\n    this.dict = dict || {};\n  }\n\n  Translation.prototype.all = function () {\n    return this.dict;\n  };\n\n  Translation.prototype.get = function (key) {\n    return this.dict[key];\n  };\n\n  Translation.prototype.extend = function (translation) {\n    this.dict = $.extend({}, translation.all(), this.dict);\n  };\n\n  // Static functions\n\n  Translation._cache = {};\n\n  Translation.loadPath = function (path) {\n    if (!(path in Translation._cache)) {\n      var translations = require(path);\n\n      Translation._cache[path] = translations;\n    }\n\n    return new Translation(Translation._cache[path]);\n  };\n\n  return Translation;\n});\n\nS2.define('select2/diacritics',[\n\n], function () {\n  var diacritics = {\n    '\\u24B6': 'A',\n    '\\uFF21': 'A',\n    '\\u00C0': 'A',\n    '\\u00C1': 'A',\n    '\\u00C2': 'A',\n    '\\u1EA6': 'A',\n    '\\u1EA4': 'A',\n    '\\u1EAA': 'A',\n    '\\u1EA8': 'A',\n    '\\u00C3': 'A',\n    '\\u0100': 'A',\n    '\\u0102': 'A',\n    '\\u1EB0': 'A',\n    '\\u1EAE': 'A',\n    '\\u1EB4': 'A',\n    '\\u1EB2': 'A',\n    '\\u0226': 'A',\n    '\\u01E0': 'A',\n    '\\u00C4': 'A',\n    '\\u01DE': 'A',\n    '\\u1EA2': 'A',\n    '\\u00C5': 'A',\n    '\\u01FA': 'A',\n    '\\u01CD': 'A',\n    '\\u0200': 'A',\n    '\\u0202': 'A',\n    '\\u1EA0': 'A',\n    '\\u1EAC': 'A',\n    '\\u1EB6': 'A',\n    '\\u1E00': 'A',\n    '\\u0104': 'A',\n    '\\u023A': 'A',\n    '\\u2C6F': 'A',\n    '\\uA732': 'AA',\n    '\\u00C6': 'AE',\n    '\\u01FC': 'AE',\n    '\\u01E2': 'AE',\n    '\\uA734': 'AO',\n    '\\uA736': 'AU',\n    '\\uA738': 'AV',\n    '\\uA73A': 'AV',\n    '\\uA73C': 'AY',\n    '\\u24B7': 'B',\n    '\\uFF22': 'B',\n    '\\u1E02': 'B',\n    '\\u1E04': 'B',\n    '\\u1E06': 'B',\n    '\\u0243': 'B',\n    '\\u0182': 'B',\n    '\\u0181': 'B',\n    '\\u24B8': 'C',\n    '\\uFF23': 'C',\n    '\\u0106': 'C',\n    '\\u0108': 'C',\n    '\\u010A': 'C',\n    '\\u010C': 'C',\n    '\\u00C7': 'C',\n    '\\u1E08': 'C',\n    '\\u0187': 'C',\n    '\\u023B': 'C',\n    '\\uA73E': 'C',\n    '\\u24B9': 'D',\n    '\\uFF24': 'D',\n    '\\u1E0A': 'D',\n    '\\u010E': 'D',\n    '\\u1E0C': 'D',\n    '\\u1E10': 'D',\n    '\\u1E12': 'D',\n    '\\u1E0E': 'D',\n    '\\u0110': 'D',\n    '\\u018B': 'D',\n    '\\u018A': 'D',\n    '\\u0189': 'D',\n    '\\uA779': 'D',\n    '\\u01F1': 'DZ',\n    '\\u01C4': 'DZ',\n    '\\u01F2': 'Dz',\n    '\\u01C5': 'Dz',\n    '\\u24BA': 'E',\n    '\\uFF25': 'E',\n    '\\u00C8': 'E',\n    '\\u00C9': 'E',\n    '\\u00CA': 'E',\n    '\\u1EC0': 'E',\n    '\\u1EBE': 'E',\n    '\\u1EC4': 'E',\n    '\\u1EC2': 'E',\n    '\\u1EBC': 'E',\n    '\\u0112': 'E',\n    '\\u1E14': 'E',\n    '\\u1E16': 'E',\n    '\\u0114': 'E',\n    '\\u0116': 'E',\n    '\\u00CB': 'E',\n    '\\u1EBA': 'E',\n    '\\u011A': 'E',\n    '\\u0204': 'E',\n    '\\u0206': 'E',\n    '\\u1EB8': 'E',\n    '\\u1EC6': 'E',\n    '\\u0228': 'E',\n    '\\u1E1C': 'E',\n    '\\u0118': 'E',\n    '\\u1E18': 'E',\n    '\\u1E1A': 'E',\n    '\\u0190': 'E',\n    '\\u018E': 'E',\n    '\\u24BB': 'F',\n    '\\uFF26': 'F',\n    '\\u1E1E': 'F',\n    '\\u0191': 'F',\n    '\\uA77B': 'F',\n    '\\u24BC': 'G',\n    '\\uFF27': 'G',\n    '\\u01F4': 'G',\n    '\\u011C': 'G',\n    '\\u1E20': 'G',\n    '\\u011E': 'G',\n    '\\u0120': 'G',\n    '\\u01E6': 'G',\n    '\\u0122': 'G',\n    '\\u01E4': 'G',\n    '\\u0193': 'G',\n    '\\uA7A0': 'G',\n    '\\uA77D': 'G',\n    '\\uA77E': 'G',\n    '\\u24BD': 'H',\n    '\\uFF28': 'H',\n    '\\u0124': 'H',\n    '\\u1E22': 'H',\n    '\\u1E26': 'H',\n    '\\u021E': 'H',\n    '\\u1E24': 'H',\n    '\\u1E28': 'H',\n    '\\u1E2A': 'H',\n    '\\u0126': 'H',\n    '\\u2C67': 'H',\n    '\\u2C75': 'H',\n    '\\uA78D': 'H',\n    '\\u24BE': 'I',\n    '\\uFF29': 'I',\n    '\\u00CC': 'I',\n    '\\u00CD': 'I',\n    '\\u00CE': 'I',\n    '\\u0128': 'I',\n    '\\u012A': 'I',\n    '\\u012C': 'I',\n    '\\u0130': 'I',\n    '\\u00CF': 'I',\n    '\\u1E2E': 'I',\n    '\\u1EC8': 'I',\n    '\\u01CF': 'I',\n    '\\u0208': 'I',\n    '\\u020A': 'I',\n    '\\u1ECA': 'I',\n    '\\u012E': 'I',\n    '\\u1E2C': 'I',\n    '\\u0197': 'I',\n    '\\u24BF': 'J',\n    '\\uFF2A': 'J',\n    '\\u0134': 'J',\n    '\\u0248': 'J',\n    '\\u24C0': 'K',\n    '\\uFF2B': 'K',\n    '\\u1E30': 'K',\n    '\\u01E8': 'K',\n    '\\u1E32': 'K',\n    '\\u0136': 'K',\n    '\\u1E34': 'K',\n    '\\u0198': 'K',\n    '\\u2C69': 'K',\n    '\\uA740': 'K',\n    '\\uA742': 'K',\n    '\\uA744': 'K',\n    '\\uA7A2': 'K',\n    '\\u24C1': 'L',\n    '\\uFF2C': 'L',\n    '\\u013F': 'L',\n    '\\u0139': 'L',\n    '\\u013D': 'L',\n    '\\u1E36': 'L',\n    '\\u1E38': 'L',\n    '\\u013B': 'L',\n    '\\u1E3C': 'L',\n    '\\u1E3A': 'L',\n    '\\u0141': 'L',\n    '\\u023D': 'L',\n    '\\u2C62': 'L',\n    '\\u2C60': 'L',\n    '\\uA748': 'L',\n    '\\uA746': 'L',\n    '\\uA780': 'L',\n    '\\u01C7': 'LJ',\n    '\\u01C8': 'Lj',\n    '\\u24C2': 'M',\n    '\\uFF2D': 'M',\n    '\\u1E3E': 'M',\n    '\\u1E40': 'M',\n    '\\u1E42': 'M',\n    '\\u2C6E': 'M',\n    '\\u019C': 'M',\n    '\\u24C3': 'N',\n    '\\uFF2E': 'N',\n    '\\u01F8': 'N',\n    '\\u0143': 'N',\n    '\\u00D1': 'N',\n    '\\u1E44': 'N',\n    '\\u0147': 'N',\n    '\\u1E46': 'N',\n    '\\u0145': 'N',\n    '\\u1E4A': 'N',\n    '\\u1E48': 'N',\n    '\\u0220': 'N',\n    '\\u019D': 'N',\n    '\\uA790': 'N',\n    '\\uA7A4': 'N',\n    '\\u01CA': 'NJ',\n    '\\u01CB': 'Nj',\n    '\\u24C4': 'O',\n    '\\uFF2F': 'O',\n    '\\u00D2': 'O',\n    '\\u00D3': 'O',\n    '\\u00D4': 'O',\n    '\\u1ED2': 'O',\n    '\\u1ED0': 'O',\n    '\\u1ED6': 'O',\n    '\\u1ED4': 'O',\n    '\\u00D5': 'O',\n    '\\u1E4C': 'O',\n    '\\u022C': 'O',\n    '\\u1E4E': 'O',\n    '\\u014C': 'O',\n    '\\u1E50': 'O',\n    '\\u1E52': 'O',\n    '\\u014E': 'O',\n    '\\u022E': 'O',\n    '\\u0230': 'O',\n    '\\u00D6': 'O',\n    '\\u022A': 'O',\n    '\\u1ECE': 'O',\n    '\\u0150': 'O',\n    '\\u01D1': 'O',\n    '\\u020C': 'O',\n    '\\u020E': 'O',\n    '\\u01A0': 'O',\n    '\\u1EDC': 'O',\n    '\\u1EDA': 'O',\n    '\\u1EE0': 'O',\n    '\\u1EDE': 'O',\n    '\\u1EE2': 'O',\n    '\\u1ECC': 'O',\n    '\\u1ED8': 'O',\n    '\\u01EA': 'O',\n    '\\u01EC': 'O',\n    '\\u00D8': 'O',\n    '\\u01FE': 'O',\n    '\\u0186': 'O',\n    '\\u019F': 'O',\n    '\\uA74A': 'O',\n    '\\uA74C': 'O',\n    '\\u0152': 'OE',\n    '\\u01A2': 'OI',\n    '\\uA74E': 'OO',\n    '\\u0222': 'OU',\n    '\\u24C5': 'P',\n    '\\uFF30': 'P',\n    '\\u1E54': 'P',\n    '\\u1E56': 'P',\n    '\\u01A4': 'P',\n    '\\u2C63': 'P',\n    '\\uA750': 'P',\n    '\\uA752': 'P',\n    '\\uA754': 'P',\n    '\\u24C6': 'Q',\n    '\\uFF31': 'Q',\n    '\\uA756': 'Q',\n    '\\uA758': 'Q',\n    '\\u024A': 'Q',\n    '\\u24C7': 'R',\n    '\\uFF32': 'R',\n    '\\u0154': 'R',\n    '\\u1E58': 'R',\n    '\\u0158': 'R',\n    '\\u0210': 'R',\n    '\\u0212': 'R',\n    '\\u1E5A': 'R',\n    '\\u1E5C': 'R',\n    '\\u0156': 'R',\n    '\\u1E5E': 'R',\n    '\\u024C': 'R',\n    '\\u2C64': 'R',\n    '\\uA75A': 'R',\n    '\\uA7A6': 'R',\n    '\\uA782': 'R',\n    '\\u24C8': 'S',\n    '\\uFF33': 'S',\n    '\\u1E9E': 'S',\n    '\\u015A': 'S',\n    '\\u1E64': 'S',\n    '\\u015C': 'S',\n    '\\u1E60': 'S',\n    '\\u0160': 'S',\n    '\\u1E66': 'S',\n    '\\u1E62': 'S',\n    '\\u1E68': 'S',\n    '\\u0218': 'S',\n    '\\u015E': 'S',\n    '\\u2C7E': 'S',\n    '\\uA7A8': 'S',\n    '\\uA784': 'S',\n    '\\u24C9': 'T',\n    '\\uFF34': 'T',\n    '\\u1E6A': 'T',\n    '\\u0164': 'T',\n    '\\u1E6C': 'T',\n    '\\u021A': 'T',\n    '\\u0162': 'T',\n    '\\u1E70': 'T',\n    '\\u1E6E': 'T',\n    '\\u0166': 'T',\n    '\\u01AC': 'T',\n    '\\u01AE': 'T',\n    '\\u023E': 'T',\n    '\\uA786': 'T',\n    '\\uA728': 'TZ',\n    '\\u24CA': 'U',\n    '\\uFF35': 'U',\n    '\\u00D9': 'U',\n    '\\u00DA': 'U',\n    '\\u00DB': 'U',\n    '\\u0168': 'U',\n    '\\u1E78': 'U',\n    '\\u016A': 'U',\n    '\\u1E7A': 'U',\n    '\\u016C': 'U',\n    '\\u00DC': 'U',\n    '\\u01DB': 'U',\n    '\\u01D7': 'U',\n    '\\u01D5': 'U',\n    '\\u01D9': 'U',\n    '\\u1EE6': 'U',\n    '\\u016E': 'U',\n    '\\u0170': 'U',\n    '\\u01D3': 'U',\n    '\\u0214': 'U',\n    '\\u0216': 'U',\n    '\\u01AF': 'U',\n    '\\u1EEA': 'U',\n    '\\u1EE8': 'U',\n    '\\u1EEE': 'U',\n    '\\u1EEC': 'U',\n    '\\u1EF0': 'U',\n    '\\u1EE4': 'U',\n    '\\u1E72': 'U',\n    '\\u0172': 'U',\n    '\\u1E76': 'U',\n    '\\u1E74': 'U',\n    '\\u0244': 'U',\n    '\\u24CB': 'V',\n    '\\uFF36': 'V',\n    '\\u1E7C': 'V',\n    '\\u1E7E': 'V',\n    '\\u01B2': 'V',\n    '\\uA75E': 'V',\n    '\\u0245': 'V',\n    '\\uA760': 'VY',\n    '\\u24CC': 'W',\n    '\\uFF37': 'W',\n    '\\u1E80': 'W',\n    '\\u1E82': 'W',\n    '\\u0174': 'W',\n    '\\u1E86': 'W',\n    '\\u1E84': 'W',\n    '\\u1E88': 'W',\n    '\\u2C72': 'W',\n    '\\u24CD': 'X',\n    '\\uFF38': 'X',\n    '\\u1E8A': 'X',\n    '\\u1E8C': 'X',\n    '\\u24CE': 'Y',\n    '\\uFF39': 'Y',\n    '\\u1EF2': 'Y',\n    '\\u00DD': 'Y',\n    '\\u0176': 'Y',\n    '\\u1EF8': 'Y',\n    '\\u0232': 'Y',\n    '\\u1E8E': 'Y',\n    '\\u0178': 'Y',\n    '\\u1EF6': 'Y',\n    '\\u1EF4': 'Y',\n    '\\u01B3': 'Y',\n    '\\u024E': 'Y',\n    '\\u1EFE': 'Y',\n    '\\u24CF': 'Z',\n    '\\uFF3A': 'Z',\n    '\\u0179': 'Z',\n    '\\u1E90': 'Z',\n    '\\u017B': 'Z',\n    '\\u017D': 'Z',\n    '\\u1E92': 'Z',\n    '\\u1E94': 'Z',\n    '\\u01B5': 'Z',\n    '\\u0224': 'Z',\n    '\\u2C7F': 'Z',\n    '\\u2C6B': 'Z',\n    '\\uA762': 'Z',\n    '\\u24D0': 'a',\n    '\\uFF41': 'a',\n    '\\u1E9A': 'a',\n    '\\u00E0': 'a',\n    '\\u00E1': 'a',\n    '\\u00E2': 'a',\n    '\\u1EA7': 'a',\n    '\\u1EA5': 'a',\n    '\\u1EAB': 'a',\n    '\\u1EA9': 'a',\n    '\\u00E3': 'a',\n    '\\u0101': 'a',\n    '\\u0103': 'a',\n    '\\u1EB1': 'a',\n    '\\u1EAF': 'a',\n    '\\u1EB5': 'a',\n    '\\u1EB3': 'a',\n    '\\u0227': 'a',\n    '\\u01E1': 'a',\n    '\\u00E4': 'a',\n    '\\u01DF': 'a',\n    '\\u1EA3': 'a',\n    '\\u00E5': 'a',\n    '\\u01FB': 'a',\n    '\\u01CE': 'a',\n    '\\u0201': 'a',\n    '\\u0203': 'a',\n    '\\u1EA1': 'a',\n    '\\u1EAD': 'a',\n    '\\u1EB7': 'a',\n    '\\u1E01': 'a',\n    '\\u0105': 'a',\n    '\\u2C65': 'a',\n    '\\u0250': 'a',\n    '\\uA733': 'aa',\n    '\\u00E6': 'ae',\n    '\\u01FD': 'ae',\n    '\\u01E3': 'ae',\n    '\\uA735': 'ao',\n    '\\uA737': 'au',\n    '\\uA739': 'av',\n    '\\uA73B': 'av',\n    '\\uA73D': 'ay',\n    '\\u24D1': 'b',\n    '\\uFF42': 'b',\n    '\\u1E03': 'b',\n    '\\u1E05': 'b',\n    '\\u1E07': 'b',\n    '\\u0180': 'b',\n    '\\u0183': 'b',\n    '\\u0253': 'b',\n    '\\u24D2': 'c',\n    '\\uFF43': 'c',\n    '\\u0107': 'c',\n    '\\u0109': 'c',\n    '\\u010B': 'c',\n    '\\u010D': 'c',\n    '\\u00E7': 'c',\n    '\\u1E09': 'c',\n    '\\u0188': 'c',\n    '\\u023C': 'c',\n    '\\uA73F': 'c',\n    '\\u2184': 'c',\n    '\\u24D3': 'd',\n    '\\uFF44': 'd',\n    '\\u1E0B': 'd',\n    '\\u010F': 'd',\n    '\\u1E0D': 'd',\n    '\\u1E11': 'd',\n    '\\u1E13': 'd',\n    '\\u1E0F': 'd',\n    '\\u0111': 'd',\n    '\\u018C': 'd',\n    '\\u0256': 'd',\n    '\\u0257': 'd',\n    '\\uA77A': 'd',\n    '\\u01F3': 'dz',\n    '\\u01C6': 'dz',\n    '\\u24D4': 'e',\n    '\\uFF45': 'e',\n    '\\u00E8': 'e',\n    '\\u00E9': 'e',\n    '\\u00EA': 'e',\n    '\\u1EC1': 'e',\n    '\\u1EBF': 'e',\n    '\\u1EC5': 'e',\n    '\\u1EC3': 'e',\n    '\\u1EBD': 'e',\n    '\\u0113': 'e',\n    '\\u1E15': 'e',\n    '\\u1E17': 'e',\n    '\\u0115': 'e',\n    '\\u0117': 'e',\n    '\\u00EB': 'e',\n    '\\u1EBB': 'e',\n    '\\u011B': 'e',\n    '\\u0205': 'e',\n    '\\u0207': 'e',\n    '\\u1EB9': 'e',\n    '\\u1EC7': 'e',\n    '\\u0229': 'e',\n    '\\u1E1D': 'e',\n    '\\u0119': 'e',\n    '\\u1E19': 'e',\n    '\\u1E1B': 'e',\n    '\\u0247': 'e',\n    '\\u025B': 'e',\n    '\\u01DD': 'e',\n    '\\u24D5': 'f',\n    '\\uFF46': 'f',\n    '\\u1E1F': 'f',\n    '\\u0192': 'f',\n    '\\uA77C': 'f',\n    '\\u24D6': 'g',\n    '\\uFF47': 'g',\n    '\\u01F5': 'g',\n    '\\u011D': 'g',\n    '\\u1E21': 'g',\n    '\\u011F': 'g',\n    '\\u0121': 'g',\n    '\\u01E7': 'g',\n    '\\u0123': 'g',\n    '\\u01E5': 'g',\n    '\\u0260': 'g',\n    '\\uA7A1': 'g',\n    '\\u1D79': 'g',\n    '\\uA77F': 'g',\n    '\\u24D7': 'h',\n    '\\uFF48': 'h',\n    '\\u0125': 'h',\n    '\\u1E23': 'h',\n    '\\u1E27': 'h',\n    '\\u021F': 'h',\n    '\\u1E25': 'h',\n    '\\u1E29': 'h',\n    '\\u1E2B': 'h',\n    '\\u1E96': 'h',\n    '\\u0127': 'h',\n    '\\u2C68': 'h',\n    '\\u2C76': 'h',\n    '\\u0265': 'h',\n    '\\u0195': 'hv',\n    '\\u24D8': 'i',\n    '\\uFF49': 'i',\n    '\\u00EC': 'i',\n    '\\u00ED': 'i',\n    '\\u00EE': 'i',\n    '\\u0129': 'i',\n    '\\u012B': 'i',\n    '\\u012D': 'i',\n    '\\u00EF': 'i',\n    '\\u1E2F': 'i',\n    '\\u1EC9': 'i',\n    '\\u01D0': 'i',\n    '\\u0209': 'i',\n    '\\u020B': 'i',\n    '\\u1ECB': 'i',\n    '\\u012F': 'i',\n    '\\u1E2D': 'i',\n    '\\u0268': 'i',\n    '\\u0131': 'i',\n    '\\u24D9': 'j',\n    '\\uFF4A': 'j',\n    '\\u0135': 'j',\n    '\\u01F0': 'j',\n    '\\u0249': 'j',\n    '\\u24DA': 'k',\n    '\\uFF4B': 'k',\n    '\\u1E31': 'k',\n    '\\u01E9': 'k',\n    '\\u1E33': 'k',\n    '\\u0137': 'k',\n    '\\u1E35': 'k',\n    '\\u0199': 'k',\n    '\\u2C6A': 'k',\n    '\\uA741': 'k',\n    '\\uA743': 'k',\n    '\\uA745': 'k',\n    '\\uA7A3': 'k',\n    '\\u24DB': 'l',\n    '\\uFF4C': 'l',\n    '\\u0140': 'l',\n    '\\u013A': 'l',\n    '\\u013E': 'l',\n    '\\u1E37': 'l',\n    '\\u1E39': 'l',\n    '\\u013C': 'l',\n    '\\u1E3D': 'l',\n    '\\u1E3B': 'l',\n    '\\u017F': 'l',\n    '\\u0142': 'l',\n    '\\u019A': 'l',\n    '\\u026B': 'l',\n    '\\u2C61': 'l',\n    '\\uA749': 'l',\n    '\\uA781': 'l',\n    '\\uA747': 'l',\n    '\\u01C9': 'lj',\n    '\\u24DC': 'm',\n    '\\uFF4D': 'm',\n    '\\u1E3F': 'm',\n    '\\u1E41': 'm',\n    '\\u1E43': 'm',\n    '\\u0271': 'm',\n    '\\u026F': 'm',\n    '\\u24DD': 'n',\n    '\\uFF4E': 'n',\n    '\\u01F9': 'n',\n    '\\u0144': 'n',\n    '\\u00F1': 'n',\n    '\\u1E45': 'n',\n    '\\u0148': 'n',\n    '\\u1E47': 'n',\n    '\\u0146': 'n',\n    '\\u1E4B': 'n',\n    '\\u1E49': 'n',\n    '\\u019E': 'n',\n    '\\u0272': 'n',\n    '\\u0149': 'n',\n    '\\uA791': 'n',\n    '\\uA7A5': 'n',\n    '\\u01CC': 'nj',\n    '\\u24DE': 'o',\n    '\\uFF4F': 'o',\n    '\\u00F2': 'o',\n    '\\u00F3': 'o',\n    '\\u00F4': 'o',\n    '\\u1ED3': 'o',\n    '\\u1ED1': 'o',\n    '\\u1ED7': 'o',\n    '\\u1ED5': 'o',\n    '\\u00F5': 'o',\n    '\\u1E4D': 'o',\n    '\\u022D': 'o',\n    '\\u1E4F': 'o',\n    '\\u014D': 'o',\n    '\\u1E51': 'o',\n    '\\u1E53': 'o',\n    '\\u014F': 'o',\n    '\\u022F': 'o',\n    '\\u0231': 'o',\n    '\\u00F6': 'o',\n    '\\u022B': 'o',\n    '\\u1ECF': 'o',\n    '\\u0151': 'o',\n    '\\u01D2': 'o',\n    '\\u020D': 'o',\n    '\\u020F': 'o',\n    '\\u01A1': 'o',\n    '\\u1EDD': 'o',\n    '\\u1EDB': 'o',\n    '\\u1EE1': 'o',\n    '\\u1EDF': 'o',\n    '\\u1EE3': 'o',\n    '\\u1ECD': 'o',\n    '\\u1ED9': 'o',\n    '\\u01EB': 'o',\n    '\\u01ED': 'o',\n    '\\u00F8': 'o',\n    '\\u01FF': 'o',\n    '\\u0254': 'o',\n    '\\uA74B': 'o',\n    '\\uA74D': 'o',\n    '\\u0275': 'o',\n    '\\u0153': 'oe',\n    '\\u01A3': 'oi',\n    '\\u0223': 'ou',\n    '\\uA74F': 'oo',\n    '\\u24DF': 'p',\n    '\\uFF50': 'p',\n    '\\u1E55': 'p',\n    '\\u1E57': 'p',\n    '\\u01A5': 'p',\n    '\\u1D7D': 'p',\n    '\\uA751': 'p',\n    '\\uA753': 'p',\n    '\\uA755': 'p',\n    '\\u24E0': 'q',\n    '\\uFF51': 'q',\n    '\\u024B': 'q',\n    '\\uA757': 'q',\n    '\\uA759': 'q',\n    '\\u24E1': 'r',\n    '\\uFF52': 'r',\n    '\\u0155': 'r',\n    '\\u1E59': 'r',\n    '\\u0159': 'r',\n    '\\u0211': 'r',\n    '\\u0213': 'r',\n    '\\u1E5B': 'r',\n    '\\u1E5D': 'r',\n    '\\u0157': 'r',\n    '\\u1E5F': 'r',\n    '\\u024D': 'r',\n    '\\u027D': 'r',\n    '\\uA75B': 'r',\n    '\\uA7A7': 'r',\n    '\\uA783': 'r',\n    '\\u24E2': 's',\n    '\\uFF53': 's',\n    '\\u00DF': 's',\n    '\\u015B': 's',\n    '\\u1E65': 's',\n    '\\u015D': 's',\n    '\\u1E61': 's',\n    '\\u0161': 's',\n    '\\u1E67': 's',\n    '\\u1E63': 's',\n    '\\u1E69': 's',\n    '\\u0219': 's',\n    '\\u015F': 's',\n    '\\u023F': 's',\n    '\\uA7A9': 's',\n    '\\uA785': 's',\n    '\\u1E9B': 's',\n    '\\u24E3': 't',\n    '\\uFF54': 't',\n    '\\u1E6B': 't',\n    '\\u1E97': 't',\n    '\\u0165': 't',\n    '\\u1E6D': 't',\n    '\\u021B': 't',\n    '\\u0163': 't',\n    '\\u1E71': 't',\n    '\\u1E6F': 't',\n    '\\u0167': 't',\n    '\\u01AD': 't',\n    '\\u0288': 't',\n    '\\u2C66': 't',\n    '\\uA787': 't',\n    '\\uA729': 'tz',\n    '\\u24E4': 'u',\n    '\\uFF55': 'u',\n    '\\u00F9': 'u',\n    '\\u00FA': 'u',\n    '\\u00FB': 'u',\n    '\\u0169': 'u',\n    '\\u1E79': 'u',\n    '\\u016B': 'u',\n    '\\u1E7B': 'u',\n    '\\u016D': 'u',\n    '\\u00FC': 'u',\n    '\\u01DC': 'u',\n    '\\u01D8': 'u',\n    '\\u01D6': 'u',\n    '\\u01DA': 'u',\n    '\\u1EE7': 'u',\n    '\\u016F': 'u',\n    '\\u0171': 'u',\n    '\\u01D4': 'u',\n    '\\u0215': 'u',\n    '\\u0217': 'u',\n    '\\u01B0': 'u',\n    '\\u1EEB': 'u',\n    '\\u1EE9': 'u',\n    '\\u1EEF': 'u',\n    '\\u1EED': 'u',\n    '\\u1EF1': 'u',\n    '\\u1EE5': 'u',\n    '\\u1E73': 'u',\n    '\\u0173': 'u',\n    '\\u1E77': 'u',\n    '\\u1E75': 'u',\n    '\\u0289': 'u',\n    '\\u24E5': 'v',\n    '\\uFF56': 'v',\n    '\\u1E7D': 'v',\n    '\\u1E7F': 'v',\n    '\\u028B': 'v',\n    '\\uA75F': 'v',\n    '\\u028C': 'v',\n    '\\uA761': 'vy',\n    '\\u24E6': 'w',\n    '\\uFF57': 'w',\n    '\\u1E81': 'w',\n    '\\u1E83': 'w',\n    '\\u0175': 'w',\n    '\\u1E87': 'w',\n    '\\u1E85': 'w',\n    '\\u1E98': 'w',\n    '\\u1E89': 'w',\n    '\\u2C73': 'w',\n    '\\u24E7': 'x',\n    '\\uFF58': 'x',\n    '\\u1E8B': 'x',\n    '\\u1E8D': 'x',\n    '\\u24E8': 'y',\n    '\\uFF59': 'y',\n    '\\u1EF3': 'y',\n    '\\u00FD': 'y',\n    '\\u0177': 'y',\n    '\\u1EF9': 'y',\n    '\\u0233': 'y',\n    '\\u1E8F': 'y',\n    '\\u00FF': 'y',\n    '\\u1EF7': 'y',\n    '\\u1E99': 'y',\n    '\\u1EF5': 'y',\n    '\\u01B4': 'y',\n    '\\u024F': 'y',\n    '\\u1EFF': 'y',\n    '\\u24E9': 'z',\n    '\\uFF5A': 'z',\n    '\\u017A': 'z',\n    '\\u1E91': 'z',\n    '\\u017C': 'z',\n    '\\u017E': 'z',\n    '\\u1E93': 'z',\n    '\\u1E95': 'z',\n    '\\u01B6': 'z',\n    '\\u0225': 'z',\n    '\\u0240': 'z',\n    '\\u2C6C': 'z',\n    '\\uA763': 'z',\n    '\\u0386': '\\u0391',\n    '\\u0388': '\\u0395',\n    '\\u0389': '\\u0397',\n    '\\u038A': '\\u0399',\n    '\\u03AA': '\\u0399',\n    '\\u038C': '\\u039F',\n    '\\u038E': '\\u03A5',\n    '\\u03AB': '\\u03A5',\n    '\\u038F': '\\u03A9',\n    '\\u03AC': '\\u03B1',\n    '\\u03AD': '\\u03B5',\n    '\\u03AE': '\\u03B7',\n    '\\u03AF': '\\u03B9',\n    '\\u03CA': '\\u03B9',\n    '\\u0390': '\\u03B9',\n    '\\u03CC': '\\u03BF',\n    '\\u03CD': '\\u03C5',\n    '\\u03CB': '\\u03C5',\n    '\\u03B0': '\\u03C5',\n    '\\u03CE': '\\u03C9',\n    '\\u03C2': '\\u03C3',\n    '\\u2019': '\\''\n  };\n\n  return diacritics;\n});\n\nS2.define('select2/data/base',[\n  '../utils'\n], function (Utils) {\n  function BaseAdapter ($element, options) {\n    BaseAdapter.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(BaseAdapter, Utils.Observable);\n\n  BaseAdapter.prototype.current = function (callback) {\n    throw new Error('The `current` method must be defined in child classes.');\n  };\n\n  BaseAdapter.prototype.query = function (params, callback) {\n    throw new Error('The `query` method must be defined in child classes.');\n  };\n\n  BaseAdapter.prototype.bind = function (container, $container) {\n    // Can be implemented in subclasses\n  };\n\n  BaseAdapter.prototype.destroy = function () {\n    // Can be implemented in subclasses\n  };\n\n  BaseAdapter.prototype.generateResultId = function (container, data) {\n    var id = container.id + '-result-';\n\n    id += Utils.generateChars(4);\n\n    if (data.id != null) {\n      id += '-' + data.id.toString();\n    } else {\n      id += '-' + Utils.generateChars(4);\n    }\n    return id;\n  };\n\n  return BaseAdapter;\n});\n\nS2.define('select2/data/select',[\n  './base',\n  '../utils',\n  'jquery'\n], function (BaseAdapter, Utils, $) {\n  function SelectAdapter ($element, options) {\n    this.$element = $element;\n    this.options = options;\n\n    SelectAdapter.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(SelectAdapter, BaseAdapter);\n\n  SelectAdapter.prototype.current = function (callback) {\n    var self = this;\n\n    var data = Array.prototype.map.call(\n      this.$element[0].querySelectorAll(':checked'),\n      function (selectedElement) {\n        return self.item($(selectedElement));\n      }\n    );\n\n    callback(data);\n  };\n\n  SelectAdapter.prototype.select = function (data) {\n    var self = this;\n\n    data.selected = true;\n\n    // If data.element is a DOM node, use it instead\n    if (\n      data.element != null && data.element.tagName.toLowerCase() === 'option'\n    ) {\n      data.element.selected = true;\n\n      this.$element.trigger('input').trigger('change');\n\n      return;\n    }\n\n    if (this.$element.prop('multiple')) {\n      this.current(function (currentData) {\n        var val = [];\n\n        data = [data];\n        data.push.apply(data, currentData);\n\n        for (var d = 0; d < data.length; d++) {\n          var id = data[d].id;\n\n          if (val.indexOf(id) === -1) {\n            val.push(id);\n          }\n        }\n\n        self.$element.val(val);\n        self.$element.trigger('input').trigger('change');\n      });\n    } else {\n      var val = data.id;\n\n      this.$element.val(val);\n      this.$element.trigger('input').trigger('change');\n    }\n  };\n\n  SelectAdapter.prototype.unselect = function (data) {\n    var self = this;\n\n    if (!this.$element.prop('multiple')) {\n      return;\n    }\n\n    data.selected = false;\n\n    if (\n      data.element != null &&\n      data.element.tagName.toLowerCase() === 'option'\n    ) {\n      data.element.selected = false;\n\n      this.$element.trigger('input').trigger('change');\n\n      return;\n    }\n\n    this.current(function (currentData) {\n      var val = [];\n\n      for (var d = 0; d < currentData.length; d++) {\n        var id = currentData[d].id;\n\n        if (id !== data.id && val.indexOf(id) === -1) {\n          val.push(id);\n        }\n      }\n\n      self.$element.val(val);\n\n      self.$element.trigger('input').trigger('change');\n    });\n  };\n\n  SelectAdapter.prototype.bind = function (container, $container) {\n    var self = this;\n\n    this.container = container;\n\n    container.on('select', function (params) {\n      self.select(params.data);\n    });\n\n    container.on('unselect', function (params) {\n      self.unselect(params.data);\n    });\n  };\n\n  SelectAdapter.prototype.destroy = function () {\n    // Remove anything added to child elements\n    this.$element.find('*').each(function () {\n      // Remove any custom data set by Select2\n      Utils.RemoveData(this);\n    });\n  };\n\n  SelectAdapter.prototype.query = function (params, callback) {\n    var data = [];\n    var self = this;\n\n    var $options = this.$element.children();\n\n    $options.each(function () {\n      if (\n        this.tagName.toLowerCase() !== 'option' &&\n        this.tagName.toLowerCase() !== 'optgroup'\n      ) {\n        return;\n      }\n\n      var $option = $(this);\n\n      var option = self.item($option);\n\n      var matches = self.matches(params, option);\n\n      if (matches !== null) {\n        data.push(matches);\n      }\n    });\n\n    callback({\n      results: data\n    });\n  };\n\n  SelectAdapter.prototype.addOptions = function ($options) {\n    this.$element.append($options);\n  };\n\n  SelectAdapter.prototype.option = function (data) {\n    var option;\n\n    if (data.children) {\n      option = document.createElement('optgroup');\n      option.label = data.text;\n    } else {\n      option = document.createElement('option');\n\n      if (option.textContent !== undefined) {\n        option.textContent = data.text;\n      } else {\n        option.innerText = data.text;\n      }\n    }\n\n    if (data.id !== undefined) {\n      option.value = data.id;\n    }\n\n    if (data.disabled) {\n      option.disabled = true;\n    }\n\n    if (data.selected) {\n      option.selected = true;\n    }\n\n    if (data.title) {\n      option.title = data.title;\n    }\n\n    var normalizedData = this._normalizeItem(data);\n    normalizedData.element = option;\n\n    // Override the option's data with the combined data\n    Utils.StoreData(option, 'data', normalizedData);\n\n    return $(option);\n  };\n\n  SelectAdapter.prototype.item = function ($option) {\n    var data = {};\n\n    data = Utils.GetData($option[0], 'data');\n\n    if (data != null) {\n      return data;\n    }\n\n    var option = $option[0];\n\n    if (option.tagName.toLowerCase() === 'option') {\n      data = {\n        id: $option.val(),\n        text: $option.text(),\n        disabled: $option.prop('disabled'),\n        selected: $option.prop('selected'),\n        title: $option.prop('title')\n      };\n    } else if (option.tagName.toLowerCase() === 'optgroup') {\n      data = {\n        text: $option.prop('label'),\n        children: [],\n        title: $option.prop('title')\n      };\n\n      var $children = $option.children('option');\n      var children = [];\n\n      for (var c = 0; c < $children.length; c++) {\n        var $child = $($children[c]);\n\n        var child = this.item($child);\n\n        children.push(child);\n      }\n\n      data.children = children;\n    }\n\n    data = this._normalizeItem(data);\n    data.element = $option[0];\n\n    Utils.StoreData($option[0], 'data', data);\n\n    return data;\n  };\n\n  SelectAdapter.prototype._normalizeItem = function (item) {\n    if (item !== Object(item)) {\n      item = {\n        id: item,\n        text: item\n      };\n    }\n\n    item = $.extend({}, {\n      text: ''\n    }, item);\n\n    var defaults = {\n      selected: false,\n      disabled: false\n    };\n\n    if (item.id != null) {\n      item.id = item.id.toString();\n    }\n\n    if (item.text != null) {\n      item.text = item.text.toString();\n    }\n\n    if (item._resultId == null && item.id && this.container != null) {\n      item._resultId = this.generateResultId(this.container, item);\n    }\n\n    return $.extend({}, defaults, item);\n  };\n\n  SelectAdapter.prototype.matches = function (params, data) {\n    var matcher = this.options.get('matcher');\n\n    return matcher(params, data);\n  };\n\n  return SelectAdapter;\n});\n\nS2.define('select2/data/array',[\n  './select',\n  '../utils',\n  'jquery'\n], function (SelectAdapter, Utils, $) {\n  function ArrayAdapter ($element, options) {\n    this._dataToConvert = options.get('data') || [];\n\n    ArrayAdapter.__super__.constructor.call(this, $element, options);\n  }\n\n  Utils.Extend(ArrayAdapter, SelectAdapter);\n\n  ArrayAdapter.prototype.bind = function (container, $container) {\n    ArrayAdapter.__super__.bind.call(this, container, $container);\n\n    this.addOptions(this.convertToOptions(this._dataToConvert));\n  };\n\n  ArrayAdapter.prototype.select = function (data) {\n    var $option = this.$element.find('option').filter(function (i, elm) {\n      return elm.value == data.id.toString();\n    });\n\n    if ($option.length === 0) {\n      $option = this.option(data);\n\n      this.addOptions($option);\n    }\n\n    ArrayAdapter.__super__.select.call(this, data);\n  };\n\n  ArrayAdapter.prototype.convertToOptions = function (data) {\n    var self = this;\n\n    var $existing = this.$element.find('option');\n    var existingIds = $existing.map(function () {\n      return self.item($(this)).id;\n    }).get();\n\n    var $options = [];\n\n    // Filter out all items except for the one passed in the argument\n    function onlyItem (item) {\n      return function () {\n        return $(this).val() == item.id;\n      };\n    }\n\n    for (var d = 0; d < data.length; d++) {\n      var item = this._normalizeItem(data[d]);\n\n      // Skip items which were pre-loaded, only merge the data\n      if (existingIds.indexOf(item.id) >= 0) {\n        var $existingOption = $existing.filter(onlyItem(item));\n\n        var existingData = this.item($existingOption);\n        var newData = $.extend(true, {}, item, existingData);\n\n        var $newOption = this.option(newData);\n\n        $existingOption.replaceWith($newOption);\n\n        continue;\n      }\n\n      var $option = this.option(item);\n\n      if (item.children) {\n        var $children = this.convertToOptions(item.children);\n\n        $option.append($children);\n      }\n\n      $options.push($option);\n    }\n\n    return $options;\n  };\n\n  return ArrayAdapter;\n});\n\nS2.define('select2/data/ajax',[\n  './array',\n  '../utils',\n  'jquery'\n], function (ArrayAdapter, Utils, $) {\n  function AjaxAdapter ($element, options) {\n    this.ajaxOptions = this._applyDefaults(options.get('ajax'));\n\n    if (this.ajaxOptions.processResults != null) {\n      this.processResults = this.ajaxOptions.processResults;\n    }\n\n    AjaxAdapter.__super__.constructor.call(this, $element, options);\n  }\n\n  Utils.Extend(AjaxAdapter, ArrayAdapter);\n\n  AjaxAdapter.prototype._applyDefaults = function (options) {\n    var defaults = {\n      data: function (params) {\n        return $.extend({}, params, {\n          q: params.term\n        });\n      },\n      transport: function (params, success, failure) {\n        var $request = $.ajax(params);\n\n        $request.then(success);\n        $request.fail(failure);\n\n        return $request;\n      }\n    };\n\n    return $.extend({}, defaults, options, true);\n  };\n\n  AjaxAdapter.prototype.processResults = function (results) {\n    return results;\n  };\n\n  AjaxAdapter.prototype.query = function (params, callback) {\n    var matches = [];\n    var self = this;\n\n    if (this._request != null) {\n      // JSONP requests cannot always be aborted\n      if (typeof this._request.abort === 'function') {\n        this._request.abort();\n      }\n\n      this._request = null;\n    }\n\n    var options = $.extend({\n      type: 'GET'\n    }, this.ajaxOptions);\n\n    if (typeof options.url === 'function') {\n      options.url = options.url.call(this.$element, params);\n    }\n\n    if (typeof options.data === 'function') {\n      options.data = options.data.call(this.$element, params);\n    }\n\n    function request () {\n      var $request = options.transport(options, function (data) {\n        var results = self.processResults(data, params);\n\n        if (self.options.get('debug') && window.console && console.error) {\n          // Check to make sure that the response included a `results` key.\n          if (!results || !results.results || !Array.isArray(results.results)) {\n            console.error(\n              'Select2: The AJAX results did not return an array in the ' +\n              '`results` key of the response.'\n            );\n          }\n        }\n\n        callback(results);\n      }, function () {\n        // Attempt to detect if a request was aborted\n        // Only works if the transport exposes a status property\n        if ('status' in $request &&\n            ($request.status === 0 || $request.status === '0')) {\n          return;\n        }\n\n        self.trigger('results:message', {\n          message: 'errorLoading'\n        });\n      });\n\n      self._request = $request;\n    }\n\n    if (this.ajaxOptions.delay && params.term != null) {\n      if (this._queryTimeout) {\n        window.clearTimeout(this._queryTimeout);\n      }\n\n      this._queryTimeout = window.setTimeout(request, this.ajaxOptions.delay);\n    } else {\n      request();\n    }\n  };\n\n  return AjaxAdapter;\n});\n\nS2.define('select2/data/tags',[\n  'jquery'\n], function ($) {\n  function Tags (decorated, $element, options) {\n    var tags = options.get('tags');\n\n    var createTag = options.get('createTag');\n\n    if (createTag !== undefined) {\n      this.createTag = createTag;\n    }\n\n    var insertTag = options.get('insertTag');\n\n    if (insertTag !== undefined) {\n        this.insertTag = insertTag;\n    }\n\n    decorated.call(this, $element, options);\n\n    if (Array.isArray(tags)) {\n      for (var t = 0; t < tags.length; t++) {\n        var tag = tags[t];\n        var item = this._normalizeItem(tag);\n\n        var $option = this.option(item);\n\n        this.$element.append($option);\n      }\n    }\n  }\n\n  Tags.prototype.query = function (decorated, params, callback) {\n    var self = this;\n\n    this._removeOldTags();\n\n    if (params.term == null || params.page != null) {\n      decorated.call(this, params, callback);\n      return;\n    }\n\n    function wrapper (obj, child) {\n      var data = obj.results;\n\n      for (var i = 0; i < data.length; i++) {\n        var option = data[i];\n\n        var checkChildren = (\n          option.children != null &&\n          !wrapper({\n            results: option.children\n          }, true)\n        );\n\n        var optionText = (option.text || '').toUpperCase();\n        var paramsTerm = (params.term || '').toUpperCase();\n\n        var checkText = optionText === paramsTerm;\n\n        if (checkText || checkChildren) {\n          if (child) {\n            return false;\n          }\n\n          obj.data = data;\n          callback(obj);\n\n          return;\n        }\n      }\n\n      if (child) {\n        return true;\n      }\n\n      var tag = self.createTag(params);\n\n      if (tag != null) {\n        var $option = self.option(tag);\n        $option.attr('data-select2-tag', 'true');\n\n        self.addOptions([$option]);\n\n        self.insertTag(data, tag);\n      }\n\n      obj.results = data;\n\n      callback(obj);\n    }\n\n    decorated.call(this, params, wrapper);\n  };\n\n  Tags.prototype.createTag = function (decorated, params) {\n    if (params.term == null) {\n      return null;\n    }\n\n    var term = params.term.trim();\n\n    if (term === '') {\n      return null;\n    }\n\n    return {\n      id: term,\n      text: term\n    };\n  };\n\n  Tags.prototype.insertTag = function (_, data, tag) {\n    data.unshift(tag);\n  };\n\n  Tags.prototype._removeOldTags = function (_) {\n    var $options = this.$element.find('option[data-select2-tag]');\n\n    $options.each(function () {\n      if (this.selected) {\n        return;\n      }\n\n      $(this).remove();\n    });\n  };\n\n  return Tags;\n});\n\nS2.define('select2/data/tokenizer',[\n  'jquery'\n], function ($) {\n  function Tokenizer (decorated, $element, options) {\n    var tokenizer = options.get('tokenizer');\n\n    if (tokenizer !== undefined) {\n      this.tokenizer = tokenizer;\n    }\n\n    decorated.call(this, $element, options);\n  }\n\n  Tokenizer.prototype.bind = function (decorated, container, $container) {\n    decorated.call(this, container, $container);\n\n    this.$search =  container.dropdown.$search || container.selection.$search ||\n      $container.find('.select2-search__field');\n  };\n\n  Tokenizer.prototype.query = function (decorated, params, callback) {\n    var self = this;\n\n    function createAndSelect (data) {\n      // Normalize the data object so we can use it for checks\n      var item = self._normalizeItem(data);\n\n      // Check if the data object already exists as a tag\n      // Select it if it doesn't\n      var $existingOptions = self.$element.find('option').filter(function () {\n        return $(this).val() === item.id;\n      });\n\n      // If an existing option wasn't found for it, create the option\n      if (!$existingOptions.length) {\n        var $option = self.option(item);\n        $option.attr('data-select2-tag', true);\n\n        self._removeOldTags();\n        self.addOptions([$option]);\n      }\n\n      // Select the item, now that we know there is an option for it\n      select(item);\n    }\n\n    function select (data) {\n      self.trigger('select', {\n        data: data\n      });\n    }\n\n    params.term = params.term || '';\n\n    var tokenData = this.tokenizer(params, this.options, createAndSelect);\n\n    if (tokenData.term !== params.term) {\n      // Replace the search term if we have the search box\n      if (this.$search.length) {\n        this.$search.val(tokenData.term);\n        this.$search.trigger('focus');\n      }\n\n      params.term = tokenData.term;\n    }\n\n    decorated.call(this, params, callback);\n  };\n\n  Tokenizer.prototype.tokenizer = function (_, params, options, callback) {\n    var separators = options.get('tokenSeparators') || [];\n    var term = params.term;\n    var i = 0;\n\n    var createTag = this.createTag || function (params) {\n      return {\n        id: params.term,\n        text: params.term\n      };\n    };\n\n    while (i < term.length) {\n      var termChar = term[i];\n\n      if (separators.indexOf(termChar) === -1) {\n        i++;\n\n        continue;\n      }\n\n      var part = term.substr(0, i);\n      var partParams = $.extend({}, params, {\n        term: part\n      });\n\n      var data = createTag(partParams);\n\n      if (data == null) {\n        i++;\n        continue;\n      }\n\n      callback(data);\n\n      // Reset the term to not include the tokenized portion\n      term = term.substr(i + 1) || '';\n      i = 0;\n    }\n\n    return {\n      term: term\n    };\n  };\n\n  return Tokenizer;\n});\n\nS2.define('select2/data/minimumInputLength',[\n\n], function () {\n  function MinimumInputLength (decorated, $e, options) {\n    this.minimumInputLength = options.get('minimumInputLength');\n\n    decorated.call(this, $e, options);\n  }\n\n  MinimumInputLength.prototype.query = function (decorated, params, callback) {\n    params.term = params.term || '';\n\n    if (params.term.length < this.minimumInputLength) {\n      this.trigger('results:message', {\n        message: 'inputTooShort',\n        args: {\n          minimum: this.minimumInputLength,\n          input: params.term,\n          params: params\n        }\n      });\n\n      return;\n    }\n\n    decorated.call(this, params, callback);\n  };\n\n  return MinimumInputLength;\n});\n\nS2.define('select2/data/maximumInputLength',[\n\n], function () {\n  function MaximumInputLength (decorated, $e, options) {\n    this.maximumInputLength = options.get('maximumInputLength');\n\n    decorated.call(this, $e, options);\n  }\n\n  MaximumInputLength.prototype.query = function (decorated, params, callback) {\n    params.term = params.term || '';\n\n    if (this.maximumInputLength > 0 &&\n        params.term.length > this.maximumInputLength) {\n      this.trigger('results:message', {\n        message: 'inputTooLong',\n        args: {\n          maximum: this.maximumInputLength,\n          input: params.term,\n          params: params\n        }\n      });\n\n      return;\n    }\n\n    decorated.call(this, params, callback);\n  };\n\n  return MaximumInputLength;\n});\n\nS2.define('select2/data/maximumSelectionLength',[\n\n], function (){\n  function MaximumSelectionLength (decorated, $e, options) {\n    this.maximumSelectionLength = options.get('maximumSelectionLength');\n\n    decorated.call(this, $e, options);\n  }\n\n  MaximumSelectionLength.prototype.bind =\n    function (decorated, container, $container) {\n      var self = this;\n\n      decorated.call(this, container, $container);\n\n      container.on('select', function () {\n        self._checkIfMaximumSelected();\n      });\n  };\n\n  MaximumSelectionLength.prototype.query =\n    function (decorated, params, callback) {\n      var self = this;\n\n      this._checkIfMaximumSelected(function () {\n        decorated.call(self, params, callback);\n      });\n  };\n\n  MaximumSelectionLength.prototype._checkIfMaximumSelected =\n    function (_, successCallback) {\n      var self = this;\n\n      this.current(function (currentData) {\n        var count = currentData != null ? currentData.length : 0;\n        if (self.maximumSelectionLength > 0 &&\n          count >= self.maximumSelectionLength) {\n          self.trigger('results:message', {\n            message: 'maximumSelected',\n            args: {\n              maximum: self.maximumSelectionLength\n            }\n          });\n          return;\n        }\n\n        if (successCallback) {\n          successCallback();\n        }\n      });\n  };\n\n  return MaximumSelectionLength;\n});\n\nS2.define('select2/dropdown',[\n  'jquery',\n  './utils'\n], function ($, Utils) {\n  function Dropdown ($element, options) {\n    this.$element = $element;\n    this.options = options;\n\n    Dropdown.__super__.constructor.call(this);\n  }\n\n  Utils.Extend(Dropdown, Utils.Observable);\n\n  Dropdown.prototype.render = function () {\n    var $dropdown = $(\n      '<span class=\"select2-dropdown\">' +\n        '<span class=\"select2-results\"></span>' +\n      '</span>'\n    );\n\n    $dropdown.attr('dir', this.options.get('dir'));\n\n    this.$dropdown = $dropdown;\n\n    return $dropdown;\n  };\n\n  Dropdown.prototype.bind = function () {\n    // Should be implemented in subclasses\n  };\n\n  Dropdown.prototype.position = function ($dropdown, $container) {\n    // Should be implemented in subclasses\n  };\n\n  Dropdown.prototype.destroy = function () {\n    // Remove the dropdown from the DOM\n    this.$dropdown.remove();\n  };\n\n  return Dropdown;\n});\n\nS2.define('select2/dropdown/search',[\n  'jquery'\n], function ($) {\n  function Search () { }\n\n  Search.prototype.render = function (decorated) {\n    var $rendered = decorated.call(this);\n    var searchLabel = this.options.get('translations').get('search');\n\n    var $search = $(\n      '<span class=\"select2-search select2-search--dropdown\">' +\n        '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\n        ' autocorrect=\"off\" autocapitalize=\"none\"' +\n        ' spellcheck=\"false\" role=\"searchbox\" aria-autocomplete=\"list\" />' +\n      '</span>'\n    );\n\n    this.$searchContainer = $search;\n    this.$search = $search.find('input');\n\n    this.$search.prop('autocomplete', this.options.get('autocomplete'));\n    this.$search.attr('aria-label', searchLabel());\n\n    $rendered.prepend($search);\n\n    return $rendered;\n  };\n\n  Search.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    var resultsId = container.id + '-results';\n\n    decorated.call(this, container, $container);\n\n    this.$search.on('keydown', function (evt) {\n      self.trigger('keypress', evt);\n\n      self._keyUpPrevented = evt.isDefaultPrevented();\n    });\n\n    // Workaround for browsers which do not support the `input` event\n    // This will prevent double-triggering of events for browsers which support\n    // both the `keyup` and `input` events.\n    this.$search.on('input', function (evt) {\n      // Unbind the duplicated `keyup` event\n      $(this).off('keyup');\n    });\n\n    this.$search.on('keyup input', function (evt) {\n      self.handleSearch(evt);\n    });\n\n    container.on('open', function () {\n      self.$search.attr('tabindex', 0);\n      self.$search.attr('aria-controls', resultsId);\n\n      self.$search.trigger('focus');\n\n      window.setTimeout(function () {\n        self.$search.trigger('focus');\n      }, 0);\n    });\n\n    container.on('close', function () {\n      self.$search.attr('tabindex', -1);\n      self.$search.removeAttr('aria-controls');\n      self.$search.removeAttr('aria-activedescendant');\n\n      self.$search.val('');\n      self.$search.trigger('blur');\n    });\n\n    container.on('focus', function () {\n      if (!container.isOpen()) {\n        self.$search.trigger('focus');\n      }\n    });\n\n    container.on('results:all', function (params) {\n      if (params.query.term == null || params.query.term === '') {\n        var showSearch = self.showSearch(params);\n\n        if (showSearch) {\n          self.$searchContainer[0].classList.remove('select2-search--hide');\n        } else {\n          self.$searchContainer[0].classList.add('select2-search--hide');\n        }\n      }\n    });\n\n    container.on('results:focus', function (params) {\n      if (params.data._resultId) {\n        self.$search.attr('aria-activedescendant', params.data._resultId);\n      } else {\n        self.$search.removeAttr('aria-activedescendant');\n      }\n    });\n  };\n\n  Search.prototype.handleSearch = function (evt) {\n    if (!this._keyUpPrevented) {\n      var input = this.$search.val();\n\n      this.trigger('query', {\n        term: input\n      });\n    }\n\n    this._keyUpPrevented = false;\n  };\n\n  Search.prototype.showSearch = function (_, params) {\n    return true;\n  };\n\n  return Search;\n});\n\nS2.define('select2/dropdown/hidePlaceholder',[\n\n], function () {\n  function HidePlaceholder (decorated, $element, options, dataAdapter) {\n    this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\n\n    decorated.call(this, $element, options, dataAdapter);\n  }\n\n  HidePlaceholder.prototype.append = function (decorated, data) {\n    data.results = this.removePlaceholder(data.results);\n\n    decorated.call(this, data);\n  };\n\n  HidePlaceholder.prototype.normalizePlaceholder = function (_, placeholder) {\n    if (typeof placeholder === 'string') {\n      placeholder = {\n        id: '',\n        text: placeholder\n      };\n    }\n\n    return placeholder;\n  };\n\n  HidePlaceholder.prototype.removePlaceholder = function (_, data) {\n    var modifiedData = data.slice(0);\n\n    for (var d = data.length - 1; d >= 0; d--) {\n      var item = data[d];\n\n      if (this.placeholder.id === item.id) {\n        modifiedData.splice(d, 1);\n      }\n    }\n\n    return modifiedData;\n  };\n\n  return HidePlaceholder;\n});\n\nS2.define('select2/dropdown/infiniteScroll',[\n  'jquery'\n], function ($) {\n  function InfiniteScroll (decorated, $element, options, dataAdapter) {\n    this.lastParams = {};\n\n    decorated.call(this, $element, options, dataAdapter);\n\n    this.$loadingMore = this.createLoadingMore();\n    this.loading = false;\n  }\n\n  InfiniteScroll.prototype.append = function (decorated, data) {\n    this.$loadingMore.remove();\n    this.loading = false;\n\n    decorated.call(this, data);\n\n    if (this.showLoadingMore(data)) {\n      this.$results.append(this.$loadingMore);\n      this.loadMoreIfNeeded();\n    }\n  };\n\n  InfiniteScroll.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('query', function (params) {\n      self.lastParams = params;\n      self.loading = true;\n    });\n\n    container.on('query:append', function (params) {\n      self.lastParams = params;\n      self.loading = true;\n    });\n\n    this.$results.on('scroll', this.loadMoreIfNeeded.bind(this));\n  };\n\n  InfiniteScroll.prototype.loadMoreIfNeeded = function () {\n    var isLoadMoreVisible = $.contains(\n      document.documentElement,\n      this.$loadingMore[0]\n    );\n\n    if (this.loading || !isLoadMoreVisible) {\n      return;\n    }\n\n    var currentOffset = this.$results.offset().top +\n      this.$results.outerHeight(false);\n    var loadingMoreOffset = this.$loadingMore.offset().top +\n      this.$loadingMore.outerHeight(false);\n\n    if (currentOffset + 50 >= loadingMoreOffset) {\n      this.loadMore();\n    }\n  };\n\n  InfiniteScroll.prototype.loadMore = function () {\n    this.loading = true;\n\n    var params = $.extend({}, {page: 1}, this.lastParams);\n\n    params.page++;\n\n    this.trigger('query:append', params);\n  };\n\n  InfiniteScroll.prototype.showLoadingMore = function (_, data) {\n    return data.pagination && data.pagination.more;\n  };\n\n  InfiniteScroll.prototype.createLoadingMore = function () {\n    var $option = $(\n      '<li ' +\n      'class=\"select2-results__option select2-results__option--load-more\"' +\n      'role=\"option\" aria-disabled=\"true\"></li>'\n    );\n\n    var message = this.options.get('translations').get('loadingMore');\n\n    $option.html(message(this.lastParams));\n\n    return $option;\n  };\n\n  return InfiniteScroll;\n});\n\nS2.define('select2/dropdown/attachBody',[\n  'jquery',\n  '../utils'\n], function ($, Utils) {\n  function AttachBody (decorated, $element, options) {\n    this.$dropdownParent = $(options.get('dropdownParent') || document.body);\n\n    decorated.call(this, $element, options);\n  }\n\n  AttachBody.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('open', function () {\n      self._showDropdown();\n      self._attachPositioningHandler(container);\n\n      // Must bind after the results handlers to ensure correct sizing\n      self._bindContainerResultHandlers(container);\n    });\n\n    container.on('close', function () {\n      self._hideDropdown();\n      self._detachPositioningHandler(container);\n    });\n\n    this.$dropdownContainer.on('mousedown', function (evt) {\n      evt.stopPropagation();\n    });\n  };\n\n  AttachBody.prototype.destroy = function (decorated) {\n    decorated.call(this);\n\n    this.$dropdownContainer.remove();\n  };\n\n  AttachBody.prototype.position = function (decorated, $dropdown, $container) {\n    // Clone all of the container classes\n    $dropdown.attr('class', $container.attr('class'));\n\n    $dropdown[0].classList.remove('select2');\n    $dropdown[0].classList.add('select2-container--open');\n\n    $dropdown.css({\n      position: 'absolute',\n      top: -999999\n    });\n\n    this.$container = $container;\n  };\n\n  AttachBody.prototype.render = function (decorated) {\n    var $container = $('<span></span>');\n\n    var $dropdown = decorated.call(this);\n    $container.append($dropdown);\n\n    this.$dropdownContainer = $container;\n\n    return $container;\n  };\n\n  AttachBody.prototype._hideDropdown = function (decorated) {\n    this.$dropdownContainer.detach();\n  };\n\n  AttachBody.prototype._bindContainerResultHandlers =\n      function (decorated, container) {\n\n    // These should only be bound once\n    if (this._containerResultsHandlersBound) {\n      return;\n    }\n\n    var self = this;\n\n    container.on('results:all', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('results:append', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('results:message', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('select', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    container.on('unselect', function () {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n\n    this._containerResultsHandlersBound = true;\n  };\n\n  AttachBody.prototype._attachPositioningHandler =\n      function (decorated, container) {\n    var self = this;\n\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.each(function () {\n      Utils.StoreData(this, 'select2-scroll-position', {\n        x: $(this).scrollLeft(),\n        y: $(this).scrollTop()\n      });\n    });\n\n    $watchers.on(scrollEvent, function (ev) {\n      var position = Utils.GetData(this, 'select2-scroll-position');\n      $(this).scrollTop(position.y);\n    });\n\n    $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent,\n      function (e) {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n  };\n\n  AttachBody.prototype._detachPositioningHandler =\n      function (decorated, container) {\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.off(scrollEvent);\n\n    $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\n  };\n\n  AttachBody.prototype._positionDropdown = function () {\n    var $window = $(window);\n\n    var isCurrentlyAbove = this.$dropdown[0].classList\n      .contains('select2-dropdown--above');\n    var isCurrentlyBelow = this.$dropdown[0].classList\n      .contains('select2-dropdown--below');\n\n    var newDirection = null;\n\n    var offset = this.$container.offset();\n\n    offset.bottom = offset.top + this.$container.outerHeight(false);\n\n    var container = {\n      height: this.$container.outerHeight(false)\n    };\n\n    container.top = offset.top;\n    container.bottom = offset.top + container.height;\n\n    var dropdown = {\n      height: this.$dropdown.outerHeight(false)\n    };\n\n    var viewport = {\n      top: $window.scrollTop(),\n      bottom: $window.scrollTop() + $window.height()\n    };\n\n    var enoughRoomAbove = viewport.top < (offset.top - dropdown.height);\n    var enoughRoomBelow = viewport.bottom > (offset.bottom + dropdown.height);\n\n    var css = {\n      left: offset.left,\n      top: container.bottom\n    };\n\n    // Determine what the parent element is to use for calculating the offset\n    var $offsetParent = this.$dropdownParent;\n\n    // For statically positioned elements, we need to get the element\n    // that is determining the offset\n    if ($offsetParent.css('position') === 'static') {\n      $offsetParent = $offsetParent.offsetParent();\n    }\n\n    var parentOffset = {\n      top: 0,\n      left: 0\n    };\n\n    if (\n      $.contains(document.body, $offsetParent[0]) ||\n      $offsetParent[0].isConnected\n      ) {\n      parentOffset = $offsetParent.offset();\n    }\n\n    css.top -= parentOffset.top;\n    css.left -= parentOffset.left;\n\n    if (!isCurrentlyAbove && !isCurrentlyBelow) {\n      newDirection = 'below';\n    }\n\n    if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\n      newDirection = 'above';\n    } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\n      newDirection = 'below';\n    }\n\n    if (newDirection == 'above' ||\n      (isCurrentlyAbove && newDirection !== 'below')) {\n      css.top = container.top - parentOffset.top - dropdown.height;\n    }\n\n    if (newDirection != null) {\n      this.$dropdown[0].classList.remove('select2-dropdown--below');\n      this.$dropdown[0].classList.remove('select2-dropdown--above');\n      this.$dropdown[0].classList.add('select2-dropdown--' + newDirection);\n\n      this.$container[0].classList.remove('select2-container--below');\n      this.$container[0].classList.remove('select2-container--above');\n      this.$container[0].classList.add('select2-container--' + newDirection);\n    }\n\n    this.$dropdownContainer.css(css);\n  };\n\n  AttachBody.prototype._resizeDropdown = function () {\n    var css = {\n      width: this.$container.outerWidth(false) + 'px'\n    };\n\n    if (this.options.get('dropdownAutoWidth')) {\n      css.minWidth = css.width;\n      css.position = 'relative';\n      css.width = 'auto';\n    }\n\n    this.$dropdown.css(css);\n  };\n\n  AttachBody.prototype._showDropdown = function (decorated) {\n    this.$dropdownContainer.appendTo(this.$dropdownParent);\n\n    this._positionDropdown();\n    this._resizeDropdown();\n  };\n\n  return AttachBody;\n});\n\nS2.define('select2/dropdown/minimumResultsForSearch',[\n\n], function () {\n  function countResults (data) {\n    var count = 0;\n\n    for (var d = 0; d < data.length; d++) {\n      var item = data[d];\n\n      if (item.children) {\n        count += countResults(item.children);\n      } else {\n        count++;\n      }\n    }\n\n    return count;\n  }\n\n  function MinimumResultsForSearch (decorated, $element, options, dataAdapter) {\n    this.minimumResultsForSearch = options.get('minimumResultsForSearch');\n\n    if (this.minimumResultsForSearch < 0) {\n      this.minimumResultsForSearch = Infinity;\n    }\n\n    decorated.call(this, $element, options, dataAdapter);\n  }\n\n  MinimumResultsForSearch.prototype.showSearch = function (decorated, params) {\n    if (countResults(params.data.results) < this.minimumResultsForSearch) {\n      return false;\n    }\n\n    return decorated.call(this, params);\n  };\n\n  return MinimumResultsForSearch;\n});\n\nS2.define('select2/dropdown/selectOnClose',[\n  '../utils'\n], function (Utils) {\n  function SelectOnClose () { }\n\n  SelectOnClose.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('close', function (params) {\n      self._handleSelectOnClose(params);\n    });\n  };\n\n  SelectOnClose.prototype._handleSelectOnClose = function (_, params) {\n    if (params && params.originalSelect2Event != null) {\n      var event = params.originalSelect2Event;\n\n      // Don't select an item if the close event was triggered from a select or\n      // unselect event\n      if (event._type === 'select' || event._type === 'unselect') {\n        return;\n      }\n    }\n\n    var $highlightedResults = this.getHighlightedResults();\n\n    // Only select highlighted results\n    if ($highlightedResults.length < 1) {\n      return;\n    }\n\n    var data = Utils.GetData($highlightedResults[0], 'data');\n\n    // Don't re-select already selected resulte\n    if (\n      (data.element != null && data.element.selected) ||\n      (data.element == null && data.selected)\n    ) {\n      return;\n    }\n\n    this.trigger('select', {\n        data: data\n    });\n  };\n\n  return SelectOnClose;\n});\n\nS2.define('select2/dropdown/closeOnSelect',[\n\n], function () {\n  function CloseOnSelect () { }\n\n  CloseOnSelect.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('select', function (evt) {\n      self._selectTriggered(evt);\n    });\n\n    container.on('unselect', function (evt) {\n      self._selectTriggered(evt);\n    });\n  };\n\n  CloseOnSelect.prototype._selectTriggered = function (_, evt) {\n    var originalEvent = evt.originalEvent;\n\n    // Don't close if the control key is being held\n    if (originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey)) {\n      return;\n    }\n\n    this.trigger('close', {\n      originalEvent: originalEvent,\n      originalSelect2Event: evt\n    });\n  };\n\n  return CloseOnSelect;\n});\n\nS2.define('select2/dropdown/dropdownCss',[\n  '../utils'\n], function (Utils) {\n  function DropdownCSS () { }\n\n  DropdownCSS.prototype.render = function (decorated) {\n    var $dropdown = decorated.call(this);\n\n    var dropdownCssClass = this.options.get('dropdownCssClass') || '';\n\n    if (dropdownCssClass.indexOf(':all:') !== -1) {\n      dropdownCssClass = dropdownCssClass.replace(':all:', '');\n\n      Utils.copyNonInternalCssClasses($dropdown[0], this.$element[0]);\n    }\n\n    $dropdown.addClass(dropdownCssClass);\n\n    return $dropdown;\n  };\n\n  return DropdownCSS;\n});\n\nS2.define('select2/dropdown/tagsSearchHighlight',[\n  '../utils'\n], function (Utils) {\n  function TagsSearchHighlight () { }\n\n  TagsSearchHighlight.prototype.highlightFirstItem = function (decorated) {\n    var $options = this.$results\n    .find(\n      '.select2-results__option--selectable' +\n      ':not(.select2-results__option--selected)'\n    );\n\n    if ($options.length > 0) {\n      var $firstOption = $options.first();\n      var data = Utils.GetData($firstOption[0], 'data');\n      var firstElement = data.element;\n\n      if (firstElement && firstElement.getAttribute) {\n        if (firstElement.getAttribute('data-select2-tag') === 'true') {\n          $firstOption.trigger('mouseenter');\n\n          return;\n        }\n      }\n    }\n\n    decorated.call(this);\n  };\n\n  return TagsSearchHighlight;\n});\n\nS2.define('select2/i18n/en',[],function () {\n  // English\n  return {\n    errorLoading: function () {\n      return 'The results could not be loaded.';\n    },\n    inputTooLong: function (args) {\n      var overChars = args.input.length - args.maximum;\n\n      var message = 'Please delete ' + overChars + ' character';\n\n      if (overChars != 1) {\n        message += 's';\n      }\n\n      return message;\n    },\n    inputTooShort: function (args) {\n      var remainingChars = args.minimum - args.input.length;\n\n      var message = 'Please enter ' + remainingChars + ' or more characters';\n\n      return message;\n    },\n    loadingMore: function () {\n      return 'Loading more results';\n    },\n    maximumSelected: function (args) {\n      var message = 'You can only select ' + args.maximum + ' item';\n\n      if (args.maximum != 1) {\n        message += 's';\n      }\n\n      return message;\n    },\n    noResults: function () {\n      return 'No results found';\n    },\n    searching: function () {\n      return 'Searching';\n    },\n    removeAllItems: function () {\n      return 'Remove all items';\n    },\n    removeItem: function () {\n      return 'Remove item';\n    },\n    search: function() {\n      return 'Search';\n    }\n  };\n});\n\nS2.define('select2/defaults',[\n  'jquery',\n\n  './results',\n\n  './selection/single',\n  './selection/multiple',\n  './selection/placeholder',\n  './selection/allowClear',\n  './selection/search',\n  './selection/selectionCss',\n  './selection/eventRelay',\n\n  './utils',\n  './translation',\n  './diacritics',\n\n  './data/select',\n  './data/array',\n  './data/ajax',\n  './data/tags',\n  './data/tokenizer',\n  './data/minimumInputLength',\n  './data/maximumInputLength',\n  './data/maximumSelectionLength',\n\n  './dropdown',\n  './dropdown/search',\n  './dropdown/hidePlaceholder',\n  './dropdown/infiniteScroll',\n  './dropdown/attachBody',\n  './dropdown/minimumResultsForSearch',\n  './dropdown/selectOnClose',\n  './dropdown/closeOnSelect',\n  './dropdown/dropdownCss',\n  './dropdown/tagsSearchHighlight',\n\n  './i18n/en'\n], function ($,\n\n             ResultsList,\n\n             SingleSelection, MultipleSelection, Placeholder, AllowClear,\n             SelectionSearch, SelectionCSS, EventRelay,\n\n             Utils, Translation, DIACRITICS,\n\n             SelectData, ArrayData, AjaxData, Tags, Tokenizer,\n             MinimumInputLength, MaximumInputLength, MaximumSelectionLength,\n\n             Dropdown, DropdownSearch, HidePlaceholder, InfiniteScroll,\n             AttachBody, MinimumResultsForSearch, SelectOnClose, CloseOnSelect,\n             DropdownCSS, TagsSearchHighlight,\n\n             EnglishTranslation) {\n  function Defaults () {\n    this.reset();\n  }\n\n  Defaults.prototype.apply = function (options) {\n    options = $.extend(true, {}, this.defaults, options);\n\n    if (options.dataAdapter == null) {\n      if (options.ajax != null) {\n        options.dataAdapter = AjaxData;\n      } else if (options.data != null) {\n        options.dataAdapter = ArrayData;\n      } else {\n        options.dataAdapter = SelectData;\n      }\n\n      if (options.minimumInputLength > 0) {\n        options.dataAdapter = Utils.Decorate(\n          options.dataAdapter,\n          MinimumInputLength\n        );\n      }\n\n      if (options.maximumInputLength > 0) {\n        options.dataAdapter = Utils.Decorate(\n          options.dataAdapter,\n          MaximumInputLength\n        );\n      }\n\n      if (options.maximumSelectionLength > 0) {\n        options.dataAdapter = Utils.Decorate(\n          options.dataAdapter,\n          MaximumSelectionLength\n        );\n      }\n\n      if (options.tags) {\n        options.dataAdapter = Utils.Decorate(options.dataAdapter, Tags);\n      }\n\n      if (options.tokenSeparators != null || options.tokenizer != null) {\n        options.dataAdapter = Utils.Decorate(\n          options.dataAdapter,\n          Tokenizer\n        );\n      }\n    }\n\n    if (options.resultsAdapter == null) {\n      options.resultsAdapter = ResultsList;\n\n      if (options.ajax != null) {\n        options.resultsAdapter = Utils.Decorate(\n          options.resultsAdapter,\n          InfiniteScroll\n        );\n      }\n\n      if (options.placeholder != null) {\n        options.resultsAdapter = Utils.Decorate(\n          options.resultsAdapter,\n          HidePlaceholder\n        );\n      }\n\n      if (options.selectOnClose) {\n        options.resultsAdapter = Utils.Decorate(\n          options.resultsAdapter,\n          SelectOnClose\n        );\n      }\n\n      if (options.tags) {\n        options.resultsAdapter = Utils.Decorate(\n          options.resultsAdapter,\n          TagsSearchHighlight\n        );\n      }\n    }\n\n    if (options.dropdownAdapter == null) {\n      if (options.multiple) {\n        options.dropdownAdapter = Dropdown;\n      } else {\n        var SearchableDropdown = Utils.Decorate(Dropdown, DropdownSearch);\n\n        options.dropdownAdapter = SearchableDropdown;\n      }\n\n      if (options.minimumResultsForSearch !== 0) {\n        options.dropdownAdapter = Utils.Decorate(\n          options.dropdownAdapter,\n          MinimumResultsForSearch\n        );\n      }\n\n      if (options.closeOnSelect) {\n        options.dropdownAdapter = Utils.Decorate(\n          options.dropdownAdapter,\n          CloseOnSelect\n        );\n      }\n\n      if (options.dropdownCssClass != null) {\n        options.dropdownAdapter = Utils.Decorate(\n          options.dropdownAdapter,\n          DropdownCSS\n        );\n      }\n\n      options.dropdownAdapter = Utils.Decorate(\n        options.dropdownAdapter,\n        AttachBody\n      );\n    }\n\n    if (options.selectionAdapter == null) {\n      if (options.multiple) {\n        options.selectionAdapter = MultipleSelection;\n      } else {\n        options.selectionAdapter = SingleSelection;\n      }\n\n      // Add the placeholder mixin if a placeholder was specified\n      if (options.placeholder != null) {\n        options.selectionAdapter = Utils.Decorate(\n          options.selectionAdapter,\n          Placeholder\n        );\n      }\n\n      if (options.allowClear) {\n        options.selectionAdapter = Utils.Decorate(\n          options.selectionAdapter,\n          AllowClear\n        );\n      }\n\n      if (options.multiple) {\n        options.selectionAdapter = Utils.Decorate(\n          options.selectionAdapter,\n          SelectionSearch\n        );\n      }\n\n      if (options.selectionCssClass != null) {\n        options.selectionAdapter = Utils.Decorate(\n          options.selectionAdapter,\n          SelectionCSS\n        );\n      }\n\n      options.selectionAdapter = Utils.Decorate(\n        options.selectionAdapter,\n        EventRelay\n      );\n    }\n\n    // If the defaults were not previously applied from an element, it is\n    // possible for the language option to have not been resolved\n    options.language = this._resolveLanguage(options.language);\n\n    // Always fall back to English since it will always be complete\n    options.language.push('en');\n\n    var uniqueLanguages = [];\n\n    for (var l = 0; l < options.language.length; l++) {\n      var language = options.language[l];\n\n      if (uniqueLanguages.indexOf(language) === -1) {\n        uniqueLanguages.push(language);\n      }\n    }\n\n    options.language = uniqueLanguages;\n\n    options.translations = this._processTranslations(\n      options.language,\n      options.debug\n    );\n\n    return options;\n  };\n\n  Defaults.prototype.reset = function () {\n    function stripDiacritics (text) {\n      // Used 'uni range + named function' from http://jsperf.com/diacritics/18\n      function match(a) {\n        return DIACRITICS[a] || a;\n      }\n\n      return text.replace(/[^\\u0000-\\u007E]/g, match);\n    }\n\n    function matcher (params, data) {\n      // Always return the object if there is nothing to compare\n      if (params.term == null || params.term.trim() === '') {\n        return data;\n      }\n\n      // Do a recursive check for options with children\n      if (data.children && data.children.length > 0) {\n        // Clone the data object if there are children\n        // This is required as we modify the object to remove any non-matches\n        var match = $.extend(true, {}, data);\n\n        // Check each child of the option\n        for (var c = data.children.length - 1; c >= 0; c--) {\n          var child = data.children[c];\n\n          var matches = matcher(params, child);\n\n          // If there wasn't a match, remove the object in the array\n          if (matches == null) {\n            match.children.splice(c, 1);\n          }\n        }\n\n        // If any children matched, return the new object\n        if (match.children.length > 0) {\n          return match;\n        }\n\n        // If there were no matching children, check just the plain object\n        return matcher(params, match);\n      }\n\n      var original = stripDiacritics(data.text).toUpperCase();\n      var term = stripDiacritics(params.term).toUpperCase();\n\n      // Check if the text contains the term\n      if (original.indexOf(term) > -1) {\n        return data;\n      }\n\n      // If it doesn't contain the term, don't return anything\n      return null;\n    }\n\n    this.defaults = {\n      amdLanguageBase: './i18n/',\n      autocomplete: 'off',\n      closeOnSelect: true,\n      debug: false,\n      dropdownAutoWidth: false,\n      escapeMarkup: Utils.escapeMarkup,\n      language: {},\n      matcher: matcher,\n      minimumInputLength: 0,\n      maximumInputLength: 0,\n      maximumSelectionLength: 0,\n      minimumResultsForSearch: 0,\n      selectOnClose: false,\n      scrollAfterSelect: false,\n      sorter: function (data) {\n        return data;\n      },\n      templateResult: function (result) {\n        return result.text;\n      },\n      templateSelection: function (selection) {\n        return selection.text;\n      },\n      theme: 'default',\n      width: 'resolve'\n    };\n  };\n\n  Defaults.prototype.applyFromElement = function (options, $element) {\n    var optionLanguage = options.language;\n    var defaultLanguage = this.defaults.language;\n    var elementLanguage = $element.prop('lang');\n    var parentLanguage = $element.closest('[lang]').prop('lang');\n\n    var languages = Array.prototype.concat.call(\n      this._resolveLanguage(elementLanguage),\n      this._resolveLanguage(optionLanguage),\n      this._resolveLanguage(defaultLanguage),\n      this._resolveLanguage(parentLanguage)\n    );\n\n    options.language = languages;\n\n    return options;\n  };\n\n  Defaults.prototype._resolveLanguage = function (language) {\n    if (!language) {\n      return [];\n    }\n\n    if ($.isEmptyObject(language)) {\n      return [];\n    }\n\n    if ($.isPlainObject(language)) {\n      return [language];\n    }\n\n    var languages;\n\n    if (!Array.isArray(language)) {\n      languages = [language];\n    } else {\n      languages = language;\n    }\n\n    var resolvedLanguages = [];\n\n    for (var l = 0; l < languages.length; l++) {\n      resolvedLanguages.push(languages[l]);\n\n      if (typeof languages[l] === 'string' && languages[l].indexOf('-') > 0) {\n        // Extract the region information if it is included\n        var languageParts = languages[l].split('-');\n        var baseLanguage = languageParts[0];\n\n        resolvedLanguages.push(baseLanguage);\n      }\n    }\n\n    return resolvedLanguages;\n  };\n\n  Defaults.prototype._processTranslations = function (languages, debug) {\n    var translations = new Translation();\n\n    for (var l = 0; l < languages.length; l++) {\n      var languageData = new Translation();\n\n      var language = languages[l];\n\n      if (typeof language === 'string') {\n        try {\n          // Try to load it with the original name\n          languageData = Translation.loadPath(language);\n        } catch (e) {\n          try {\n            // If we couldn't load it, check if it wasn't the full path\n            language = this.defaults.amdLanguageBase + language;\n            languageData = Translation.loadPath(language);\n          } catch (ex) {\n            // The translation could not be loaded at all. Sometimes this is\n            // because of a configuration problem, other times this can be\n            // because of how Select2 helps load all possible translation files\n            if (debug && window.console && console.warn) {\n              console.warn(\n                'Select2: The language file for \"' + language + '\" could ' +\n                'not be automatically loaded. A fallback will be used instead.'\n              );\n            }\n          }\n        }\n      } else if ($.isPlainObject(language)) {\n        languageData = new Translation(language);\n      } else {\n        languageData = language;\n      }\n\n      translations.extend(languageData);\n    }\n\n    return translations;\n  };\n\n  Defaults.prototype.set = function (key, value) {\n    var camelKey = $.camelCase(key);\n\n    var data = {};\n    data[camelKey] = value;\n\n    var convertedData = Utils._convertData(data);\n\n    $.extend(true, this.defaults, convertedData);\n  };\n\n  var defaults = new Defaults();\n\n  return defaults;\n});\n\nS2.define('select2/options',[\n  'jquery',\n  './defaults',\n  './utils'\n], function ($, Defaults, Utils) {\n  function Options (options, $element) {\n    this.options = options;\n\n    if ($element != null) {\n      this.fromElement($element);\n    }\n\n    if ($element != null) {\n      this.options = Defaults.applyFromElement(this.options, $element);\n    }\n\n    this.options = Defaults.apply(this.options);\n  }\n\n  Options.prototype.fromElement = function ($e) {\n    var excludedData = ['select2'];\n\n    if (this.options.multiple == null) {\n      this.options.multiple = $e.prop('multiple');\n    }\n\n    if (this.options.disabled == null) {\n      this.options.disabled = $e.prop('disabled');\n    }\n\n    if (this.options.autocomplete == null && $e.prop('autocomplete')) {\n      this.options.autocomplete = $e.prop('autocomplete');\n    }\n\n    if (this.options.dir == null) {\n      if ($e.prop('dir')) {\n        this.options.dir = $e.prop('dir');\n      } else if ($e.closest('[dir]').prop('dir')) {\n        this.options.dir = $e.closest('[dir]').prop('dir');\n      } else {\n        this.options.dir = 'ltr';\n      }\n    }\n\n    $e.prop('disabled', this.options.disabled);\n    $e.prop('multiple', this.options.multiple);\n\n    if (Utils.GetData($e[0], 'select2Tags')) {\n      if (this.options.debug && window.console && console.warn) {\n        console.warn(\n          'Select2: The `data-select2-tags` attribute has been changed to ' +\n          'use the `data-data` and `data-tags=\"true\"` attributes and will be ' +\n          'removed in future versions of Select2.'\n        );\n      }\n\n      Utils.StoreData($e[0], 'data', Utils.GetData($e[0], 'select2Tags'));\n      Utils.StoreData($e[0], 'tags', true);\n    }\n\n    if (Utils.GetData($e[0], 'ajaxUrl')) {\n      if (this.options.debug && window.console && console.warn) {\n        console.warn(\n          'Select2: The `data-ajax-url` attribute has been changed to ' +\n          '`data-ajax--url` and support for the old attribute will be removed' +\n          ' in future versions of Select2.'\n        );\n      }\n\n      $e.attr('ajax--url', Utils.GetData($e[0], 'ajaxUrl'));\n      Utils.StoreData($e[0], 'ajax-Url', Utils.GetData($e[0], 'ajaxUrl'));\n    }\n\n    var dataset = {};\n\n    function upperCaseLetter(_, letter) {\n      return letter.toUpperCase();\n    }\n\n    // Pre-load all of the attributes which are prefixed with `data-`\n    for (var attr = 0; attr < $e[0].attributes.length; attr++) {\n      var attributeName = $e[0].attributes[attr].name;\n      var prefix = 'data-';\n\n      if (attributeName.substr(0, prefix.length) == prefix) {\n        // Get the contents of the attribute after `data-`\n        var dataName = attributeName.substring(prefix.length);\n\n        // Get the data contents from the consistent source\n        // This is more than likely the jQuery data helper\n        var dataValue = Utils.GetData($e[0], dataName);\n\n        // camelCase the attribute name to match the spec\n        var camelDataName = dataName.replace(/-([a-z])/g, upperCaseLetter);\n\n        // Store the data attribute contents into the dataset since\n        dataset[camelDataName] = dataValue;\n      }\n    }\n\n    // Prefer the element's `dataset` attribute if it exists\n    // jQuery 1.x does not correctly handle data attributes with multiple dashes\n    if ($.fn.jquery && $.fn.jquery.substr(0, 2) == '1.' && $e[0].dataset) {\n      dataset = $.extend(true, {}, $e[0].dataset, dataset);\n    }\n\n    // Prefer our internal data cache if it exists\n    var data = $.extend(true, {}, Utils.GetData($e[0]), dataset);\n\n    data = Utils._convertData(data);\n\n    for (var key in data) {\n      if (excludedData.indexOf(key) > -1) {\n        continue;\n      }\n\n      if ($.isPlainObject(this.options[key])) {\n        $.extend(this.options[key], data[key]);\n      } else {\n        this.options[key] = data[key];\n      }\n    }\n\n    return this;\n  };\n\n  Options.prototype.get = function (key) {\n    return this.options[key];\n  };\n\n  Options.prototype.set = function (key, val) {\n    this.options[key] = val;\n  };\n\n  return Options;\n});\n\nS2.define('select2/core',[\n  'jquery',\n  './options',\n  './utils',\n  './keys'\n], function ($, Options, Utils, KEYS) {\n  var Select2 = function ($element, options) {\n    if (Utils.GetData($element[0], 'select2') != null) {\n      Utils.GetData($element[0], 'select2').destroy();\n    }\n\n    this.$element = $element;\n\n    this.id = this._generateId($element);\n\n    options = options || {};\n\n    this.options = new Options(options, $element);\n\n    Select2.__super__.constructor.call(this);\n\n    // Set up the tabindex\n\n    var tabindex = $element.attr('tabindex') || 0;\n    Utils.StoreData($element[0], 'old-tabindex', tabindex);\n    $element.attr('tabindex', '-1');\n\n    // Set up containers and adapters\n\n    var DataAdapter = this.options.get('dataAdapter');\n    this.dataAdapter = new DataAdapter($element, this.options);\n\n    var $container = this.render();\n\n    this._placeContainer($container);\n\n    var SelectionAdapter = this.options.get('selectionAdapter');\n    this.selection = new SelectionAdapter($element, this.options);\n    this.$selection = this.selection.render();\n\n    this.selection.position(this.$selection, $container);\n\n    var DropdownAdapter = this.options.get('dropdownAdapter');\n    this.dropdown = new DropdownAdapter($element, this.options);\n    this.$dropdown = this.dropdown.render();\n\n    this.dropdown.position(this.$dropdown, $container);\n\n    var ResultsAdapter = this.options.get('resultsAdapter');\n    this.results = new ResultsAdapter($element, this.options, this.dataAdapter);\n    this.$results = this.results.render();\n\n    this.results.position(this.$results, this.$dropdown);\n\n    // Bind events\n\n    var self = this;\n\n    // Bind the container to all of the adapters\n    this._bindAdapters();\n\n    // Register any DOM event handlers\n    this._registerDomEvents();\n\n    // Register any internal event handlers\n    this._registerDataEvents();\n    this._registerSelectionEvents();\n    this._registerDropdownEvents();\n    this._registerResultsEvents();\n    this._registerEvents();\n\n    // Set the initial state\n    this.dataAdapter.current(function (initialData) {\n      self.trigger('selection:update', {\n        data: initialData\n      });\n    });\n\n    // Hide the original select\n    $element[0].classList.add('select2-hidden-accessible');\n    $element.attr('aria-hidden', 'true');\n\n    // Synchronize any monitored attributes\n    this._syncAttributes();\n\n    Utils.StoreData($element[0], 'select2', this);\n\n    // Ensure backwards compatibility with $element.data('select2').\n    $element.data('select2', this);\n  };\n\n  Utils.Extend(Select2, Utils.Observable);\n\n  Select2.prototype._generateId = function ($element) {\n    var id = '';\n\n    if ($element.attr('id') != null) {\n      id = $element.attr('id');\n    } else if ($element.attr('name') != null) {\n      id = $element.attr('name') + '-' + Utils.generateChars(2);\n    } else {\n      id = Utils.generateChars(4);\n    }\n\n    id = id.replace(/(:|\\.|\\[|\\]|,)/g, '');\n    id = 'select2-' + id;\n\n    return id;\n  };\n\n  Select2.prototype._placeContainer = function ($container) {\n    $container.insertAfter(this.$element);\n\n    var width = this._resolveWidth(this.$element, this.options.get('width'));\n\n    if (width != null) {\n      $container.css('width', width);\n    }\n  };\n\n  Select2.prototype._resolveWidth = function ($element, method) {\n    var WIDTH = /^width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;\n\n    if (method == 'resolve') {\n      var styleWidth = this._resolveWidth($element, 'style');\n\n      if (styleWidth != null) {\n        return styleWidth;\n      }\n\n      return this._resolveWidth($element, 'element');\n    }\n\n    if (method == 'element') {\n      var elementWidth = $element.outerWidth(false);\n\n      if (elementWidth <= 0) {\n        return 'auto';\n      }\n\n      return elementWidth + 'px';\n    }\n\n    if (method == 'style') {\n      var style = $element.attr('style');\n\n      if (typeof(style) !== 'string') {\n        return null;\n      }\n\n      var attrs = style.split(';');\n\n      for (var i = 0, l = attrs.length; i < l; i = i + 1) {\n        var attr = attrs[i].replace(/\\s/g, '');\n        var matches = attr.match(WIDTH);\n\n        if (matches !== null && matches.length >= 1) {\n          return matches[1];\n        }\n      }\n\n      return null;\n    }\n\n    if (method == 'computedstyle') {\n      var computedStyle = window.getComputedStyle($element[0]);\n\n      return computedStyle.width;\n    }\n\n    return method;\n  };\n\n  Select2.prototype._bindAdapters = function () {\n    this.dataAdapter.bind(this, this.$container);\n    this.selection.bind(this, this.$container);\n\n    this.dropdown.bind(this, this.$container);\n    this.results.bind(this, this.$container);\n  };\n\n  Select2.prototype._registerDomEvents = function () {\n    var self = this;\n\n    this.$element.on('change.select2', function () {\n      self.dataAdapter.current(function (data) {\n        self.trigger('selection:update', {\n          data: data\n        });\n      });\n    });\n\n    this.$element.on('focus.select2', function (evt) {\n      self.trigger('focus', evt);\n    });\n\n    this._syncA = Utils.bind(this._syncAttributes, this);\n    this._syncS = Utils.bind(this._syncSubtree, this);\n\n    this._observer = new window.MutationObserver(function (mutations) {\n      self._syncA();\n      self._syncS(mutations);\n    });\n    this._observer.observe(this.$element[0], {\n      attributes: true,\n      childList: true,\n      subtree: false\n    });\n  };\n\n  Select2.prototype._registerDataEvents = function () {\n    var self = this;\n\n    this.dataAdapter.on('*', function (name, params) {\n      self.trigger(name, params);\n    });\n  };\n\n  Select2.prototype._registerSelectionEvents = function () {\n    var self = this;\n    var nonRelayEvents = ['toggle', 'focus'];\n\n    this.selection.on('toggle', function () {\n      self.toggleDropdown();\n    });\n\n    this.selection.on('focus', function (params) {\n      self.focus(params);\n    });\n\n    this.selection.on('*', function (name, params) {\n      if (nonRelayEvents.indexOf(name) !== -1) {\n        return;\n      }\n\n      self.trigger(name, params);\n    });\n  };\n\n  Select2.prototype._registerDropdownEvents = function () {\n    var self = this;\n\n    this.dropdown.on('*', function (name, params) {\n      self.trigger(name, params);\n    });\n  };\n\n  Select2.prototype._registerResultsEvents = function () {\n    var self = this;\n\n    this.results.on('*', function (name, params) {\n      self.trigger(name, params);\n    });\n  };\n\n  Select2.prototype._registerEvents = function () {\n    var self = this;\n\n    this.on('open', function () {\n      self.$container[0].classList.add('select2-container--open');\n    });\n\n    this.on('close', function () {\n      self.$container[0].classList.remove('select2-container--open');\n    });\n\n    this.on('enable', function () {\n      self.$container[0].classList.remove('select2-container--disabled');\n    });\n\n    this.on('disable', function () {\n      self.$container[0].classList.add('select2-container--disabled');\n    });\n\n    this.on('blur', function () {\n      self.$container[0].classList.remove('select2-container--focus');\n    });\n\n    this.on('query', function (params) {\n      if (!self.isOpen()) {\n        self.trigger('open', {});\n      }\n\n      this.dataAdapter.query(params, function (data) {\n        self.trigger('results:all', {\n          data: data,\n          query: params\n        });\n      });\n    });\n\n    this.on('query:append', function (params) {\n      this.dataAdapter.query(params, function (data) {\n        self.trigger('results:append', {\n          data: data,\n          query: params\n        });\n      });\n    });\n\n    this.on('keypress', function (evt) {\n      var key = evt.which;\n\n      if (self.isOpen()) {\n        if (key === KEYS.ESC || (key === KEYS.UP && evt.altKey)) {\n          self.close(evt);\n\n          evt.preventDefault();\n        } else if (key === KEYS.ENTER || key === KEYS.TAB) {\n          self.trigger('results:select', {});\n\n          evt.preventDefault();\n        } else if ((key === KEYS.SPACE && evt.ctrlKey)) {\n          self.trigger('results:toggle', {});\n\n          evt.preventDefault();\n        } else if (key === KEYS.UP) {\n          self.trigger('results:previous', {});\n\n          evt.preventDefault();\n        } else if (key === KEYS.DOWN) {\n          self.trigger('results:next', {});\n\n          evt.preventDefault();\n        }\n      } else {\n        if (key === KEYS.ENTER || key === KEYS.SPACE ||\n            (key === KEYS.DOWN && evt.altKey)) {\n          self.open();\n\n          evt.preventDefault();\n        }\n      }\n    });\n  };\n\n  Select2.prototype._syncAttributes = function () {\n    this.options.set('disabled', this.$element.prop('disabled'));\n\n    if (this.isDisabled()) {\n      if (this.isOpen()) {\n        this.close();\n      }\n\n      this.trigger('disable', {});\n    } else {\n      this.trigger('enable', {});\n    }\n  };\n\n  Select2.prototype._isChangeMutation = function (mutations) {\n    var self = this;\n\n    if (mutations.addedNodes && mutations.addedNodes.length > 0) {\n      for (var n = 0; n < mutations.addedNodes.length; n++) {\n        var node = mutations.addedNodes[n];\n\n        if (node.selected) {\n          return true;\n        }\n      }\n    } else if (mutations.removedNodes && mutations.removedNodes.length > 0) {\n      return true;\n    } else if (Array.isArray(mutations)) {\n      return mutations.some(function (mutation) {\n        return self._isChangeMutation(mutation);\n      });\n    }\n\n    return false;\n  };\n\n  Select2.prototype._syncSubtree = function (mutations) {\n    var changed = this._isChangeMutation(mutations);\n    var self = this;\n\n    // Only re-pull the data if we think there is a change\n    if (changed) {\n      this.dataAdapter.current(function (currentData) {\n        self.trigger('selection:update', {\n          data: currentData\n        });\n      });\n    }\n  };\n\n  /**\n   * Override the trigger method to automatically trigger pre-events when\n   * there are events that can be prevented.\n   */\n  Select2.prototype.trigger = function (name, args) {\n    var actualTrigger = Select2.__super__.trigger;\n    var preTriggerMap = {\n      'open': 'opening',\n      'close': 'closing',\n      'select': 'selecting',\n      'unselect': 'unselecting',\n      'clear': 'clearing'\n    };\n\n    if (args === undefined) {\n      args = {};\n    }\n\n    if (name in preTriggerMap) {\n      var preTriggerName = preTriggerMap[name];\n      var preTriggerArgs = {\n        prevented: false,\n        name: name,\n        args: args\n      };\n\n      actualTrigger.call(this, preTriggerName, preTriggerArgs);\n\n      if (preTriggerArgs.prevented) {\n        args.prevented = true;\n\n        return;\n      }\n    }\n\n    actualTrigger.call(this, name, args);\n  };\n\n  Select2.prototype.toggleDropdown = function () {\n    if (this.isDisabled()) {\n      return;\n    }\n\n    if (this.isOpen()) {\n      this.close();\n    } else {\n      this.open();\n    }\n  };\n\n  Select2.prototype.open = function () {\n    if (this.isOpen()) {\n      return;\n    }\n\n    if (this.isDisabled()) {\n      return;\n    }\n\n    this.trigger('query', {});\n  };\n\n  Select2.prototype.close = function (evt) {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.trigger('close', { originalEvent : evt });\n  };\n\n  /**\n   * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n   * object.\n   *\n   * @return {true} if the instance is not disabled.\n   * @return {false} if the instance is disabled.\n   */\n  Select2.prototype.isEnabled = function () {\n    return !this.isDisabled();\n  };\n\n  /**\n   * Helper method to abstract the \"disabled\" state of this object.\n   *\n   * @return {true} if the disabled option is true.\n   * @return {false} if the disabled option is false.\n   */\n  Select2.prototype.isDisabled = function () {\n    return this.options.get('disabled');\n  };\n\n  Select2.prototype.isOpen = function () {\n    return this.$container[0].classList.contains('select2-container--open');\n  };\n\n  Select2.prototype.hasFocus = function () {\n    return this.$container[0].classList.contains('select2-container--focus');\n  };\n\n  Select2.prototype.focus = function (data) {\n    // No need to re-trigger focus events if we are already focused\n    if (this.hasFocus()) {\n      return;\n    }\n\n    this.$container[0].classList.add('select2-container--focus');\n    this.trigger('focus', {});\n  };\n\n  Select2.prototype.enable = function (args) {\n    if (this.options.get('debug') && window.console && console.warn) {\n      console.warn(\n        'Select2: The `select2(\"enable\")` method has been deprecated and will' +\n        ' be removed in later Select2 versions. Use $element.prop(\"disabled\")' +\n        ' instead.'\n      );\n    }\n\n    if (args == null || args.length === 0) {\n      args = [true];\n    }\n\n    var disabled = !args[0];\n\n    this.$element.prop('disabled', disabled);\n  };\n\n  Select2.prototype.data = function () {\n    if (this.options.get('debug') &&\n        arguments.length > 0 && window.console && console.warn) {\n      console.warn(\n        'Select2: Data can no longer be set using `select2(\"data\")`. You ' +\n        'should consider setting the value instead using `$element.val()`.'\n      );\n    }\n\n    var data = [];\n\n    this.dataAdapter.current(function (currentData) {\n      data = currentData;\n    });\n\n    return data;\n  };\n\n  Select2.prototype.val = function (args) {\n    if (this.options.get('debug') && window.console && console.warn) {\n      console.warn(\n        'Select2: The `select2(\"val\")` method has been deprecated and will be' +\n        ' removed in later Select2 versions. Use $element.val() instead.'\n      );\n    }\n\n    if (args == null || args.length === 0) {\n      return this.$element.val();\n    }\n\n    var newVal = args[0];\n\n    if (Array.isArray(newVal)) {\n      newVal = newVal.map(function (obj) {\n        return obj.toString();\n      });\n    }\n\n    this.$element.val(newVal).trigger('input').trigger('change');\n  };\n\n  Select2.prototype.destroy = function () {\n    Utils.RemoveData(this.$container[0]);\n    this.$container.remove();\n\n    this._observer.disconnect();\n    this._observer = null;\n\n    this._syncA = null;\n    this._syncS = null;\n\n    this.$element.off('.select2');\n    this.$element.attr('tabindex',\n    Utils.GetData(this.$element[0], 'old-tabindex'));\n\n    this.$element[0].classList.remove('select2-hidden-accessible');\n    this.$element.attr('aria-hidden', 'false');\n    Utils.RemoveData(this.$element[0]);\n    this.$element.removeData('select2');\n\n    this.dataAdapter.destroy();\n    this.selection.destroy();\n    this.dropdown.destroy();\n    this.results.destroy();\n\n    this.dataAdapter = null;\n    this.selection = null;\n    this.dropdown = null;\n    this.results = null;\n  };\n\n  Select2.prototype.render = function () {\n    var $container = $(\n      '<span class=\"select2 select2-container\">' +\n        '<span class=\"selection\"></span>' +\n        '<span class=\"dropdown-wrapper\" aria-hidden=\"true\"></span>' +\n      '</span>'\n    );\n\n    $container.attr('dir', this.options.get('dir'));\n\n    this.$container = $container;\n\n    this.$container[0].classList\n      .add('select2-container--' + this.options.get('theme'));\n\n    Utils.StoreData($container[0], 'element', this.$element);\n\n    return $container;\n  };\n\n  return Select2;\n});\n\nS2.define('jquery-mousewheel',[\n  'jquery'\n], function ($) {\n  // Used to shim jQuery.mousewheel for non-full builds.\n  return $;\n});\n\nS2.define('jquery.select2',[\n  'jquery',\n  'jquery-mousewheel',\n\n  './select2/core',\n  './select2/defaults',\n  './select2/utils'\n], function ($, _, Select2, Defaults, Utils) {\n  if ($.fn.select2 == null) {\n    // All methods that should return the element\n    var thisMethods = ['open', 'close', 'destroy'];\n\n    $.fn.select2 = function (options) {\n      options = options || {};\n\n      if (typeof options === 'object') {\n        this.each(function () {\n          var instanceOptions = $.extend(true, {}, options);\n\n          var instance = new Select2($(this), instanceOptions);\n        });\n\n        return this;\n      } else if (typeof options === 'string') {\n        var ret;\n        var args = Array.prototype.slice.call(arguments, 1);\n\n        this.each(function () {\n          var instance = Utils.GetData(this, 'select2');\n\n          if (instance == null && window.console && console.error) {\n            console.error(\n              'The select2(\\'' + options + '\\') method was called on an ' +\n              'element that is not using Select2.'\n            );\n          }\n\n          ret = instance[options].apply(instance, args);\n        });\n\n        // Check if we should be returning `this`\n        if (thisMethods.indexOf(options) > -1) {\n          return this;\n        }\n\n        return ret;\n      } else {\n        throw new Error('Invalid arguments for Select2: ' + options);\n      }\n    };\n  }\n\n  if ($.fn.select2.defaults == null) {\n    $.fn.select2.defaults = Defaults;\n  }\n\n  return Select2;\n});\n\n  // Return the AMD loader configuration so it can be used outside of this file\n  return {\n    define: S2.define,\n    require: S2.require\n  };\n}());\n\n  // Autoload the jQuery bindings\n  // We know that all of the modules exist above this, so we're safe\n  var select2 = S2.require('jquery.select2');\n\n  // Hold the AMD module references on the jQuery function that was just loaded\n  // This allows Select2 to use the internal loader outside of this file, such\n  // as in the language files.\n  jQuery.fn.select2.amd = S2;\n\n  // Return the Select2 instance for anyone who is importing it.\n  return select2;\n}));\n","/* global window, exports, define */\n\n!function() {\n    'use strict'\n\n    var re = {\n        not_string: /[^s]/,\n        not_bool: /[^t]/,\n        not_type: /[^T]/,\n        not_primitive: /[^v]/,\n        number: /[diefg]/,\n        numeric_arg: /[bcdiefguxX]/,\n        json: /[j]/,\n        not_json: /[^j]/,\n        text: /^[^\\x25]+/,\n        modulo: /^\\x25{2}/,\n        placeholder: /^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,\n        key: /^([a-z_][a-z_\\d]*)/i,\n        key_access: /^\\.([a-z_][a-z_\\d]*)/i,\n        index_access: /^\\[(\\d+)\\]/,\n        sign: /^[+-]/\n    }\n\n    function sprintf(key) {\n        // `arguments` is not an array, but should be fine for this call\n        return sprintf_format(sprintf_parse(key), arguments)\n    }\n\n    function vsprintf(fmt, argv) {\n        return sprintf.apply(null, [fmt].concat(argv || []))\n    }\n\n    function sprintf_format(parse_tree, argv) {\n        var cursor = 1, tree_length = parse_tree.length, arg, output = '', i, k, ph, pad, pad_character, pad_length, is_positive, sign\n        for (i = 0; i < tree_length; i++) {\n            if (typeof parse_tree[i] === 'string') {\n                output += parse_tree[i]\n            }\n            else if (typeof parse_tree[i] === 'object') {\n                ph = parse_tree[i] // convenience purposes only\n                if (ph.keys) { // keyword argument\n                    arg = argv[cursor]\n                    for (k = 0; k < ph.keys.length; k++) {\n                        if (arg == undefined) {\n                            throw new Error(sprintf('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"', ph.keys[k], ph.keys[k-1]))\n                        }\n                        arg = arg[ph.keys[k]]\n                    }\n                }\n                else if (ph.param_no) { // positional argument (explicit)\n                    arg = argv[ph.param_no]\n                }\n                else { // positional argument (implicit)\n                    arg = argv[cursor++]\n                }\n\n                if (re.not_type.test(ph.type) && re.not_primitive.test(ph.type) && arg instanceof Function) {\n                    arg = arg()\n                }\n\n                if (re.numeric_arg.test(ph.type) && (typeof arg !== 'number' && isNaN(arg))) {\n                    throw new TypeError(sprintf('[sprintf] expecting number but found %T', arg))\n                }\n\n                if (re.number.test(ph.type)) {\n                    is_positive = arg >= 0\n                }\n\n                switch (ph.type) {\n                    case 'b':\n                        arg = parseInt(arg, 10).toString(2)\n                        break\n                    case 'c':\n                        arg = String.fromCharCode(parseInt(arg, 10))\n                        break\n                    case 'd':\n                    case 'i':\n                        arg = parseInt(arg, 10)\n                        break\n                    case 'j':\n                        arg = JSON.stringify(arg, null, ph.width ? parseInt(ph.width) : 0)\n                        break\n                    case 'e':\n                        arg = ph.precision ? parseFloat(arg).toExponential(ph.precision) : parseFloat(arg).toExponential()\n                        break\n                    case 'f':\n                        arg = ph.precision ? parseFloat(arg).toFixed(ph.precision) : parseFloat(arg)\n                        break\n                    case 'g':\n                        arg = ph.precision ? String(Number(arg.toPrecision(ph.precision))) : parseFloat(arg)\n                        break\n                    case 'o':\n                        arg = (parseInt(arg, 10) >>> 0).toString(8)\n                        break\n                    case 's':\n                        arg = String(arg)\n                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)\n                        break\n                    case 't':\n                        arg = String(!!arg)\n                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)\n                        break\n                    case 'T':\n                        arg = Object.prototype.toString.call(arg).slice(8, -1).toLowerCase()\n                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)\n                        break\n                    case 'u':\n                        arg = parseInt(arg, 10) >>> 0\n                        break\n                    case 'v':\n                        arg = arg.valueOf()\n                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)\n                        break\n                    case 'x':\n                        arg = (parseInt(arg, 10) >>> 0).toString(16)\n                        break\n                    case 'X':\n                        arg = (parseInt(arg, 10) >>> 0).toString(16).toUpperCase()\n                        break\n                }\n                if (re.json.test(ph.type)) {\n                    output += arg\n                }\n                else {\n                    if (re.number.test(ph.type) && (!is_positive || ph.sign)) {\n                        sign = is_positive ? '+' : '-'\n                        arg = arg.toString().replace(re.sign, '')\n                    }\n                    else {\n                        sign = ''\n                    }\n                    pad_character = ph.pad_char ? ph.pad_char === '0' ? '0' : ph.pad_char.charAt(1) : ' '\n                    pad_length = ph.width - (sign + arg).length\n                    pad = ph.width ? (pad_length > 0 ? pad_character.repeat(pad_length) : '') : ''\n                    output += ph.align ? sign + arg + pad : (pad_character === '0' ? sign + pad + arg : pad + sign + arg)\n                }\n            }\n        }\n        return output\n    }\n\n    var sprintf_cache = Object.create(null)\n\n    function sprintf_parse(fmt) {\n        if (sprintf_cache[fmt]) {\n            return sprintf_cache[fmt]\n        }\n\n        var _fmt = fmt, match, parse_tree = [], arg_names = 0\n        while (_fmt) {\n            if ((match = re.text.exec(_fmt)) !== null) {\n                parse_tree.push(match[0])\n            }\n            else if ((match = re.modulo.exec(_fmt)) !== null) {\n                parse_tree.push('%')\n            }\n            else if ((match = re.placeholder.exec(_fmt)) !== null) {\n                if (match[2]) {\n                    arg_names |= 1\n                    var field_list = [], replacement_field = match[2], field_match = []\n                    if ((field_match = re.key.exec(replacement_field)) !== null) {\n                        field_list.push(field_match[1])\n                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {\n                            if ((field_match = re.key_access.exec(replacement_field)) !== null) {\n                                field_list.push(field_match[1])\n                            }\n                            else if ((field_match = re.index_access.exec(replacement_field)) !== null) {\n                                field_list.push(field_match[1])\n                            }\n                            else {\n                                throw new SyntaxError('[sprintf] failed to parse named argument key')\n                            }\n                        }\n                    }\n                    else {\n                        throw new SyntaxError('[sprintf] failed to parse named argument key')\n                    }\n                    match[2] = field_list\n                }\n                else {\n                    arg_names |= 2\n                }\n                if (arg_names === 3) {\n                    throw new Error('[sprintf] mixing positional and named placeholders is not (yet) supported')\n                }\n\n                parse_tree.push(\n                    {\n                        placeholder: match[0],\n                        param_no:    match[1],\n                        keys:        match[2],\n                        sign:        match[3],\n                        pad_char:    match[4],\n                        align:       match[5],\n                        width:       match[6],\n                        precision:   match[7],\n                        type:        match[8]\n                    }\n                )\n            }\n            else {\n                throw new SyntaxError('[sprintf] unexpected placeholder')\n            }\n            _fmt = _fmt.substring(match[0].length)\n        }\n        return sprintf_cache[fmt] = parse_tree\n    }\n\n    /**\n     * export to either browser or node.js\n     */\n    /* eslint-disable quote-props */\n    if (typeof exports !== 'undefined') {\n        exports['sprintf'] = sprintf\n        exports['vsprintf'] = vsprintf\n    }\n    if (typeof window !== 'undefined') {\n        window['sprintf'] = sprintf\n        window['vsprintf'] = vsprintf\n\n        if (typeof define === 'function' && define['amd']) {\n            define(function() {\n                return {\n                    'sprintf': sprintf,\n                    'vsprintf': vsprintf\n                }\n            })\n        }\n    }\n    /* eslint-enable quote-props */\n}(); // eslint-disable-line\n","module.exports = jQuery;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { addParametersToURL, isDefined } from '../common/utilities.js';\n\n/**\n * Creates circle on the bottom right corner for users to send feedback\n */\nexport default class SendFeedback {\n\t// eslint-disable-next-line require-jsdoc\n\tconstructor() {\n\t\tthis.render();\n\t}\n\n\t/**\n\t * Creates the elements\n\t *\n\t * @return {undefined}\n\t */\n\trender() {\n\t\tconst $container = $( `\n\t\t\t<div class=\"uap-report-bug\">\n\t\t\t\t<a\n\t\t\t\t\tclass=\"uap-report-bug__btn\"\n\n\t\t\t\t\tuap-tooltip=\"${ UncannyAutomator.i18n.sendFeedback.title }\"\n\t\t\t\t\tuap-flow=\"left\"\n\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\thref=\"${ addParametersToURL( 'https://automatorplugin.com/feedback/', this.utmBtnParameters ) }\"\n\t\t\t\t></a>\n\t\t\t</div>\n\t\t` );\n\n\t\t// Append to the body\n\t\t$( 'body' ).append( $container );\n\t}\n\n\t/**\n\t * Returns the UTM parameters for the link that goes\n\t * to automatorplugin.com for users to leave feedback\n\t *\n\t * @return {Object} UTM parameters\n\t */\n\tget utmBtnParameters() {\n\t\t// Check version\n\t\tlet version, utmSource;\n\n\t\tif ( ! isDefined( UncannyAutomator.wp ) || ! UncannyAutomator.wp ) {\n\t\t\tversion = `Uncanny Automator ${ UncannyAutomator.version }`;\n\t\t\tutmSource = 'uncanny_automator';\n\t\t} else {\n\t\t\tversion = `Uncanny Automator Pro ${ UncannyAutomator.version }`;\n\t\t\tutmSource = 'uncanny_automator_pro';\n\t\t}\n\n\t\treturn {\n\t\t\tversion: version,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tutm_source: utmSource,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tutm_medium: 'send_feedback',\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tutm_content: 'bulb_icon',\n\t\t};\n\t}\n}\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { restCall } from '../common/utilities.js';\n\nclass RecipeTitle {\n\tconstructor() {\n\t\tthis.elements = {\n\t\t\tcontainer: $( '#titlediv' ),\n\t\t\tinput: $( '#titlediv #title' ),\n\t\t\tstatus: {},\n\t\t};\n\n\t\tthis.publishedTitle = this.elements.input.val();\n\n\t\t// Create DOM elements\n\t\tthis.createStatus();\n\n\t\t// Bind changes\n\t\tthis.bindChanges();\n\n\t\t// Unbind beforeunload.edit-post\n\t\tthis.notSavedAlert();\n\t}\n\n\tcreateStatus() {\n\t\tconst container = $( '<div/>', { class: 'uap-title-status' } ),\n\t\t\tuapContainer = $( '<div/>', { class: 'uap' } );\n\n\t\t// Saving\n\t\tconst saving = $( '<div/>', { class: 'uo-status uo-status--saving' } ),\n\t\t\tsavingIcon = $( '<span/>', { class: 'uo-status-icon uo-icon uo-icon--loading uo-icon--rotate' } ),\n\t\t\tsavingText = $( '<span/>', { class: 'uo-status__text' } ).text( UncannyAutomator.i18n.title.saving );\n\n\t\tsaving.append( savingIcon );\n\t\tsaving.append( savingText );\n\n\t\tthis.elements.status.saving = saving;\n\n\t\t// Saved\n\t\tconst saved = $( '<div/>', { class: 'uo-status uo-status--saved' } ),\n\t\t\tsavedIcon = $( '<span/>', { class: 'uo-status-icon uo-icon uo-icon--check' } ),\n\t\t\tsavedText = $( '<span/>', { class: 'uo-status__text' } ).text( UncannyAutomator.i18n.title.saved );\n\n\t\tsaved.append( savedIcon );\n\t\tsaved.append( savedText );\n\n\t\tthis.elements.status.saved = saved;\n\n\t\tuapContainer.append( saving );\n\t\tuapContainer.append( saved );\n\t\tcontainer.append( uapContainer );\n\n\t\t// Append to the WP container\n\t\tthis.elements.container.append( container );\n\t}\n\n\tsetStatusSaving() {\n\t\tthis.elements.status.saving.stop().fadeIn( 150 );\n\t}\n\n\tsetStatusSaved() {\n\t\tthis.elements.status.saving.stop().fadeOut( 150 );\n\n\t\tthis.elements.status.saved.stop().fadeIn( 150, () => {\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.elements.status.saved.fadeOut( 150 );\n\t\t\t}, 3000 );\n\t\t} );\n\t}\n\n\trevertChanges() {\n\t\t// Revert the title\n\t\tthis.elements.input.val( this.publishedTitle );\n\n\t\t// Stop the saving animation\n\t\tthis.elements.status.saving.stop().fadeOut( 150 );\n\t}\n\n\tbindChanges() {\n\t\tlet typingTimeout;\n\n\t\t// Bind\n\t\tthis.elements.input.on( 'input', () => {\n\t\t\t// Clear the timeout if it has already been set.\n\t\t\t// This will prevent the previous task from executing\n\t\t\tclearTimeout( typingTimeout );\n\n\t\t\t// Wait 1.5 seconds\n\t\t\ttypingTimeout = setTimeout( () => {\n\t\t\t\t// Set status saving\n\t\t\t\tthis.setStatusSaving();\n\n\t\t\t\t// Update title\n\t\t\t\tthis.updateTitle();\n\t\t\t}, 1500 );\n\t\t} );\n\t}\n\n\tgetTitle() {\n\t\treturn this.elements.input.val();\n\t}\n\n\tupdateTitle() {\n\t\trestCall(\n\t\t\t'change_post_title',\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\tpost_ID: UncannyAutomator.recipe.id,\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\tpost_title: this.getTitle(),\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.setStatusSaved();\n\n\t\t\t\t// Update the published title\n\t\t\t\tthis.publishedTitle = this.getTitle();\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error( \"Couldn't save the title\" );\n\t\t\t\t}\n\n\t\t\t\t// Revert the changes\n\t\t\t\tthis.revertChanges();\n\t\t\t}\n\t\t);\n\t}\n\n\tnotSavedAlert() {\n\t\t$( document ).ready( () => {\n\t\t\t$( window ).off( 'beforeunload.edit-post' );\n\t\t} );\n\t}\n}\n\nexport default RecipeTitle;\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { isDefined, restCall } from '../common/utilities.js';\n\n/**\n * Listens to the Categories metabox to save the values using AJAX on change.\n * We need to do this because Automator doesn't have a \"Save\" button\n */\nexport default class Categories {\n\t// eslint-disable-next-line require-jsdoc\n\tconstructor() {\n\t\t// Check if the required element exist before adding the event listeners\n\t\tif ( this.hasMetabox ) {\n\t\t\t// Listen changes to the checkboxes\n\t\t\tthis.listenCheckboxes();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the node of the container of the Categories metabox\n\t *\n\t * @return {Node} The categories metabox\n\t */\n\tget $container() {\n\t\treturn $( '#recipe_categorydiv' );\n\t}\n\n\t/**\n\t * Returns the node of the container (ul) with the list\n\t * of categories\n\t *\n\t * @return {Node} The list\n\t */\n\tget $allCategoriesList() {\n\t\treturn $( '#recipe_categorychecklist' );\n\t}\n\n\t/**\n\t * Returns true if the required metabox exists\n\t *\n\t * @return {Boolean} True if \"Categories\" exists\n\t */\n\tget hasMetabox() {\n\t\treturn isDefined( this.$allCategoriesList );\n\t}\n\n\t/**\n\t * Listens changes to all checkboxes in the Category metabox\n\t *\n\t * @return {undefined}\n\t */\n\tlistenCheckboxes() {\n\t\t// Listen changes to each checkbox\n\t\tthis.$container.on(\n\t\t\t'change',\n\t\t\t'input[type=\"checkbox\"][name=\"tax_input[recipe_category][]\"], .popular-category input[type=\"checkbox\"]',\n\t\t\t( event ) => {\n\t\t\t\t// Get checkbox\n\t\t\t\tconst $checkbox = $( event.currentTarget );\n\n\t\t\t\t// Save category\n\t\t\t\tthis.saveCategory( $checkbox );\n\t\t\t}\n\t\t);\n\n\t\t// Listen when the user adds a new category. This will be\n\t\t// triggered when WP creates a new category after the user\n\t\t// used the \"+ Add New Category\" form\n\t\tnew MutationObserver( ( mutations ) => {\n\t\t\t// Iterate mutations\n\t\t\tmutations.forEach( ( mutation ) => {\n\t\t\t\t// Iterate new categories\n\t\t\t\tmutation.addedNodes.forEach( ( addedNode ) => {\n\t\t\t\t\t// Get the checkbox of the new category\n\t\t\t\t\tconst $checkbox = $( addedNode ).find(\n\t\t\t\t\t\t'input[type=\"checkbox\"][name=\"tax_input[recipe_category][]\"]'\n\t\t\t\t\t);\n\n\t\t\t\t\t// Save category\n\t\t\t\t\tthis.saveCategory( $checkbox );\n\t\t\t\t} );\n\t\t\t} );\n\t\t} ).observe( this.$allCategoriesList[ 0 ], {\n\t\t\tchildList: true,\n\t\t} );\n\t}\n\n\t/**\n\t * Saves the value of the category (checked/not checked)\n\t *\n\t * @param {Node} $checkbox The checkbox\n\t * @return {undefined}\n\t */\n\tsaveCategory( $checkbox ) {\n\t\t// Get the data\n\t\tconst checkboxData = {\n\t\t\tid: $checkbox.val(),\n\t\t\tisChecked: $checkbox.is( ':checked' ),\n\t\t};\n\n\t\t// Set checkbox as loading\n\t\tthis.setStatus( 'loading', true, $checkbox );\n\n\t\t// Do call\n\t\trestCall(\n\t\t\t'set_recipe_terms',\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\tterm_id: 'recipe_category',\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\trecipe_id: UncannyAutomator.recipe.id,\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\tcategory_id: checkboxData.id,\n\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\tset_category: checkboxData.isChecked,\n\t\t\t},\n\t\t\t( response ) => {\n\t\t\t\t// If the call (not necessarily the task) was successful...\n\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t// If everything went well...\n\t\t\t\t\t// Show a green check icon\n\t\t\t\t\tthis.setStatus( 'success', true, $checkbox );\n\n\t\t\t\t\t// Remove it after 2 seconds\n\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t// Remove the green check icon\n\t\t\t\t\t\tthis.setStatus( 'success', false, $checkbox );\n\t\t\t\t\t}, 2000 );\n\t\t\t\t} else {\n\t\t\t\t\t// Output if the developer mode is enabled\n\t\t\t\t\tif ( UncannyAutomator.dev.developerMode ) {\n\t\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\t\tconsole.error( \"Couldn't change the status of the recipe category\" );\n\t\t\t\t\t}\n\n\t\t\t\t\t// If something went wrong,\n\t\t\t\t\t// revert the value of the checkbox\n\t\t\t\t\tthis.revertCheckboxValue( $checkbox );\n\n\t\t\t\t\t// Show an error icon\n\t\t\t\t\tthis.setStatus( 'error', true, $checkbox );\n\t\t\t\t\t// Remove it after 2 seconds\n\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t// Remove the error icon\n\t\t\t\t\t\tthis.setStatus( 'error', false, $checkbox );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.setStatus( 'loading', false, $checkbox );\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// On error...\n\n\t\t\t\t// Revert the value of the checkbox\n\t\t\t\tthis.revertCheckboxValue( $checkbox );\n\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.setStatus( 'loading', false, $checkbox );\n\n\t\t\t\t// Show an error icon\n\t\t\t\tthis.setStatus( 'error', true, $checkbox );\n\t\t\t\t// Remove it after 2 seconds\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t// Remove the error icon\n\t\t\t\t\tthis.setStatus( 'error', false, $checkbox );\n\t\t\t\t} );\n\t\t\t},\n\t\t\t{\n\t\t\t\trequiresRecipesObject: false,\n\t\t\t\trenderUI: false,\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Reverts the value of the checkbox\n\t *\n\t * @param {Node} $checkbox The checkbox\n\t * @return {undefined}\n\t */\n\trevertCheckboxValue( $checkbox ) {\n\t\t// Revert the value of the checkbox\n\t\t$checkbox.prop( 'checked', ! $checkbox.is( ':checked' ) );\n\t}\n\n\t/**\n\t * Sets the status of the metabox\n\t *\n\t * @param {String}  status    The status of the metabox\n\t * @param {Boolean} enable    Defines the value of the status.\n\t *                            For example, if status is \"loading\",\n\t *                            and \"enable\" is true, then the checkbox\n\t *                            is rendered with the loading animations.\n\t * @param {Node}    $checkbox The checkbox of the category\n\t * @return {undefined}\n\t */\n\tsetStatus( status = '', enable = true, $checkbox ) {\n\t\t// Get label container\n\t\tconst $label = $checkbox.closest( '.selectit' );\n\n\t\t// Check what status we have to set or unset\n\t\tif ( status == 'loading' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\t$label.addClass( 'uap-taxonomy-loading' );\n\n\t\t\t\t// Disable checkbox\n\t\t\t\t$checkbox.prop( 'disabled', true );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\t$label.removeClass( 'uap-taxonomy-loading' );\n\n\t\t\t\t// Enable checkbox\n\t\t\t\t$checkbox.prop( 'disabled', false );\n\t\t\t}\n\t\t} else if ( status == 'success' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\t$label.addClass( 'uap-taxonomy-success' );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\t$label.removeClass( 'uap-taxonomy-success' );\n\t\t\t}\n\t\t} else if ( status == 'error' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\t$label.addClass( 'uap-taxonomy-error' );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\t$label.removeClass( 'uap-taxonomy-error' );\n\t\t\t}\n\t\t}\n\t}\n}\n","// eslint-disable-next-line import/no-unresolved\nimport $ from 'jquery';\n\nimport { restCall, handleFatalError, supportLink } from '../common/utilities.js';\n\nexport default class Tags {\n\t// eslint-disable-next-line require-jsdoc\n\tconstructor() {\n\t\t// Get elements\n\t\tthis.getElements();\n\n\t\t// Check if the required elements exist before adding\n\t\t// the event listeners\n\t\tif ( this.$elements.tagsTextarea.length == 1 ) {\n\t\t\t// Listen modifications to the textarea\n\t\t\tthis.listenModificationsToTags();\n\t\t}\n\t}\n\n\tgetElements() {\n\t\tthis.$elements = {\n\t\t\tcontainer: $( '#tagsdiv-recipe_tag' ),\n\t\t\ttagsTextarea: $( 'textarea#tax-input-recipe_tag' ),\n\t\t\ttagsList: $( '#tagsdiv-recipe_tag .tagchecklist' ),\n\t\t};\n\t}\n\n\tlistenModificationsToTags() {\n\t\t// Listen when the user adds a new tag. This will be\n\t\t// triggered when the user uses the input to add tags\n\t\tnew MutationObserver( ( mutations ) => {\n\t\t\t// Save tags\n\t\t\tthis.saveTags();\n\t\t} ).observe( this.$elements.tagsList[ 0 ], {\n\t\t\tchildList: true,\n\t\t} );\n\t}\n\n\tsaveTags() {\n\t\t// Get tags\n\t\tconst tags = this.getTags();\n\n\t\t// Set checkbox as loading\n\t\tthis.setStatus( 'loading', true );\n\n\t\t// Do call\n\t\trestCall(\n\t\t\t'set_recipe_terms',\n\t\t\t{\n\t\t\t\tterm_id: 'recipe_tag',\n\t\t\t\trecipe_id: UncannyAutomator.recipe.id,\n\t\t\t\ttags: tags,\n\t\t\t},\n\t\t\t( response ) => {\n\t\t\t\t// If the call (not necessarily the task) was successful...\n\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t// If everything went well...\n\t\t\t\t\t// Show a green check icon\n\t\t\t\t\tthis.setStatus( 'success', true );\n\n\t\t\t\t\t// Remove it after 2 seconds\n\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t// Remove the green check icon\n\t\t\t\t\t\tthis.setStatus( 'success', false );\n\t\t\t\t\t}, 2000 );\n\t\t\t\t} else {\n\t\t\t\t\t// Handle error by showing a modal with data\n\t\t\t\t\thandleFatalError({\n\t\t\t\t\t\ttitle:   UncannyAutomator.i18n.debugging.fatalErrorHandler.exceptions.tags.couldNotSave,\n\t\t\t\t\t\twarning: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.generic.content, [\n\t\t\t\t\t\t\t`<a href=\"${ supportLink() }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.automatorSupport }</a>`\n\t\t\t\t\t\t] ),\n\t\t\t\t\t\tcontent: '',\n\t\t\t\t\t\tconsole: `Data sent:\\n ${ JSON.stringify( response ) }`,\n\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\tconfirm: null,\n\t\t\t\t\t\t\tcancel: {\n\t\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.close,\n\t\t\t\t\t\t\t\tonClick: ( $modal ) => {\n\t\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\t\t$modal.destroy();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.setStatus( 'loading', false );\n\t\t\t},\n\t\t\t( response ) => {\n\t\t\t\t// On error...\n\n\t\t\t\t// Handle error by showing a modal with data\n\t\t\t\thandleFatalError({\n\t\t\t\t\ttitle:   UncannyAutomator.i18n.debugging.fatalErrorHandler.exceptions.tags.couldNotSave,\n\t\t\t\t\twarning: vsprintf( UncannyAutomator.i18n.debugging.fatalErrorHandler.generic.content, [\n\t\t\t\t\t\t`<a href=\"${ supportLink() }\" target=\"_blank\">${ UncannyAutomator.i18n.debugging.automatorSupport }</a>`\n\t\t\t\t\t] ),\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tconsole: `Data sent:\\n ${ JSON.stringify( response ) }`,\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tconfirm: null,\n\t\t\t\t\t\tcancel: {\n\t\t\t\t\t\t\tlabel: UncannyAutomator.i18n.close,\n\t\t\t\t\t\t\tonClick: ( $modal ) => {\n\t\t\t\t\t\t\t\t// Destroy modal\n\t\t\t\t\t\t\t\t$modal.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t{\n\t\t\t\trequiresRecipesObject: false,\n\t\t\t\trenderUI: false,\n\t\t\t}\n\t\t);\n\t}\n\n\tsetStatus( status = '', enable = true ) {\n\t\t// Check what status we have to set or unset\n\t\tif ( status == 'loading' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\tthis.$elements.container.addClass( 'uap-tags-loading' );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.$elements.container.removeClass( 'uap-tags-loading' );\n\t\t\t}\n\t\t} else if ( status == 'success' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\tthis.$elements.container.addClass( 'uap-tags-success' );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.$elements.container.removeClass( 'uap-tags-success' );\n\t\t\t}\n\t\t} else if ( status == 'error' ) {\n\t\t\t// Check if we have to add or remove the loading status\n\t\t\tif ( enable ) {\n\t\t\t\t// Add loading animation\n\t\t\t\tthis.$elements.container.addClass( 'uap-tags-error' );\n\t\t\t} else {\n\t\t\t\t// Remove loading animation\n\t\t\t\tthis.$elements.container.removeClass( 'uap-tags-error' );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTags() {\n\t\t// Get tags separated by comma\n\t\tconst tagsCommaSeparated = this.$elements.tagsTextarea.val();\n\n\t\t// Create array\n\t\tconst tagsArray = tagsCommaSeparated.split( ',' );\n\n\t\t// Return both\n\t\treturn {\n\t\t\tasArray: tagsArray,\n\t\t\tcommaSeparated: tagsCommaSeparated,\n\t\t};\n\t}\n}\n","import Categories from './categories.js';\nimport Tags from './tags.js';\n\n/**\n * Creates instances of the Categories and Tags classes, which listen\n * to the changes in both metaboxes to save the values using AJAX.\n * We need to do this because Automator doesn't have a \"Save\" button.\n */\nexport default class Taxonomies {\n\t// eslint-disable-next-line require-jsdoc\n\tconstructor() {\n\t\t// Invoke class used to save the categories using AJAX\n\t\tnew Categories();\n\n\t\t// Invoke class used to save the tags using AJAX\n\t\tnew Tags();\n\t}\n}\n","// Load static resources\nimport './scss/main.scss';\n\n// Import jQuery\nimport $ from 'jquery';\n\n// Create JS cache object\nUncannyAutomator.cache = {\n\ttokens: {},\n};\n\nimport {\n\tcreateDataOnLoad,\n\tconsoleLogLabel,\n\treplaceCurlyBraces,\n\thandleFatalError\n}   from './js/common/utilities.js';\n\nimport Publish            from './js/publish/publish.js';\n\nimport Triggers           from './js/item/triggers.js';\nimport Actions            from './js/item/actions.js';\n\nimport SendFeedback       from './js/send-feedback/send-feedback.js';\n\nimport RecipeTypeSelector from './js/recipe/type-selector.js';\nimport RecipeTitle        from './js/recipe/title.js';\n\nimport Taxonomies         from './js/taxonomies/taxonomies.js';\n\n// Create the data required to render Automator\ntry {\n\tcreateDataOnLoad(() => {\n\t\tconsoleLogLabel( 'Render the UI', false, { bgColor: '#579f49' });\n\n\t\t// Once ready, render the UI\n\t\tnew Triggers();\n\t\tnew Actions();\n\t\tnew Publish();\n\t\tnew SendFeedback();\n\t\tnew RecipeTitle();\n\t\tnew Taxonomies();\n\t});\n} catch ( error ){\n\t// Show a modal with data in case the UI couldn't load\n\thandleFatalError({\n\t\ttitle:   UncannyAutomator.i18n.debugging.uiCantLoad.title,\n\t\twarning: UncannyAutomator.i18n.debugging.uiCantLoad.warning,\n\t\tcontent: UncannyAutomator.i18n.debugging.uiCantLoad.content,\n\t\tconsole: error\n\t});\n}"],"names":["Markdown","content","this","escapeHTML","parseItalicsAndBold","parseAnchors","regularExpressions","doubleUnderscores","singleUnderscores","doubleAsterisks","singleAsterisks","replace","regExAnchors","replacerFunction","wholeMatch","m1","linkText","linkId","url","m5","m6","title","toLowerCase","search","encodeURI","isEmpty","result","Modal","config","elements","container","automatorContainer","modal","box","warning","buttons","cancel","confirm","$","isVisible","fadeDuration","size","warningFirst","UncannyAutomator","i18n","create","modalContent","modalWarning","class","modalBox","isDefined","includes","addClass","customClass","modalTitle","html","append","e","modalButtons","cancelButton","confirmButton","bind","events","afterSetEvents","afterShow","afterHide","onConfirm","onCancel","hide","thisModal","unbind","remove","removeClass","on","callback","fadeIn","fadeOut","FieldsGroup","attributes","setAttributes","createFields","hasLabel","label","hasDescription","description","fields","map","fieldData","Field","fieldType","$container","$label","$formGroup","forEach","field","$fieldElement","createFormElement","$description","formElement","fieldsValue","getFieldID","getValue","renderError","validationObject","isValid","message","validate","sortable","require","FieldsRepeater","rowFieldsTemplate","fieldsRows","Array","isArray","currentValue","length","row","rowFields","JSON","parse","stringify","optionCode","push","isRequired","emptyRow","fieldObject","fieldRows","response","$table","getFieldsTable","makeRowsSortable","listenSave","event","updateAttributesFieldsFromRow","fieldInstance","find","forcePlaceholderSize","handle","placeholder","itemSerializer","serializedItem","sortableContainer","position","index","newOrder","detail","destination","items","data","newFieldRowsOrder","oldIndex","reRender","heading","$heading","headingColumn","$headingColumn","$rows","numberOfRows","$row","$fieldCell","$field","getFormElement","initLibraries","$actions","fieldAtts","getAttributes","removeRowLabel","removeRowButtonLabel","removeRow","$removeRowButton","deleteRow","hideActions","$addRowButton","addRow","addRowButtonLabel","text","value","fieldsData","focusFirstFieldOfLastRow","destroyCodeMirror","destroyTokenSelector","$currentFormElement","$newFormElement","replaceWith","initTokenSelector","initCodeMirror","lastRow","firstField","focus","splice","validation","rowsValidation","rowValidation","vsprintf","createDataOnLoad","dev","developerMode","consoleLogLabel","completeProcess","filterAutomatorItemsByRecipeType","groupItemsByIntegration","recipeObject","allRecipes","recipes_object","triggers","actions","recipe","type","RecipeTypeSelector","action","validActions","inArray","requiredData","Object","keys","theRecipe","ID","id","extra_options","item","itemType","closures","concat","apply","itemsObject","recipeIsAnonymous","itemToAdd","extraOptions","itemIntegration","meta","integration","itemCode","code","error","globalItem","getGlobalItem","options","i","option","option_code","options_group","groupsOfOptions","groupKey","allFieldsOnThisGroup","hasMoreThanOneOption","sanitizeFieldData","isGroup","itemId","required","isReadOnly","read_only","supportsTinyMCE","supports_tinymce","supportsCopyToClipboard","copy_to_clipboard","isAjax","is_ajax","groupId","input_type","isHidden","is_hidden","tokenName","token_name","defaultValue","default_value","customFieldTokens","relevant_tokens","relevantTokens","maxLength","max_length","dateFormat","date_format","dateAltFormat","date_alt_format","format","date","supportsRange","supports_range","min_date","minDate","max_date","maxDate","timeFormat","time_format","timeAltFormat","time_alt_format","min_time","minTime","maxTime","max_time","supportsTokens","supports_tokens","supports_custom_value","supportsCustomValue","customValue","custom_value_description","customValueDescription","supports_multiple_values","supportsMultipleValues","targetField","fill_values_in","endpoint","integrationId","console","warn","hide_actions","add_row_button","remove_row_button","button","show_in","integrationCode","isLive","post_status","isMissing","tokens","inlineCss","inline_css","filterTokens","filter_tokens","support","optionKey","opts","fieldAttributes","canLogNewUserIn","can_log_in_new_user","integrationName","integration_name","sentence","recipeTriggers","filter","trigger","missingAttributes","arrayDifference","isRecipeValid","hasLive","itemID","itemData","itemIsValid","optionsGroupID","optionsGroupData","groupIsValid","requiresUserData","userSelector","closure","liveItems","oneAction","oneTrigger","matchFilters","key","entries","integrations","integrationID","available","sortArrayOfObjectsAlphabetically","replaceCurlyBraces","unavailable","wp","proFeatures","recipeType","allItemsArePro","every","is_pro","hasAvailableItems","hasUnavailableItems","hasTriggers","hasActions","propertyToCompare","sort","a","b","compare","valueA","valueB","localeCompare","getItemsByIntegration","assign","addDeprecatedItems","filterDeprecatedItems","is_deprecated","userSelectorObject","step","source","existingUser","newUser","collapseGroup","log","consoleLogResult","groupEnd","restCall","endPoint","onSuccess","onFail","validEndpoints","supportPageURL","supportLink","requiresRecipesObject","renderUI","errorMessaging","accessDenied","debugging","fatalErrorHandler","notFound","permalinksURL","sitePermalinks","automatorSupport","timeout","serverError","parserError","dataMissing","contactSupport","automatorTools","generic","method","restURL","doing_rest","dataType","beforeSend","xhr","setRequestHeader","nonce","done","textStatus","errorThrown","success","fail","jqXHR","errorCode","status","timeOut","handleFatalError","close","onClick","$modal","destroy","join","addParametersToURL","addUTMParameters","supportPage","medium","subject","version","site_url","siteURL","AJAXRequest","ajaxurl","location","reload","statusCode","bgColor","getCurrentFieldsValues","values","groupOfFields","fieldId","fieldValue","getSelectCustomValue","getReadableValue","getField","optionsGroupId","optionsGroup","theItem","integrationItems","recipeSetRequiresUser","requires","recipePostID","requiresUser","getDOMElements","element","validElements","cssSelectorMetabox","$metabox","metabox","$items","cssSelector","$item","$contentContainer","contentContainer","cssSelectorTokenInSentence","groupID","cssSelectorFieldsContainer","$tokenInSentence","$fieldsContainer","$optionsContainer","tokenInSentence","fieldsContainer","optionsContainer","lastItem","last","getIntegrationIcon","node","document","createElement","icon_svg","setAttribute","name","icon_32","icon_64","icon16","icon_16","icon32","icon64","getFieldTypes","parseStringWithTokens","string","plain","brackets","normal","token","parts","trim","match","tokensRegex","RegExp","normals","mappedString","tokenNumber","stringParts","fullMatch","readableText","tokenParts","split","tokenPlaceholderText","tokenValueID","optionsID","hasFields","originalText","normalNumber","sentenceSection","exec","part","itemTokens","elementAttributes","contentIsNode","tagNodeContent","test","Tokens","includeGroupName","renderTextWithTokens","abbreviatedText","abbreviateText","isAbbreviated","decodeEntities","get","itemSentence","openCenteredWindow","w","h","onClose","dualScreenLeft","window","screenLeft","screenX","dualScreenTop","screenTop","screenY","width","documentElement","clientWidth","screen","innerWidth","height","clientHeight","innerHeight","systemZoom","availWidth","left","top","newWindow","open","wasWindowClosed","closed","setTimeout","variable","isObject","compareStrings","string1","string2","settings","caseSensitive","toString","needle","haystack","array1","array2","not","isString","start","end","labelStyle","groupCollapsed","group","tagsToReplace","replaceTag","tag","partLengths","Math","floor","textParts","substring","slice","getUniqueId","random","substr","parameters","href","URL","urlParameters","x","parameter","parameterParts","setAsURL","refresh","pageTitle","history","pushState","getURLParameter","searchParams","encodedString","$textarea","innerHTML","throttle","func","interval","lastCall","now","Date","arguments","debounce","clearTimeout","args","copyToClipboard","$tempTextarea","style","body","appendChild","select","execCommand","removeChild","learnMore","debuggingURL","recipeData","reportLog","logRecipe","recipeTitle","recipeTypeUser","recipe_type","recipeTypeAnonymous","recipeStatus","recipeStatusDraft","recipeStatusLive","logRecipeItems","recipeItemsTitle","cleanItemData","itemStatusLive","itemStatusDraft","replaceAll","hasClosures","triggersTitle","noTriggers","actionsTitle","noActions","closuresTitle","noClosures","noRecipeItemsFound","jsConsole","stack","setEvents","$debuggingConsole","range","createRange","selectNodeContents","getSelection","removeAllRanges","addRange","filterMetaValue","itemsWithMeta","filterMeta","filteredItems","openInNewTab","target","click","campaign","utm_source","utm_medium","utm_campaign","utm_content","marketing","utmR","utm_r","HOOKS","defaults","_disable","allowInput","allowInvalidPreload","altFormat","altInput","altInputClass","animate","navigator","userAgent","indexOf","ariaDateFormat","autoFillDefaultTime","clickOpens","closeOnSelect","conjunction","defaultHour","defaultMinute","defaultSeconds","disable","disableMobile","enableSeconds","enableTime","errorHandler","err","getWeek","givenDate","getTime","setHours","setDate","getDate","getDay","week1","getFullYear","round","hourIncrement","ignoredFocusElements","inline","locale","minuteIncrement","mode","monthSelectorType","nextArrow","noCalendar","onChange","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition","plugins","positionElement","undefined","prevArrow","shorthandCurrentMonth","showMonths","static","time_24hr","weekNumbers","wrap","english","weekdays","shorthand","longhand","months","daysInMonth","firstDayOfWeek","ordinal","nth","s","rangeSeparator","weekAbbreviation","scrollTitle","toggleTitle","amPM","yearAriaLabel","monthAriaLabel","hourAriaLabel","minuteAriaLabel","pad","number","bool","fn","wait","t","arrayify","obj","toggleClass","elem","className","classList","add","textContent","clearNode","firstChild","findParent","condition","parentNode","createNumberInput","inputClassName","wrapper","numInput","arrowUp","arrowDown","pattern","getEventTarget","composedPath","doNothing","monthToStr","monthNumber","revFormat","D","F","dateObj","monthName","setMonth","G","hour","parseFloat","H","J","day","K","getHours","M","shortMonth","S","seconds","setSeconds","U","_","unixSeconds","W","weekNum","weekNumber","parseInt","Y","year","setFullYear","Z","ISODate","d","minutes","setMinutes","j","l","m","month","n","u","unixMillSeconds","y","tokenRegex","formats","toISOString","getMonth","getSeconds","getMinutes","String","createDateFormatter","l10n","isMobile","frmt","overrideLocale","formatDate","c","arr","createDateParser","givenFormat","timeless","customLocale","parsedDate","dateOrig","toFixed","datestr","parseDate","matched","ops","matchIndex","regexStr","isBackSlash","escaped","val","isNaN","Error","compareDates","date1","date2","getDefaultHours","hours","minHour","minMinutes","minSeconds","maxHr","maxMinutes","min","FlatpickrInstance","instanceConfig","self","flatpickr","defaultConfig","bindToInstance","setCalendarWidth","requestAnimationFrame","calendarContainer","visibility","display","daysContainer","daysWidth","days","offsetWidth","weekWrapper","removeProperty","updateTime","selectedDates","defaultDate","getMilliseconds","latestSelectedDateObj","preventDefault","isKeyDown","eventTarget","input","getAttribute","max","curValue","newValue","delta","which","isHourElem","hourElement","isMinuteElem","minuteElement","incrementNumInput","abs","timeWrapper","prevValue","_input","setHoursFromInputs","updateValue","_debouncedChange","secondElement","limitMinHours","minDateHasTime","maxDateHasTime","setHoursFromDate","onYearInput","changeYear","handler","ev","el","addEventListener","_handlers","removeEventListener","triggerChange","triggerEvent","jumpToDate","jumpDate","jumpTo","oldYear","currentYear","oldMonth","currentMonth","buildMonthSwitch","redraw","timeIncrement","contains","inputElem","createEvent","dispatchEvent","createDay","dayNumber","dateIsEnabled","isEnabled","dayElement","$i","todayDateElem","tabIndex","isDateSelected","selectedDateElem","isDateInRange","insertAdjacentHTML","focusOnDayElem","targetNode","onMouseOver","getFirstAvailableDay","startMonth","endMonth","children","startIndex","endIndex","focusOnDay","current","offset","dayFocused","isInView","activeElement","startElem","givenMonth","loopDelta","numMonthDays","changeMonth","getNextAvailableDay","buildMonthDays","firstOfMonth","prevMonthDays","utils","getDaysInMonth","createDocumentFragment","isMultiMonth","prevMonthDayClass","nextMonthDayClass","dayIndex","dayNum","dayContainer","buildDays","frag","shouldBuildMonth","monthsDropdownContainer","selected","buildMonth","monthNavFragment","monthElement","selectedMonth","yearInput","tabindex","yearElement","getElementsByTagName","disabled","buildMonths","monthNav","prevMonthNav","yearElements","monthElements","nextMonthNav","buildWeekdays","weekdayContainer","updateWeekdays","isOffset","_hidePrevMonthArrow","_hideNextMonthArrow","updateNavigationCurrentMonth","isCalendarElem","appendTo","documentClick","isOpen","isCalendarElement","isInput","path","lostFocus","relatedTarget","isIgnored","some","timeContainer","clear","newYear","newYearNum","isNewYear","_a","dateToCheck","enable","array","parsed","from","to","onBlur","allowKeydown","allowInlineKeydown","keyCode","blur","isTimeObj","focusAndClose","selectDate","ctrlKey","stopPropagation","currentYearElement","elems","pluginElements","shiftKey","charAt","hoverDate","firstElementChild","initialDate","rangeStartDate","rangeEndDate","containsDisabled","minRange","maxRange","dayElem","timestamp","outOfRange","ts1","ts2","ts","onResize","positionCalendar","minMaxDateSetter","inverseDateObj","removeAttribute","getInputElem","querySelector","setupLocale","l10ns","default","dataset","customPositionElement","_positionElement","calendarHeight","prototype","reduce","call","acc","child","offsetHeight","calendarWidth","configPos","configPosVertical","configPosHorizontal","inputBounds","getBoundingClientRect","distanceFromBottom","bottom","showOnTop","pageYOffset","pageXOffset","isCenter","isRight","right","rightMost","centerMost","doc","editableSheet","styleSheets","sheet","cssRules","head","createStyleSheet","getDocumentStyleSheet","bodyWidth","centerLeft","centerBefore","centerAfter","centerIndex","centerStyle","insertRule","msMaxTouchPoints","selectedDate","shouldChangeMonth","selectedIndex","single","loadedPlugins","_bind","_setHoursFromDate","_positionCalendar","triggerChangeEvent","toInitial","mobileInput","_initialDate","_createElement","lastChild","insertBefore","_type","k","wasOpen","set","CALLBACKS","setSelectedDate","toggle","inputDate","dates","parseDateRules","rule","hooks","initEvent","getDateStr","dObj","mobileFormatStr","onMonthNavClick","isPrevMonth","isNextMonth","boolOpts","userConfig","defineProperty","_enable","timeMode","defaultDateFormat","defaultAltFormat","_minDate","_maxDate","minMaxTimeSetter","_minTime","_maxTime","hook","pluginConf","parseConfig","nodeName","nextSibling","preloadedDate","setupDates","yr","fragment","__hidePrevMonthArrow","__hideNextMonthArrow","innerContainer","buildWeeks","rContainer","separator","hourInput","minuteInput","military2ampm","secondInput","buildTime","customAppend","nodeType","build","evt","querySelectorAll","inputType","setupMobile","debouncedResize","ontouchstart","capture","selText","bindEvents","isSafari","init","_flatpickr","nodeList","nodes","HTMLElement","instances","HTMLCollection","NodeList","selector","Node","en","localize","setDefaults","jQuery","fp_incr","TokenSelector","TokenSelectorTextarea","TokenSelectorInput","render","setData","getCodeMirrorEditor","editor","setValue","renderTokens","handleAddTokens","renderTokensInRealTime","RenderTokenSelector","tokenRenderingDebounce","fieldCM","off","insertTextAtCursor","ignoreRequiresUserModal","replaceRange","getCursor","querySearchTokens","getSearchCursor","tokenId","getRange","$tokenNode","createTokenDOMNode","widget","markText","replacedWith","tokensThatRequireUser","startsWith","tokenNeedsUserModal","removeToken","widgetPosition","onFocusOut","onClickOutside","onCopy","onDelete","onNavigation","charCode","setCursor","findNext","callbacks","actionWillSetRecipeToDraft","userDataModal","allowed","proOnly","pro","mustRunOnUser","outerHTML","modalElements","getElements","prop","publish","statusToggle","allowedConfirm","allowedCancel","forbidden","uncannyAutomatorPro","upgradeNow","upgradeLater","forbiddenConfirm","forbiddenCancel","getTinyMCEEditor","addStylesToEditor","parsePlainTokensInTinyMCE","parseTokensInAttributes","parseHTMLTokensInPlainTextarea","handleHTMLTokensInPlainTextarea","handlePlainTokensInTinyMCE","tokenCSSClass","tinyMCEeditor","hidden","fieldTinyMCE","dom","addStyle","editorContent","getContent","editorContentWithTokens","template","setContent","$temporalContainer","$tokens","tokenID","getData","createWrapper","createFilter","createGroupsOfTokens","listenToggleButton","resizeDropdownOnWindowResize","resizeDropdownOnWindowScroll","refreshOnFieldChange","shouldSupportFilters","setFilter","$elements","toggleButton","searchField","dropdown","allGroups","dropdownGroupsContainer","dropdownTokens","noResultsOption","$wrapper","$fieldsToMove","getFieldCM","insertAfter","renderContainer","searchFieldContainer","fieldTypeHumanReadable","tokenType","$filterContainer","filterToggle","$filterFormElement","prepend","filterContainer","groupOfTokens","createIndividualGroupOfTokens","noResults","noResultsDescriptionWithFilter","noResultsDescription","$group","groupName","clone","$icon","icon","$tokensListContainer","$token","needsUserData","$modalContent","metaKeyField","specialTokens","userMeta","userMetaKey","userMetaKeyDescription","show","fieldValidation","global","userMetaKeyTemplate","query","updateGroupsOfTokensVisibility","filterByType","$tokensByType","hasResults","flatpickrInstance","closeWhenClickedOutside","css","outerWidth","setDropdownDirection","setDropdownHeight","is","has","$window","above","scrollTop","below","outerHeight","dropdownHeight","hasSpaceBelow","getDropdownPosition","maxHeight","createDOMelements","customValidationFunction","formElementClass","fieldContainer","fieldLabel","uniqueFieldID","isChildField","defaultOptionExists","hasSelectedOption","numberOfOptions","hasDefaultValue","option_value","option_name","$normalOptions","option_data","selectOption","hasValue","defaultOption","prependTo","hasPlaceholder","customFieldValue","$otherOptions","otherOptions","attr","customValueField","hasCustomValueDescription","customValueToken","parentOptionCode","selectHasSelectedOption","$noResults","Option","customData","fieldContainerClass","$fakeCodemirrorField","$clearButton","clearValue","checkboxLabel","checkboxPseudo","isToggle","checkboxToggleOn","checkboxToggleOff","color","align","$fields","$fieldContainers","$formRadioContainer","$fakeRadio","for","fieldLabelAsterisk","fieldError","fieldDescription","customValueFieldContainer","onFocus","getFieldContainer","validateField","onChangeAJAXCallback","doAJAX","parentField","completedFirstLoad","setCustomValue","onChangeTimeout","currentTarget","ready","getMetaValue","startLoadingAnimation","parentFieldValue","targetFieldValue","recipe_id","integration_id","item_id","group_id","field_id","target_field","stopLoadingAnimation","setSelectOptions","isReady","isTargetField","accumulator","manuallySet","optionValue","itemSeparator","getSelectOptionByValue","trueLabel","falseLabel","$checkedRadio","closest","metaValue","doTrigger","updateCodemirror","allOptions","optionID","wantsToCheck","isChecked","removeSelectOptions","optionsDOM","optionDOM","rerenderSelect2","empty","hasClass","CSSclass","initSelect2","initURLChecker","initFlatpickr","theme","searchInputPlaceholder","language","templateResult","Number","isInteger","postIDPlaceholder","templateSelection","escapeMarkup","markUp","getSelect2Settings","select2","getElementById","sunday","monday","tuesday","wednesday","thursday","friday","saturday","january","february","march","april","may","june","july","august","september","october","november","december","scrollToIncrement","clickToToggle","am","pm","minute","dateStr","instance","formatCodemirrorDate","setCodemirrorValue","manTime","initialValue","CodeMirror","lineNumbers","tabSize","dragDrop","viewportMargin","Infinity","lineWrapping","autoRefresh","noNewlines","scrollbarStyle","extraKeys","Tab","nextField","getNextField","readOnly","setOption","fieldPosition","getWrapperElement","tokenSelector","tinymce","initialize","mediaButtons","toolbar1","toolbar2","quicktags","Defaults","amd","extend","SearchDropdown","_renderSearchDropdown","$rendered","$search","ItemHeaderMenu","createItemActions","btn","btnIcon","dropdownUl","deleteAction","deleteText","globalItemData","support_link","utmContent","select_option_name","supportAction","supportText","confirmationModal","deleteWarning","Triggers","Actions","UserSelector","$content","getSelectSourceNodes","getOptionsNodes","errorMode","RecipeNotices","getSentenceNodes","$userSelector","userType","existing","getHeaderNodes","userSource","getOptionsFields","optionsFields","roles","resources","administrator","$groupOfFields","uniqueField","uniqueFieldLabel","uniqueFieldOptionEmail","uniqueFieldOptionId","uniqueFieldOptionUsername","valueField","uniqueFieldValue","valueFieldLabel","$uniqueFieldFormElement","$valueFieldFormElement","fallbackField","createNewUserFieldLabel","fallback","createNewUserFieldOptionCreateUser","createNewUserFieldOptionDoNothing","$fallbackFieldFormElement","$doNothingNotice","doNothingMessage","$subOptionsContainer","firstName","lastName","email","username","displayName","password","passwordDescription","role","logUserIn","yes","no","$fieldFormElement","newUserFallbackField","existingUserFieldLabel","existingUserFieldOptionExisting","existingUserFieldOptionDoNothing","$newUserfallbackFieldFormElement","fieldsValues","prioritizedField","prioritizedFieldLabel","prioritizedFieldDescription","$prioritizedField","$buttonsContainer","$saveButton","save","$cancelButton","areAllFieldsValid","isFieldValid","recipeId","$summaryContainer","$sourceRow","$sourceRowToken","$dataRowSentence","$dataRow","summary","matches","withEmail","$fallbackRow","otherwiseText","createNewUser","selectExistingUser","$fallbackRowSentence","otherwise","sentenceTitle","setOptions","$output","$itemActions","$containerBox","$button","ItemCreatorIntegrations","Closures","createClosure","wasAdded","checkboxAttributes","closureInRecipe","getClosureByCodeFromItemsObject","itemid","checkboxField","$checkbox","item_code","default_meta","post_ID","first","$toggleContent","$itemHeader","createHeader","$itemContent","$title","ItemHeaderIcon","$itemTag","ItemHeaderTag","$titleSentence","ItemHeaderSentence","instantActions","delayedActions","scheduledActions","MetaboxItems","MetaboxFooter","isContinuingIntegrationConnection","asyncActions","closuresLabelAsyncOnly","ItemCreatorAdd","createItemIcon","createItemTag","ItemCreatorTaskSelector","$currentItem","createItemsList","removeConnectingIntegrationsParameters","$header","$itemIcon","$integrationTag","searchPlaceholder","unlockTriggers","unlockActions","$taskSelector","$searchField","$itemsList","list","itemsThatRequireUserData","itemsThatDontRequireUserData","requires_user","isPro","cannotAddRequiresUserData","restRequestCode","defaultMeta","addItemREST","$newItem","createCancelButton","ua_connecting_integration","ua_connecting_integration_id","ua_connecting_integration_context","handleContinueIntegrationConnection","header","itemContent","createIntegrations","discoverMore","createDiscoverMoreIntegrations","titleContainer","titleContent","filterByNonEmptyIntegrations","sortIntegrationsAlphabetically","integrationElement","createIntegration","connected","integrationModalCurrentStep","connectIntegrationModal","currentStep","connectApiUrl","redirect_url","dashboardUrl","ua_close_window","modalFirstStep","apiIntegrations","instructionsToConnect","step1Pro","activate","step1","uncannyAutomator","signUp","connectIntegration","stepCounter","step2","completePrevious","connectAccount","licenseUrl","settings_url","minimal","hide_settings_tabs","$logoImg","logo","isProOnly","isAvailable","hasAccountConnected","integrationNotConnected","notConnected","allActionsRequireUserData","requiresPro","dontSeeTrigger","hasItems","hasValidProLicense","ItemOptions","optionId","initTinyMCE","itemOptions","createButtons","noticeContainer","saveButton","automatorButtons","developerButtons","$buttonElement","css_classes","doOnClick","on_click","eval","modules","validateItemFields","itemSentenceHTML","getOptionValue","sentence_human_readable","sentence_human_readable_html","hasSelect","hasRepeater","createItemSentence","parents","itemToggle","liveRecipeItem","draftRecipeItem","itemStatusToggle","makeLive","isValidItem","validateItem","statusWarning","shouldCreateMetaboxFooter","createFooter","recipeActions","addAnother","$anonymousNotice","createAnonymousNotice","everyoneOnlyOneTrigger","ItemHeaderAsync","asyncMode","async_mode","proVersion","createAsyncButton","async_delay_number","async_delay_unit","async_schedule_time","async_schedule_date","hasSchedule","async_sentence","delay","buttonContainer","buttonIcon","getButtonText","createRemoveButton","isNew","createBadge","showModal","pleaseSave","removeAttr","buttonBadge","removeButton","removeButtonIcon","removeSchedule","asyncModeHTML","createAsyncModeHTML","after","createDelayOptions","createScheduleOptions","attachModeChangeEvent","modalNoticeHTML","modalNoticeIcon","scheduleNotice2","confirmButtonText","schedule","createModalContent","modalEvents","submitModal","validateForm","asyncModeField","delayNumber","delayNumberField","delayUnit","delayUnitField","scheduleTime","scheduleTimeField","scheduleDate","scheduleDateField","delaySentence","scheduleSentence","saveSchedule","multiplier","unit","timeZoneLink","timezoneLink","timeZoneHelpIcon","timeZoneDesc","timezone","timezoneString","selectedAsyncMode","scheduleNoticeHTML","scheduleOptions","scheduleDesc","scheduleFields","scheduleNotice1","createScheduleDateHTML","createScheduleTimeHTML","createTimeZone","delayOptions","delayDesc","delayFields","delayNumberHTML","createDelayNumberHTML","delayUnitHTML","createDelayUnitHTML","delayFieldsDesc","validateDelayNumber","$delayNumberField","years","today","$scheduleDateField","selectTime","$scheduleTimeField","validSchedule","validateScheduleFields","unsupported","simulate_int","positiveNumber","createItem","notice","createNotice","asyncButtons","itemTag","titleSentence","asyncButton","itemMissing","Publish","timesPerUser","editLink","hiddenBox","timesPerRecipe","createMetabox","footer","timesRow","timesRowVisible","timesRowIconBox","timesRowIcon","timesRowName","timesValue","unlimited","timesRowValue","timesRowEdit","edit","timesRowHidden","timesRowHiddenBox","timesRowField","leaveEmpty","oneOrBigger","timesField","timesRowButtons","timesRowSaveBtn","timesRowCancelBtn","recipeTypeRow","recipeTypeRowVisible","recipeTypeRowIconBox","recipeTypeRowIcon","recipeTypeRowName","recipeTypeRowValue","recipeTypeLearnMore","userRecipeName","everyoneRecipeName","createdRow","createdRowVisible","createdRowIconBox","createdRowIcon","createdRowName","createdOn","createdRowValue","recipeRunTimeVal","recipeRunTimes","recipeRunTimeUrlVal","recipeRunTimesUrl","recipeRunTimesViewLogs","recipeRunTimesRow","recipeRunTimesRowVisible","recipeRunTimesRowIconBox","recipeRunTimesRowIcon","recipeRunTimesRowName","copyRecipeRow","copyRecipeRowVisible","copyRecipeRowName","copyToDraft","copyRecipe","footerRow","footerRowLeft","footerMoveToDraft","moveToTrash","footerRowRight","recipeStatusToggle","liveRecipe","draftRecipe","recipeStatusToggleDOM","validateStatus","timesRecipeRow","timesRecipeRowVisible","timesRecipeRowIconBox","timesRecipeRowIcon","timesRecipeRowName","timesRecipeValue","timesRecipeRowValue","timesRecipeRowEdit","timesRecipeRowHidden","timesRecipeRowHiddenBox","timesRecipeRowField","timesRecipeField","timesRecipeRowButtons","timesRecipeRowSaveBtn","timesRecipeRowCancelBtn","$element","$fieldValue","$timeField","slideToggle","numberOfTimes","recipe_completions_allowed","validateTimesPerFields","postStatus","createContainer","emptyContainer","createWarning","createError","doWhenReady","listenSubmission","$recipeTypeSelector","userRecipeDescription","everyoneRecipeDescription","cantChangeLaterNotice","form","submitButton","showError","errorDidNotSelectType","saveRecipeType","errorTryingToSaveOtherValue","$triggersMetaboxTitle","triggersMetaboxTitle","userTriggers","everyoneTrigger","errorSomethingWentWrong","errorMessage","$error","$oldErrorContainer","saveData","includeGroupIcon","includeGroupTokens","tokensRegEx","tokensRegExNoAttributes","getAllTokens","tokensList","commonTokens","getCommonTokens","advancedTokens","getAdvancedTokens","itemsTokens","getItemsTokens","common","siteName","cacheable","userID","userUsername","userFirstName","userLastName","userEmail","userDisplay","userResetPassLink","adminEmail","siteUrl","recipeName","currentDate","currentTime","advanced","autoLoginLink","getItemTokens","tokensGroup","rowIndex","rowNumber","tokenIdentifier","getTokenDataByID","cache","cloneNode","$tokenName","$tokenIcon","originalTokenID","locatedToken","currentToken","textWithTokens","hasTemplate","tokenHTML","itemElement","optionsGroupElements","validateChildren","isFormValid","each","radioInput","selectedRadio","field_type","fieldTypes","messages","invalid","textarea","int","multipleTokens","float","multiple","checkbox","radio","time","invalidType","$formElement","tokensInString","$childrenFields","customValidation","int_regex","getTokensFromString","hasTokens","simulate_float","float_regex","simulate_email","email_regex","emails","allEmailsAreValid","hasMultipleEmails","hasMultipleVariables","validateURL","parseURL","simulatedURL","$error_container","regex","allTokens","matchedToken","tokenGroup","replaceTokensInString","output","regexCondition","full_match","getExampleValueByFieldType","changed","newURL","regexURL","tokensInValue","simulate_url","checkURL","$this","input_attributes","validationNotice","validationNoticeHeader","validationNoticeURL","preURL","TypeError","addData","h5s","stores","Map","Store","_config","_placeholder","_data","mergedConfig","enumerable","configurable","setConfig","getConfig","deleteData","delete","store","sortableElement","eventName","addAttribute","attribute","dragging","draggingHeight","draggingWidth","originContainer","originIndex","originElementIndex","originItemsBeforeUpdate","previousContainer","destinationItemsBeforeUpdate","parentElement","getClientRects","rect","getIndex","elementList","isInDom","insertNode","referenceNode","newElement","nextElementSibling","getElementHeight","getComputedStyle","getPropertyValue","sum","getElementWidth","getHandles","shadowRoot","defaultDragImage","draggedElement","elementOffset","posX","pageX","posY","pageY","listsConnected","origin","isSortable","acceptFrom","sel","defaultConfiguration","connectWith","disableIEFix","copy","placeholderClass","draggingClass","hoverClass","dropTargetContainerClass","throttleTime","maxItems","containerSerializer","customDragImage","orientation","enableHoverClass","hoverClasses_1","threshold","_this","lastEventTimestamp","_i","_b","removeItemEvents","removeContainerEvents","removeSortableData","removeItemData","findSortable","findDragElement","itemlist","ele","enableSortable","handles","parent","sortableElements","customItemSerializer","customContainerSerializer","serializedContainer","serializedItems","itemCount","serialize","configKey","hasOwnProperty","reloadSortable","customPlaceholder","listItems","tempContainer","tagName","makePlaceholder","stopImmediatePropagation","dragItem","Event","dataTransfer","setDragImage","dragImage","effectAllowed","draggedItem","ditem","oldDisplay","getDragging","CustomEvent","elementIndex","originalTarget","itemsBeforeUpdate","outTarget","fromElement","visiblePlaceholder","originItems","destinationContainer","destinationItems","destinationElementIndex","destinationIndex","debouncedDragOverEnter","thisHeight","thisWidth","placeholderIndex","thisIndex","deadZoneVertical","deadZoneHorizontal","offsetTop","offsetLeft","placeAfter","elementMiddleVertical","elementMiddleHorizontal","placeholders","onDragOverEnter","dropEffect","destroySortable","disableSortable","__testing","module","exports","S2","requirejs","define","undef","main","req","makeMap","handlers","defined","waiting","defining","hasOwn","aps","jsSuffixRegExp","hasProp","normalize","baseName","nameParts","nameSegment","mapValue","foundMap","lastIndex","foundI","foundStarMap","starI","baseParts","starMap","nodeIdCompat","makeRequire","relName","forceSync","makeLoad","depName","callDep","splitPrefix","prefix","makeRelParts","makeConfig","relParts","plugin","relResourceName","f","pr","p","uri","deps","cjsModule","ret","usingExports","callbackType","load","alt","cfg","_defined","_$","Utils","getMethods","theClass","proto","methods","methodName","Extend","ChildClass","SuperClass","__hasProp","BaseConstructor","constructor","__super__","Decorate","DecoratorClass","decoratedMethods","superMethods","DecoratedClass","unshift","argCount","calledConstructor","superMethod","calledMethod","originalMethod","decoratedMethod","Observable","listeners","params","invoke","len","generateChars","chars","context","_convertData","originalKey","dataLevel","hasScroll","$el","overflowX","overflowY","scrollHeight","scrollWidth","markup","replaceMap","__cache","GetUniqueElementId","select2Id","StoreData","GetData","RemoveData","copyNonInternalCssClasses","dest","src","destinationClasses","clazz","sourceClasses","replacements","Results","dataAdapter","$results","displayMessage","hideLoading","$message","hideMessages","$options","results","$option","$dropdown","sorter","highlightFirstItem","$selected","ensureHighlightVisible","setClasses","selectedIds","showLoading","loading","loadingMore","$loading","attrs","Element","msMatchesSelector","webkitMatchesSelector","_resultId","$children","$child","$childrenContainer","$highlighted","getHighlightedResults","currentIndex","nextIndex","$next","eq","currentOffset","nextTop","nextOffset","nextBottom","mousewheel","deltaY","isAtTop","isAtBottom","originalEvent","offsetDelta","BACKSPACE","TAB","ENTER","SHIFT","CTRL","ALT","ESC","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN","DELETE","KEYS","BaseSelection","$selection","_tabindex","resultsId","_handleBlur","update","_attachCloseHandler","_detachCloseHandler","$select","isDisabled","SingleSelection","selectionContainer","selection","formatted","MultipleSelection","$selections","selectionIdPrefix","selectionId","removeItem","$remove","Placeholder","decorated","normalizePlaceholder","createPlaceholder","$placeholder","placeholderTitle","singlePlaceholder","AllowClear","_handleClear","_handleKeyboardClear","$clear","previousVal","unselectData","prevented","removeAll","Search","searchLabel","$searchContainer","_transferTabIndex","resizeSearch","_keyUpPrevented","isDefaultPrevented","$previousChoice","searchRemoveChoice","msie","documentMode","disableInputEvents","handleSearch","searchHadFocus","term","SelectionCSS","selectionCssClass","EventRelay","relayEvents","preventableEvents","Translation","dict","all","translation","_cache","loadPath","translations","BaseAdapter","generateResultId","SelectAdapter","selectedElement","currentData","unselect","addOptions","innerText","normalizedData","_normalizeItem","matcher","ArrayAdapter","_dataToConvert","convertToOptions","elm","$existing","existingIds","onlyItem","$existingOption","existingData","newData","$newOption","AjaxAdapter","ajaxOptions","_applyDefaults","processResults","q","transport","failure","$request","ajax","then","_request","abort","request","_queryTimeout","Tags","tags","createTag","insertTag","_removeOldTags","page","checkChildren","toUpperCase","Tokenizer","tokenizer","tokenData","separators","termChar","MinimumInputLength","$e","minimumInputLength","minimum","MaximumInputLength","maximumInputLength","maximum","MaximumSelectionLength","maximumSelectionLength","_checkIfMaximumSelected","successCallback","count","Dropdown","showSearch","HidePlaceholder","removePlaceholder","modifiedData","InfiniteScroll","lastParams","$loadingMore","createLoadingMore","showLoadingMore","loadMoreIfNeeded","isLoadMoreVisible","loadMore","pagination","more","AttachBody","$dropdownParent","_showDropdown","_attachPositioningHandler","_bindContainerResultHandlers","_hideDropdown","_detachPositioningHandler","$dropdownContainer","detach","_containerResultsHandlersBound","_positionDropdown","_resizeDropdown","scrollEvent","resizeEvent","orientationEvent","$watchers","scrollLeft","isCurrentlyAbove","isCurrentlyBelow","newDirection","viewport","enoughRoomAbove","enoughRoomBelow","$offsetParent","offsetParent","parentOffset","isConnected","minWidth","countResults","MinimumResultsForSearch","minimumResultsForSearch","SelectOnClose","_handleSelectOnClose","originalSelect2Event","$highlightedResults","CloseOnSelect","_selectTriggered","metaKey","DropdownCSS","dropdownCssClass","TagsSearchHighlight","$firstOption","firstElement","errorLoading","inputTooLong","overChars","inputTooShort","maximumSelected","searching","removeAllItems","ResultsList","SelectionSearch","DIACRITICS","SelectData","ArrayData","AjaxData","DropdownSearch","EnglishTranslation","reset","tokenSeparators","resultsAdapter","selectOnClose","dropdownAdapter","SearchableDropdown","selectionAdapter","allowClear","_resolveLanguage","uniqueLanguages","_processTranslations","debug","stripDiacritics","amdLanguageBase","autocomplete","dropdownAutoWidth","original","scrollAfterSelect","applyFromElement","optionLanguage","defaultLanguage","elementLanguage","parentLanguage","languages","isEmptyObject","isPlainObject","resolvedLanguages","baseLanguage","languageData","ex","camelCase","convertedData","Options","excludedData","dir","upperCaseLetter","letter","attributeName","dataName","dataValue","jquery","Select2","_generateId","DataAdapter","_placeContainer","SelectionAdapter","DropdownAdapter","ResultsAdapter","_bindAdapters","_registerDomEvents","_registerDataEvents","_registerSelectionEvents","_registerDropdownEvents","_registerResultsEvents","_registerEvents","initialData","_syncAttributes","_resolveWidth","WIDTH","styleWidth","elementWidth","_syncA","_syncS","_syncSubtree","_observer","MutationObserver","mutations","observe","childList","subtree","nonRelayEvents","toggleDropdown","altKey","_isChangeMutation","addedNodes","removedNodes","mutation","actualTrigger","preTriggerMap","preTriggerName","preTriggerArgs","hasFocus","newVal","disconnect","removeData","thisMethods","instanceOptions","re","not_string","not_bool","not_type","not_primitive","numeric_arg","json","not_json","modulo","key_access","index_access","sign","sprintf","sprintf_format","sprintf_parse","fmt","argv","parse_tree","arg","ph","pad_character","pad_length","is_positive","cursor","tree_length","param_no","Function","fromCharCode","precision","toExponential","toPrecision","valueOf","pad_char","repeat","sprintf_cache","_fmt","arg_names","SyntaxError","field_list","replacement_field","field_match","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","o","SendFeedback","sendFeedback","utmBtnParameters","utmSource","RecipeTitle","publishedTitle","createStatus","bindChanges","notSavedAlert","uapContainer","saving","savingIcon","savingText","saved","savedIcon","savedText","stop","typingTimeout","setStatusSaving","updateTitle","post_title","getTitle","setStatusSaved","revertChanges","Categories","hasMetabox","listenCheckboxes","$allCategoriesList","saveCategory","addedNode","checkboxData","setStatus","term_id","category_id","set_category","revertCheckboxValue","tagsTextarea","listenModificationsToTags","tagsList","saveTags","getTags","exceptions","couldNotSave","tagsCommaSeparated","asArray","commaSeparated","Taxonomies","uiCantLoad"],"sourceRoot":""}