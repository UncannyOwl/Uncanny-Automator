(()=>{var __webpack_modules__={619:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var a=n(609),i=n.n(a),o=n(179),r=n(378),s=n(276);function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),UncannyAutomator.recipe.userSelector.step=(0,o.Cn)("get-step"),this.render()}var t,n;return t=e,(n=[{key:"render",value:function(){var e="";switch(UncannyAutomator.recipe.userSelector.step){case"select-source":UncannyAutomator.recipe.userSelector.isValid=!1,(0,o.Tm)("validate"),e=this.getSelectSourceNodes();break;case"set-options":e=this.getOptionsNodes();break;case"show-sentence":(0,o.Tm)("validate"),UncannyAutomator.recipe.errorMode=!1,new s.Z,e=this.getSentenceNodes()}var t=(0,o.M0)("metabox",{type:"action"});console.log("%cRender User Selector","background: red; color: #fff; padding: 2px 10px;"),t.prepend(e)}},{key:"getSelectSourceNodes",value:function(){var e=i()('\n\t\t\t<div class="user-selector '.concat(UncannyAutomator.recipe.requiresUserData?"user-selector--show":"",'">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-integrations">\n\t\t\t\t\t\t\t<div class="item-integration user-selector-option user-selector-option--existing-user" data-source="existingUser">\n\t\t\t\t\t\t\t\t<div class="item-integration__logo"></div>\n\t\t\t\t\t\t\t\t<div class="item-integration__name">\n\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.userSelector.userType.existing,'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-integration user-selector-option user-selector-option--new-user" data-source="newUser">\n\t\t\t\t\t\t\t\t<div class="item-integration__logo"></div>\n\t\t\t\t\t\t\t\t<div class="item-integration__name">\n\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.userSelector.userType.new,"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t"));return e.find(".item").prepend(this.getHeaderNodes()),e.find(".user-selector-option").on("click",(function(e){var t=i()(e.currentTarget).data("source");(0,o.Cn)("set-source",{source:t}),UncannyAutomator.recipe.userSelector.step="set-options",new k})),e}},{key:"getOptionsNodes",value:function(){var e=i()('\n\t\t\t<div class="user-selector '.concat(UncannyAutomator.recipe.requiresUserData?"user-selector--show":"",'">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-options"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'));return e.find(".item").prepend(this.getHeaderNodes()),e.find(".item-options").append(this.getOptionsFields()),e}},{key:"getOptionsFields",value:function(){var e=i()("<div></div>"),t=i()('<div class="item-options__group"></div>'),n=[];(0,o.Cn)("update-fields",{source:"existingUser",data:{}}),(0,o.Cn)("update-fields",{source:"newUser",data:{}});var a=UncannyAutomator.recipe.userSelector.resources.roles;switch(delete a.administrator,UncannyAutomator.recipe.userSelector.source){case"existingUser":var s=i()('<div class="user-selector__field-group user-selector__field-group--two-columns"></div>'),c=new r.Z("select",{itemType:"user-selector",optionCode:"uniqueField",label:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldLabel,currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.uniqueField,isRequired:!0,options:[{value:"email",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionEmail},{value:"id",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionId},{value:"username",text:UncannyAutomator.i18n.userSelector.existingUser.uniqueFieldOptionUsername}]});n.push(c);var l=new r.Z("text",{itemType:"user-selector",optionCode:"uniqueFieldValue",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.uniqueFieldValue,label:UncannyAutomator.i18n.userSelector.existingUser.valueFieldLabel,isRequired:!0,supportsTokens:!0});n.push(l);var u=c.getFormElement();l.initTokenSelector(),l.initCodeMirror(),s.append(u);var d=l.getFormElement();s.append(d),t.append(s);var p=new r.Z("radio",{itemType:"user-selector",optionCode:"fallback",name:"user-selector-existing-user-fallback",label:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldLabel,isRequired:!0,currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.fallback,options:[{value:"create-new-user",text:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionCreateUser},{value:"do-nothing",text:UncannyAutomator.i18n.userSelector.existingUser.createNewUserFieldOptionDoNothing}]});n.push(p);var m=p.getFormElement();if(t.append(m),u.on("automator:field:change",(function(){(0,o.Cn)("update-fields",{source:"existingUser",data:{uniqueField:c.getValue()}})})),d.on("automator:field:change",(function(){(0,o.Cn)("update-fields",{source:"existingUser",data:{uniqueFieldValue:l.getValue()}})})),m.on("automator:field:change",(function(){(0,o.Cn)("update-fields",{source:"existingUser",data:{fallback:p.getValue()}}),new k})),"do-nothing"==UncannyAutomator.recipe.userSelector.data.existingUser.fallback){var f=i()('\n\t\t\t\t\t\t<div class="user-selector__warning">\n\t\t\t\t\t\t\t'.concat(UncannyAutomator.i18n.userSelector.existingUser.doNothingMessage,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"));t.append(f)}else if("create-new-user"==UncannyAutomator.recipe.userSelector.data.existingUser.fallback){var h=i()("<div/>",{class:"item-options"});[{itemType:"user-selector",fieldType:"text",optionCode:"firstName",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.firstName,label:UncannyAutomator.i18n.userSelector.newUser.firstName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"lastName",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.lastName,label:UncannyAutomator.i18n.userSelector.newUser.lastName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"email",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.email,label:UncannyAutomator.i18n.userSelector.newUser.email,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"username",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.username,label:UncannyAutomator.i18n.userSelector.newUser.username,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"displayName",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.displayName,label:UncannyAutomator.i18n.userSelector.newUser.displayName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"password",currentValue:UncannyAutomator.recipe.userSelector.data.existingUser.password,label:UncannyAutomator.i18n.userSelector.newUser.password,description:UncannyAutomator.i18n.userSelector.newUser.passwordDescription,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"select",optionCode:"role",currentValue:(0,o.xb)(UncannyAutomator.recipe.userSelector.data.existingUser.role)?"subscriber":UncannyAutomator.recipe.userSelector.data.existingUser.role,label:UncannyAutomator.i18n.userSelector.newUser.role,isRequired:!0,supportsTokens:!1,options:Object.keys(a).map((function(e,t){return{value:e,text:a[e]}}))},{itemType:"user-selector",fieldType:"radio",optionCode:"logUserIn",name:"logUserIn",currentValue:UncannyAutomator.recipe.canLogNewUserIn?(0,o.xb)(UncannyAutomator.recipe.userSelector.data.existingUser.logUserIn)?"no":UncannyAutomator.recipe.userSelector.data.existingUser.logUserIn:"no",isHidden:!UncannyAutomator.recipe.canLogNewUserIn,label:UncannyAutomator.i18n.userSelector.logUserIn,supportsTokens:!1,options:[{value:"yes",text:UncannyAutomator.i18n.yes},{value:"no",text:UncannyAutomator.i18n.no}]}].forEach((function(e){var t=new r.Z(e.fieldType,e),a=t.getFormElement();h.append(a),t.initTokenSelector(),t.initCodeMirror(),n.push(t)})),t.append(h)}break;case"newUser":[{itemType:"user-selector",fieldType:"text",optionCode:"firstName",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.firstName,label:UncannyAutomator.i18n.userSelector.newUser.firstName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"lastName",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.lastName,label:UncannyAutomator.i18n.userSelector.newUser.lastName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"email",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.email,label:UncannyAutomator.i18n.userSelector.newUser.email,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"username",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.username,label:UncannyAutomator.i18n.userSelector.newUser.username,isRequired:!0,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"displayName",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.displayName,label:UncannyAutomator.i18n.userSelector.newUser.displayName,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"text",optionCode:"password",currentValue:UncannyAutomator.recipe.userSelector.data.newUser.password,label:UncannyAutomator.i18n.userSelector.newUser.password,description:UncannyAutomator.i18n.userSelector.newUser.passwordDescription,isRequired:!1,supportsTokens:!0},{itemType:"user-selector",fieldType:"select",optionCode:"role",currentValue:(0,o.xb)(UncannyAutomator.recipe.userSelector.data.newUser.role)?"subscriber":UncannyAutomator.recipe.userSelector.data.newUser.role,label:UncannyAutomator.i18n.userSelector.newUser.role,isRequired:!0,supportsTokens:!1,options:Object.keys(a).map((function(e,t){return{value:e,text:a[e]}}))},{itemType:"user-selector",fieldType:"radio",optionCode:"logUserIn",name:"logUserIn",currentValue:UncannyAutomator.recipe.canLogNewUserIn?(0,o.xb)(UncannyAutomator.recipe.userSelector.data.newUser.logUserIn)?"no":UncannyAutomator.recipe.userSelector.data.newUser.logUserIn:"no",isHidden:!UncannyAutomator.recipe.canLogNewUserIn,label:UncannyAutomator.i18n.userSelector.logUserIn,supportsTokens:!1,options:[{value:"yes",text:UncannyAutomator.i18n.yes},{value:"no",text:UncannyAutomator.i18n.no}]}].forEach((function(e){var a=new r.Z(e.fieldType,e),i=a.getFormElement();t.append(i),a.initTokenSelector(),a.initCodeMirror(),n.push(a)}));var g=new r.Z("radio",{itemType:"user-selector",optionCode:"fallback",name:"user-selector-new-user-fallback",label:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldLabel,isRequired:!0,currentValue:UncannyAutomator.recipe.userSelector.data.newUser.fallback,options:[{value:"select-existing-user",text:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionExisting},{value:"do-nothing",text:UncannyAutomator.i18n.userSelector.newUser.existingUserFieldOptionDoNothing}]});n.push(g);var y=g.getFormElement();if(t.append(y),y.on("automator:field:change",(function(){var e={};n.forEach((function(t){e[t.getAttributes().optionCode]=t.getValue()})),(0,o.Cn)("update-fields",{source:"newUser",data:e}),new k})),"do-nothing"==UncannyAutomator.recipe.userSelector.data.newUser.fallback){var v=i()('\n\t\t\t\t\t\t<div class="user-selector__warning">\n\t\t\t\t\t\t\t'.concat(UncannyAutomator.i18n.userSelector.newUser.doNothingMessage,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t"));t.append(v)}else if("select-existing-user"==UncannyAutomator.recipe.userSelector.data.newUser.fallback){var _=i()("<div/>",{class:"item-options"}),b=new r.Z("select",{itemType:"user-selector",optionCode:"prioritizedField",label:UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldLabel,currentValue:UncannyAutomator.recipe.userSelector.data.newUser.prioritizedField,defaultValue:"email",description:UncannyAutomator.i18n.userSelector.newUser.prioritizedFieldDescription,isRequired:!0,options:[{value:"email",text:UncannyAutomator.i18n.userSelector.newUser.email},{value:"username",text:UncannyAutomator.i18n.userSelector.newUser.username}]});n.push(b);var w=b.getFormElement();_.append(w),t.append(_)}}UncannyAutomator.recipe.userSelector.fields=n,e.append(t);var A=i()('<div class="item-options__buttons"></div>'),C=i()('<div class="uap-btn uap-btn--primary">'.concat(UncannyAutomator.i18n.save,"</div>")),U=i()('<div class="uap-btn uap-btn--secondary">'.concat(UncannyAutomator.i18n.cancel,"</div>"));return C.on("click",(function(){var e=!0,t={};n.forEach((function(n){var a=n.validate().isValid;e=e&&a,a&&(t[n.getAttributes().optionCode]=n.getValue())})),(0,o.Cn)("update-fields",{source:UncannyAutomator.recipe.userSelector.source,data:t}),e&&(C.addClass("uap-btn--primary uap-btn--loading uap-btn--disabled"),(0,o.L8)("user-selector",{recipeId:UncannyAutomator.recipe.id,source:UncannyAutomator.recipe.userSelector.source,data:UncannyAutomator.recipe.userSelector.data[UncannyAutomator.recipe.userSelector.source]},(function(e){UncannyAutomator.recipe.userSelector.isValid=!0,(0,o.Cn)("set-step",{step:"show-sentence"}),new k}),(function(e){})))})),U.on("click",(function(){(0,o.Cn)("set-step",{step:"select-source"}),new k})),A.append(C),A.append(U),e.append(A),e}},{key:"getSentenceNodes",value:function(){var e=i()('\n\t\t\t<div class="user-selector user-selector--summary '.concat(UncannyAutomator.recipe.requiresUserData?"user-selector--show":"",'">\n\t\t\t\t<div class="item item--user-selector">\n\t\t\t\t\t<div class="item__content">\n\t\t\t\t\t\t<div class="item-options">\n\t\t\t\t\t\t\t<div class="user-selector-summary"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'));e.find(".item").prepend(this.getHeaderNodes());var t=e.find(".user-selector-summary"),n=i()('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--atom"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t'),a=i()('\n\t\t\t<div class="user-selector-summary-row__token"></div>\n\t\t');n.find(".user-selector-summary-row__content").append(a),"existingUser"==UncannyAutomator.recipe.userSelector.source?a.text(UncannyAutomator.i18n.userSelector.userType.existing):"newUser"==UncannyAutomator.recipe.userSelector.source&&a.text(UncannyAutomator.i18n.userSelector.userType.new),a.on("click",(function(){(0,o.Cn)("set-step",{step:"select-source"}),new k})),t.append(n);var r,s=i()('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--fingerprint"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t');"existingUser"==UncannyAutomator.recipe.userSelector.source?r=i()("\n\t\t\t\t<div>\n\t\t\t\t".concat((0,o.qi)(UncannyAutomator.i18n.userSelector.summary.matches,['<div class="user-selector-summary-row__token">'.concat(UncannyAutomator.i18n.userSelector.summary[UncannyAutomator.recipe.userSelector.data.existingUser.uniqueField],"</div>"),'<div class="user-selector-summary-row__token">'.concat(UncannyAutomator.recipe.userSelector.data.existingUser.uniqueFieldValue,"</div>")]),"\n\t\t\t\t</div>")):"newUser"==UncannyAutomator.recipe.userSelector.source&&(r=i()("\n\t\t\t\t<div>\n\t\t\t\t".concat((0,o.qi)(UncannyAutomator.i18n.userSelector.summary.withEmail,['<div class="user-selector-summary-row__token">'.concat(UncannyAutomator.recipe.userSelector.data.newUser.email,"</div>")]),"\n\t\t\t\t</div>\n\t\t\t\t"))),s.find(".user-selector-summary-row__content").append(r),r.find(".user-selector-summary-row__token").on("click",(function(){(0,o.Cn)("set-step",{step:"set-options"}),new k})),t.append(s);var c=i()('\n\t\t\t<div class="user-selector-summary-row">\n\t\t\t\t<div class="user-selector-summary-row__icon">\n\t\t\t\t\t<span class="uo-icon uo-icon--directions"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="user-selector-summary-row__content"></div>\n\t\t\t</div>\n\t\t'),l="";"existingUser"==UncannyAutomator.recipe.userSelector.source?"create-new-user"==UncannyAutomator.recipe.userSelector.data.existingUser.fallback?l=UncannyAutomator.i18n.userSelector.summary.createNewUser:"do-nothing"==UncannyAutomator.recipe.userSelector.data.existingUser.fallback&&(l=UncannyAutomator.i18n.userSelector.summary.doNothing):"newUser"==UncannyAutomator.recipe.userSelector.source&&("select-existing-user"==UncannyAutomator.recipe.userSelector.data.newUser.fallback?l=UncannyAutomator.i18n.userSelector.summary.selectExistingUser:"do-nothing"==UncannyAutomator.recipe.userSelector.data.newUser.fallback&&(l=UncannyAutomator.i18n.userSelector.summary.doNothing));var u=i()("\n\t\t\t<div>\n\t\t\t".concat((0,o.qi)(UncannyAutomator.i18n.userSelector.summary.otherwise,['<div class="user-selector-summary-row__token">'.concat(l,"</div>")]),"\n\t\t\t</div>"));return c.find(".user-selector-summary-row__content").append(u),c.find(".user-selector-summary-row__token").on("click",(function(){(0,o.Cn)("set-step",{step:"set-options"}),new k})),t.append(c),e}},{key:"getHeaderNodes",value:function(){var e;switch(UncannyAutomator.recipe.userSelector.step){case"select-source":case"show-sentence":e=UncannyAutomator.i18n.userSelector.sentenceTitle;break;case"set-options":e=UncannyAutomator.i18n.userSelector.setOptions}var t=i()('\n\t\t\t<div>\n\t\t\t\t<div class="item-actions">\n\t\t\t\t\t<div class="item-actions__btn">\n\t\t\t\t\t\t<i class="uo-icon uo-icon--ellipsis-h-alt"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="item-actions__dropdown">\n\t\t\t\t\t\t<ul class="item-actions-dropdown__ul">\n\t\t\t\t\t\t\t<a href="'.concat((0,o.hl)("https://automatorplugin.com/knowledge-base/anonymous-recipes/#Introducing_the_User_Selector",{utm_source:"uncanny_automator_pro",utm_medium:"user_selector",utm_content:"support_menu_link"}),'" target="_blank" class="item-actions-dropdown__action">\n\t\t\t\t\t\t\t\t<span>').concat(UncannyAutomator.i18n.support,'</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="item-icon"></div>\n\t\t\t\t<div class="item-title uap-clear">\n\t\t\t\t\t<div class="item-title__describe">\n\t\t\t\t\t\t<div class="item-title__non-editable">\n\t\t\t\t\t\t\t').concat(e,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t")),n=t.find(".item-actions");return t.find(".item-actions__btn").on("click",(function(){n.hasClass("item-actions--open")?(n.removeClass("item-actions--open"),i()(document).off("mouseup.uap-actions-click-outside")):(n.addClass("item-actions--open"),i()(document).on("mouseup.uap-actions-click-outside",(function(e){n.is(e.target)||0!==n.has(e.target).length||(n.removeClass("item-actions--open"),i()(document).off("mouseup.uap-actions-click-outside"))})))})),t}}])&&c(t.prototype,n),e}();var u=n(849),d=n(234),p=n(156);const m=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=i()("<div/>",{class:"item item--start"}),a=i()("<div/>",{class:"item-icon"}),r=i()("<div/>",{class:"item-title uap-clear"}),s=i()("<div/>",{class:"uap-btn uap-btn--secondary uap-btn--small"});r.append(s),n.append(a),n.append(r),(0,o.M0)("metabox",{type:t}).append(n),"trigger"==t&&s.text(UncannyAutomator.i18n.trigger.add),"action"==t&&s.text(UncannyAutomator.i18n.action.add),s.on("click",(function(){return new p.Z(t)}))};var f=n(842),h=n(181),g=n(751),y=n(765);function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const _=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements={$metabox:(0,o.M0)("metabox",{type:"action"})},i().each(UncannyAutomator.closures,(function(e,a){return n.createClosure(a,t)}))}var t,n;return t=e,(n=[{key:"createClosure",value:function(e,t){var n=!1,a=i()("<div/>",{class:"metabox__footer metabox__closures"}),s={label:t,formElementClass:"form-element--nomargin"},c=this.getClosureByCodeFromItemsObject(e.code);(0,o.$K)(c)&&(n=!0,s.currentValue=!0,s.itemid=c.id);var l=new r.Z("checkbox",s),u=l.getFormElement();u.on("change",(function(){var t=l.getValue();l.startLoadingAnimation(),t?(0,o.L8)("add",{recipePostID:UncannyAutomator.recipe.id,action:"add-new-closure",item_code:e.code,default_meta:{integration_name:UncannyAutomator.integrations[e.integration].name,sentence:e.sentence}},(function(e){new k,(0,o.$K)(e.post_ID)&&(0,o.M0)("item",{id:e.post_ID}).item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")}),(function(e){console.log("‼️ ERROR-TODO. Couldn't add the closure"),l.stopLoadingAnimation(),l.setValue(!1,!1)})):(0,o.L8)("delete",{ID:c.id},(function(){new k}),(function(){console.log("‼️ ERROR-TODO. Couldn't delete the closure"),new k}))})),a.append(u);var d=i()("<div/>",{class:"uo-toggle uo-toggle--show"});if(n){d.addClass("uo-toggle--show");var p=i()("<div/>",{class:"item item--closure item--margintop","data-id":c.id}),m=this.createHeader(UncannyAutomator.recipe.items[c.id].integrationCode,"closure",e.code,c.id);p.append(m);var f=i()("<div/>",{class:"item__content"});p.append(f),d.append(p)}a.append(d),this.elements.$metabox.append(a)}},{key:"createHeader",value:function(e,t,n,a){var o=i()("<div/>"),r=i()("<div/>",{class:"item-title uap-clear"}),s=new f.Z(t,e,n,a);o.append(s);var c=new h.Z(e);o.append(c);var l=new g.Z(e);r.append(l);var u=new y.Z(t,e,n,a);return r.append(u),o.append(r),o}},{key:"getClosureByCodeFromItemsObject",value:function(e){var t;return i().each(UncannyAutomator.recipe.items,(function(n,a){a.itemCode==e&&(t=a)})),t}}])&&v(t.prototype,n),e}();function b(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,o.M0)("metabox",{type:"action"}).empty(),"anonymous"==UncannyAutomator.recipe.type&&new l;var t=(0,o.Wr)("get",{filter:{itemType:"action"}});if(!(0,o.xb)(t)&&(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp){var n=(0,o.p5)(t,"async_mode",!1),a=(0,o.PT)(t,"async_mode","delay"),i=(0,o.PT)(t,"async_mode","schedule");(0,o.xb)(a)&&(0,o.xb)(i)?(new u.Z("action",n),new d.Z("action"),this.isContinuingIntegrationConnection()&&new p.Z("action"),new _(UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly)):((0,o.xb)(n)||new u.Z("action",n),new d.Z("action"),this.isContinuingIntegrationConnection()&&new p.Z("action"),new _(UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly),new u.Z("action",a),new u.Z("action",i))}else(0,o.xb)(t)?(new m("action"),this.isContinuingIntegrationConnection()&&new p.Z("action"),new _(UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly)):(new u.Z("action",t),new d.Z("action"),this.isContinuingIntegrationConnection()&&new p.Z("action"),new _(UncannyAutomator.i18n.action.asyncActions.closuresLabelAsyncOnly))}var t,n;return t=e,(n=[{key:"isContinuingIntegrationConnection",value:function(){return 1==(0,o.Tb)(null,"ua_connecting_integration")&&"action"==(0,o.Tb)(null,"ua_connecting_integration_context")}}])&&b(t.prototype,n),e}()},378:(e,t,n)=>{"use strict";n.d(t,{Z:()=>J});var a=n(609),i=n.n(a);const o=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],r={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>"undefined"!=typeof console&&console.warn(e),getWeek:e=>{const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},s={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{const t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},c=s,l=(e,t=2)=>`000${e}`.slice(-1*t),u=e=>!0===e?1:0;function d(e,t){let n;return function(){clearTimeout(n),n=setTimeout((()=>e.apply(this,arguments)),t)}}const p=e=>e instanceof Array?e:[e];function m(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function f(e,t,n){const a=window.document.createElement(e);return t=t||"",n=n||"",a.className=t,void 0!==n&&(a.textContent=n),a}function h(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function g(e,t){return t(e)?e:e.parentNode?g(e.parentNode,t):void 0}function y(e,t){const n=f("div","numInputWrapper"),a=f("input","numInput "+e),i=f("span","arrowUp"),o=f("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?a.type="number":(a.type="text",a.pattern="\\d*"),void 0!==t)for(const e in t)a.setAttribute(e,t[e]);return n.appendChild(a),n.appendChild(i),n.appendChild(o),n}function v(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(t){return e.target}}const _=()=>{},b=(e,t,n)=>n.months[t?"shorthand":"longhand"][e],k={D:_,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:(e,t)=>{e.setHours(parseFloat(t))},H:(e,t)=>{e.setHours(parseFloat(t))},J:(e,t)=>{e.setDate(parseFloat(t))},K:(e,t,n)=>{e.setHours(e.getHours()%12+12*u(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:(e,t)=>{e.setSeconds(parseFloat(t))},U:(e,t)=>new Date(1e3*parseFloat(t)),W:function(e,t,n){const a=parseInt(t),i=new Date(e.getFullYear(),0,2+7*(a-1),0,0,0,0);return i.setDate(i.getDate()-i.getDay()+n.firstDayOfWeek),i},Y:(e,t)=>{e.setFullYear(parseFloat(t))},Z:(e,t)=>new Date(t),d:(e,t)=>{e.setDate(parseFloat(t))},h:(e,t)=>{e.setHours(parseFloat(t))},i:(e,t)=>{e.setMinutes(parseFloat(t))},j:(e,t)=>{e.setDate(parseFloat(t))},l:_,m:(e,t)=>{e.setMonth(parseFloat(t)-1)},n:(e,t)=>{e.setMonth(parseFloat(t)-1)},s:(e,t)=>{e.setSeconds(parseFloat(t))},u:(e,t)=>new Date(parseFloat(t)),w:_,y:(e,t)=>{e.setFullYear(2e3+parseFloat(t))}},w={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},A={Z:e=>e.toISOString(),D:function(e,t,n){return t.weekdays.shorthand[A.w(e,t,n)]},F:function(e,t,n){return b(A.n(e,t,n)-1,!1,t)},G:function(e,t,n){return l(A.h(e,t,n))},H:e=>l(e.getHours()),J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:(e,t)=>t.amPM[u(e.getHours()>11)],M:function(e,t){return b(e.getMonth(),!0,t)},S:e=>l(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,t,n){return n.getWeek(e)},Y:e=>l(e.getFullYear(),4),d:e=>l(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>l(e.getMinutes()),j:e=>e.getDate(),l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:e=>l(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},C=({config:e=r,l10n:t=s,isMobile:n=!1})=>(a,i,o)=>{const r=o||t;return void 0===e.formatDate||n?i.split("").map(((t,n,i)=>A[t]&&"\\"!==i[n-1]?A[t](a,r,e):"\\"!==t?t:"")).join(""):e.formatDate(a,i,r)},U=({config:e=r,l10n:t=s})=>(n,a,i,o)=>{if(0!==n&&!n)return;const s=o||t;let c;const l=n;if(n instanceof Date)c=new Date(n.getTime());else if("string"!=typeof n&&void 0!==n.toFixed)c=new Date(n);else if("string"==typeof n){const t=a||(e||r).dateFormat,o=String(n).trim();if("today"===o)c=new Date,i=!0;else if(/Z$/.test(o)||/GMT$/.test(o))c=new Date(n);else if(e&&e.parseDate)c=e.parseDate(n,t);else{c=e&&e.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let a,i=[];for(let e=0,o=0,r="";e<t.length;e++){const l=t[e],u="\\"===l,d="\\"===t[e-1]||u;if(w[l]&&!d){r+=w[l];const e=new RegExp(r).exec(n);e&&(a=!0)&&i["Y"!==l?"push":"unshift"]({fn:k[l],val:e[++o]})}else u||(r+=".");i.forEach((({fn:e,val:t})=>c=e(c,t,s)||c))}c=a?c:void 0}}if(c instanceof Date&&!isNaN(c.getTime()))return!0===i&&c.setHours(0,0,0,0),c;e.errorHandler(new Error(`Invalid date provided: ${l}`))};function T(e,t,n=!0){return!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}function x(e){let t=e.defaultHour,n=e.defaultMinute,a=e.defaultSeconds;if(void 0!==e.minDate){const i=e.minDate.getHours(),o=e.minDate.getMinutes(),r=e.minDate.getSeconds();t<i&&(t=i),t===i&&n<o&&(n=o),t===i&&n===o&&a<r&&(a=e.minDate.getSeconds())}if(void 0!==e.maxDate){const i=e.maxDate.getHours(),o=e.maxDate.getMinutes();t=Math.min(t,i),t===i&&(n=Math.min(o,n)),t===i&&n===o&&(a=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:a}}function E(e,t){const n={config:Object.assign(Object.assign({},r),M.defaultConfig),l10n:c};function a(e){return e.bind(n)}function i(){const e=n.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==n.calendarContainer&&(n.calendarContainer.style.visibility="hidden",n.calendarContainer.style.display="block"),void 0!==n.daysContainer){const t=(n.days.offsetWidth+1)*e.showMonths;n.daysContainer.style.width=t+"px",n.calendarContainer.style.width=t+(void 0!==n.weekWrapper?n.weekWrapper.offsetWidth:0)+"px",n.calendarContainer.style.removeProperty("visibility"),n.calendarContainer.style.removeProperty("display")}}))}function s(e){if(0===n.selectedDates.length){const e=void 0===n.config.minDate||T(new Date,n.config.minDate)>=0?new Date:new Date(n.config.minDate.getTime()),t=x(n.config);e.setHours(t.hours,t.minutes,t.seconds,e.getMilliseconds()),n.selectedDates=[e],n.latestSelectedDateObj=e}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();const t="keydown"===e.type,a=v(e),i=a;void 0!==n.amPM&&a===n.amPM&&(n.amPM.textContent=n.l10n.amPM[u(n.amPM.textContent===n.l10n.amPM[0])]);const o=parseFloat(i.getAttribute("min")),r=parseFloat(i.getAttribute("max")),s=parseFloat(i.getAttribute("step")),c=parseInt(i.value,10);let d=c+s*(e.delta||(t?38===e.which?1:-1:0));if(void 0!==i.value&&2===i.value.length){const e=i===n.hourElement,t=i===n.minuteElement;d<o?(d=r+d+u(!e)+(u(e)&&u(!n.amPM)),t&&L(void 0,-1,n.hourElement)):d>r&&(d=i===n.hourElement?d-r-u(!n.amPM):o,t&&L(void 0,1,n.hourElement)),n.amPM&&e&&(1===s?d+c===23:Math.abs(d-c)>s)&&(n.amPM.textContent=n.l10n.amPM[u(n.amPM.textContent===n.l10n.amPM[0])]),i.value=l(d)}}(e);const t=n._input.value;_(),ye(),n._input.value!==t&&n._debouncedChange()}function _(){if(void 0===n.hourElement||void 0===n.minuteElement)return;let e=(parseInt(n.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(n.minuteElement.value,10)||0)%60,a=void 0!==n.secondElement?(parseInt(n.secondElement.value,10)||0)%60:0;var i,o;void 0!==n.amPM&&(i=e,o=n.amPM.textContent,e=i%12+12*u(o===n.l10n.amPM[1]));const r=void 0!==n.config.minTime||n.config.minDate&&n.minDateHasTime&&n.latestSelectedDateObj&&0===T(n.latestSelectedDateObj,n.config.minDate,!0);if(void 0!==n.config.maxTime||n.config.maxDate&&n.maxDateHasTime&&n.latestSelectedDateObj&&0===T(n.latestSelectedDateObj,n.config.maxDate,!0)){const i=void 0!==n.config.maxTime?n.config.maxTime:n.config.maxDate;e=Math.min(e,i.getHours()),e===i.getHours()&&(t=Math.min(t,i.getMinutes())),t===i.getMinutes()&&(a=Math.min(a,i.getSeconds()))}if(r){const i=void 0!==n.config.minTime?n.config.minTime:n.config.minDate;e=Math.max(e,i.getHours()),e===i.getHours()&&t<i.getMinutes()&&(t=i.getMinutes()),t===i.getMinutes()&&(a=Math.max(a,i.getSeconds()))}A(e,t,a)}function k(e){const t=e||n.latestSelectedDateObj;t&&A(t.getHours(),t.getMinutes(),t.getSeconds())}function A(e,t,a){void 0!==n.latestSelectedDateObj&&n.latestSelectedDateObj.setHours(e%24,t,a||0,0),n.hourElement&&n.minuteElement&&!n.isMobile&&(n.hourElement.value=l(n.config.time_24hr?e:(12+e)%12+12*u(e%12==0)),n.minuteElement.value=l(t),void 0!==n.amPM&&(n.amPM.textContent=n.l10n.amPM[u(e>=12)]),void 0!==n.secondElement&&(n.secondElement.value=l(a)))}function E(e){const t=v(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&z(n)}function D(e,t,a,i){return t instanceof Array?t.forEach((t=>D(e,t,a,i))):e instanceof Array?e.forEach((e=>D(e,t,a,i))):(e.addEventListener(t,a,i),void n._handlers.push({remove:()=>e.removeEventListener(t,a)}))}function S(){pe("onChange")}function O(e,t){const a=void 0!==e?n.parseDate(e):n.latestSelectedDateObj||(n.config.minDate&&n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now),i=n.currentYear,o=n.currentMonth;try{void 0!==a&&(n.currentYear=a.getFullYear(),n.currentMonth=a.getMonth())}catch(e){e.message="Invalid date supplied: "+a,n.config.errorHandler(e)}t&&n.currentYear!==i&&(pe("onYearChange"),j()),!t||n.currentYear===i&&n.currentMonth===o||pe("onMonthChange"),n.redraw()}function I(e){const t=v(e);~t.className.indexOf("arrow")&&L(e,t.classList.contains("arrowUp")?1:-1)}function L(e,t,n){const a=e&&v(e),i=n||a&&a.parentNode&&a.parentNode.firstChild,o=me("increment");o.delta=t,i&&i.dispatchEvent(o)}function R(e,t,a,i){const o=G(t,!0),r=f("span","flatpickr-day "+e,t.getDate().toString());return r.dateObj=t,r.$i=i,r.setAttribute("aria-label",n.formatDate(t,n.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===T(t,n.now)&&(n.todayDateElem=r,r.classList.add("today"),r.setAttribute("aria-current","date")),o?(r.tabIndex=-1,fe(t)&&(r.classList.add("selected"),n.selectedDateElem=r,"range"===n.config.mode&&(m(r,"startRange",n.selectedDates[0]&&0===T(t,n.selectedDates[0],!0)),m(r,"endRange",n.selectedDates[1]&&0===T(t,n.selectedDates[1],!0)),"nextMonthDay"===e&&r.classList.add("inRange")))):r.classList.add("flatpickr-disabled"),"range"===n.config.mode&&function(e){return!("range"!==n.config.mode||n.selectedDates.length<2)&&T(e,n.selectedDates[0])>=0&&T(e,n.selectedDates[1])<=0}(t)&&!fe(t)&&r.classList.add("inRange"),n.weekNumbers&&1===n.config.showMonths&&"prevMonthDay"!==e&&a%7==1&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+n.config.getWeek(t)+"</span>"),pe("onDayCreate",r),r}function F(e){e.focus(),"range"===n.config.mode&&ee(e)}function V(e){const t=e>0?0:n.config.showMonths-1,a=e>0?n.config.showMonths:-1;for(let i=t;i!=a;i+=e){const t=n.daysContainer.children[i],a=e>0?0:t.children.length-1,o=e>0?t.children.length:-1;for(let n=a;n!=o;n+=e){const e=t.children[n];if(-1===e.className.indexOf("hidden")&&G(e.dateObj))return e}}}function P(e,t){const a=J(document.activeElement||document.body),i=void 0!==e?e:a?document.activeElement:void 0!==n.selectedDateElem&&J(n.selectedDateElem)?n.selectedDateElem:void 0!==n.todayDateElem&&J(n.todayDateElem)?n.todayDateElem:V(t>0?1:-1);void 0===i?n._input.focus():a?function(e,t){const a=-1===e.className.indexOf("Month")?e.dateObj.getMonth():n.currentMonth,i=t>0?n.config.showMonths:-1,o=t>0?1:-1;for(let r=a-n.currentMonth;r!=i;r+=o){const i=n.daysContainer.children[r],s=a-n.currentMonth===r?e.$i+t:t<0?i.children.length-1:0,c=i.children.length;for(let n=s;n>=0&&n<c&&n!=(t>0?c:-1);n+=o){const a=i.children[n];if(-1===a.className.indexOf("hidden")&&G(a.dateObj)&&Math.abs(e.$i-n)>=Math.abs(t))return F(a)}}n.changeMonth(o),P(V(o),0)}(i,t):F(i)}function $(e,t){const a=(new Date(e,t,1).getDay()-n.l10n.firstDayOfWeek+7)%7,i=n.utils.getDaysInMonth((t-1+12)%12,e),o=n.utils.getDaysInMonth(t,e),r=window.document.createDocumentFragment(),s=n.config.showMonths>1,c=s?"prevMonthDay hidden":"prevMonthDay",l=s?"nextMonthDay hidden":"nextMonthDay";let u=i+1-a,d=0;for(;u<=i;u++,d++)r.appendChild(R(c,new Date(e,t-1,u),u,d));for(u=1;u<=o;u++,d++)r.appendChild(R("",new Date(e,t,u),u,d));for(let i=o+1;i<=42-a&&(1===n.config.showMonths||d%7!=0);i++,d++)r.appendChild(R(l,new Date(e,t+1,i%o),i,d));const p=f("div","dayContainer");return p.appendChild(r),p}function K(){if(void 0===n.daysContainer)return;h(n.daysContainer),n.weekNumbers&&h(n.weekNumbers);const e=document.createDocumentFragment();for(let t=0;t<n.config.showMonths;t++){const a=new Date(n.currentYear,n.currentMonth,1);a.setMonth(n.currentMonth+t),e.appendChild($(a.getFullYear(),a.getMonth()))}n.daysContainer.appendChild(e),n.days=n.daysContainer.firstChild,"range"===n.config.mode&&1===n.selectedDates.length&&ee()}function j(){if(n.config.showMonths>1||"dropdown"!==n.config.monthSelectorType)return;const e=function(e){return!(void 0!==n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&e<n.config.minDate.getMonth()||void 0!==n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()&&e>n.config.maxDate.getMonth())};n.monthsDropdownContainer.tabIndex=-1,n.monthsDropdownContainer.innerHTML="";for(let t=0;t<12;t++){if(!e(t))continue;const a=f("option","flatpickr-monthDropdown-month");a.value=new Date(n.currentYear,t).getMonth().toString(),a.textContent=b(t,n.config.shorthandCurrentMonth,n.l10n),a.tabIndex=-1,n.currentMonth===t&&(a.selected=!0),n.monthsDropdownContainer.appendChild(a)}}function N(){const e=f("div","flatpickr-month"),t=window.document.createDocumentFragment();let a;n.config.showMonths>1||"static"===n.config.monthSelectorType?a=f("span","cur-month"):(n.monthsDropdownContainer=f("select","flatpickr-monthDropdown-months"),n.monthsDropdownContainer.setAttribute("aria-label",n.l10n.monthAriaLabel),D(n.monthsDropdownContainer,"change",(e=>{const t=v(e),a=parseInt(t.value,10);n.changeMonth(a-n.currentMonth),pe("onMonthChange")})),j(),a=n.monthsDropdownContainer);const i=y("cur-year",{tabindex:"-1"}),o=i.getElementsByTagName("input")[0];o.setAttribute("aria-label",n.l10n.yearAriaLabel),n.config.minDate&&o.setAttribute("min",n.config.minDate.getFullYear().toString()),n.config.maxDate&&(o.setAttribute("max",n.config.maxDate.getFullYear().toString()),o.disabled=!!n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear());const r=f("div","flatpickr-current-month");return r.appendChild(a),r.appendChild(i),t.appendChild(r),e.appendChild(t),{container:e,yearElement:o,monthElement:a}}function q(){h(n.monthNav),n.monthNav.appendChild(n.prevMonthNav),n.config.showMonths&&(n.yearElements=[],n.monthElements=[]);for(let e=n.config.showMonths;e--;){const e=N();n.yearElements.push(e.yearElement),n.monthElements.push(e.monthElement),n.monthNav.appendChild(e.container)}n.monthNav.appendChild(n.nextMonthNav)}function B(){n.weekdayContainer?h(n.weekdayContainer):n.weekdayContainer=f("div","flatpickr-weekdays");for(let e=n.config.showMonths;e--;){const e=f("div","flatpickr-weekdaycontainer");n.weekdayContainer.appendChild(e)}return H(),n.weekdayContainer}function H(){if(!n.weekdayContainer)return;const e=n.l10n.firstDayOfWeek;let t=[...n.l10n.weekdays.shorthand];e>0&&e<t.length&&(t=[...t.splice(e,t.length),...t.splice(0,e)]);for(let e=n.config.showMonths;e--;)n.weekdayContainer.children[e].innerHTML=`\n      <span class='flatpickr-weekday'>\n        ${t.join("</span><span class='flatpickr-weekday'>")}\n      </span>\n      `}function W(e,t=!0){const a=t?e:e-n.currentMonth;a<0&&!0===n._hidePrevMonthArrow||a>0&&!0===n._hideNextMonthArrow||(n.currentMonth+=a,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,pe("onYearChange"),j()),K(),pe("onMonthChange"),he())}function Z(e){return!(!n.config.appendTo||!n.config.appendTo.contains(e))||n.calendarContainer.contains(e)}function Y(e){if(n.isOpen&&!n.config.inline){const t=v(e),a=Z(t),i=t===n.input||t===n.altInput||n.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(n.input)||~e.path.indexOf(n.altInput)),o="blur"===e.type?i&&e.relatedTarget&&!Z(e.relatedTarget):!i&&!a&&!Z(e.relatedTarget),r=!n.config.ignoredFocusElements.some((e=>e.contains(t)));o&&r&&(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement&&""!==n.input.value&&void 0!==n.input.value&&s(),n.close(),n.config&&"range"===n.config.mode&&1===n.selectedDates.length&&(n.clear(!1),n.redraw()))}}function z(e){if(!e||n.config.minDate&&e<n.config.minDate.getFullYear()||n.config.maxDate&&e>n.config.maxDate.getFullYear())return;const t=e,a=n.currentYear!==t;n.currentYear=t||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),a&&(n.redraw(),pe("onYearChange"),j())}function G(e,t=!0){var a;const i=n.parseDate(e,void 0,t);if(n.config.minDate&&i&&T(i,n.config.minDate,void 0!==t?t:!n.minDateHasTime)<0||n.config.maxDate&&i&&T(i,n.config.maxDate,void 0!==t?t:!n.maxDateHasTime)>0)return!1;if(!n.config.enable&&0===n.config.disable.length)return!0;if(void 0===i)return!1;const o=!!n.config.enable,r=null!==(a=n.config.enable)&&void 0!==a?a:n.config.disable;for(let e,t=0;t<r.length;t++){if(e=r[t],"function"==typeof e&&e(i))return o;if(e instanceof Date&&void 0!==i&&e.getTime()===i.getTime())return o;if("string"==typeof e){const t=n.parseDate(e,void 0,!0);return t&&t.getTime()===i.getTime()?o:!o}if("object"==typeof e&&void 0!==i&&e.from&&e.to&&i.getTime()>=e.from.getTime()&&i.getTime()<=e.to.getTime())return o}return!o}function J(e){return void 0!==n.daysContainer&&-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&n.daysContainer.contains(e)}function X(e){e.target!==n._input||!(n.selectedDates.length>0||n._input.value.length>0)||e.relatedTarget&&Z(e.relatedTarget)||n.setDate(n._input.value,!0,e.target===n.altInput?n.config.altFormat:n.config.dateFormat)}function Q(t){const a=v(t),i=n.config.wrap?e.contains(a):a===n._input,o=n.config.allowInput,r=n.isOpen&&(!o||!i),c=n.config.inline&&i&&!o;if(13===t.keyCode&&i){if(o)return n.setDate(n._input.value,!0,a===n.altInput?n.config.altFormat:n.config.dateFormat),a.blur();n.open()}else if(Z(a)||r||c){const e=!!n.timeContainer&&n.timeContainer.contains(a);switch(t.keyCode){case 13:e?(t.preventDefault(),s(),se()):ce(t);break;case 27:t.preventDefault(),se();break;case 8:case 46:i&&!n.config.allowInput&&(t.preventDefault(),n.clear());break;case 37:case 39:if(e||i)n.hourElement&&n.hourElement.focus();else if(t.preventDefault(),void 0!==n.daysContainer&&(!1===o||document.activeElement&&J(document.activeElement))){const e=39===t.keyCode?1:-1;t.ctrlKey?(t.stopPropagation(),W(e),P(V(1),0)):P(void 0,e)}break;case 38:case 40:t.preventDefault();const r=40===t.keyCode?1:-1;n.daysContainer&&void 0!==a.$i||a===n.input||a===n.altInput?t.ctrlKey?(t.stopPropagation(),z(n.currentYear-r),P(V(1),0)):e||P(void 0,7*r):a===n.currentYearElement?z(n.currentYear-r):n.config.enableTime&&(!e&&n.hourElement&&n.hourElement.focus(),s(t),n._debouncedChange());break;case 9:if(e){const e=[n.hourElement,n.minuteElement,n.secondElement,n.amPM].concat(n.pluginElements).filter((e=>e)),i=e.indexOf(a);if(-1!==i){const a=e[i+(t.shiftKey?-1:1)];t.preventDefault(),(a||n._input).focus()}}else!n.config.noCalendar&&n.daysContainer&&n.daysContainer.contains(a)&&t.shiftKey&&(t.preventDefault(),n._input.focus())}}if(void 0!==n.amPM&&a===n.amPM)switch(t.key){case n.l10n.amPM[0].charAt(0):case n.l10n.amPM[0].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[0],_(),ye();break;case n.l10n.amPM[1].charAt(0):case n.l10n.amPM[1].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[1],_(),ye()}(i||Z(a))&&pe("onKeyDown",t)}function ee(e){if(1!==n.selectedDates.length||e&&(!e.classList.contains("flatpickr-day")||e.classList.contains("flatpickr-disabled")))return;const t=e?e.dateObj.getTime():n.days.firstElementChild.dateObj.getTime(),a=n.parseDate(n.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,n.selectedDates[0].getTime()),o=Math.max(t,n.selectedDates[0].getTime());let r=!1,s=0,c=0;for(let e=i;e<o;e+=864e5)G(new Date(e),!0)||(r=r||e>i&&e<o,e<a&&(!s||e>s)?s=e:e>a&&(!c||e<c)&&(c=e));for(let i=0;i<n.config.showMonths;i++){const o=n.daysContainer.children[i];for(let i=0,p=o.children.length;i<p;i++){const p=o.children[i],m=p.dateObj.getTime(),f=s>0&&m<s||c>0&&m>c;f?(p.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((e=>{p.classList.remove(e)}))):r&&!f||(["startRange","inRange","endRange","notAllowed"].forEach((e=>{p.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=n.selectedDates[0].getTime()?"startRange":"endRange"),a<t&&m===a?p.classList.add("startRange"):a>t&&m===a&&p.classList.add("endRange"),m>=s&&(0===c||m<=c)&&(u=a,d=t,(l=m)>Math.min(u,d)&&l<Math.max(u,d))&&p.classList.add("inRange")))}}var l,u,d}function te(){!n.isOpen||n.config.static||n.config.inline||oe()}function ne(e){return t=>{const a=n.config[`_${e}Date`]=n.parseDate(t,n.config.dateFormat),i=n.config[`_${"min"===e?"max":"min"}Date`];void 0!==a&&(n["min"===e?"minDateHasTime":"maxDateHasTime"]=a.getHours()>0||a.getMinutes()>0||a.getSeconds()>0),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((e=>G(e))),n.selectedDates.length||"min"!==e||k(a),ye()),n.daysContainer&&(re(),void 0!==a?n.currentYearElement[e]=a.getFullYear().toString():n.currentYearElement.removeAttribute(e),n.currentYearElement.disabled=!!i&&void 0!==a&&i.getFullYear()===a.getFullYear())}}function ae(){return n.config.wrap?e.querySelector("[data-input]"):e}function ie(){"object"!=typeof n.config.locale&&void 0===M.l10ns[n.config.locale]&&n.config.errorHandler(new Error(`flatpickr: invalid locale ${n.config.locale}`)),n.l10n=Object.assign(Object.assign({},M.l10ns.default),"object"==typeof n.config.locale?n.config.locale:"default"!==n.config.locale?M.l10ns[n.config.locale]:void 0),w.K=`(${n.l10n.amPM[0]}|${n.l10n.amPM[1]}|${n.l10n.amPM[0].toLowerCase()}|${n.l10n.amPM[1].toLowerCase()})`,void 0===Object.assign(Object.assign({},t),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr&&void 0===M.defaultConfig.time_24hr&&(n.config.time_24hr=n.l10n.time_24hr),n.formatDate=C(n),n.parseDate=U({config:n.config,l10n:n.l10n})}function oe(e){if("function"==typeof n.config.position)return void n.config.position(n,e);if(void 0===n.calendarContainer)return;pe("onPreCalendarPosition");const t=e||n._positionElement,a=Array.prototype.reduce.call(n.calendarContainer.children,((e,t)=>e+t.offsetHeight),0),i=n.calendarContainer.offsetWidth,o=n.config.position.split(" "),r=o[0],s=o.length>1?o[1]:null,c=t.getBoundingClientRect(),l=window.innerHeight-c.bottom,u="above"===r||"below"!==r&&l<a&&c.top>a,d=window.pageYOffset+c.top+(u?-a-2:t.offsetHeight+2);if(m(n.calendarContainer,"arrowTop",!u),m(n.calendarContainer,"arrowBottom",u),n.config.inline)return;let p=window.pageXOffset+c.left,f=!1,h=!1;"center"===s?(p-=(i-c.width)/2,f=!0):"right"===s&&(p-=i-c.width,h=!0),m(n.calendarContainer,"arrowLeft",!f&&!h),m(n.calendarContainer,"arrowCenter",f),m(n.calendarContainer,"arrowRight",h);const g=window.document.body.offsetWidth-(window.pageXOffset+c.right),y=p+i>window.document.body.offsetWidth,v=g+i>window.document.body.offsetWidth;if(m(n.calendarContainer,"rightMost",y),!n.config.static)if(n.calendarContainer.style.top=`${d}px`,y)if(v){const e=function(){let e=null;for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t];try{n.cssRules}catch(e){continue}e=n;break}return null!=e?e:function(){const e=document.createElement("style");return document.head.appendChild(e),e.sheet}()}();if(void 0===e)return;const t=window.document.body.offsetWidth,a=Math.max(0,t/2-i/2),o=".flatpickr-calendar.centerMost:before",r=".flatpickr-calendar.centerMost:after",s=e.cssRules.length,l=`{left:${c.left}px;right:auto;}`;m(n.calendarContainer,"rightMost",!1),m(n.calendarContainer,"centerMost",!0),e.insertRule(`${o},${r}${l}`,s),n.calendarContainer.style.left=`${a}px`,n.calendarContainer.style.right="auto"}else n.calendarContainer.style.left="auto",n.calendarContainer.style.right=`${g}px`;else n.calendarContainer.style.left=`${p}px`,n.calendarContainer.style.right="auto"}function re(){n.config.noCalendar||n.isMobile||(j(),he(),K())}function se(){n._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(n.close,0):n.close()}function ce(e){e.preventDefault(),e.stopPropagation();const t=g(v(e),(e=>e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")));if(void 0===t)return;const a=t,i=n.latestSelectedDateObj=new Date(a.dateObj.getTime()),o=(i.getMonth()<n.currentMonth||i.getMonth()>n.currentMonth+n.config.showMonths-1)&&"range"!==n.config.mode;if(n.selectedDateElem=a,"single"===n.config.mode)n.selectedDates=[i];else if("multiple"===n.config.mode){const e=fe(i);e?n.selectedDates.splice(parseInt(e),1):n.selectedDates.push(i)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(!1,!1),n.latestSelectedDateObj=i,n.selectedDates.push(i),0!==T(i,n.selectedDates[0],!0)&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime())));if(_(),o){const e=n.currentYear!==i.getFullYear();n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth(),e&&(pe("onYearChange"),j()),pe("onMonthChange")}if(he(),K(),ye(),o||"range"===n.config.mode||1!==n.config.showMonths?void 0!==n.selectedDateElem&&void 0===n.hourElement&&n.selectedDateElem&&n.selectedDateElem.focus():F(a),void 0!==n.hourElement&&void 0!==n.hourElement&&n.hourElement.focus(),n.config.closeOnSelect){const e="single"===n.config.mode&&!n.config.enableTime,t="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(e||t)&&se()}S()}n.parseDate=U({config:n.config,l10n:n.l10n}),n._handlers=[],n.pluginElements=[],n.loadedPlugins=[],n._bind=D,n._setHoursFromDate=k,n._positionCalendar=oe,n.changeMonth=W,n.changeYear=z,n.clear=function(e=!0,t=!0){if(n.input.value="",void 0!==n.altInput&&(n.altInput.value=""),void 0!==n.mobileInput&&(n.mobileInput.value=""),n.selectedDates=[],n.latestSelectedDateObj=void 0,!0===t&&(n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth()),!0===n.config.enableTime){const{hours:e,minutes:t,seconds:a}=x(n.config);A(e,t,a)}n.redraw(),e&&pe("onChange")},n.close=function(){n.isOpen=!1,n.isMobile||(void 0!==n.calendarContainer&&n.calendarContainer.classList.remove("open"),void 0!==n._input&&n._input.classList.remove("active")),pe("onClose")},n._createElement=f,n.destroy=function(){void 0!==n.config&&pe("onDestroy");for(let e=n._handlers.length;e--;)n._handlers[e].remove();if(n._handlers=[],n.mobileInput)n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=void 0;else if(n.calendarContainer&&n.calendarContainer.parentNode)if(n.config.static&&n.calendarContainer.parentNode){const e=n.calendarContainer.parentNode;if(e.lastChild&&e.removeChild(e.lastChild),e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}else n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput),n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((e=>{try{delete n[e]}catch(e){}}))},n.isEnabled=G,n.jumpToDate=O,n.open=function(e,t=n._positionElement){if(!0===n.isMobile){if(e){e.preventDefault();const t=v(e);t&&t.blur()}return void 0!==n.mobileInput&&(n.mobileInput.focus(),n.mobileInput.click()),void pe("onOpen")}if(n._input.disabled||n.config.inline)return;const a=n.isOpen;n.isOpen=!0,a||(n.calendarContainer.classList.add("open"),n._input.classList.add("active"),pe("onOpen"),oe(t)),!0===n.config.enableTime&&!0===n.config.noCalendar&&(!1!==n.config.allowInput||void 0!==e&&n.timeContainer.contains(e.relatedTarget)||setTimeout((()=>n.hourElement.select()),50))},n.redraw=re,n.set=function(e,t){if(null!==e&&"object"==typeof e){Object.assign(n.config,e);for(const t in e)void 0!==le[t]&&le[t].forEach((e=>e()))}else n.config[e]=t,void 0!==le[e]?le[e].forEach((e=>e())):o.indexOf(e)>-1&&(n.config[e]=p(t));n.redraw(),ye(!0)},n.setDate=function(e,t=!1,a=n.config.dateFormat){if(0!==e&&!e||e instanceof Array&&0===e.length)return n.clear(t);ue(e,a),n.latestSelectedDateObj=n.selectedDates[n.selectedDates.length-1],n.redraw(),O(void 0,t),k(),0===n.selectedDates.length&&n.clear(!1),ye(t),t&&pe("onChange")},n.toggle=function(e){if(!0===n.isOpen)return n.close();n.open(e)};const le={locale:[ie,H],showMonths:[q,i,B],minDate:[O],maxDate:[O],clickOpens:[()=>{!0===n.config.clickOpens?(D(n._input,"focus",n.open),D(n._input,"click",n.open)):(n._input.removeEventListener("focus",n.open),n._input.removeEventListener("click",n.open))}]};function ue(e,t){let a=[];if(e instanceof Array)a=e.map((e=>n.parseDate(e,t)));else if(e instanceof Date||"number"==typeof e)a=[n.parseDate(e,t)];else if("string"==typeof e)switch(n.config.mode){case"single":case"time":a=[n.parseDate(e,t)];break;case"multiple":a=e.split(n.config.conjunction).map((e=>n.parseDate(e,t)));break;case"range":a=e.split(n.l10n.rangeSeparator).map((e=>n.parseDate(e,t)))}else n.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(e)}`));n.selectedDates=n.config.allowInvalidPreload?a:a.filter((e=>e instanceof Date&&G(e,!1))),"range"===n.config.mode&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime()))}function de(e){return e.slice().map((e=>"string"==typeof e||"number"==typeof e||e instanceof Date?n.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:n.parseDate(e.from,void 0),to:n.parseDate(e.to,void 0)}:e)).filter((e=>e))}function pe(e,t){if(void 0===n.config)return;const a=n.config[e];if(void 0!==a&&a.length>0)for(let e=0;a[e]&&e<a.length;e++)a[e](n.selectedDates,n.input.value,n,t);"onChange"===e&&(n.input.dispatchEvent(me("change")),n.input.dispatchEvent(me("input")))}function me(e){const t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function fe(e){for(let t=0;t<n.selectedDates.length;t++)if(0===T(n.selectedDates[t],e))return""+t;return!1}function he(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.yearElements.forEach(((e,t)=>{const a=new Date(n.currentYear,n.currentMonth,1);a.setMonth(n.currentMonth+t),n.config.showMonths>1||"static"===n.config.monthSelectorType?n.monthElements[t].textContent=b(a.getMonth(),n.config.shorthandCurrentMonth,n.l10n)+" ":n.monthsDropdownContainer.value=a.getMonth().toString(),e.value=a.getFullYear().toString()})),n._hidePrevMonthArrow=void 0!==n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=void 0!==n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function ge(e){return n.selectedDates.map((t=>n.formatDate(t,e))).filter(((e,t,a)=>"range"!==n.config.mode||n.config.enableTime||a.indexOf(e)===t)).join("range"!==n.config.mode?n.config.conjunction:n.l10n.rangeSeparator)}function ye(e=!0){void 0!==n.mobileInput&&n.mobileFormatStr&&(n.mobileInput.value=void 0!==n.latestSelectedDateObj?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):""),n.input.value=ge(n.config.dateFormat),void 0!==n.altInput&&(n.altInput.value=ge(n.config.altFormat)),!1!==e&&pe("onValueUpdate")}function ve(e){const t=v(e),a=n.prevMonthNav.contains(t),i=n.nextMonthNav.contains(t);a||i?W(a?-1:1):n.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?n.changeYear(n.currentYear+1):t.classList.contains("arrowDown")&&n.changeYear(n.currentYear-1)}return function(){n.element=n.input=e,n.isOpen=!1,function(){const i=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],s=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),t),c={};n.config.parseDate=s.parseDate,n.config.formatDate=s.formatDate,Object.defineProperty(n.config,"enable",{get:()=>n.config._enable,set:e=>{n.config._enable=de(e)}}),Object.defineProperty(n.config,"disable",{get:()=>n.config._disable,set:e=>{n.config._disable=de(e)}});const l="time"===s.mode;if(!s.dateFormat&&(s.enableTime||l)){const e=M.defaultConfig.dateFormat||r.dateFormat;c.dateFormat=s.noCalendar||l?"H:i"+(s.enableSeconds?":S":""):e+" H:i"+(s.enableSeconds?":S":"")}if(s.altInput&&(s.enableTime||l)&&!s.altFormat){const e=M.defaultConfig.altFormat||r.altFormat;c.altFormat=s.noCalendar||l?"h:i"+(s.enableSeconds?":S K":" K"):e+` h:i${s.enableSeconds?":S":""} K`}Object.defineProperty(n.config,"minDate",{get:()=>n.config._minDate,set:ne("min")}),Object.defineProperty(n.config,"maxDate",{get:()=>n.config._maxDate,set:ne("max")});const u=e=>t=>{n.config["min"===e?"_minTime":"_maxTime"]=n.parseDate(t,"H:i:S")};Object.defineProperty(n.config,"minTime",{get:()=>n.config._minTime,set:u("min")}),Object.defineProperty(n.config,"maxTime",{get:()=>n.config._maxTime,set:u("max")}),"time"===s.mode&&(n.config.noCalendar=!0,n.config.enableTime=!0),Object.assign(n.config,c,s);for(let e=0;e<i.length;e++)n.config[i[e]]=!0===n.config[i[e]]||"true"===n.config[i[e]];o.filter((e=>void 0!==n.config[e])).forEach((e=>{n.config[e]=p(n.config[e]||[]).map(a)})),n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let e=0;e<n.config.plugins.length;e++){const t=n.config.plugins[e](n)||{};for(const e in t)o.indexOf(e)>-1?n.config[e]=p(t[e]).map(a).concat(n.config[e]):void 0===s[e]&&(n.config[e]=t[e])}s.altInputClass||(n.config.altInputClass=ae().className+" "+n.config.altInputClass),pe("onParseConfig")}(),ie(),n.input=ae(),n.input?(n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=f(n.input.nodeName,n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.required=n.input.required,n.altInput.tabIndex=n.input.tabIndex,n.altInput.type="text",n.input.setAttribute("type","hidden"),!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling)),n.config.allowInput||n._input.setAttribute("readonly","readonly"),n._positionElement=n.config.positionElement||n._input):n.config.errorHandler(new Error("Invalid input element specified")),function(){n.selectedDates=[],n.now=n.parseDate(n.config.now)||new Date;const e=n.config.defaultDate||("INPUT"!==n.input.nodeName&&"TEXTAREA"!==n.input.nodeName||!n.input.placeholder||n.input.value!==n.input.placeholder?n.input.value:null);e&&ue(e,n.config.dateFormat),n._initialDate=n.selectedDates.length>0?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now.getTime()?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now.getTime()?n.config.maxDate:n.now,n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth(),n.selectedDates.length>0&&(n.latestSelectedDateObj=n.selectedDates[0]),void 0!==n.config.minTime&&(n.config.minTime=n.parseDate(n.config.minTime,"H:i")),void 0!==n.config.maxTime&&(n.config.maxTime=n.parseDate(n.config.maxTime,"H:i")),n.minDateHasTime=!!n.config.minDate&&(n.config.minDate.getHours()>0||n.config.minDate.getMinutes()>0||n.config.minDate.getSeconds()>0),n.maxDateHasTime=!!n.config.maxDate&&(n.config.maxDate.getHours()>0||n.config.maxDate.getMinutes()>0||n.config.maxDate.getSeconds()>0)}(),n.utils={getDaysInMonth:(e=n.currentMonth,t=n.currentYear)=>1===e&&(t%4==0&&t%100!=0||t%400==0)?29:n.l10n.daysInMonth[e]},n.isMobile||function(){const e=window.document.createDocumentFragment();if(n.calendarContainer=f("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,!n.config.noCalendar){if(e.appendChild((n.monthNav=f("div","flatpickr-months"),n.yearElements=[],n.monthElements=[],n.prevMonthNav=f("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.nextMonthNav=f("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,q(),Object.defineProperty(n,"_hidePrevMonthArrow",{get:()=>n.__hidePrevMonthArrow,set(e){n.__hidePrevMonthArrow!==e&&(m(n.prevMonthNav,"flatpickr-disabled",e),n.__hidePrevMonthArrow=e)}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:()=>n.__hideNextMonthArrow,set(e){n.__hideNextMonthArrow!==e&&(m(n.nextMonthNav,"flatpickr-disabled",e),n.__hideNextMonthArrow=e)}}),n.currentYearElement=n.yearElements[0],he(),n.monthNav)),n.innerContainer=f("div","flatpickr-innerContainer"),n.config.weekNumbers){const{weekWrapper:e,weekNumbers:t}=function(){n.calendarContainer.classList.add("hasWeeks");const e=f("div","flatpickr-weekwrapper");e.appendChild(f("span","flatpickr-weekday",n.l10n.weekAbbreviation));const t=f("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}();n.innerContainer.appendChild(e),n.weekNumbers=t,n.weekWrapper=e}n.rContainer=f("div","flatpickr-rContainer"),n.rContainer.appendChild(B()),n.daysContainer||(n.daysContainer=f("div","flatpickr-days"),n.daysContainer.tabIndex=-1),K(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),e.appendChild(n.innerContainer)}n.config.enableTime&&e.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar");const e=x(n.config);n.timeContainer=f("div","flatpickr-time"),n.timeContainer.tabIndex=-1;const t=f("span","flatpickr-time-separator",":"),a=y("flatpickr-hour",{"aria-label":n.l10n.hourAriaLabel});n.hourElement=a.getElementsByTagName("input")[0];const i=y("flatpickr-minute",{"aria-label":n.l10n.minuteAriaLabel});if(n.minuteElement=i.getElementsByTagName("input")[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=l(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),n.minuteElement.value=l(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():e.minutes),n.hourElement.setAttribute("step",n.config.hourIncrement.toString()),n.minuteElement.setAttribute("step",n.config.minuteIncrement.toString()),n.hourElement.setAttribute("min",n.config.time_24hr?"0":"1"),n.hourElement.setAttribute("max",n.config.time_24hr?"23":"12"),n.hourElement.setAttribute("maxlength","2"),n.minuteElement.setAttribute("min","0"),n.minuteElement.setAttribute("max","59"),n.minuteElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(a),n.timeContainer.appendChild(t),n.timeContainer.appendChild(i),n.config.time_24hr&&n.timeContainer.classList.add("time24hr"),n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");const t=y("flatpickr-second");n.secondElement=t.getElementsByTagName("input")[0],n.secondElement.value=l(n.latestSelectedDateObj?n.latestSelectedDateObj.getSeconds():e.seconds),n.secondElement.setAttribute("step",n.minuteElement.getAttribute("step")),n.secondElement.setAttribute("min","0"),n.secondElement.setAttribute("max","59"),n.secondElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(f("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(t)}return n.config.time_24hr||(n.amPM=f("span","flatpickr-am-pm",n.l10n.amPM[u((n.latestSelectedDateObj?n.hourElement.value:n.config.defaultHour)>11)]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM)),n.timeContainer}()),m(n.calendarContainer,"rangeMode","range"===n.config.mode),m(n.calendarContainer,"animate",!0===n.config.animate),m(n.calendarContainer,"multiMonth",n.config.showMonths>1),n.calendarContainer.appendChild(e);const t=void 0!==n.config.appendTo&&void 0!==n.config.appendTo.nodeType;if((n.config.inline||n.config.static)&&(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&(!t&&n.element.parentNode?n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling):void 0!==n.config.appendTo&&n.config.appendTo.appendChild(n.calendarContainer)),n.config.static)){const e=f("div","flatpickr-wrapper");n.element.parentNode&&n.element.parentNode.insertBefore(e,n.element),e.appendChild(n.element),n.altInput&&e.appendChild(n.altInput),e.appendChild(n.calendarContainer)}n.config.static||n.config.inline||(void 0!==n.config.appendTo?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)}(),function(){if(n.config.wrap&&["open","close","toggle","clear"].forEach((e=>{Array.prototype.forEach.call(n.element.querySelectorAll(`[data-${e}]`),(t=>D(t,"click",n[e])))})),n.isMobile)return void function(){const e=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=f("input",n.input.className+" flatpickr-mobile"),n.mobileInput.tabIndex=1,n.mobileInput.type=e,n.mobileInput.disabled=n.input.disabled,n.mobileInput.required=n.input.required,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",n.selectedDates.length>0&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr)),n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d")),n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d")),n.input.getAttribute("step")&&(n.mobileInput.step=String(n.input.getAttribute("step"))),n.input.type="hidden",void 0!==n.altInput&&(n.altInput.type="hidden");try{n.input.parentNode&&n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(e){}D(n.mobileInput,"change",(e=>{n.setDate(v(e).value,!1,n.mobileFormatStr),pe("onChange"),pe("onClose")}))}();const e=d(te,50);if(n._debouncedChange=d(S,300),n.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&D(n.daysContainer,"mouseover",(e=>{"range"===n.config.mode&&ee(v(e))})),D(window.document.body,"keydown",Q),n.config.inline||n.config.static||D(window,"resize",e),void 0!==window.ontouchstart?D(window.document,"touchstart",Y):D(window.document,"mousedown",Y),D(window.document,"focus",Y,{capture:!0}),!0===n.config.clickOpens&&(D(n._input,"focus",n.open),D(n._input,"click",n.open)),void 0!==n.daysContainer&&(D(n.monthNav,"click",ve),D(n.monthNav,["keyup","increment"],E),D(n.daysContainer,"click",ce)),void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement){const e=e=>v(e).select();D(n.timeContainer,["increment"],s),D(n.timeContainer,"blur",s,{capture:!0}),D(n.timeContainer,"click",I),D([n.hourElement,n.minuteElement],["focus","click"],e),void 0!==n.secondElement&&D(n.secondElement,"focus",(()=>n.secondElement&&n.secondElement.select())),void 0!==n.amPM&&D(n.amPM,"click",(e=>{s(e),S()}))}n.config.allowInput&&D(n._input,"blur",X)}(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&k(n.config.noCalendar?n.latestSelectedDateObj:void 0),ye(!1)),i();const c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!n.isMobile&&c&&oe(),pe("onReady")}(),n}function D(e,t){const n=Array.prototype.slice.call(e).filter((e=>e instanceof HTMLElement)),a=[];for(let e=0;e<n.length;e++){const i=n[e];try{if(null!==i.getAttribute("data-fp-omit"))continue;void 0!==i._flatpickr&&(i._flatpickr.destroy(),i._flatpickr=void 0),i._flatpickr=E(i,t||{}),a.push(i._flatpickr)}catch(e){console.error(e)}}return 1===a.length?a[0]:a}n(895),"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return D(this,e)},HTMLElement.prototype.flatpickr=function(e){return D([this],e)});var M=function(e,t){return"string"==typeof e?D(window.document.querySelectorAll(e),t):e instanceof Node?D([e],t):D(e,t)};M.defaultConfig={},M.l10ns={en:Object.assign({},c),default:Object.assign({},c)},M.localize=e=>{M.l10ns.default=Object.assign(Object.assign({},M.l10ns.default),e)},M.setDefaults=e=>{M.defaultConfig=Object.assign(Object.assign({},M.defaultConfig),e)},M.parseDate=U({}),M.formatDate=C({}),M.compareDates=T,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return D(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=M);var S=n(179),O=n(867),I=n(195),L=n(25);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e,t,n){return t&&F(e.prototype,t),n&&F(e,n),e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=q(e);if(t){var i=q(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return j(this,n)}}function j(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?N(e):t}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var H=function e(t){if(B(this,e),t.attributes.supportsTokens)return"textarea"==t.type?new Z(t):new W(t)},W=function(e){P(n,e);var t=K(n);function n(e){var a;return B(this,n),(a=t.call(this,e.attributes.itemType,e.type)).Field=e,a.Field.TokenSelector=N(a),a.render(),a.setData(),a.Field.getField().on("ua-codemirror-ready",(function(){a.getCodeMirrorEditor(),a.editor.setValue(a.editor.getValue()),a.renderTokens(),a.handleAddTokens(),a.renderTokensInRealTime()})),a}return V(n,[{key:"render",value:function(){this.RenderTokenSelector=new Y(this.Field,this.tokens)}},{key:"setData",value:function(){this.data={tokenRenderingDebounce:200}}},{key:"getCodeMirrorEditor",value:function(){this.editor=this.Field.fieldCM}},{key:"handleAddTokens",value:function(){var e=this;this.Field.field.off("ua-add-token").on("ua-add-token",(function(t,n){["date","time"].includes(e.Field.attributes.fieldType)&&e.editor.setValue(""),e.insertTextAtCursor("{{".concat(n.id,"}}")),e.renderTokens({ignoreRequiresUserModal:!0}),["date","time"].includes(e.Field.attributes.fieldType)||e.editor.focus(),["date","time"].includes(e.Field.attributes.fieldType)&&e.Field.setValue("{{".concat(n.id,"}}"))}))}},{key:"destroy",value:function(){this.RenderTokenSelector.destroy()}},{key:"insertTextAtCursor",value:function(e){this.editor.doc.replaceRange(e,this.editor.doc.getCursor())}},{key:"renderTokensInRealTime",value:function(){var e=this;this.editor.on("changes",(0,S.Ds)((function(t){e.renderTokens()}),this.data.tokenRenderingDebounce))}},{key:"renderTokens",value:function(e){var t=this;e=Object.assign({ignoreRequiresUserModal:!1},e);for(var n=this.editor.getSearchCursor(/\{\{(.*?)\}\}/),a=function(){var a={from:n.from(),to:n.to()},i=t.editor.getRange(a.from,a.to).replace("{{","").replace("}}",""),o=t.createTokenDOMNode(i),r=t.editor.markText(a.from,a.to,{replacedWith:o});if("anonymous"==UncannyAutomator.recipe.type&&!UncannyAutomator.recipe.requiresUserData&&(t.tokensThatRequireUser.includes(i)||i.startsWith("USERMETA:"))&&!e.ignoreRequiresUserModal)return t.tokenNeedsUserModal(o,{removeToken:function(){var e=r.find();r.clear(),t.editor.replaceRange("",e.from,e.to)}}),"break";t.Field.attributes.isReadOnly||o.addEventListener("click",(function(){if(!o.classList.contains("uap-token--cm-focused")){o.classList.add("uap-token--cm-focused");var e=function(){o.classList.remove("uap-token--cm-focused"),document.removeEventListener("mouseup",n),document.removeEventListener("copy",a),document.removeEventListener("keydown",s),document.removeEventListener("keydown",c)},n=function(t){o===t.target||o.contains(t.target)||e()};document.addEventListener("mouseup",n);var a=function(t){e(),(0,S.vQ)("{{".concat(i,"}}"))};document.addEventListener("copy",a);var s=function(n){var a=n.keyCode||n.charCode;if(8==a||46==a){var i=r.find();r.clear(),t.editor.replaceRange("",i.from,i.to),e()}};document.addEventListener("keydown",s);var c=function(n){var a=n.keyCode||n.charCode;if(37==a||39==a){e();var i,o=r.find();37==a&&(i=o.from),39==a&&(i=o.to),t.editor.focus(),t.editor.setCursor(i)}};document.addEventListener("keydown",c)}}))};n.findNext()&&"break"!==a(););}},{key:"tokenNeedsUserModal",value:function(e){var t,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,S.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp){var i=UncannyAutomator.recipe.isLive;(t=new L.Z({title:"".concat(UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.title,' <span class="needs-user-data-modal-pro-badge needs-user-data-modal-pro-badge--gray">').concat(UncannyAutomator.i18n.proOnly.pro,"</span>"),content:'\n                    <div class="needs-user-data-modal">\n                        <div class="needs-user-data-modal__title">'.concat((0,S.qi)(UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.content.mustRunOnUser,[e.outerHTML]),'</div>\n                        <div class="needs-user-data-modal__disclaimer">\n                            <div class="description">').concat(UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.content.description,"</div>\n                        </div>\n                    </div>\n                "),buttons:{cancel:UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.cancelButton,confirm:UncannyAutomator.i18n.userSelector.userDataModal.token.allowed.confirmButton}},{size:"large"})).setEvents({onConfirm:function(){var e=t.getElements();e.modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),(0,S.R$)(!0,(function(e){t.destroy(),n.renderTokens()}),(function(t){e.modal.box.buttons.confirm.removeClass("uap-btn--loading").prop("disabled",!1)})),i&&UncannyAutomator.recipe.publish.statusToggle.setValue(!1),(0,S.$K)(a.allowedConfirm)&&a.allowedConfirm()},onCancel:function(){t.destroy(),(0,S.$K)(a.removeToken)&&a.removeToken(),(0,S.$K)(a.allowedCancel)&&a.allowedCancel()}})}else(t=new L.Z({title:"".concat(UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.title,' <span class="needs-user-data-modal-pro-badge">').concat(UncannyAutomator.i18n.proOnly.pro,"</span>"),content:'\n                    <div class="needs-user-data-modal">\n                        <div class="needs-user-data-modal__title">'.concat((0,S.qi)(UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.mustRunOnUser,[e.outerHTML]),'</div>\n                        <div class="needs-user-data-modal__disclaimer">\n                            <p>\n                                <div class="description">').concat((0,S.qi)(UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.description,[UncannyAutomator.i18n.uncannyAutomatorPro]),' <a href="').concat((0,S.hl)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_campaign:"update_to_pro",utm_content:"requires_user_data"}),'" target="_blank">').concat(UncannyAutomator.i18n.upgradeNow,' <span class="uo-icon uo-icon--external-link-alt"></span></a></div>\n                            </p>\n                            <p>\n                                <div class="description">').concat(UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.content.upgradeLater,' <a href="').concat((0,S.hl)("https://automatorplugin.com/knowledge-base/creating-a-recipe/#Recipe_types",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_content:"requires_user_data-learn-more"}),'" target="_blank">').concat(UncannyAutomator.i18n.learnMore,' <span class="uo-icon uo-icon--external-link-alt"></span></a></div>\n                            </p>\n                        </div>\n                    </div>\n                '),buttons:{cancel:UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.cancelButton,confirm:UncannyAutomator.i18n.userSelector.userDataModal.token.forbidden.confirmButton}},{size:"large"})).setEvents({onConfirm:function(){t.destroy(),(0,S.YQ)((0,S.hl)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"add_token",utm_campaign:"update_to_pro",utm_content:"requires_user_data"})),(0,S.$K)(a.removeToken)&&a.removeToken(),(0,S.$K)(a.forbiddenConfirm)&&a.forbiddenConfirm()},onCancel:function(){t.destroy(),(0,S.$K)(a.removeToken)&&a.removeToken(),(0,S.$K)(a.forbiddenCancel)&&a.forbiddenCancel()}})}}]),n}(I.Z),Z=function(e){P(n,e);var t=K(n);function n(e){var a;return B(this,n),(a=t.call(this,e)).Field.attributes.supportsTinyMCE&&a.Field.getField().on("ua-tinymce-ready",(function(){a.getTinyMCEEditor(),a.addStylesToEditor(),setTimeout((function(){a.parsePlainTokensInTinyMCE()}),a.data.tokenRenderingDebounce),setTimeout((function(){a.parseHTMLTokensInPlainTextarea()}),a.data.tokenRenderingDebounce),a.handleAddTokens(),a.handleHTMLTokensInPlainTextarea(),a.handlePlainTokensInTinyMCE()})),a}return V(n,[{key:"setData",value:function(){this.data={tokenRenderingDebounce:200,tokenCSSClass:"uap-token-tinymce"}}},{key:"render",value:function(){this.RenderTokenSelector=new Y(this.Field,this.tokens)}},{key:"insertTextAtCursor",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!(0,S.$K)(this.tinyMCEeditor)||(0,S.$K)(this.tinyMCEeditor)&&this.tinyMCEeditor.hidden)this.editor.doc.replaceRange(t,this.editor.doc.getCursor());else{t=t.replace("{{","").replace("}}","");var n=this.createTokenDOMNode(t);"anonymous"!=UncannyAutomator.recipe.type||UncannyAutomator.recipe.requiresUserData||!this.tokensThatRequireUser.includes(t)&&!t.startsWith("USERMETA:")?(this.tinyMCEeditor.execCommand("mceInsertContent",!1,'<span class="'.concat(this.data.tokenCSSClass,'" contenteditable="false" data-token-id="').concat(t,'">').concat(n.outerHTML,"</span>")),this.Field.getField().trigger("change input")):this.tokenNeedsUserModal(n,{allowedConfirm:function(){e.tinyMCEeditor.execCommand("mceInsertContent",!1,'<span class="'.concat(e.data.tokenCSSClass,'" contenteditable="false" data-token-id="').concat(t,'">').concat(n.outerHTML,"</span>")),e.Field.getField().trigger("change input")}})}}},{key:"getTinyMCEEditor",value:function(){this.tinyMCEeditor=this.Field.fieldTinyMCE}},{key:"addStylesToEditor",value:function(){this.tinyMCEeditor.dom.addStyle("\n            html body {\n                font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                font-size: 15px;\n                margin-left: 12px;\n                margin-right: 12px;\n            }\n\n            .uap-token {\n                display: inline-flex;\n                align-items: center;\n                background: #eee;\n                line-height: 1;\n                padding: 3px 8px;\n                border-radius: 150px;\n\n                font-size: 15px;\n                font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                -webkit-font-smoothing:antialiased;\n                -moz-osx-font-smoothing:grayscale;\n            }\n\n                .uap-token-tinymce {\n                    display: inline-block;\n                    line-height: 1;\n                    border-radius: 150px;\n                    box-shadow: 0 0 0 2px transparent;\n                    transition: box-shadow 150ms ease-in-out;\n                    cursor: pointer;\n                }\n\n                .uap-token-tinymce[data-mce-selected=\"1\"] {\n                    outline: 0 !important;\n                    box-shadow: 0 0 0 2px #0790e8;\n                }\n\n                .uap-token img {\n                    width: 12px;\n                    height: 11px;\n                    margin-right: 5px;\n                    object-fit: contain;\n                    object-position: center;\n                    display: block;\n                }\n\n                .uap-token .uo-icon {\n                    width: 14px;\n                    height: 14px;\n                    border: 1px solid #444;\n                    border-radius: 50%;\n                    font-size: 9px;\n                    color: #444;\n                    text-align: center;\n                    line-height: 15px;\n                    background: #fff;\n                    opacity: .8;\n                    margin-right: 5px;\n                    position: relative;\n                }\n\n                    .uap-token .uo-icon.uo-icon--bolt:before {\n                        content: '';\n\n                        width: 9px;\n                        height: 9px;\n\n                        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 384 512'%3E%3Cpath fill='%23444' d='M377.8 167.9c-8.2-14.3-23.1-22.9-39.6-22.9h-94.4l28.7-87.5c3.7-13.8.8-28.3-7.9-39.7C255.8 6.5 242.5 0 228.2 0H97.7C74.9 0 55.4 17.1 52.9 37.1L.5 249.3c-1.9 13.8 2.2 27.7 11.3 38.2C20.9 298 34.1 304 48 304h98.1l-34.9 151.7c-3.2 13.7-.1 27.9 8.6 38.9 8.7 11.1 21.8 17.4 35.9 17.4 16.3 0 31.5-8.8 38.8-21.6l183.2-276.7c8.4-14.3 8.4-31.5.1-45.8zM160.1 457.4L206.4 256H47.5L97.7 48l127.6-.9L177.5 193H334L160.1 457.4z'%3E%3C/path%3E%3C/svg%3E\");\n\n                        background-size: contain;\n                        background-position: center;\n                        background-repeat: no-repeat;\n\n                        position: absolute;\n                        top: 50%;\n                        left: 50%;\n                        transform: translate(-50%,-50%);\n                    }\n\n                .uap-token__name {\n                    color: #444444;\n                    font-size: 14px;\n                    font-weight: 600;\n                }\n\n                    .uap-token--invalid {\n                        background: #f9e2e2;\n                    }\n\n                    .uap-token--invalid .uo-icon {\n                        color: #c00;\n                        border-color: #c00;\n                    }\n\n        ")}},{key:"handleHTMLTokensInPlainTextarea",value:function(){var e=this;this.Field.getField().on("change input",(0,S.Ds)((function(){e.parseHTMLTokensInPlainTextarea()}),this.data.tokenRenderingDebounce)),this.Field.getField().on("ua-tinymce-activate-text-view",(function(){setTimeout((function(){e.parseHTMLTokensInPlainTextarea()}),e.data.tokenRenderingDebounce)}))}},{key:"handlePlainTokensInTinyMCE",value:function(){var e=this;this.Field.getField().on("ua-tinymce-activate-visual-view",(function(){setTimeout((function(){e.parsePlainTokensInTinyMCE()}),e.data.tokenRenderingDebounce)}))}},{key:"parsePlainTokensInTinyMCE",value:function(){var e=this.tinyMCEeditor.getContent({format:"raw"}),t=this.renderTextWithTokens(e,{template:'<span class="'.concat(this.data.tokenCSSClass,'" contenteditable="false" data-token-id="%2$s">%1$s</span>')});e!=t&&this.tinyMCEeditor.setContent(t.innerHTML)}},{key:"parseHTMLTokensInPlainTextarea",value:function(){var e=this.Field.getField().val(),t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll(".".concat(this.data.tokenCSSClass));if(n.length>0){n.forEach((function(e){var t=e.dataset.tokenId;e.outerHTML="{{".concat(t,"}}")})),e=t.innerHTML;try{this.editor.setValue(e)}catch(t){this.Field.getField().val(e)}}}},{key:"destroy",value:function(){this.RenderTokenSelector.destroy()}}]),n}(W),Y=function(){function e(t,n){B(this,e),this.Field=t,this.tokens=n,this.getData(),this.getElements(),this.createWrapper(),this.createFilter(),this.createGroupsOfTokens(),this.listenToggleButton(),this.resizeDropdownOnWindowResize(),this.resizeDropdownOnWindowScroll(),this.refreshOnFieldChange(),this.search(),this.shouldSupportFilters()&&this.setFilter(!0)}return V(e,[{key:"getData",value:function(){this.data={isOpen:!1,position:"below"}}},{key:"getElements",value:function(){this.$elements={wrapper:null,toggleButton:null,searchField:null,dropdown:null,allGroups:null,dropdownGroupsContainer:null,dropdownTokens:null,noResultsOption:null}}},{key:"createWrapper",value:function(){var e=i()('\n            <div class="form-variable">\n                <div class="form-variable__element">\n                    <div class="form-variable__render-container"></div>\n                    <div class="form-variable__toggle">\n                        <span class="uo-icon uo-icon--asterisk"></span>\n                    </div>\n                </div>\n                <div class="form-variable__dropdown">\n                    <div class="form-variable__dropdown-container">\n                        <div class="form-variable__search">\n                            <input \n                                class="form-variable__search-input" \n                                placeholder="'.concat(UncannyAutomator.i18n.tokens.search,'"\n                            >\n                        </div>\n                        <div class="form-variable__groups"></div>\n                    </div>\n                </div>\n            </div>\n        ')),t=[];"textarea"==this.Field.type&&t.push(this.Field.getField()),(0,S.$K)(this.Field.getFieldCM())&&t.push(this.Field.getFieldCM()),t.forEach((function(t){e.insertAfter(t),e.find(".form-variable__render-container").append(t)})),this.$elements.wrapper=e,this.$elements.renderContainer=e.find(".form-variable__render-container"),this.$elements.searchFieldContainer=e.find(".form-variable__search"),this.$elements.searchField=e.find(".form-variable__search-input"),this.$elements.toggleButton=e.find(".form-variable__toggle"),this.$elements.dropdown=e.find(".form-variable__dropdown"),this.$elements.dropdownGroupsContainer=e.find(".form-variable__groups")}},{key:"createFilter",value:function(){var e=this;if(this.shouldSupportFilters()){var t=this.Field.attributes.fieldType,n=(0,S.$K)(UncannyAutomator.i18n.tokens.tokenType[t])?UncannyAutomator.i18n.tokens.tokenType[t]:t,a=i()('\n                <div class="form-variable__filter"></div>\n            '),o=new J("checkbox",{optionCode:"token__enableFilter",currentValue:!0,label:'<span class="form-variable__filter-label">'+(0,S.qi)(UncannyAutomator.i18n.tokens.filter,['<span class="form-variable__filter-type">'.concat(n,"</span>")])+"<span>"}),r=o.createFormElement();a.prepend(r),this.$elements.searchFieldContainer.append(a),this.$elements.filterContainer=a,r.on("automator:field:change",(function(){o.getValue()?e.setFilter(!0):e.setFilter(!1)}))}}},{key:"createGroupsOfTokens",value:function(){var e=this,t=this.$elements.wrapper.find(".form-variable__groups");this.tokens.forEach((function(n){t.append(e.createIndividualGroupOfTokens(n))})),this.$elements.allGroups=t.find(".form-variable__group"),this.$elements.dropdownTokens=t.find(".form-variable__group-item"),this.$elements.noResultsOption=i()('\n            <div class="form-variable__group-item-no-results form-variable__group-item-no-results--hide">\n                <div class="form-variable__group-item-no-results-title">\n                    '.concat(UncannyAutomator.i18n.tokens.noResults,'\n                </div>\n                <div class="form-variable__group-item-no-results-description">\n                    ').concat(this.shouldSupportFilters()?UncannyAutomator.i18n.tokens.noResultsDescriptionWithFilter:UncannyAutomator.i18n.tokens.noResultsDescription,"\n                </div>\n            </div>\n        ")),t.append(this.$elements.noResultsOption)}},{key:"createIndividualGroupOfTokens",value:function(e){var t=this,n=i()('\n            <div \n                class="form-variable__group"\n                data-id="'.concat(e.id,'"\n            >\n                <div class="form-variable__group-source">\n                    <div class="form-variable-group-source__icon"></div>\n                    <div class="form-variable-group-source__description"></div>\n                    <div class="form-variable-group-source__toggle">\n                        <span class="form-variable-group-source__toggle-icon"></span>\n                    </div>\n                </div>\n                <span class="form-variable__group-children"></span>\n            </div>\n        ')),a=e.name;"string"==!R(a)&&(a.html.clone(),function(e){throw new TypeError('"groupName" is read-only')}()),n.find(".form-variable-group-source__description").append(e.name);var o=e.icon.clone();n.find(".form-variable-group-source__icon").append(o),n.find(".form-variable__group-source").on("click",(function(){n.toggleClass("form-variable__group--open")}));var r=n.find(".form-variable__group-children");return e.tokens.forEach((function(e){var n=(0,S.xb)(e.name)?"":e.name,a=i()('\n                <div \n                    class="form-variable__group-item"\n                    data-search="'.concat(n.trim().toLowerCase().replace(/\s/g,""),'"\n                    data-type="').concat(e.type,'"\n                >\n                    ').concat(n,"\n\n                    ").concat("anonymous"==UncannyAutomator.recipe.type&&!UncannyAutomator.recipe.requiresUserData&&(0,S.$K)(e.requiresUser)&&e.requiresUser?'<span class="form-variable__group-item-tag">'+UncannyAutomator.i18n.needsUserData+"</span>":"","\n                </div>\n            "));"USERMETA:KEY"==e.id?a.on("click",(function(){t.close();var n=i()("<div></div>"),a=new J("text",{optionCode:"token__metaKeyField",label:UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.userMetaKey,description:UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.userMetaKeyDescription,isRequired:!0});n.append(a.createFormElement());var o=new L.Z({title:UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.title,content:n,buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.tokens.specialTokens.userMeta.modal.confirmButton}});o.setEvents({afterSetEvents:function(){o.show()},onConfirm:function(){var n=a.validate(),r=a.getValue();n.isValid&&((e=i().extend(!0,{},e)).id=e.id.replace("KEY",r),e.name=(0,S.qi)(UncannyAutomator.i18n.tokens.global.userMetaKeyTemplate,[r]),t.Field.field.trigger("ua-add-token",e),o.destroy())},afterHide:function(){o.destroy()}})})):a.on("click",(function(){t.Field.field.trigger("ua-add-token",e),t.close()})),r.append(a)})),n}},{key:"listenToggleButton",value:function(){var e=this;this.$elements.toggleButton.on("click",(function(){e.data.isOpen?e.close():e.open()}))}},{key:"search",value:function(){var e=this;this.$elements.searchField.on("input",(0,S.P2)((function(){var t=e.$elements.searchField.val();t=t.trim().toLowerCase().replace(/\s/g,""),(0,S.xb)(t)?(e.$elements.allGroups.removeClass("form-variable__group--open"),e.$elements.dropdownTokens.removeClass("form-variable__group-item--hidden-by-search")):(e.$elements.allGroups.addClass("form-variable__group--open"),e.$elements.dropdownTokens.addClass("form-variable__group-item--hidden-by-search"),e.$elements.dropdownTokens.filter((function(e,n){return-1!==n.dataset.search.search(t)})).removeClass("form-variable__group-item--hidden-by-search")),e.updateGroupsOfTokensVisibility()}),30))}},{key:"setFilter",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){this.$elements.dropdownTokens.addClass("form-variable__group-item--hidden-by-filter");var n=this.$elements.dropdownTokens.filter((function(t,n){return("int"==n.dataset.type&&"float"==e.Field.attributes.fieldType?"float":n.dataset.type)==e.Field.attributes.fieldType}));n.removeClass("form-variable__group-item--hidden-by-filter")}else this.$elements.dropdownTokens.removeClass("form-variable__group-item--hidden-by-filter");this.updateGroupsOfTokensVisibility()}},{key:"updateGroupsOfTokensVisibility",value:function(){var e=!1;this.$elements.allGroups.removeClass("form-variable__group--without-available-tokens"),this.$elements.allGroups.filter((function(t,n){n.querySelectorAll(".form-variable__group-item:not(.form-variable__group-item--hidden-by-filter):not(.form-variable__group-item--hidden-by-search)").length>0?e=!0:n.classList.add("form-variable__group--without-available-tokens")})),e?this.$elements.noResultsOption.addClass("form-variable__group-item-no-results--hide"):this.$elements.noResultsOption.removeClass("form-variable__group-item-no-results--hide")}},{key:"open",value:function(){if(["date","time"].includes(this.Field.attributes.fieldType))try{this.Field.flatpickrInstance.close()}catch(e){}this.$elements.wrapper.addClass("form-variable--open"),this.data.isOpen=!0,this.closeWhenClickedOutside(),this.$elements.searchField.val("").trigger("input").css({"padding-right":"".concat(((0,S.$K)(this.$elements.filterContainer)?this.$elements.filterContainer.outerWidth():0)+12,"px")}),this.$elements.searchField.focus(),this.setDropdownDirection(),this.setDropdownHeight()}},{key:"close",value:function(){this.$elements.wrapper.removeClass("form-variable--open"),this.data.isOpen=!1,this.$elements.searchField.val("").trigger("input"),i()(document).off("mouseup.uap-token-selector-click-outside")}},{key:"destroy",value:function(){this.$elements.renderContainer.children().insertAfter(this.$elements.wrapper),this.$elements.wrapper.remove()}},{key:"closeWhenClickedOutside",value:function(){var e=this;i()(document).on("mouseup.uap-token-selector-click-outside",(function(t){var n=e.$elements.wrapper;n.is(t.target)||0!==n.has(t.target).length||e.close()}))}},{key:"getDropdownPosition",value:function(){var e=i()(window),t={};t.above=this.$elements.wrapper.offset().top-e.scrollTop(),t.below=e.height()-(t.above+this.$elements.wrapper.outerHeight()),"textarea"==this.Field.type&&(t.below=e.height()-(t.above+38)),this.$elements.dropdown.addClass("uo-realsize");var n=this.$elements.dropdown.outerHeight()+110;return this.$elements.dropdown.removeClass("uo-realsize"),"textarea"==this.Field.type?t.hasSpaceBelow=!0:t.hasSpaceBelow=t.below>=n,t}},{key:"setDropdownDirection",value:function(){var e=this.getDropdownPosition();this.$elements.wrapper.removeClass("form-variable--above form-variable--below"),e.below>e.above||e.hasSpaceBelow?(this.$elements.wrapper.addClass("form-variable--below"),this.data.position="below"):(this.$elements.wrapper.addClass("form-variable--above"),this.data.position="above")}},{key:"setDropdownHeight",value:function(){if(this.data.isOpen){var e=this.getDropdownPosition()[this.data.position]-this.$elements.searchField.outerHeight()-45;this.$elements.dropdownGroupsContainer.css({"max-height":"".concat(e,"px")})}}},{key:"focusSearchField",value:function(){this.$elements.searchField.focus()}},{key:"resizeDropdownOnWindowResize",value:function(){var e=this;i()(window).on("resize",(0,S.P2)((function(){e.setDropdownDirection(),e.setDropdownHeight()}),20))}},{key:"resizeDropdownOnWindowScroll",value:function(){var e=this;i()(window).on("scroll",(0,S.Ds)((function(){e.setDropdownDirection(),e.setDropdownHeight()}),300))}},{key:"refreshOnFieldChange",value:function(){var e=this;this.Field.formElement.on("automator:field:change",(function(){e.setDropdownDirection(),e.setDropdownHeight()}))}},{key:"shouldSupportFilters",value:function(){var e=this.Field.attributes.fieldType;return["email","int","float","url","date","time"].includes(e)}}]),e}();function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const J=function(){function e(t,n){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;z(this,e),this.type=t,this.attributes=this.setAttributes(n),this.customValidationFunction=i,a&&this.createFormElement()}var t,n;return t=e,(n=[{key:"createFormElement",value:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=null,o=this.type,r=this.attributes;if((0,S.d3)(o,(0,S.ew)())){var s=i()("<div/>",{class:"form-element"});(0,S.$K)(r.formElementClass)&&s.addClass(r.formElementClass);var c,l,u,d={name:r.optionCode,id:r.uniqueFieldID,"data-isajax":r.isAjax,"data-targetfield":r.targetField,"data-integrationid":r.integrationID,"data-endPoint":r.endPoint,"data-supportsTokens":r.supportsTokens,"data-supportsTinymce":r.supportsTinyMCE,"data-required":r.isRequired,"data-item_type":r.itemType,"data-item-id":r.itemId,"data-option-group":r.groupId,"data-is-hidden":r.isHidden,"data-is-child-field":r.isChildField};switch(o){case"select":c=i()("<div/>",{class:"form-select"}),this.fieldContainer=c,l=i()("<select/>",i().extend({},d,{"data-type":"select",class:"form-element__select","data-supports-custom-value":r.supportsCustomValue})),r.supportsMultipleValues&&l.prop("multiple","multiple"),this.field=l;var p,m,f=!1,h=0;r.hasDefaultValue&&(p=(0,S.xb)(r.defaultValue.option_value)||(0,S.xb)(r.defaultValue.option_name)?r.defaultValue:r.defaultValue.option_value);var g=i()('<optgroup\n\t\t\t\t\t\t\ttitle="form-element__select-normal-options"\n\t\t\t\t\t\t\tclass="form-element__select-normal-options">\n\t\t\t\t\t\t</optgroup>');if(r.options=r.options.filter((function(e){return"automator_custom_value"!==e.value})),i().each(r.options,(function(e,t){var n=i()("<option/>",{value:t.value,text:t.text});r.hasDefaultValue&&(0,S.A5)(p,e)&&(n.prop("selected",!0),m=!0,f=!0),r.hasValue&&(0,S.A5)(r.currentValue,t.value)&&(n.prop("selected",!0),f=!0),n.appendTo(g),h++})),g.appendTo(l),r.supportsMultipleValues){if(!(0,S.xb)(r.currentValue))try{l.val(r.currentValue)}catch(e){}(0,S.xb)(l.val())||(f=!0)}if(r.hasDefaultValue&&!m&&!(0,S.xb)(r.defaultValue.option_value)&&!(0,S.xb)(r.defaultValue.option_name)){var y=i()("<option/>",{value:r.defaultValue.option_value,text:r.defaultValue.option_name});r.hasValue||(0,S.A5)(r.defaultValue.option_value,r.currentValue)||(y.prop("selected",!0),f=!0),y.prependTo(l),h++}if(r.hasPlaceholder&&(l.prepend("<option></option>"),r.hasDefaultValue||r.hasValue||l.find("option:selected").prop("selected",!1)),r.supportsCustomValue){var v=r.customValue,_=i()('\n\t\t\t\t\t\t\t<optgroup label="'.concat(UncannyAutomator.i18n.validation.field.select.otherOptions,'">\n\t\t\t\t\t\t\t\t<option value="automator_custom_value">').concat(UncannyAutomator.i18n.validation.field.select.customValue,"</option>\n\t\t\t\t\t\t\t</optgroup>\n\t\t\t\t\t\t"));l.append(_),r.hasValue&&(0,S.A5)(r.currentValue,"automator_custom_value")&&(_.find("option").attr("selected",!0),f=!0),r.hasValue&&!f&&(_.find("option").attr("selected",!0),f=!0,v=r.currentValue),this.customValueField=new e("text",{itemId:r.itemId,itemType:r.itemType,isRequired:r.isRequired,isReadOnly:!1,supportsTinyMCE:!1,supportsCopyToClipboard:!1,supportsTokens:r.supportsTokens,isAjax:!1,fieldType:"text",optionCode:"".concat(r.optionCode,"_custom"),label:"",description:r.hasCustomValueDescription?r.customValueDescription:void 0,placeholder:"",isHidden:!1,tokenName:(0,S.qi)(UncannyAutomator.i18n.validation.field.select.customValueToken,[r.label]),defaultValue:null,currentValue:v,isChildField:!0,parentOptionCode:r.optionCode})}if(this.selectHasSelectedOption=f,0==h){var b=i()(new Option(UncannyAutomator.i18n.noResults,"",!0,!0));b.prop("disabled",!0),this.field.find(".form-element__select-normal-options").append(b),this.attributes.supportsCustomValue||this.field.prop("disabled",!0)}l.on("change",(function(e,t){s.trigger("automator:field:change",t)}));break;case"text":case"url":case"email":case"int":case"float":case"date":case"time":var k="form-input form-input--".concat(o);if(c=i()("<div/>",{class:k}),this.$fakeCodemirrorField=i()("<div/>",{class:"form-element__input-cm"}),c.append(this.$fakeCodemirrorField),this.fieldContainer=c,l=i()("<input/>",i().extend({},d,{class:"form-element__input",type:"text","data-type":o})),(0,S.$K)(r.maxLength)&&l.prop("maxlength",r.maxLength),this.field=l,r.supportsTokens&&c.addClass("form-input--token"),r.hasPlaceholder&&l.prop("placeholder",r.placeholder),r.hasValue?l.prop("value",r.currentValue):r.hasDefaultValue&&l.prop("value",r.defaultValue),["date","time"].includes(r.fieldType)){var w=i()('\n\t\t\t\t\t\t\t\t<div class="form-element__input-clear" uap-tooltip="'.concat(UncannyAutomator.i18n.clear,'">\n\t\t\t\t\t\t\t\t\t<span class="uo-icon uo-icon--times"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t'));c.addClass("form-input--has-clear"),this.$fakeCodemirrorField.append(w),w.on("click",(function(){t.clearValue()}))}l.on("input",(function(){s.trigger("automator:field:change")}));break;case"textarea":c=i()("<div/>",{class:"form-textarea"}),this.fieldContainer=c,l=i()("<textarea/>",i().extend(!0,d,{"data-type":"textarea",class:"form-element__textarea","data-item_type":r.itemType})),(0,S.$K)(r.maxLength)&&l.prop("maxlength",r.maxLength),this.field=l,r.supportsTokens&&c.addClass("form-textarea--token"),r.hasPlaceholder&&l.prop("placeholder",r.placeholder),this.$fakeCodemirrorField=i()("<div/>",{class:"form-element__input-cm"}),c.append(this.$fakeCodemirrorField),r.hasValue?l.text(r.currentValue):r.hasDefaultValue&&l.text(r.defaultValue),l.on("input",(function(){s.trigger("automator:field:change")}));break;case"checkbox":c=i()("<div/>",{class:"form-checkbox"}),this.fieldContainer=c;var A=i()("<label/>",{class:"form-checkbox__container"}),C=i()("<div/>",{class:"checkbox--show"});if(l=i()("<input/>",i().extend({},d,{type:"checkbox","data-type":"checkbox",class:"checkbox--hidden checkbox--primary"})),r.hasValue&&r.currentValue&&l.prop("checked",!0),this.field=l,r.hasLabel&&A.html(r.label),c.append(A),A.append(l),A.append(C),(0,S.$K)(r.isToggle)&&r.isToggle&&(c.addClass("form-checkbox--toggle"),(0,S.$K)(r.toggle))){if((0,S.$K)(r.toggle.on)){var U=i()("<span/>",{class:"checkbox-label checkbox-label--on"}).text(r.toggle.on);A.append(U)}if((0,S.$K)(r.toggle.off)){var T=i()("<span/>",{class:"checkbox-label checkbox-label--off"}).text(r.toggle.off);A.append(T)}}if((0,S.$K)(r.color))if((0,S.d3)(r.color,["gutenberg","green"]))switch(r.color){case"gutenberg":c.addClass("form-checkbox--toggle-gutenberg");break;case"green":c.addClass("form-checkbox--toggle-green")}else console.error((0,S.qi)("The color %s does not exists. Default color will be used instead.",[r.color]));(0,S.$K)(r.align)&&((0,S.d3)(r.align,["left","right"])?"right"==r.align&&c.addClass("form-checkbox--toggle-right"):console.error((0,S.qi)("The alignment %s does not exists. %s will be used instead.",[r.align,'"left"']))),l.on("change",(function(e,t){s.trigger("automator:field:change",t)})),l=A;break;case"radio":c=i()("<div/>",{class:"form-radio"}),this.fieldContainer=c;var x=i()(),E=i()();i().each(r.options,(function(e,t){var n=i()("<label/>",{class:"form-radio__container"});n.html(t.text);var a=i()("<input/>",i().extend({},d,{type:"radio","data-type":"radio",class:"radio--hidden radio--primary",value:t.value,name:d.id}));x=x.add(a);var o=i()("<div/>",{class:"radio--show"});n.append(a),n.append(o),(r.hasValue&&r.currentValue==t.value||!r.hasValue&&r.hasDefaultValue&&r.defaultValue==t.value)&&a.prop("checked",!0),E=E.add(n)})),this.field=E,l=E,x.on("change",(function(e,t){s.trigger("automator:field:change",t)}))}if(c.append(l),"checkbox"!=o&&(r.hasLabel||r.isRequired)&&(u=i()("<label/>",{class:"form-element__label",for:r.uniqueFieldID}),r.hasLabel&&u.html(r.label)),r.isRequired)if(c.addClass("form-element--required"),"checkbox"==r.fieldType){if(l.find("input").prop("required",!0),r.hasLabel){var D=i()("<span/>",{class:"form-element-label__required"});l.append(D)}}else if(l.prop("required",!0),r.hasLabel){var M=i()("<span/>",{class:"form-element-label__required"});u.append(M)}(0,S.$K)(r.isReadOnly)&&r.isReadOnly&&(["date","time"].includes(this.attributes.fieldType)||c.addClass("form-element--readonly"),"select"==r.fieldType?l.prop("disabled",!0):["checkbox","radio"].includes(r.fieldType)?l.find("input").prop("disabled",!0):l.prop("readonly",!0)),(r.hasLabel||r.isRequired)&&c.prepend(u);var O=i()("<div/>",{class:"form-element__error"});if(c.append(O),this.fieldContainer=c,r.hasDescription){var I=i()("<div/>",{class:"description"});I.html(r.description),c.append(I)}r.isHidden&&c.addClass("form-element--hidden"),s.append(c),"select"==r.fieldType&&(0,S.$K)(this.customValueField)&&(this.customValueFieldContainer=i()('<div class="form-select-custom">\n\t\t\t\t\t\t<div class="form-element-children"></div>\n\t\t\t\t\t</div>'),this.customValueFieldContainer.find(".form-element-children").append(this.customValueField.createFormElement()),s.append(this.customValueFieldContainer),"automator_custom_value"==this.getValue()?this.customValueFieldContainer.addClass("form-select-custom--visible"):this.customValueFieldContainer.removeClass("form-select-custom--visible")),a=s,this.formElement=s,n&&this.initLibraries(),this.onChange(),this.onFocus()}else console.error((0,S.qi)('The field type "%s" is invalid. The valid ones are %s',[o,(0,S.ew)().join(", ")]));return a}},{key:"setAttributes",value:function(e){if(e.fieldType=this.type,e.uniqueFieldID="".concat(e.optionCode,"__").concat((0,S.Ki)()),"checkbox"!=e.fieldType||(0,S.xb)(e.currentValue)||["true","false"].includes(e.currentValue)&&(e.currentValue="true"==e.currentValue,e.currentValue?e.hasValue=!0:e.hasValue=!1),(0,S.$K)(e.hasValue)||((0,S.xb)(e.currentValue)?e.hasValue=!1:e.hasValue=!0),(0,S.$K)(e.hasPlaceholder)||((0,S.xb)(e.placeholder)?e.hasPlaceholder=!1:e.hasPlaceholder=!0),(0,S.$K)(e.hasDefaultValue)||((0,S.xb)(e.defaultValue)?e.hasDefaultValue=!1:e.hasDefaultValue=!0),(0,S.$K)(e.hasLabel)||((0,S.xb)(e.label)?e.hasLabel=!1:e.hasLabel=!0),(0,S.$K)(e.hasDescription)||((0,S.xb)(e.description)?e.hasDescription=!1:e.hasDescription=!0),(0,S.$K)(e.isRequired)||(e.isRequired=!1),(0,S.$K)(e.isChildField)||(e.isChildField=!1),(0,S.$K)(e.supportsTokens)||(e.supportsTokens=!1),e.supportsTokens&&"select"==e.fieldType&&!["action","closure"].includes(e.itemType)&&(e.supportsTokens=!1),(0,S.$K)(e.isReadOnly)||(e.isReadOnly=!1),"select"==e.fieldType){if((0,S.$K)(e.supportsMultipleValues)||(e.supportsMultipleValues=!1),e.supportsMultipleValues&&(e.supportsCustomValue=!1),e.supportsMultipleValues)try{e.currentValue=JSON.parse(e.currentValue)}catch(e){}(0,S.$K)(e.supportsCustomValue)||(e.supportsCustomValue=!1),e.hasCustomValueDescription=!(0,S.xb)(e.customValueDescription)}return"date"==e.fieldType&&(e.isReadOnly=!0,(0,S.$K)(e.dateFormat)||(e.dateFormat="Y-m-d"),(0,S.$K)(e.dateAltFormat)||(e.dateAltFormat=UncannyAutomator.format.date),(0,S.$K)(e.minDate)&&(e.minDate=e.minDate),(0,S.$K)(e.maxDate)&&(e.maxDate=e.maxDate),(0,S.$K)(e.supportsRange)||(e.supportsRange=!1)),"time"==e.fieldType&&(e.isReadOnly=!0,(0,S.$K)(e.timeFormat)||(e.timeFormat="h:i K"),(0,S.$K)(e.timeAltFormat)||(e.timeAltFormat="h:i K"),(0,S.$K)(e.minTime)&&(e.minTime=e.minTime),(0,S.$K)(e.maxTime)&&(e.maxTime=e.maxTime)),(0,S.$K)(e.supportsTinyMCE)||(e.supportsTinyMCE=!1),!(0,S.$K)(e.isToggle)&&(0,S.$K)(e.toggle)&&(e.isToggle=!0),(0,S.$K)(e.isAjax)||(e.isAjax=!1),(0,S.$K)(e.isHidden)||(e.isHidden=!1),e}},{key:"validate",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=null;t?(n=this.getFieldContainer(),e=this.getValue()):e=this.attributes.currentValue,this.type;var a={supportsTokens:this.attributes.supportsTokens,required:this.attributes.isRequired};return(0,O.OP)(n,this.type,e,a,this.customValidationFunction)}},{key:"onChange",value:function(){var e=this;this.formElement.on("automator:field:change",(function(t,n){(0,S.$K)(e.fieldContainer)&&((0,S.xb)(e.getValue())?e.fieldContainer.removeClass("form-input--has-value"):e.fieldContainer.addClass("form-input--has-value")),"select"==e.attributes.fieldType&&e.attributes.supportsCustomValue&&("automator_custom_value"==e.getValue()?e.customValueFieldContainer.addClass("form-select-custom--visible"):e.customValueFieldContainer.removeClass("form-select-custom--visible"));var a=function(){if(e.attributes.isAjax&&e.attributes.targetField!==e.attributes.optionCode&&e.doAJAX(),(0,S.$K)(e.attributes.isChildField)&&e.attributes.isChildField&&(0,S.$K)(e.attributes.parentOptionCode)){var t=(0,S.rz)(e.attributes.itemId,e.attributes.parentOptionCode);(0,S.$K)(t)&&t.doAJAX()}};if(e.attributes.isAjax&&(0,S.$K)(e.attributes.targetField)&&e.attributes.targetField!==e.attributes.optionCode&&(e.attributes.completedFirstLoad||(0,S.xb)(e.attributes.currentValue)&&!e.attributes.hasDefaultValue&&!e.attributes.completedFirstLoad)){var i=(0,S.rz)(e.attributes.itemId,e.attributes.targetField);i.setValue(null,!1),i.setCustomValue(null,!1)}return["select","radio","checkbox"].includes(e.attributes.fieldType)?a():((0,S.$K)(e.onChangeTimeout)&&clearTimeout(e.onChangeTimeout),e.onChangeTimeout=setTimeout((function(){a()}),1500)),!1}))}},{key:"onFocus",value:function(){var e=this;this.field.on("focusin",(function(t){e.attributes.isReadOnly&&i()(t.currentTarget).select()})),this.field.on("focusout",(function(){}))}},{key:"isReady",value:function(){var e=!1;return(0,S.$K)(UncannyAutomator.recipe.items[this.attributes.itemId])&&(e=!0),e}},{key:"doAJAX",value:function(){var e=this;if((0,S.$K)(this.getValue())?this.getValue():this.getMetaValue(),this.attributes.isAjax){var t=this;if(this.attributes.optionCode!=this.attributes.targetField&&(t=(0,S.rz)(this.attributes.itemId,this.attributes.targetField)),!(0,S.xb)(this.attributes.integrationId)&&!(0,S.xb)(this.attributes.endpoint)){this.startLoadingAnimation(),t.startLoadingAnimation();var n=this.getValue(),a=(0,S.$K)(t.getValue())?t.getValue():t.getMetaValue();(0,S.bN)(this.attributes.endpoint,{recipe_id:UncannyAutomator.recipe.id,integration_id:this.attributes.integrationId,item_id:this.attributes.itemId,group_id:this.attributes.groupId,field_id:this.attributes.optionCode,target_field:this.attributes.targetField,value:n,values:(0,S.q7)(this.attributes.itemId)},(function(n){if(e.stopLoadingAnimation(),t.stopLoadingAnimation(),"select"==t.getAttributes().fieldType&&i().isArray(n)){if(e.attributes.isAjax&&(0,S.$K)(e.attributes.targetField)&&e.attributes.targetField!==e.attributes.optionCode&&(e.attributes.completedFirstLoad||(0,S.xb)(e.attributes.currentValue)&&!e.attributes.hasDefaultValue&&!e.attributes.completedFirstLoad)&&(a=null),"automator_custom_value"==a){var o=t.getSelectCustomValue();a=(0,S.xb)(o)?null:o}t.setSelectOptions(n,!1),t.setValue(a)}else t.setValue(n);e.attributes.completedFirstLoad=!0}))}}}},{key:"getFormElement",value:function(){var e=this;if(this.isReady()){this.attributes.completedFirstLoad=!1;var t=!1;try{t=UncannyAutomator.recipe.items[this.attributes.itemId].options[this.attributes.groupId].fields.reduce((function(t,n){return t||n.attributes.targetField==e.attributes.optionCode&&n.attributes.optionCode!=e.attributes.optionCode&&n.attributes.isAjax}),!1)}catch(e){}t||(this.attributes.targetField==this.attributes.optionCode&&this.attributes.isAjax&&this.doAJAX(),this.field.trigger("automator:field:change",{manuallySet:!1}))}return this.formElement}},{key:"getFieldContainer",value:function(){return this.fieldContainer}},{key:"getFieldID",value:function(){return this.attributes.optionCode}},{key:"getField",value:function(){return this.field}},{key:"getFieldCM",value:function(){return this.$fakeCodemirrorField}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getValue",value:function(){var e=null;if((0,S.$K)(this.field))switch(this.type){case"select":case"text":case"url":case"email":case"int":case"float":e=this.field.val();break;case"textarea":if((0,S.$K)(this.TokenSelector))try{this.TokenSelector.parseHTMLTokensInPlainTextarea()}catch(e){console.log(e)}if(e=this.field.val(),this.attributes.supportsTinyMCE)try{e=e.replaceAll("\n","")}catch(e){console.log(e)}break;case"checkbox":e=this.field.is(":checked");break;case"radio":e=this.field.find("input:checked").val();break;case"date":case"time":e=this.field.val()}return(0,S.$K)(this.field)&&(0,S.$K)(e)||(this.attributes.hasValue?e=this.attributes.currentValue:this.attributes.hasDefaultValue&&(e=this.attributes.defaultValue)),e}},{key:"getReadableValue",value:function(){var e=this,t=null,n=this.getValue();switch(this.type){case"select":if((0,S.$K)(this.field))t=this.attributes.supportsMultipleValues&&i().isArray(n)?n.map((function(t){return e.field.find((0,S.qi)('option[value="%s"]',[t])).text()})).join("".concat(UncannyAutomator.i18n.itemSeparator," ")):this.field.find((0,S.qi)('option[value="%s"]',[n])).text();else if(this.attributes.supportsMultipleValues&&i().isArray(n))try{t=n.map((function(t){return e.getSelectOptionByValue(t).text})).join("".concat(UncannyAutomator.i18n.itemSeparator," "))}catch(e){}else try{t=this.getSelectOptionByValue(n).text}catch(e){}break;case"text":case"url":case"email":case"int":case"float":case"textarea":n=i()("<p/>").html(n).text();break;case"checkbox":t=n?UncannyAutomator.i18n.trueLabel:UncannyAutomator.i18n.falseLabel;break;case"radio":if((0,S.$K)(this.field)){var a=this.field.find("input:checked");1==a.length&&(t=a.closest(".form-radio__container").text().trim())}else try{t=this.getSelectOptionByValue(n).text}catch(e){}break;case"date":case"time":n=i()("<p/>").html(n).text()}return t}},{key:"getSelectCustomValue",value:function(){var e=null;if("select"==this.attributes.fieldType&&this.attributes.supportsCustomValue&&"automator_custom_value"==this.getValue())if((0,S.$K)(this.customValueField))e=this.customValueField.getValue();else try{e=UncannyAutomator.recipe.items[this.attributes.itemId].meta["".concat(this.attributes.optionCode,"_custom")]}catch(e){}return e}},{key:"getSelectOptionByValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null,n=this.attributes.options;return this.attributes.supportsCustomValue&&n.push({value:"automator_custom_value",text:UncannyAutomator.i18n.validation.field.select.customValue}),(0,S.xb)(n)||n.forEach((function(n){e==n.value&&(t=n)})),t}},{key:"getMetaValue",value:function(){var e;if((0,S.$K)(UncannyAutomator.recipe.items[this.attributes.itemId])){var t=UncannyAutomator.recipe.items[this.attributes.itemId].meta[this.attributes.optionCode];(0,S.$K)(t)&&(e=t)}return e}},{key:"setValue",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{updateCodemirror:!0};if((0,S.$K)(this.field))switch(this.type){case"select":(0,S.$K)(e)||(e=this.attributes.supportsMultipleValues?[]:"");var o=this.field.find("option");if(this.attributes.supportsMultipleValues)o.prop("selected",!1),i().isArray(e)&&!(0,S.xb)(e)&&(e.forEach((function(e){var n=t.field.find('option[value="'+e+'"]');n.length>0&&n.prop("selected",!0)})),n&&this.field.trigger("change",{manuallySet:!1}));else{var r=this.field.find('option[value="'+e+'"]');r.length>0?(o.prop("selected",!1),r.prop("selected",!0),n&&this.field.trigger("change",{manuallySet:!1})):(o.prop("selected",!1),this.attributes.supportsCustomValue&&!(0,S.xb)(e)&&this.setCustomValue(e,!1),n&&this.field.trigger("change",{manuallySet:!1}))}break;case"text":case"url":case"email":case"int":case"float":if((0,S.$K)(a.updateCodemirror)&&a.updateCodemirror&&(0,S.$K)(this.fieldCM))try{this.fieldCM.setValue(e)}catch(t){this.field.val(e)}else this.field.val(e);n&&this.field.trigger("automator:field:change");break;case"textarea":this.field.val(e),(0,S.$K)(this.fieldTinyMCE)&&this.fieldTinyMCE.setContent(e),n&&this.field.trigger("automator:field:change");break;case"checkbox":var s=e,c=this.getValue();s&&!c&&this.field.prop("checked",!0),!s&&c&&this.field.prop("checked",!1),n&&(s&&!c||!s&&c)&&this.field.trigger("automator:field:change");break;case"radio":this.field.filter('[name="'.concat(e,'"]')).prop("checked",!0),n&&this.field.trigger("automator:field:change");break;case"date":case"time":this.field.val(e),n&&this.field.trigger("automator:field:change")}}},{key:"clearValue",value:function(){this.setValue("",!0);try{this.fieldCM.setValue("")}catch(e){}if(["date","time"].includes(this.attributes.fieldType))try{this.flatpickrInstance.clear()}catch(e){}}},{key:"setCustomValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"select"==this.attributes.fieldType&&(0,S.$K)(this.customValueField)&&(this.field.val("automator_custom_value"),this.customValueField.setValue(e,t),t&&this.field.trigger("change",{manuallySet:!1}))}},{key:"hasSelectedOption",value:function(){return this.selectHasSelectedOption}},{key:"setSelectOptions",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removeSelectOptions();try{e=e.filter((function(e){return(0,S.$K)(e.value)&&(0,S.$K)(e.text)}))}catch(e){}if((0,S.$K)(this.field)){var n=this.field.find(".form-element__select-normal-options");if(e.length>0){this.field.prop("disabled",!1);var a=(0,S.$K)(this.getValue())?this.getValue():this.getMetaValue(),o=[];i().each(e,(function(e,t){var a=new Option(t.text,t.value,!1,!1);n.append(a),o.push(a)})),(0,S.xb)(a)||i().each(this.field.find("option"),(function(e,t){t.value==a&&i()(t).prop("selected",!0)}))}else{var r=i()(new Option(UncannyAutomator.i18n.noResults,"",!this.attributes.supportsCustomValue,!this.attributes.supportsCustomValue));r.prop("disabled",!0),n.append(r),this.attributes.supportsCustomValue||this.field.prop("disabled",!0)}t&&this.field.trigger("change"),this.rerenderSelect2()}}},{key:"removeSelectOptions",value:function(){(0,S.$K)(this.field)&&this.field.find(".form-element__select-normal-options").empty()}},{key:"isLoading",value:function(){return this.formElement.hasClass("form-element--loading")}},{key:"startLoadingAnimation",value:function(){var e="form-element--loading";(0,S.$K)(this.formElement)&&!this.formElement.hasClass(e)&&(this.formElement.addClass(e),"checkbox"!=this.type||(0,S.$K)(this.attributes.isToggle)||this.fieldContainer.addClass("form-checkbox--loading-inline"),this.formElement.trigger("automator:field:loading"))}},{key:"stopLoadingAnimation",value:function(){var e="form-element--loading";(0,S.$K)(this.formElement)&&this.formElement.hasClass(e)&&(this.formElement.removeClass(e),this.fieldContainer.removeClass("form-checkbox--loading-inline"),this.formElement.trigger("automator:field:loading"))}},{key:"initLibraries",value:function(){switch(this.type){case"select":this.initSelect2(this.field);break;case"text":case"url":case"email":case"int":case"float":case"textarea":"url"==this.attributes.fieldType&&(0,O.oy)(this.fieldContainer);break;case"date":case"time":this.initFlatpickr(this.field)}}},{key:"getSelect2Settings",value:function(){var e={theme:"uap-select2",searchInputPlaceholder:UncannyAutomator.i18n.search,language:{noResults:function(){return UncannyAutomator.i18n.noResults}},templateResult:function(e){var t=e.text;return(0,S.$K)(e.id)&&Number.isInteger(parseInt(e.id))&&parseInt(e.id)>0&&(t='<span class="uap-select2-item__meta">('.concat((0,S.qi)(UncannyAutomator.i18n.postIDPlaceholder,[e.id.replace("-objectkey","")]),")</span> ").concat(e.text)),t},templateSelection:function(e){var t=e.text;return(0,S.$K)(e.id)&&Number.isInteger(parseInt(e.id))&&parseInt(e.id)>0&&(t='<span class="uap-select2-item__meta">('.concat((0,S.qi)(UncannyAutomator.i18n.postIDPlaceholder,[e.id.replace("-objectkey","")]),")</span> ").concat(t)),t},escapeMarkup:function(e){return e}};return this.attributes.hasPlaceholder&&(e.placeholder=this.attributes.placeholder),this.attributes.customClass&&(e.customClass=this.attributes.customClass),e}},{key:"initSelect2",value:function(e){var t=this.getSelect2Settings();e.hasClass("select2-hidden-accessible")||e.select2(t)}},{key:"initFlatpickr",value:function(e){var t=this;(0,S.$K)(document.getElementById("uap-flatpickr-calendar"))||i()("body").append(i()('<div id="uap-flatpickr-calendar" class="uap uap-flatpickr-calendar"></div>'));var n=document.getElementById("uap-flatpickr-calendar"),a={allowInput:!0,positionElement:this.$fakeCodemirrorField[0],altInput:!0,clickOpens:!1,appendTo:n,locale:{weekdays:{shorthand:[UncannyAutomator.i18n.format.date.weekdays.shorthand.sunday,UncannyAutomator.i18n.format.date.weekdays.shorthand.monday,UncannyAutomator.i18n.format.date.weekdays.shorthand.tuesday,UncannyAutomator.i18n.format.date.weekdays.shorthand.wednesday,UncannyAutomator.i18n.format.date.weekdays.shorthand.thursday,UncannyAutomator.i18n.format.date.weekdays.shorthand.friday,UncannyAutomator.i18n.format.date.weekdays.shorthand.saturday],longhand:[UncannyAutomator.i18n.format.date.weekdays.longhand.sunday,UncannyAutomator.i18n.format.date.weekdays.longhand.monday,UncannyAutomator.i18n.format.date.weekdays.longhand.tuesday,UncannyAutomator.i18n.format.date.weekdays.longhand.wednesday,UncannyAutomator.i18n.format.date.weekdays.longhand.thursday,UncannyAutomator.i18n.format.date.weekdays.longhand.friday,UncannyAutomator.i18n.format.date.weekdays.longhand.saturday]},months:{shorthand:[UncannyAutomator.i18n.format.date.months.shorthand.january,UncannyAutomator.i18n.format.date.months.shorthand.february,UncannyAutomator.i18n.format.date.months.shorthand.march,UncannyAutomator.i18n.format.date.months.shorthand.april,UncannyAutomator.i18n.format.date.months.shorthand.may,UncannyAutomator.i18n.format.date.months.shorthand.june,UncannyAutomator.i18n.format.date.months.shorthand.july,UncannyAutomator.i18n.format.date.months.shorthand.august,UncannyAutomator.i18n.format.date.months.shorthand.september,UncannyAutomator.i18n.format.date.months.shorthand.october,UncannyAutomator.i18n.format.date.months.shorthand.november,UncannyAutomator.i18n.format.date.months.shorthand.december],longhand:[UncannyAutomator.i18n.format.date.months.longhand.january,UncannyAutomator.i18n.format.date.months.longhand.february,UncannyAutomator.i18n.format.date.months.longhand.march,UncannyAutomator.i18n.format.date.months.longhand.april,UncannyAutomator.i18n.format.date.months.longhand.may,UncannyAutomator.i18n.format.date.months.longhand.june,UncannyAutomator.i18n.format.date.months.longhand.july,UncannyAutomator.i18n.format.date.months.longhand.august,UncannyAutomator.i18n.format.date.months.longhand.september,UncannyAutomator.i18n.format.date.months.longhand.october,UncannyAutomator.i18n.format.date.months.longhand.november,UncannyAutomator.i18n.format.date.months.longhand.december]},rangeSeparator:" ".concat(UncannyAutomator.i18n.format.date.rangeSeparator," "),firstDayOfWeek:parseInt(UncannyAutomator.i18n.format.date.firstDayOfWeek)>=1&&parseInt(UncannyAutomator.i18n.format.date.firstDayOfWeek)<=7?parseInt(UncannyAutomator.i18n.format.date.firstDayOfWeek)-1:0,weekAbbreviation:" ".concat(UncannyAutomator.i18n.format.date.weekAbbreviation," "),scrollTitle:UncannyAutomator.i18n.scrollToIncrement,toggleTitle:UncannyAutomator.i18n.clickToToggle,amPM:[UncannyAutomator.i18n.format.date.am,UncannyAutomator.i18n.format.date.pm],yearAriaLabel:UncannyAutomator.i18n.format.date.year,monthAriaLabel:UncannyAutomator.i18n.format.date.month,hourAriaLabel:UncannyAutomator.i18n.format.date.hour,minuteAriaLabel:UncannyAutomator.i18n.format.date.minute},onReady:function(e,n,a){try{var i=function(){t.getValue().includes("}}")||t.fieldCM.getValue()!=a.altInput.value&&t.fieldCM.setValue(a.altInput.value)};(0,S.$K)(t.fieldCM)?i():t.field.on("ua-codemirror-ready",(function(){i()}))}catch(e){console.log(e)}},onChange:function(e,n,a){try{var i=function(){t.fieldCM.setValue(a.altInput.value)};(0,S.$K)(t.fieldCM)?i():t.field.on("ua-codemirror-ready",(function(){i()}))}catch(e){console.log(e)}}};"date"==this.attributes.fieldType&&(a=i().extend(a,{dateFormat:this.attributes.dateFormat,altFormat:this.attributes.dateAltFormat}),this.attributes.supportsRange&&(a.mode="range"),(0,S.$K)(this.attributes.minDate)&&(a.minDate=this.attributes.minDate),(0,S.$K)(this.attributes.maxDate)&&(a.maxDate=this.attributes.maxDate)),"time"==this.attributes.fieldType&&(a=i().extend(a,{enableTime:!0,noCalendar:!0,dateFormat:this.attributes.timeFormat,altFormat:this.attributes.timeAltFormat}),(0,S.$K)(this.attributes.minTime)&&(a.minTime=this.attributes.minTime),(0,S.$K)(this.attributes.manTime)&&(a.manTime=this.attributes.manTime)),this.flatpickrInstance=e.flatpickr(a)}},{key:"initCodeMirror",value:function(){var e=this;if(["text","url","email","int","float","date","time","textarea"].includes(this.attributes.fieldType)){this.destroyCodeMirror();var t=this.getValue();this.fieldCM=CodeMirror(this.$fakeCodemirrorField[0],{lineNumbers:0,tabSize:4,value:t,mode:"default",dragDrop:!1,viewportMargin:1/0,lineWrapping:!0,autoRefresh:!0,noNewlines:!("textarea"==this.attributes.fieldType),scrollbarStyle:"textarea"==this.attributes.fieldType?"native":null,extraKeys:{Tab:function(){var t=e.getNextField();return(0,S.$K)(t)&&t.focus(),!1}},readOnly:this.attributes.isReadOnly}),this.attributes.hasPlaceholder&&this.fieldCM.setOption("placeholder",this.attributes.placeholder),this.fieldCM.on("changes",(function(t,n){["date","time"].includes(e.attributes.fieldType)||e.setValue(e.fieldCM.getValue(),!0,{updateCodemirror:!1})})),this.fieldCM.on("focus",(function(){if(["date","time"].includes(e.attributes.fieldType))try{setTimeout((function(){e.flatpickrInstance.open()}),50)}catch(e){console.log(e)}})),this.field.on("focus",(function(){e.fieldCM.focus()})),this.field.trigger("ua-codemirror-ready")}"select"==this.attributes.fieldType&&(0,S.$K)(this.customValueField)&&this.customValueField.initCodeMirror()}},{key:"getNextField",value:function(){var e=null;if((0,S.$K)(this.attributes.itemId)&&(0,S.$K)(this.attributes.groupId)){var t=UncannyAutomator.recipe.items[this.attributes.itemId].options[this.attributes.groupId].fields;if((0,S.$K)(t)&&i().isArray(t)){var n=t.indexOf(this);-1!=n&&n!=t.length-1&&(e=t[n+1])}}if((0,S.$K)(this.attributes.itemType)&&"user-selector"==this.attributes.itemType){var a=UncannyAutomator.recipe.userSelector.fields;if((0,S.$K)(a)&&i().isArray(a)){var o=a.indexOf(this);-1!=o&&o!=a.length-1&&(e=a[o+1])}}return e}},{key:"focus",value:function(){if((0,S.$K)(this.field))switch(this.type){case"select":try{this.field.select2("focus")}catch(e){this.field.focus()}break;case"text":case"url":case"email":case"int":case"float":case"date":case"time":(0,S.$K)(this.fieldCM)?this.fieldCM.focus():this.field.focus();break;case"textarea":if((0,S.$K)(this.fieldTinyMCE))if(this.field.is(":visible"))this.field.focus();else try{this.fieldTinyMCE.focus()}catch(e){}else this.field.focus();break;case"checkbox":case"radio":this.field.focus()}}},{key:"destroyCodeMirror",value:function(){if((0,S.$K)(this.fieldCM))try{var e=this.fieldCM.getWrapperElement();e.parentNode.removeChild(e),this.fieldCM=null}catch(e){}}},{key:"rerenderSelect2",value:function(){var e=this.getSelect2Settings();!(0,S.xb)(this.field)&&this.field.hasClass("select2-hidden-accessible")&&this.field.select2("destroy").select2(e)}},{key:"initTokenSelector",value:function(){this.attributes.supportsTokens&&(this.destroyTokenSelector(),this.tokenSelector=new H(this)),"select"==this.attributes.fieldType&&(0,S.$K)(this.customValueField)&&this.customValueField.initTokenSelector()}},{key:"destroyTokenSelector",value:function(){(0,S.$K)(this.tokenSelector)&&this.tokenSelector.destroy()}},{key:"initTinyMCE",value:function(){var e=this;if(this.field,(0,S.$K)(this.field)&&"textarea"==this.attributes.fieldType&&this.attributes.supportsTinyMCE){var t=this.field.prop("id"),n=tinymce.get(t);(0,S.$K)(n)&&wp.editor.remove(t),wp.editor.initialize(t,{mediaButtons:!0,tinymce:{toolbar1:"formatselect bold italic bullist numlist blockquote alignleft aligncenter alignright link unlink wp_more",toolbar2:"strikethrough hr forecolor pastetext removeformat visualchars outdent indent undo redo"},quicktags:!0}),(n=tinymce.get(t)).hidden?this.fieldContainer.addClass("form-textarea--tinymce-text"):this.fieldContainer.addClass("form-textarea--tinymce-visual"),this.formElement.find(".switch-tmce").on("click",(function(){e.field.trigger("ua-tinymce-activate-visual-view"),e.fieldContainer.removeClass("form-textarea--tinymce-text").addClass("form-textarea--tinymce-visual")})),this.formElement.find(".switch-html").on("click",(function(){e.field.trigger("ua-tinymce-activate-text-view"),e.fieldContainer.removeClass("form-textarea--tinymce-visual").addClass("form-textarea--tinymce-text");try{e.fieldCM.setValue(n.getContent({format:"raw"}))}catch(t){e.field.val(n.getContent({format:"raw"}))}})),this.fieldTinyMCE=n,n.on("init",(function(){e.field.trigger("ua-tinymce-ready")}))}}}])&&G(t.prototype,n),e}();!function(e){var t=e.fn.select2.amd.require("select2/defaults");e.extend(t.defaults,{searchInputPlaceholder:""});var n=e.fn.select2.amd.require("select2/dropdown/search"),a=n.prototype.render;n.prototype.render=function(e){var t=a.apply(this,Array.prototype.slice.apply(arguments));return this.$search.attr("placeholder",this.options.get("searchInputPlaceholder")),this.$search.addClass(this.options.get("customClass")),t}}(window.jQuery)},156:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var a=n(609),i=n.n(a),o=n(179),r=n(842),s=n(181),c=n(751),l=n(549),u=n(619),d=n(25);function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const m=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemType=t,this.integrationID=n,this.$currentItem=a,this.render()}var t,n;return t=e,(n=[{key:"render",value:function(){this.$container=i()('<div class="item"></div>'),this.$item=this.$container,this.createHeader(),this.createItemsList(),this.removeConnectingIntegrationsParameters(),this.$currentItem.replaceWith(this.$container)}},{key:"createHeader",value:function(){var e=i()('\n\t\t\t<div>\n\t\t\t\t<div class="item-title uap-clear">\n\t\t\t\t\t<div class="item-title__describe">\n\t\t\t\t\t\t<div class="item-title__non-editable">\n\t\t\t\t\t\t\t'.concat("trigger"==this.itemType?UncannyAutomator.i18n.trigger.select:UncannyAutomator.i18n.action.select,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t")),t=new r.Z(this.itemType);e.append(t);var n=new s.Z(this.integrationID);e.append(n);var a=new c.Z(this.integrationID);e.find(".item-title").prepend(a),this.$container.append(e)}},{key:"createItemsList",value:function(){var e,t,n=this;"trigger"==this.itemType?(e=(0,o.eU)(this.integrationID,"triggers"),t=UncannyAutomator.i18n.trigger.search,UncannyAutomator.i18n.proOnly.unlockTriggers):"action"==this.itemType&&(e=(0,o.eU)(this.integrationID,"actions"),t=UncannyAutomator.i18n.action.search,UncannyAutomator.i18n.proOnly.unlockActions);var a=i()('\n\t\t\t<div class="item__content">\n\t\t\t\t<div class="item-options item-options--nopadding item-options--noborder">\n\t\t\t\t\t<div class="form-element">\n\t\t\t\t\t\t<div class="item__task-selector">\n\t\t\t\t\t\t\t<div class="item-task-selector__search">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="item-task-selector__search-input"\n\t\t\t\t\t\t\t\t\tplaceholder="'.concat(t,'"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="item-task-selector__options">\n\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group item-task-selector-options__group--available"></div>\n\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group item-task-selector-options__group--unavailable">\n\t\t\t\t\t\t\t\t\t<div class="item-task-selector-options__group-items"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="item-task-selector__option item-task-selector__option--no-results item-task-selector__option--hide">\n\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.noResults,"\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t")),r=a.find(".item-options"),s=a.find(".item__task-selector"),c=a.find(".item-task-selector__search-input"),p={container:a.find(".item-task-selector__options"),available:a.find(".item-task-selector-options__group--available"),unavailable:{container:a.find(".item-task-selector-options__group--unavailable"),list:a.find(".item-task-selector-options__group-items")},noResults:a.find(".item-task-selector__option--no-results")};if(e.hasAvailableItems){if(!((0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp||"anonymous"!=UncannyAutomator.recipe.type)){var m=[],f=[];e.available.forEach((function(e){e.requires_user?m.push(e):f.push(e)})),e.available=[].concat(f,m)}p.available.append(e.available.map((function(e){var t=e.is_pro,a=(!(0,o.$K)(UncannyAutomator.wp)||!UncannyAutomator.wp)&&"anonymous"==UncannyAutomator.recipe.type&&e.requires_user,r=i()('\n\t\t\t\t\t<div class="item-task-selector__option '.concat(t?"item-task-selector__option--pro":""," ").concat(e.requires_user?"item-task-selector__option--requires-user":""," ").concat(a?"item-task-selector__option-cannot-add":"",'"\n\t\t\t\t\t\tdata-search="').concat(e.select_option_name.toLowerCase().replace(/\s+|{|}/g,""),'">\n\t\t\t\t\t\t<div class="item-task-selector__option-sentence">\n\t\t\t\t\t\t\t').concat(a?'<span class="uo-icon uo-icon--lock-alt"></span>':"","\n\t\t\t\t\t\t\t").concat((0,o.hF)(e.select_option_name,'<span class="item-task-selector__option-variable">',"</span>")," ").concat(t?'<span class="item-task-selector-option__badge">'.concat(UncannyAutomator.i18n.proOnly.pro,"</span>"):"",'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="item-task-selector__option-properties">\n\t\t\t\t\t\t\t').concat("anonymous"==UncannyAutomator.recipe.type&&!UncannyAutomator.recipe.requiresUserData&&e.requires_user?'<span class="item-task-selector-option__requires-user">'.concat(UncannyAutomator.i18n.needsUserData,"</span>"):"","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t"));return r.on("click",(function(){s.addClass("item__task-selector--loading"),r.addClass("item-task-selector__option--loading");var t=["trigger","action"].includes(n.itemType)?"add-new-".concat(n.itemType):"",a={};i().each(e.options,(function(e,t){(0,o.$K)(t.default_value)&&(a[t.option_code]=t.default_value)})),"anonymous"==e.type&&(a.can_log_in_new_user=!(0,o.$K)(e.can_log_in_new_user)||e.can_log_in_new_user);var c,p=function(c,d){(0,o.L8)("add",{recipePostID:UncannyAutomator.recipe.id,action:t,item_code:e.code,default_meta:i().extend({},a,{integration_name:UncannyAutomator.integrations[n.integrationID].name,sentence:e.sentence})},(function(e){if(new l.Z,new u.Z,(0,o.$K)(e.post_ID)){var t=(0,o.M0)("item",{id:e.post_ID});UncannyAutomator.recipe.items[e.post_ID].isValid?UncannyAutomator.recipe.isLive||t.item.find('.item-status input[type="checkbox"]').prop("checked",!0).trigger("change"):t.item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")}(0,o.$K)(c)&&c(e)}),(function(e){console.log("ERROR-TODO. Couldn't add the item"),s.removeClass("item__task-selector--loading"),r.removeClass("item-task-selector__option--loading"),0==e.success&&new l.Z,(0,o.$K)(d)&&d(e)}))};if("action"==n.itemType&&"anonymous"==UncannyAutomator.recipe.type&&!UncannyAutomator.recipe.requiresUserData&&e.requires_user)if(s.removeClass("item__task-selector--loading"),r.removeClass("item-task-selector__option--loading"),(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp){var m=UncannyAutomator.recipe.isLive;(c=new d.Z({title:"".concat(UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.title,' <span class="needs-user-data-modal-pro-badge needs-user-data-modal-pro-badge--gray">').concat(UncannyAutomator.i18n.proOnly.pro,"</span>"),content:'\n\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal">\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__title">'.concat(UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.content.mustRunOnUser,'</div>\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__sentence">\n\t\t\t\t\t\t\t\t\t\t\t').concat((0,o.hF)(e.select_option_name,"<span>","</span>"),'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__disclaimer">\n\t\t\t\t\t\t\t\t\t\t\t<div class="description">').concat(UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.content.description,"</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t"),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.userSelector.userDataModal.action.allowed.confirmButton}},{size:"large"})).setEvents({onConfirm:function(){var e=c.getElements();e.modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),(0,o.R$)(!0,(function(t){p((function(){c.destroy()}),(function(){e.modal.box.buttons.confirm.removeClass("uap-btn--loading").prop("disabled",!1)}))}),(function(t){e.modal.box.buttons.confirm.removeClass("uap-btn--loading").prop("disabled",!1)})),m&&UncannyAutomator.recipe.publish.statusToggle.setValue(!1)},onCancel:function(){c.destroy()}})}else(c=new d.Z({title:"".concat(UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.title,' <span class="needs-user-data-modal-pro-badge">').concat(UncannyAutomator.i18n.proOnly.pro,"</span>"),content:'\n\t\t\t\t\t\t        \t<div class="needs-user-data-modal">\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__title">'.concat(UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.mustRunOnUser,'</div>\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__sentence">\n\t\t\t\t\t\t\t\t\t\t\t').concat((0,o.hF)(e.select_option_name,"<span>","</span>"),'\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="needs-user-data-modal__disclaimer">\n\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="description">').concat((0,o.qi)(UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.description,[UncannyAutomator.i18n.uncannyAutomatorPro]),' <a href="').concat((0,o.hl)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_campaign:"update_to_pro",utm_content:"requires_user_data"}),'" target="_blank">').concat(UncannyAutomator.i18n.upgradeNow,' <span class="uo-icon uo-icon--external-link-alt"></span></a></div>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="description">').concat(UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.content.upgradeLater,' <a href="').concat((0,o.hl)("https://automatorplugin.com/knowledge-base/creating-a-recipe/#Recipe_types",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_content:"requires_user_data-learn-more"}),'" target="_blank">').concat(UncannyAutomator.i18n.learnMore,' <span class="uo-icon uo-icon--external-link-alt"></span></a></div>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t'),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.userSelector.userDataModal.action.forbidden.confirmButton}},{size:"large"})).setEvents({onConfirm:function(){c.destroy(),(0,o.YQ)((0,o.hl)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_campaign:"update_to_pro",utm_content:"requires_user_data"}))},onCancel:function(){c.destroy()}});else p()})),r})))}else p.available.remove();e.hasUnavailableItems?p.unavailable.list.append(e.unavailable.map((function(e){var t="unavailable_item-".concat(n.integrationID,"-").concat(n.integrationID,"_").concat((0,o.hF)(e.name,"","").toLowerCase().replace(/\s+|{|}/g,"_"));return i()('\n\t\t\t\t\t<a href="'.concat((0,o.hl)("https://automatorplugin.com/pricing/",{utm_source:"uncanny_automator",utm_medium:"select_an_item",utm_campaign:"update_to_pro",utm_content:t}),'"\n\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\tclass="item-task-selector__option item-task-selector__option--pro"\n\t\t\t\t\t\tdata-search="').concat(e.name.toLowerCase().replace(/\s+|{|}/g,""),'">\n\t\t\t\t\t\t<div class="item-task-selector__option-sentence">\n\t\t\t\t\t\t\t<span class="uo-icon uo-icon--lock-alt"></span>\n\t\t\t\t\t\t\t').concat((0,o.hF)(e.name,'<span class="item-task-selector__option-variable">',"</span>"),'\n\t\t\t\t\t\t\t<span class="item-task-selector-option__badge">').concat(UncannyAutomator.i18n.proOnly.pro,"</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t"))}))):p.unavailable.container.remove();var h=p.container.find(".item-task-selector__option:not(.item-task-selector__option--no-results)");c.on("input",(function(){var e=c.val().toLowerCase().replace(/\s+|{|}/g,"");h.removeClass("item-task-selector__option--show item-task-selector__option--hide");var t=!0;(0,o.xb)(e)||(t=!1,i().each(h,(function(n,a){var o=i()(a);-1!==o.data("search").search(e)?(o.addClass("item-task-selector__option--show"),t=!0):o.addClass("item-task-selector__option--hide")}))),p.noResults.removeClass("item-task-selector__option--hide item-task-selector__option--show"),t?p.noResults.addClass("item-task-selector__option--hide"):p.noResults.addClass("item-task-selector__option--show")})),r.append(this.createCancelButton()),this.$container.append(a)}},{key:"createCancelButton",value:function(){var e=this,t=i()("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);return t.on("click",(function(){new g(e.itemType,e.$item)})),t}},{key:"removeConnectingIntegrationsParameters",value:function(){(0,o.hl)(window.location.href,{ua_connecting_integration:"",ua_connecting_integration_id:"",ua_connecting_integration_context:""},{setAsURL:!0,refresh:!1})}}])&&p(t.prototype,n),e}();function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const g=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemType=t,this.$currentItem=n,this.integrations=[],this.render(),this.handleContinueIntegrationConnection()}var t,n;return t=e,(n=[{key:"render",value:function(){var e=i()("<div/>",{class:"item"});this.$item=e;var t=this.createHeader(),n=i()("<div/>",{class:"item__content"}),a=this.createIntegrations(),r=this.createDiscoverMoreIntegrations();if(e.append(t),n.append(a),n.append(r),e.append(n),(0,o.$K)(this.$currentItem))this.$currentItem.replaceWith(e);else{var s=(0,o.M0)("lastItem",{type:this.itemType});"trigger"==this.itemType&&(s.length>0?e.insertAfter(s):(0,o.M0)("metabox",{type:this.itemType}).append(e)),"action"==this.itemType&&((0,o.M0)("items",{type:this.itemType}).length>0?e.insertBefore(i()(".add-action-btn")):(0,o.M0)("metabox",{type:this.itemType}).find(".item.item--start").replaceWith(e))}}},{key:"createHeader",value:function(){var e=i()("<div/>"),t=i()("<div/>",{class:"item-icon"}),n=i()("<div/>",{class:"item-title uap-clear"}),a=i()("<div/>",{class:"item-title__describe"}),o=i()("<div/>",{class:"item-title__non-editable"}).text(UncannyAutomator.i18n.integration.select),s=new r.Z(this.itemType);return e.append(s),e.append(t),a.append(o),n.append(a),e.append(n),e}},{key:"createIntegrations",value:function(){var e=this,t=i()("<div/>",{class:"item-integrations"});return this.filterByNonEmptyIntegrations(this.itemType),this.sortIntegrationsAlphabetically(),this.integrations.forEach((function(n){var a=n.id,i=e.createIntegration(a,n),r=function(){new m(e.itemType,a,e.$item)};if((0,o.$K)(n.connected))switch(e.integrationModalCurrentStep(n)){case 1:r=function(){(0,o.hl)(window.location.href,{ua_connecting_integration:1,ua_connecting_integration_id:a,ua_connecting_integration_context:e.itemType},{setAsURL:!0,refresh:!1}),e.connectIntegrationModal(a,n,{currentStep:1})};break;case 2:r=function(){(0,o.hl)(window.location.href,{ua_connecting_integration:1,ua_connecting_integration_id:a,ua_connecting_integration_context:e.itemType},{setAsURL:!0,refresh:!1}),e.connectIntegrationModal(a,n,{currentStep:2})}}i.on("click",(function(){r()})),t.append(i)})),t}},{key:"connectIntegrationModal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=Object.assign({currentStep:1},n);var a=(0,o.hl)(UncannyAutomator.connectApiUrl,{redirect_url:(0,o.hl)(UncannyAutomator.dashboardUrl,{ua_close_window:1})}),i="";i=(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp?'\n                <div class="connect-integration-modal-step '.concat(n.currentStep>1?"connect-integration-modal-step--completed":"",'">\n                    <div class="connect-integration-modal-step__icon">\n                        <span class="uo-icon uo-icon--check-circle"></span>\n                    </div> \n                    <div class="connect-integration-modal-step__description">\n                        <div class="connect-integration-modal-step__description-main">\n                            <strong>1.</strong> ').concat((0,o.qi)(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step1Pro,[UncannyAutomator.i18n.uncannyAutomatorPro]),'\n                        </div>\n                    </div>\n                    <div class="connect-integration-modal-step__action">\n                        <a id="connect-integration-modal-activate-license" class="connect-integration-modal-step__action-anchor">\n                            ').concat(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.activate,' <span class="uo-icon uo-icon--arrow-circle-right"></span>\n                        </a>\n                    </div>\n                </div>\n            '):'\n                <div class="connect-integration-modal-step '.concat(n.currentStep>1?"connect-integration-modal-step--completed":"",'">\n                    <div class="connect-integration-modal-step__icon">\n                        <span class="uo-icon uo-icon--smile-plus"></span>\n                    </div> \n                    <div class="connect-integration-modal-step__description">\n                        <div class="connect-integration-modal-step__description-main">\n                            <strong>1.</strong> ').concat((0,o.qi)(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step1,[UncannyAutomator.i18n.uncannyAutomator]),'\n                        </div>\n                    </div>\n                    <div class="connect-integration-modal-step__action">\n                        <a id="connect-integration-modal-sign-up" class="connect-integration-modal-step__action-anchor">\n                            ').concat(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.signUp,' <span class="uo-icon uo-icon--arrow-circle-right"></span>\n                        </a>\n                    </div>\n                </div>\n            ');var r=new d.Z({title:"".concat(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.connectIntegration),content:'\n                <div class="connect-integration-modal">\n                    <div class="connect-integration-modal-steps__counter">\n                        '.concat((0,o.qi)(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.stepCounter,[n.currentStep-1,"2"]),'\n                    </div>\n                    <div class="connect-integration-modal-steps">\n                        <div class="connect-integration-modal-steps__list">\n                            ').concat(i,'\n                            <div class="connect-integration-modal-step ').concat(n.currentStep>2?"connect-integration-modal-step--completed":""," ").concat(1==n.currentStep?"connect-integration-modal-step--previous-not-completed":"",'">\n                                <div class="connect-integration-modal-step__icon">\n                                    <span class="uo-icon uo-icon--plug"></span>\n                                </div> \n                                <div class="connect-integration-modal-step__description">\n                                    <div class="connect-integration-modal-step__description-main">\n                                        <strong>2.</strong> ').concat((0,o.qi)(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.step2,['<span class="connect-integration-modal-step-integration-name">'+(0,o.Y6)(e).node.outerHTML+t.name+"</span>",UncannyAutomator.i18n.uncannyAutomator]),'\n                                    </div>\n                                </div>\n                                <div class="connect-integration-modal-step__action">\n                                    <span ').concat(1==n.currentStep?'uap-tooltip="'+UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.completePrevious+'"':"",'>\n                                        <a id="connect-integration-modal-connect-account" class="connect-integration-modal-step__action-anchor">\n                                            ').concat(UncannyAutomator.i18n.apiIntegrations.instructionsToConnect.connectAccount,' <span class="uo-icon uo-icon--arrow-circle-right"></span>\n                                        </a>\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            '),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:null}},{size:"extra-large"});r.setEvents({onCancel:function(){r.destroy(),setTimeout((function(){(0,o.hl)(window.location.href,{ua_connecting_integration:"",ua_connecting_integration_id:"",ua_connecting_integration_context:""},{setAsURL:!0,refresh:!1})}),10)}}),r.getElements().modal.container.find("#connect-integration-modal-sign-up").on("click",(function(e){e.preventDefault(),e.currentTarget.classList.add("connect-integration-modal-step__action-anchor--loading"),(0,o.Lc)({url:a,w:550,h:600,onClose:function(){location.reload()}})})),r.getElements().modal.container.find("#connect-integration-modal-activate-license").on("click",(function(e){e.preventDefault(),e.currentTarget.classList.add("connect-integration-modal-step__action-anchor--loading"),(0,o.Lc)({url:UncannyAutomator.licenseUrl,w:550,h:600,onClose:function(){location.reload()}})})),2==n.currentStep&&r.getElements().modal.container.find("#connect-integration-modal-connect-account").on("click",(function(e){e.preventDefault(),e.currentTarget.classList.add("connect-integration-modal-step__action-anchor--loading"),(0,o.Lc)({url:(0,o.hl)(t.settings_url,{minimal:1,hide_settings_tabs:1}),w:550,h:600,onClose:function(){location.reload()}})}))}},{key:"handleContinueIntegrationConnection",value:function(){if(1==(0,o.Tb)(null,"ua_connecting_integration")&&(0,o.Tb)(null,"ua_connecting_integration_context")==this.itemType){var e=(0,o.Tb)(null,"ua_connecting_integration_id");if(!(0,o.xb)(e)){var t=UncannyAutomator.integrations[e];if((0,o.$K)(t)&&(0,o.$K)(t.connected))switch(this.integrationModalCurrentStep(t)){case 1:this.connectIntegrationModal(e,t,{currentStep:1});break;case 2:this.connectIntegrationModal(e,t,{currentStep:2});break;case 3:new m(this.itemType,e,this.$item)}}}}},{key:"createIntegration",value:function(e,t){var n,a=i()("<div/>",{class:"item-integration"}),r=i()("<div/>",{class:"item-integration__logo"}),s=i()("<div/>",{class:"item-integration__name"});return t.isProOnly&&(a.addClass("item-integration--pro"),a.append(i()('\n                <div class="item-integration__badge">'.concat(UncannyAutomator.i18n.proOnly.pro,"</div>\n            ")))),t.isAvailable?(0,o.$K)(t.connected)?UncannyAutomator.hasAccountConnected?t.connected?a.addClass("item-integration--available"):(a.addClass("item-integration--unavailable item-integration--unavailable-integration-not-connected"),a.attr("uap-tooltip",(0,o.qi)(UncannyAutomator.i18n.apiIntegrations.integrationNotConnected,[t.name])),a.append(i()('\n                            <div class="item-integration__badge item-integration__badge--warning">'.concat(UncannyAutomator.i18n.apiIntegrations.notConnected,"</div>\n                        ")))):(a.addClass("item-integration--unavailable item-integration--unavailable-ap-account-not-connected"),a.attr("uap-tooltip",(0,o.qi)(UncannyAutomator.i18n.apiIntegrations.integrationNotConnected,[t.name])),a.append(i()('\n                        <div class="item-integration__badge item-integration__badge--warning">'.concat(UncannyAutomator.i18n.apiIntegrations.notConnected,"</div>\n                    ")))):"action"==this.itemType?(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp||"anonymous"!=UncannyAutomator.recipe.type?a.addClass("item-integration--available"):0==t.items.actions.available.filter((function(e){return 0==e.requires_user})).length?(a.addClass("item-integration--unavailable item-integration--unavailable-requires-user-data"),a.attr("uap-tooltip",UncannyAutomator.i18n.apiIntegrations.allActionsRequireUserData)):a.addClass("item-integration--available"):a.addClass("item-integration--available"):(a.addClass("item-integration--unavailable item-integration--unavailable-requires-pro"),a.attr("uap-tooltip",(0,o.qi)(UncannyAutomator.i18n.proOnly.requiresPro,[UncannyAutomator.i18n.uncannyAutomatorPro]))),(0,o.$K)(t.icon_svg)?n=i()('<img src="'.concat(t.icon_svg,'" alt="').concat(t.name,'">')):(0,o.$K)(t.icon_32)&&(0,o.$K)(t.icon_64)&&(n=i()('<img src="'.concat(t.icon_32,'" srcset="').concat((0,o.qi)("%s 1x, %s 2x",[t.icon_32,t.icon_64]),'" alt="').concat(t.name,'">'))),s.text(t.name),r.append(n),a.append(r),a.append(s),a}},{key:"createDiscoverMoreIntegrations",value:function(){return i()('\n            <div class="item-content__description">\n                '.concat("anonymous"==UncannyAutomator.recipe.type?UncannyAutomator.i18n.integration.dontSeeTrigger:UncannyAutomator.i18n.integration.discoverMore,' <a href="').concat((0,o.hl)("https://automatorplugin.com/integrations/",{utm_source:"uncanny_automator",utm_medium:"select_an_integration",utm_content:"discover_more_integrations"}),'" target="_blank">').concat(UncannyAutomator.i18n.learnMore,' <span class="uo-icon uo-icon--external-link-alt"></span></a>\n            </div>\n        '))}},{key:"filterByNonEmptyIntegrations",value:function(e){var t=this;if(["trigger","action"].includes(e)){var n=i().extend(!0,{},UncannyAutomator.integrations);Object.entries(n).forEach((function(n){var a,r,s,c=(s=2,function(e){if(Array.isArray(e))return e}(r=n)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var a,i,o=[],r=!0,s=!1;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);r=!0);}catch(e){s=!0,i=e}finally{try{r||null==n.return||n.return()}finally{if(s)throw i}}return o}}(r,s)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(r,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],u=c[1],d=!1,p=!1,m=!1;"trigger"==e?(d=(a=(0,o.IL)(u.items.triggers)).hasTriggers,m=a.hasAvailableItems,p=a.allItemsArePro):"action"==e&&(d=(a=(0,o.IL)(u.items.actions)).hasActions,m=a.hasAvailableItems,p=a.allItemsArePro),d&&t.integrations.push(i().extend({},u,{id:l,isAvailable:m,isProOnly:p}))}))}}},{key:"sortIntegrationsAlphabetically",value:function(){this.integrations=(0,o.yv)(this.integrations,"name")}},{key:"integrationModalCurrentStep",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(!(0,o.$K)(UncannyAutomator.wp)||(0,o.$K)(UncannyAutomator.wp)&&!UncannyAutomator.wp)&&!UncannyAutomator.hasAccountConnected||(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp&&!UncannyAutomator.hasAccountConnected&&!UncannyAutomator.hasValidProLicense?e=1:((!(0,o.$K)(UncannyAutomator.wp)||(0,o.$K)(UncannyAutomator.wp)&&!UncannyAutomator.wp)&&UncannyAutomator.hasAccountConnected||(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp&&(UncannyAutomator.hasAccountConnected||UncannyAutomator.hasValidProLicense))&&(e=t.connected?3:2),e}}])&&h(t.prototype,n),e}()},181:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(609),i=n.n(a),o=n(179);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const s=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.integrationCode=t,this.createItemIcon()}var t,n;return t=e,(n=[{key:"createItemIcon",value:function(){var e=i()("<div/>",{class:"item-icon"});if((0,o.$K)(UncannyAutomator.integrations[this.integrationCode])){var t,n=UncannyAutomator.integrations[this.integrationCode];(0,o.$K)(n.icon_svg)?t=i()('<img src="'.concat(n.icon_svg,'" alt="').concat(n.name,'">')):(0,o.$K)(n.icon_32)&&(0,o.$K)(n.icon_64)&&(t=i()('<img src="'.concat(n.icon_32,'" srcset="').concat((0,o.qi)("%s 1x, %s 2x",[n.icon_32,n.icon_64]),'" alt="').concat(n.name,'">'))),e.append(t)}return e}}])&&r(t.prototype,n),e}()},842:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(609),i=n.n(a),o=n(179),r=n(25),s=n(549),c=n(619);function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const u=function(){function e(t,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemType=t,this.integrationID=n,this.itemCode=a,this.itemId=i,this.item=UncannyAutomator.recipe.items[i],this.createItemActions()}var t,n;return t=e,(n=[{key:"createItemActions",value:function(){var e=this,t=i()("<div/>",{class:"item-actions"}),n=i()("<div/>",{class:"item-actions__btn"}),a=i()("<i/>",{class:"uo-icon uo-icon--ellipsis-h-alt"}),l=i()("<div/>",{class:"item-actions__dropdown"}),u=i()("<ul/>",{class:"item-actions-dropdown__ul"});n.append(a),t.append(n);var d=i()("<li/>",{class:"item-actions-dropdown__action"}),p=i()("<span/>").text(UncannyAutomator.i18n.delete);if(d.append(p),u.append(d),(0,o.$K)(this.itemType)&&(0,o.$K)(this.itemCode)&&(!(0,o.$K)(this.item)||(0,o.$K)(this.item)&&!this.item.isMissing)){var m=(0,o.Vx)(this.integrationID,this.itemType,this.itemCode);if((0,o.$K)(m.support_link)){var f="support_menu_link-".concat(this.integrationID,"-").concat(this.integrationID,"_").concat(this.itemCode,"-").concat(this.integrationID,"_").concat((0,o.hF)(m.select_option_name,"","").toLowerCase().replace(/\s+|{|}/g,"_")),h=i()("<a/>",{href:(0,o.hl)(m.support_link,{utm_source:"uncanny_automator",utm_medium:"action_menu",utm_content:f}),class:"item-actions-dropdown__action",target:"_blank"}),g=i()("<span/>").text(UncannyAutomator.i18n.support);h.append(g),u.append(h)}}return l.append(u),t.append(l),n.on("click",(function(){t.hasClass("item-actions--open")?(t.removeClass("item-actions--open"),i()(document).off("mouseup.uap-actions-click-outside")):(t.addClass("item-actions--open"),i()(document).on("mouseup.uap-actions-click-outside",(function(e){t.is(e.target)||0!==t.has(e.target).length||(t.removeClass("item-actions--open"),i()(document).off("mouseup.uap-actions-click-outside"))})))})),d.on("click",(function(){if((0,o.$K)(e.itemId)&&UncannyAutomator.recipe.isLive&&UncannyAutomator.recipe.items[e.itemId].isLive){t.removeClass("item-actions--open");var n=new r.Z({title:UncannyAutomator.i18n.confirmationModal.title,warning:(0,o.hF)(UncannyAutomator.i18n.confirmationModal.deleteWarning,"<strong>","</strong>"),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.confirm}});n.setEvents({afterSetEvents:function(){n.show()},onConfirm:function(){n.getElements().modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),(0,o.L8)("delete",{ID:e.itemId},(function(){n.destroy(),"trigger"==e.itemType&&(new s.Z,"anonymous"==UncannyAutomator.recipe.type&&new c.Z),"action"!=e.itemType&&"closure"!=e.itemType||new c.Z,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}),(function(){n.destroy(),console.log("‼️ ERROR-TODO. Couldn't delete the item"),"trigger"==e.itemType&&new s.Z,"action"!=e.itemType&&"closure"!=e.itemType||new c.Z}))},afterHide:function(){n.destroy()}})}else(0,o.$K)(e.itemId)?(d.addClass("item-actions-dropdown__action--loading"),(0,o.L8)("delete",{ID:e.itemId},(function(){"trigger"==e.itemType&&(new s.Z,"anonymous"==UncannyAutomator.recipe.type&&new c.Z),"action"!=e.itemType&&"closure"!=e.itemType||new c.Z}),(function(){console.log("‼️ ERROR-TODO. Couldn't delete the item"),"trigger"==e.itemType&&new s.Z,"action"!=e.itemType&&"closure"!=e.itemType||new c.Z}))):("trigger"==e.itemType&&new s.Z,"action"==e.itemType&&new c.Z)})),t}}])&&l(t.prototype,n),e}()},765:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var a=n(609),i=n.n(a),o=n(179),r=n(25),s=n(741),c=n(378),l=n(549),u=n(619),d=n(867),p=n(276);function m(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const f=function(){function e(t,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemType=t,this.integrationID=n,this.itemCode=a,this.itemId=i,this.item=UncannyAutomator.recipe.items[i],this.createItemSentence(t,a,i)}var t,n;return t=e,(n=[{key:"createItemSentence",value:function(e,t,n){var a,m=(0,o.Vx)(this.integrationID,e,t);this.globalItem=m,a=this.item.isMissing?this.item.sentence:(0,o.Vx)(this.integrationID,this.item.itemType,this.item.itemCode).sentence,a=(0,o.qh)(this.item,a,UncannyAutomator.recipe.items[this.itemId].meta,!0),this.item.isMissing||a.elements.token.on("click",(function(e){var t=i()(e.currentTarget);a.elements.token.removeClass("item-title__token--open"),t.addClass("item-title__token--open");var r=t.parents(".item");r.addClass("item--open"),r.trigger("automator:item:open",r.hasClass("item--open"));var c=t.data("options-id");(0,o.M0)("optionGroup",{itemID:n,groupID:c}),new s.Z(n,c)}));var f=i()("<div/>",{class:"item-title__describe-container"}),h=i()("<div/>",{class:"item-status"});f.append(a.html.addClass("item-title__describe"));var g=new c.Z("checkbox",{color:"green",align:"right",toggle:{on:UncannyAutomator.i18n.status.liveRecipeItem,off:UncannyAutomator.i18n.status.draftRecipeItem},currentValue:UncannyAutomator.recipe.items[n].isLive}),y=g.getFormElement();return h.append(y),f.append(h),this.item.isMissing||y.on("automator:field:change",(function(){var e=g.getValue(),t=!0;if(e&&(t=(0,d.RC)(n).isValid),g.startLoadingAnimation(),t){var i=e?"publish":"draft";if(!e&&UncannyAutomator.recipe.isLive){var s=new r.Z({title:UncannyAutomator.i18n.confirmationModal.title,warning:(0,o.hF)(UncannyAutomator.i18n.confirmationModal.statusWarning,"<strong>","</strong>"),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:UncannyAutomator.i18n.confirm}});s.setEvents({afterSetEvents:function(){s.show()},onConfirm:function(){var t;s.getElements().modal.box.buttons.confirm.addClass("uap-btn--loading").prop("disabled",!0),g.startLoadingAnimation();try{t=a.html.get(0).outerHTML}catch(e){}(0,o.L8)("change_post_status",{post_ID:n,post_status:i,sentence_human_readable:a.brackets,sentence_human_readable_html:t},(function(){s.destroy(),new l.Z,new u.Z,new p.Z,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}),(function(){console.log("‼️ ERROR-TODO. Couldn't set the item status"),s.destroy(),g.stopLoadingAnimation(),g.setValue(!e,!1)}))},onCancel:function(){s.destroy(),g.setValue(!e,!1),g.stopLoadingAnimation()},afterHide:function(){s.destroy()}})}else{var c;try{c=a.html.get(0).outerHTML}catch(e){}(0,o.L8)("change_post_status",{post_ID:n,post_status:i,sentence_human_readable:a.brackets,sentence_human_readable_html:c},(function(){g.stopLoadingAnimation(),new p.Z}),(function(){console.log("‼️ ERROR-TODO. Couldn't set the item status"),g.stopLoadingAnimation(),g.setValue(!e,!1)}))}}else setTimeout((function(){g.stopLoadingAnimation(),g.setValue(!1,!1)}),1e3)})),f}}])&&m(t.prototype,n),e}()},751:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(609),i=n.n(a),o=n(179);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r(this,e),this.integrationId=t,this.integrationName=n,this.createItemTag()}var t,n;return t=e,(n=[{key:"createItemTag",value:function(){var e=UncannyAutomator.integrations[this.integrationId],t=i()("<div/>",{class:"item-title__integration uap-clear"}),n=i()("<div/>",{class:"item-title__tag"});return(0,o.$K)(e)?n.text(e.name):n.text(this.integrationName),t.append(n),t}}])&&s(t.prototype,n),e}()},741:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(609),jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__),_Utilities_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179),_Validation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(867),_Triggers_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(549),_Actions_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(619),_Modal_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25),_Markdown_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(778);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var ItemOptions=function(){function ItemOptions(e,t){_classCallCheck(this,ItemOptions),this.itemId=e,this.optionId=t,this.item=UncannyAutomator.recipe.items[e],this.fields=this.item.options[this.optionId].fields,this.buttons=this.item.options[this.optionId].buttons,this.create(),this.initTokenSelector(),this.initTinyMCE(),this.initCodeMirror()}return _createClass(ItemOptions,[{key:"create",value:function(){var e=(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.M0)("item",{id:this.itemId}).contentContainer,t=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options"}),n=this.createButtons(),a=this.createFields();this.fieldsContainer=a,t.append(a);var i=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options__notices"});this.noticeContainer=i,t.append(i),t.append(n),e.html(t)}},{key:"createFields",value:function(){var e=this,t=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options__group"});return jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.fields,(function(n,a){var i=a.getAttributes().fieldType;"repeater"==i&&a.createFields(),a.createFormElement(),t.append(a.getFormElement()),["textarea","group","repeater"].includes(i)?"group"==i?a.fields.forEach((function(t){"textarea"!==t.getAttributes().fieldType&&t.getField().on("keyup",(function(t){13==t.keyCode&&e.saveButton.trigger("click")}))})):"repeater"==i&&a.fieldRows.forEach((function(t,n){t.forEach((function(t,n){t.getField().on("keyup",(function(t){13==t.keyCode&&e.saveButton.trigger("click")}))}))})):a.getField().on("keyup",(function(t){13==t.keyCode&&e.saveButton.trigger("click")}))})),t}},{key:"createButtons",value:function createButtons(){var _this2=this,container=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options__buttons"}),automatorButtons=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options__automator-buttons"}),developerButtons=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"item-options__developer-buttons"}),saveButton=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"uap-btn uap-btn--primary"}),cancelButton=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);return"trigger"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),"action"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),"closure"==this.item.itemType&&saveButton.text(UncannyAutomator.i18n.save),this.saveButton=saveButton,automatorButtons.append(saveButton),automatorButtons.append(cancelButton),jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.buttons,(function(index,button){var $buttonElement=jquery__WEBPACK_IMPORTED_MODULE_0___default()("<div/>",{class:"uap-btn"}).text(button.text);(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.$K)(button.css_classes)&&$buttonElement.addClass(button.css_classes);var doOnClick=function(){};if((0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.$K)(button.on_click))try{doOnClick=eval("(".concat(button.on_click.replace("<script>","").replace("<\/script>","").trim(),")"))}catch(e){console.log(e),console.log(button.on_click)}$buttonElement.on("click",(function(){var e;doOnClick($buttonElement,{item:_this2.item,values:(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.q7)(_this2.itemId)},(e={},(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.$K)(button.modules)&&(button.modules.includes("modal")&&(e.Modal=_Modal_js__WEBPACK_IMPORTED_MODULE_5__.Z),button.modules.includes("markdown")&&(e.Markdown=_Markdown_js__WEBPACK_IMPORTED_MODULE_6__.Z)),e))})),developerButtons.append($buttonElement)})),container.append(automatorButtons),container.append(developerButtons),saveButton.on("click",(function(){if((0,_Validation__WEBPACK_IMPORTED_MODULE_2__.R3)(_this2.fieldsContainer).isValid){saveButton.addClass("uap-btn--loading uap-btn--disabled");var e,t=_this2.itemId,n=_this2.optionId,a=_this2.getOptionValue(),i=(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.qh)(_this2.item,_this2.item.meta.sentence,jquery__WEBPACK_IMPORTED_MODULE_0___default().extend({},_this2.item.meta,(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.q7)(_this2.itemId)));try{e=i.html.get(0).outerHTML}catch(e){}(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.L8)("update",{itemId:t,optionCode:n,optionValue:a,sentence_human_readable:i.brackets,sentence_human_readable_html:e},(function(e){_this2.fields.forEach((function(e){e.getFormElement().trigger("saved")})),"trigger"==_this2.item.itemType&&new _Triggers_js__WEBPACK_IMPORTED_MODULE_3__.Z,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions_js__WEBPACK_IMPORTED_MODULE_4__.Z;var t=UncannyAutomator.recipe.items[_this2.item.id].isValid,n=(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.M0)("item",{id:_this2.item.id});t?UncannyAutomator.recipe.isLive||_this2.item.isLive||n.item.find('.item-status input[type="checkbox"]').prop("checked",!0).trigger("change"):n.item.find(".item-title__token:not(.item-title__token--filled)").first().trigger("click")}),(function(e){console.log("‼️ ERROR-TODO. Couldn't save the options of the item"),"trigger"==_this2.item.itemType&&new _Triggers_js__WEBPACK_IMPORTED_MODULE_3__.Z,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions_js__WEBPACK_IMPORTED_MODULE_4__.Z;try{(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.M0)("item",{id:_this2.itemId}).item.find('.item-title__token[data-options-id="'.concat(n,'"]')).trigger("click")}catch(e){}}))}})),cancelButton.on("click",(function(){"trigger"==_this2.item.itemType&&new _Triggers_js__WEBPACK_IMPORTED_MODULE_3__.Z,"action"!=_this2.item.itemType&&"closure"!=_this2.item.itemType||new _Actions_js__WEBPACK_IMPORTED_MODULE_4__.Z})),container}},{key:"initTokenSelector",value:function(){jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.fields,(function(e,t){t.initTokenSelector()}))}},{key:"initTinyMCE",value:function(){jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.fields,(function(e,t){"textarea"==t.getAttributes().fieldType&&t.initTinyMCE()}))}},{key:"initCodeMirror",value:function(){jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.fields,(function(e,t){t.initCodeMirror()}))}},{key:"getOptionValue",value:function(){var e={},t=!1,n=!1;return jquery__WEBPACK_IMPORTED_MODULE_0___default().each(this.fields,(function(a,i){var o=i.getAttributes().optionCode,r=i.getValue();if(["select","radio"].includes(i.getAttributes().fieldType)){if(t=!0,i.getAttributes().supportsMultipleValues)try{r=JSON.stringify(r)}catch(e){console.log(e)}e[(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.qi)("%s_readable",[o])]=i.getReadableValue();var s=i.getSelectCustomValue();"automator_custom_value"==r&&(e[(0,_Utilities_js__WEBPACK_IMPORTED_MODULE_1__.qi)("%s_custom",[o])]=s)}else"repeater"==i.getAttributes().fieldType&&(n=!0,r=JSON.stringify(r));e[o]=r})),n||t||1!=Object.keys(e).length||(e=e[Object.keys(e)[0]]),e}}]),ItemOptions}();const __WEBPACK_DEFAULT_EXPORT__=ItemOptions},778:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r}),n(609);var a=n(179);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";i(this,e),this.content=t}var t,n;return t=e,(n=[{key:"getHTML",value:function(){var e=(0,a.r)(this.content);return e=this.parseItalicsAndBold(e),this.parseAnchors(e)}},{key:"parseItalicsAndBold",value:function(e){return(e=(e=(e=e.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm,"$1<strong>$2</strong>")).replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm,"$1<em>$2</em>")).replace(/(\*\*)(?=\S)([^\r]*?\S[*]*)\1/g,"<strong>$2</strong>")).replace(/(\*)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")}},{key:"parseAnchors",value:function(e){return e.replace(/(\[((?:\[[^\]]*]|[^\[\]])*)]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,(function(e,t,n,i,o,r,s,c){(0,a.$K)(c)||(c=""),e=t;var l=n,u=i.toLowerCase(),d=o,p=c;if(!d){if(u||(u=l.toLowerCase().replace(/ ?\n/g," ")),d="#"+u,!(e.search(/\(\s*\)$/m)>-1))return e;d=""}var m='<a href="'+(d=encodeURI(d,"*_",!1))+'" target="_blank"';return""!==p&&null!==p&&(p=p.replace(/"/g,"&quot;"),m+=' title="'+(p=encodeURI(p,"*_",!1))+'"'),m+">"+l+"</a>"}))}}])&&o(t.prototype,n),e}()},234:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(609),i=n.n(a),o=n(179),r=n(156);function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n(549),n(619),n(849);const c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.itemType=t,this.shouldCreateMetaboxFooter()&&this.createFooter()}var t,n;return t=e,(n=[{key:"shouldCreateMetaboxFooter",value:function(){var e=!1;if("trigger"==this.itemType){var t=(0,o.Wr)("get",{filter:{itemType:"trigger"}});(0,o.xb)(t)&&(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp&&"anonymous"!=UncannyAutomator.recipe.type||(e=!0)}if("action"==this.itemType){var n=(0,o.Wr)("get",{filter:{itemType:"action"}});!(0,o.xb)(n)&&(e=!0)}return e}},{key:"createFooter",value:function(){var e=this,t=i()("<div/>",{class:"metabox__footer"}),n=i()("<div/>",{class:"uap-btn uap-btn--secondary"});if(("action"==this.itemType||"trigger"==this.itemType&&"user"==UncannyAutomator.recipe.type)&&t.append(n),"trigger"==this.itemType&&("user"==UncannyAutomator.recipe.type&&n.text(UncannyAutomator.i18n.trigger.addAnother),"anonymous"==UncannyAutomator.recipe.type)){var a=this.createAnonymousNotice();t.append(a)}"action"==this.itemType&&(n.text(UncannyAutomator.i18n.action.addAnother),t.addClass("add-action-btn")),"trigger"!=this.itemType&&"action"!=this.itemType||n.on("click",(function(){new r.Z(e.itemType)})),(0,o.M0)("metabox",{type:this.itemType}).append(t)}},{key:"createAnonymousNotice",value:function(){return i()('\n            <div class="description">\n                '.concat(UncannyAutomator.i18n.recipeType.everyoneOnlyOneTrigger,' <a href="').concat((0,o.hl)("https://automatorplugin.com/knowledge-base/managing-triggers/",{utm_source:"uncanny_automator",utm_medium:"anonymous_recipe_one_trigger",utm_content:"learn_more"}),'" target="_blank">').concat(UncannyAutomator.i18n.learnMore,' <span class="uo-icon uo-icon--external-link-alt"></span></a>\n            </div>\n        '))}}])&&s(t.prototype,n),e}()},849:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var a=n(609),i=n.n(a),o=n(179),r=n(842),s=n(181),c=n(751),l=n(378),u=n(25),d=n(619);function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=function(){function e(t,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"buttonContainer",void 0),m(this,"button",void 0),m(this,"buttonIcon",void 0),m(this,"removeButton",void 0),m(this,"asyncModeField",void 0),m(this,"asyncModeHTML",void 0),m(this,"delayNumberField",void 0),m(this,"delayNumberHTML",void 0),m(this,"delayUnitField",void 0),m(this,"delayUnitHTML",void 0),m(this,"scheduleDateField",void 0),m(this,"scheduleDateHTML",void 0),m(this,"scheduleTimeField",void 0),m(this,"scheduleTimeHTML",void 0),m(this,"scheduleNoticeHTML",void 0),m(this,"modal",void 0),this.itemType=t,this.integrationID=n,this.itemCode=a,this.itemId=i,this.item=UncannyAutomator.recipe.items[i],this.asyncMode=this.item.meta.async_mode,UncannyAutomator.proVersion.startsWith("2")?null:this.createAsyncButton()}var t,n;return t=e,(n=[{key:"hasSchedule",value:function(){return!!this.asyncMode&&("delay"==this.asyncMode?this.item.meta.async_delay_number&&this.item.meta.async_delay_unit:"schedule"==this.asyncMode&&this.item.meta.async_schedule_time&&this.item.meta.async_schedule_date)}},{key:"getButtonText",value:function(){if(this.hasSchedule()){var e=UncannyAutomator.i18n.action.asyncActions[this.asyncMode];return(e+=" ")+"<strong>"+this.item.meta.async_sentence+"</strong>"}return UncannyAutomator.i18n.action.asyncActions.delay}},{key:"createAsyncButton",value:function(){var e=this;return this.buttonContainer=i()("<div/>",{class:"item-async"}),this.button=i()("<div/>",{class:"item-async__btn"}),this.buttonIcon=i()("<i/>",{class:"uo-icon uo-icon--clock"}),this.button.html(this.getButtonText()),this.button.prepend(this.buttonIcon),this.buttonContainer.append(this.button),this.hasSchedule()&&this.createRemoveButton(),this.isNew()&&this.createBadge(UncannyAutomator.i18n.action.asyncActions.new),this.button.on("click",(function(){e.buttonContainer.hasClass("disabled")||e.showModal()})),this.buttonContainer.on("automator:asyncButton:maybeDisable",(function(e,t){var n=i()(e.currentTarget);t?(n.attr("uap-tooltip",UncannyAutomator.i18n.action.asyncActions.pleaseSave),n.attr("uap-flow","down"),n.addClass("disabled")):(n.removeAttr("uap-tooltip"),n.removeClass("disabled"))})),this.buttonContainer}},{key:"enable",value:function(){this.button.removeAttr("uap-tooltip"),this.button.removeAttr("disabled")}},{key:"isNew",value:function(){return!0}},{key:"createBadge",value:function(e){this.buttonBadge=i()("<span/>",{class:"async-button__badge"}),this.buttonBadge.text(e),this.button.append(this.buttonBadge)}},{key:"createRemoveButton",value:function(){var e=this;this.removeButton=i()("<span/>",{class:"async-remove"}),this.removeButtonIcon=i()("<i/>",{class:"uo-icon uo-icon--times"}),this.removeButton.text(UncannyAutomator.i18n.action.asyncActions.remove),this.removeButton.on("click",(function(){e.removeSchedule()})),this.removeButton.prepend(this.removeButtonIcon),this.buttonContainer.append(this.removeButton)}},{key:"createModalContent",value:function(){var e=i()("<div/>",{class:"async-action-modal"});if(this.asyncModeHTML=this.createAsyncModeHTML(),this.asyncModeHTML.find(".form-radio__container:first").after(this.createDelayOptions()),this.asyncModeHTML.find(".form-radio__container:last").after(this.createScheduleOptions()),this.attachModeChangeEvent(),e.append(this.asyncModeHTML),this.hasSchedule()){var t=i()("<div/>",{class:"async-notice async-notice__blue"}),n=i()("<i/>",{class:"uo-icon uo-icon--exclamation-triangle"});t.append(n),t.append(UncannyAutomator.i18n.action.asyncActions.modal.scheduleNotice2),e.append(t)}return e}},{key:"showModal",value:function(){var e=UncannyAutomator.i18n.action.asyncActions.modal.confirm;this.hasSchedule()&&"schedule"==this.asyncMode&&(e=UncannyAutomator.i18n.action.asyncActions.schedule),this.modal=new u.Z({title:UncannyAutomator.i18n.action.asyncActions.modal.title,content:this.createModalContent(),buttons:{cancel:UncannyAutomator.i18n.cancel,confirm:e}},{size:"large",customClass:"async-action"}),this.modalEvents()}},{key:"modalEvents",value:function(){var e=this;this.modal.setEvents({afterSetEvents:function(){e.modal.show()},onConfirm:function(){e.submitModal()},afterHide:function(){e.modal.destroy()}})}},{key:"submitModal",value:function(){var e=this.modal.getElements().modal.box.buttons.confirm;if(e.addClass("uap-btn--loading").prop("disabled",!0),this.validateForm().isValid){var t,n=this.asyncModeField.getValue(),a=this.delayNumberField.getValue(),i=this.delayUnitField.getValue(),o=this.scheduleTimeField.getValue(),r=this.scheduleDateField.getValue();t="delay"==n?this.delaySentence():this.scheduleSentence(),this.saveSchedule(n,a,i,o,r,t)}else e.removeClass("uap-btn--loading").prop("disabled",!1)}},{key:"delaySeconds",value:function(){var e,t=this.delayUnitField.getValue(),n=this.delayNumberField.getValue();switch(t){case"seconds":e=1;break;case"minutes":e=60;break;case"hours":e=3600;break;case"days":e=86400;break;case"years":e=31536e3;break;default:e=1}return n*e}},{key:"delaySentence",value:function(){var e=this.delayUnitField.getValue();return 1==this.delayNumberField.getValue()&&(e=e.slice(0,-1)),this.delayNumberField.getValue()+" "+UncannyAutomator.i18n.action.asyncActions.modal[e].toLowerCase()}},{key:"scheduleSeconds",value:function(){return Date.parse(this.scheduleDateField.getValue()+" "+this.scheduleTimeField.getValue())}},{key:"scheduleSentence",value:function(){return this.scheduleDateField.getValue()+" @ "+this.scheduleTimeField.getValue()}},{key:"saveSchedule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;(0,o.L8)("schedule_action",{recipeId:UncannyAutomator.recipe.id,actionId:this.itemId,asyncMode:e,delayNumber:n,delayUnit:a,scheduleTime:i,scheduleDate:r,scheduleSentence:s},(function(){t.modal.destroy(),new d.Z,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}),(function(){t.modal.destroy(),console.log("‼️ ERROR-TODO. Couldn't schedule the item"),new d.Z}))}},{key:"removeSchedule",value:function(){this.removeButtonIcon.removeClass("uo-icon--times"),this.removeButtonIcon.addClass("uo-icon--loading uo-icon--rotate"),(0,o.L8)("remove_schedule",{recipeId:UncannyAutomator.recipe.id,actionId:this.itemId},(function(){new d.Z,UncannyAutomator.recipe.isValid||UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}),(function(){console.log("‼️ ERROR-TODO. Couldn't schedule the item"),new d.Z}))}},{key:"createTimeZone",value:function(){var e=i()("<a/>",{href:UncannyAutomator.i18n.action.asyncActions.modal.timezoneLink,target:"_blank"}),t=i()("<i/>",{class:"uo-icon uo-icon--question-circle"}),n=i()("<span/>",{class:"schedule-fields__description"}).html("<strong>"+UncannyAutomator.i18n.action.asyncActions.modal.timezone+"</strong>: "+UncannyAutomator.i18n.action.asyncActions.modal.timezoneString);return e.append(t),n.append(e),n}},{key:"createAsyncModeHTML",value:function(){return this.asyncModeField=new l.Z("radio",{itemType:"action",optionCode:"schedule_type",name:"schedule-type",isRequired:!0,currentValue:this.asyncMode?this.asyncMode:"delay",options:[{value:"delay",text:UncannyAutomator.i18n.action.asyncActions.delay},{value:"schedule",text:UncannyAutomator.i18n.action.asyncActions.schedule}]}),this.asyncModeField.createFormElement().addClass("schedule-type-radio")}},{key:"attachModeChangeEvent",value:function(){var e=this;this.asyncModeHTML.on("automator:field:change",(function(){var t,n=e.asyncModeField.getValue();t="schedule"==n?UncannyAutomator.i18n.action.asyncActions.schedule:UncannyAutomator.i18n.action.asyncActions.modal.confirm,e.hasSchedule()||("schedule"==n?e.scheduleNoticeHTML.removeClass("hidden"):e.scheduleNoticeHTML.addClass("hidden")),e.modal.elements.modal.box.buttons.confirm.text(t)}))}},{key:"createScheduleOptions",value:function(){var e=i()("<div/>",{class:"schedule-options"}),t=i()("<span/>",{class:"async-mode__description"}).text(UncannyAutomator.i18n.action.asyncActions.modal.scheduleDesc),n=i()("<div/>",{class:"schedule-fields"});return this.hasSchedule()||(this.scheduleNoticeHTML=i()("<div/>",{class:"schedule-notice hidden"}),i()("<i/>",{class:"uo-icon uo-icon--question-circle"}),this.scheduleNoticeHTML.text(UncannyAutomator.i18n.action.asyncActions.modal.scheduleNotice1),this.scheduleNoticeHTML.addClass("schedule-notice__yellow")),e.append(t),n.append(this.createScheduleDateHTML()),n.append(this.createScheduleTimeHTML()),e.append(n),e.append(this.createTimeZone()),e.append(this.scheduleNoticeHTML),e}},{key:"createDelayOptions",value:function(){var e=i()("<div/>",{class:"delay-options"}),t=i()("<span/>",{class:"async-mode__description"}).text(UncannyAutomator.i18n.action.asyncActions.modal.delayDesc),n=i()("<div/>",{class:"delay-fields"});this.delayNumberHTML=this.createDelayNumberHTML(),this.delayUnitHTML=this.createDelayUnitHTML();var a=i()("<span/>",{class:"delay-fields__description"}).text(UncannyAutomator.i18n.action.asyncActions.modal.after);return n.append(this.delayNumberHTML),n.append(this.delayUnitHTML),n.append(a),e.append(t),e.append(n),e}},{key:"createDelayNumberHTML",value:function(){this.delayNumberField=new l.Z("int",{itemType:"action",optionCode:"delay-number",isRequired:!0,placeholder:"10",supportsTokens:!1,currentValue:this.item.meta.async_delay_number?this.item.meta.async_delay_number:""},!0,this.validateDelayNumber);var e=this.delayNumberField.createFormElement();return e.addClass("delay-fields__number"),this.delayNumberField.initCodeMirror(),e}},{key:"createDelayUnitHTML",value:function(){return this.delayUnitField=new l.Z("select",{itemType:"action",optionCode:"delay-unit",currentValue:this.item.meta.async_delay_unit?this.item.meta.async_delay_unit:"minutes",customClass:"hide-this",isRequired:!0,options:[{value:"seconds",text:UncannyAutomator.i18n.action.asyncActions.modal.seconds},{value:"minutes",text:UncannyAutomator.i18n.action.asyncActions.modal.minutes},{value:"hours",text:UncannyAutomator.i18n.action.asyncActions.modal.hours},{value:"days",text:UncannyAutomator.i18n.action.asyncActions.modal.days},{value:"years",text:UncannyAutomator.i18n.action.asyncActions.modal.years}]}),this.delayUnitField.createFormElement().addClass("delay-fields__unit")}},{key:"createScheduleDateHTML",value:function(){this.scheduleDateField=new l.Z("date",m({itemType:"action",optionCode:"schedule-date",isRequired:!0,placeholder:UncannyAutomator.i18n.action.asyncActions.modal.today,dateFormat:UncannyAutomator.i18n.action.asyncActions.modal.dateFormat,supportsTokens:!1,currentValue:this.item.meta.async_schedule_date?this.item.meta.async_schedule_date:""},"placeholder",UncannyAutomator.i18n.format.date.selectDate));var e=this.scheduleDateField.createFormElement();return e.addClass("schedule-fields__date"),this.scheduleDateField.initCodeMirror(),e}},{key:"createScheduleTimeHTML",value:function(){this.scheduleTimeField=new l.Z("time",m({itemType:"action",optionCode:"schedule-time",isRequired:!0,placeholder:"11:00 AM",timeFormat:"h:i K",timeAltFormat:"h:i K",supportsTokens:!1,currentValue:this.item.meta.async_schedule_time?this.item.meta.async_schedule_time:""},"placeholder",UncannyAutomator.i18n.format.date.selectTime));var e=this.scheduleTimeField.createFormElement();return e.addClass("schedule-fields__time"),this.scheduleTimeField.initCodeMirror(),e}},{key:"validateForm",value:function(){var e;switch(this.asyncModeField.getValue()){case"schedule":e=this.validateScheduleFields();break;case"delay":e=this.delayNumberField.validate();break;default:e={isValid:!1,message:UncannyAutomator.i18n.action.asyncActions.modal.validation.unsupported}}return e.isValid?{isValid:!0}:e}},{key:"validateScheduleFields",value:function(){var e=this.scheduleDateField.validate();return e.isValid&&(e=this.scheduleTimeField.validate()),e}},{key:"validateDelayNumber",value:function(e,t){return e<1?{isValid:!1,message:UncannyAutomator.i18n.action.asyncActions.modal.validation.positiveNumber}:{isValid:!0}}}])&&p(t.prototype,n),e}();var h=n(765);function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const y=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i().each(n,(function(e,n){if(t==n.itemType){var i=a.createItem(e);(0,o.M0)("metabox",{type:t}).append(i)}}))}var t,n;return t=e,(n=[{key:"createItem",value:function(e){var t=UncannyAutomator.recipe.items[e],n=i()("<div/>",{class:"item","data-id":e});t.isMissing&&n.addClass("item--missing"),t.meta.async_mode&&n.addClass("item--hasSchedule"),(0,o.xb)(t.inlineCss)||(t.inlineCss=t.inlineCss.replace(/{{item_id}}/g,e),n.prepend(t.inlineCss));var a=this.createHeader(t.integrationCode,t.itemType,t.itemCode,e),r=this.createNotice(t);return n.append(a),n.append(r),n.on("automator:item:open",(function(e,t){var a=n.find(".item-async");i()(a[0]).trigger("automator:asyncButton:maybeDisable",t)})),n}},{key:"createHeader",value:function(e,t,n,a){var l=i()("<div/>"),u=i()("<div/>",{class:"item-title uap-clear"}),d=UncannyAutomator.recipe.items[a];d.isMissing&&(e=null);var p=new r.Z(t,e,n,a);l.append(p);var m=new s.Z(e);l.append(m);var g=d.integrationName,y=new c.Z(e,g);u.append(y);var v=new h.Z(t,e,n,a);u.append(v),l.append(u);var _=i()("<div/>",{class:"item__content"});if(l.append(_),"action"==t&&(0,o.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp){var b=new f(t,e,n,a,l);l.append(b)}return l}},{key:"createNotice",value:function(e){var t;return e.isMissing&&(t=i()("<div/>",{class:"item-notice"})).text(UncannyAutomator.i18n.itemMissing),t}}])&&g(t.prototype,n),e}()},25:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(609),i=n.n(a),o=n(179);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),this.elements={container:null,automatorContainer:null,modal:{container:null,box:{container:null,title:null,warning:null,buttons:{container:null,cancel:null,confirm:null}}}},this.elements.container=i()("body"),this.isVisible=!1,this.config=i().extend(!0,{fadeDuration:150,size:"medium",warningFirst:!1},n),this.content=i().extend({},{buttons:{cancel:UncannyAutomator.i18n.cancel}},t),this.create(),this}var t,n;return t=e,(n=[{key:"create",value:function(){var e,t,n=i()("<div/>",{class:"uap"}),a=i()("<div/>",{class:"modal"}),r=i()("<div/>",{class:"modal__box"});if((0,o.$K)(this.config.size)&&["small","medium","large","extra-large"].includes(this.config.size)&&a.addClass("modal--".concat(this.config.size)),(0,o.$K)(this.config.customClass)&&a.addClass("modal--".concat(this.config.customClass)),this.elements.automatorContainer=n,this.elements.modal.container=a,this.elements.modal.box.container=r,(0,o.$K)(this.content.title)){var s=i()("<div/>",{class:"modal__title"}).html(this.content.title);r.append(s),this.elements.modal.box.title=s}if((0,o.$K)(this.content.content)){e=i()("<div/>",{class:"modal__content"});try{e.append(this.content.content)}catch(t){e.html(this.content.content)}r.append(e),this.elements.modal.box.content=e}(0,o.$K)(this.content.warning)&&(t=i()("<div/>",{class:"modal__warning"}).html(this.content.warning),this.elements.modal.box.warning=t),(0,o.$K)(this.config.warningFirst)&&this.config.warningFirst?((0,o.$K)(this.content.warning)&&r.append(t),(0,o.$K)(this.content.content)&&r.append(e)):((0,o.$K)(this.content.content)&&r.append(e),(0,o.$K)(this.content.warning)&&r.append(t));var c=i()("<div/>",{class:"modal__buttons"}),l=i()("<button/>",{class:"uap-btn uap-btn--secondary"}).html(this.content.buttons.cancel);if(c.append(l),this.elements.modal.box.buttons.container=c,this.elements.modal.box.buttons.cancel=l,(0,o.$K)(this.content.buttons.confirm)){var u=i()("<button/>",{class:"uap-btn uap-btn--primary"}).html(this.content.buttons.confirm);c.append(u),this.elements.modal.box.buttons.confirm=u}r.append(c),a.append(r),n.append(a),this.elements.container.append(n),i()("html").addClass("automator-modal-open"),this.bind()}},{key:"setEvents",value:function(e){var t=this,n=function(){};this.events={afterSetEvents:(0,o.$K)(e.afterSetEvents)?e.afterSetEvents:n,afterShow:(0,o.$K)(e.afterShow)?e.afterShow:n,afterHide:(0,o.$K)(e.afterHide)?e.afterHide:n,onConfirm:(0,o.$K)(e.onConfirm)?e.onConfirm:n,onCancel:(0,o.$K)(e.onCancel)?e.onCancel:n},(0,o.$K)(e.onCancel)||(this.events.onCancel=function(){t.hide()}),this.events.afterSetEvents()}},{key:"destroy",value:function(){var e=this;this.unbind(),this.isVisible?this.hide((function(){e.elements.automatorContainer.remove()})):e.elements.automatorContainer.remove(),i()("html").removeClass("automator-modal-open")}},{key:"bind",value:function(){var e=this;(0,o.$K)(this.elements.modal.box.buttons.cancel)&&this.elements.modal.box.buttons.cancel.on("click",(function(){e.events.onCancel()})),(0,o.$K)(this.elements.modal.box.buttons.confirm)&&this.elements.modal.box.buttons.confirm.on("click",(function(){e.events.onConfirm()}))}},{key:"unbind",value:function(){(0,o.$K)(this.elements.modal.box.buttons.cancel)&&this.elements.modal.box.buttons.cancel.unbind("click"),(0,o.$K)(this.elements.modal.box.buttons.confirm)&&this.elements.modal.box.buttons.confirm.unbind("click")}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this;e=(0,o.$K)(e)?e:this.events.afterShow,this.isVisible=!0,this.elements.modal.container.fadeIn(t.config.fadeDuration,e)}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this;e=(0,o.$K)(e)?e:this.events.afterHide,this.isVisible=!1,this.elements.modal.container.fadeOut(t.config.fadeDuration,e),i()("html").removeClass("automator-modal-open")}},{key:"getElements",value:function(){return this.elements}}])&&s(t.prototype,n),e}()},413:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(609),i=n.n(a),o=n(179),r=n(276),s=n(378);function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements={metabox:i()("#uo-automator-publish-metabox"),timesPerUser:{editLink:null,hiddenBox:null,saveButton:null,cancelButton:null,endPoint:"recipe_completions_allowed"},timesPerRecipe:{editLink:null,hiddenBox:null,saveButton:null,cancelButton:null,endPoint:"recipe_max_completions_allowed"},toggle:null},this.createMetabox()}var t,n;return t=e,(n=[{key:"createMetabox",value:function(){var e=i()("<div/>",{id:"uap-publish-metabox"}),t=i()("<div/>",{class:"metabox__content"}),n=i()("<div/>",{class:"metabox__footer"});if("anonymous"!=UncannyAutomator.recipe.type){var a=i()("<div/>",{class:"publish-row"}),c=i()("<div/>",{class:"publish-row__visible"}),l=i()("<span/>",{class:"publish-row__icon"}),u=i()("<i/>",{class:"uo-icon uo-icon--repeat-alt"}),d=i()("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.timesPerUser);UncannyAutomator.recipe.publish.timesPerUser=-1==UncannyAutomator.recipe.publish.timesPerUser?"":UncannyAutomator.recipe.publish.timesPerUser;var p=(0,o.xb)(UncannyAutomator.recipe.publish.timesPerUser)?UncannyAutomator.i18n.publish.unlimited:UncannyAutomator.recipe.publish.timesPerUser,m=i()("<span/>",{class:"publish-row__value"}).text(p),f=i()("<span/>",{class:"publish-row__edit"}).text(UncannyAutomator.i18n.edit),h=i()("<div/>",{class:"publish-row__hidden"}),g=i()("<div/>",{class:"publish-row__settings"});this.elements.timesPerUser.editLink=f,this.elements.timesPerUser.hiddenBox=h;var y=new s.Z("int",{currentValue:UncannyAutomator.recipe.publish.timesPerUser,description:UncannyAutomator.i18n.publish.leaveEmpty,placeholder:UncannyAutomator.i18n.publish.unlimited},!0,(function(e,t){var n={isValid:!1,message:""};return e>=1?n.isValid=!0:n.message=UncannyAutomator.i18n.publish.oneOrBigger,n}));this.timesField=y;var v=i()("<div/>",{class:"publish-row__buttons"}),_=i()("<div/>",{class:"uap-btn uap-btn--primary"}).text(UncannyAutomator.i18n.save),b=i()("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);this.elements.timesPerUser.saveButton=_,this.elements.timesPerUser.cancelButton=b,v.append(_),v.append(b),g.append(y.getFormElement()),g.append(v),h.append(g),l.append(u),c.append(l),c.append(d),c.append(m),c.append(f),a.append(c),a.append(h),t.append(a)}var k=this.timesPerRecipe();t.append(k);var w=i()("<div/>",{class:"publish-row"}),A=i()("<div/>",{class:"publish-row__visible"}),C=i()("<span/>",{class:"publish-row__icon"}),U=i()("<i/>",{class:"uo-icon uo-icon--user-astronaut"}),T=i()("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.recipeType),x=i()("<span/>",{class:"publish-row__value"}),E=i()('\n\t\t\t\t<a href="'.concat((0,o.hl)("https://automatorplugin.com/knowledge-base/creating-a-recipe/",{utm_source:"uncanny_automator",utm_medium:"publish_metabox",utm_content:"recipe_type_question_icon"}),'" class="publish-row__learn-more" target="_blank"><span class="uo-icon uo-icon--question-circle"></span></a>\n\t\t\t'));"user"==UncannyAutomator.recipe.type&&x.text(UncannyAutomator.i18n.recipeType.userRecipeName),"anonymous"==UncannyAutomator.recipe.type&&x.text(UncannyAutomator.i18n.recipeType.everyoneRecipeName),C.append(U),A.append(C),A.append(T),A.append(x),A.append(E),w.append(A),t.append(w);var D=i()("<div/>",{class:"publish-row"}),M=i()("<div/>",{class:"publish-row__visible"}),S=i()("<span/>",{class:"publish-row__icon"}),O=i()("<i/>",{class:"uo-icon uo-icon--calendar-alt"}),I=i()("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.createdOn),L=i()("<span/>",{class:"publish-row__value"}).text(UncannyAutomator.recipe.publish.createdOn);S.append(O),M.append(S),M.append(I),M.append(L),D.append(M),t.append(D);var R=i()("<div/>",{class:"publish-row"}),F=i()("<div/>",{class:"publish-row__visible"}),V=i()("<a/>",{class:"publish-row__copy-to-draft button button-secondary",href:UncannyAutomator.recipe.publish.copyToDraft.replace(/&amp;/g,"&")}).text(UncannyAutomator.i18n.publish.copyRecipe);F.append(V),R.append(F),t.append(R);var P=i()("<div/>",{class:"publish-footer__row uap-clear"}),$=i()("<div/>",{class:"publish-footer__left"}),K=i()("<a/>",{class:"publish-footer__move-to-draft",href:UncannyAutomator.recipe.publish.moveToTrash.replace(/&amp;/g,"&")}).text(UncannyAutomator.i18n.proOnly.moveToTrash),j=i()("<div/>",{class:"publish-footer__right"}),N=new s.Z("checkbox",{color:"gutenberg",align:"right",toggle:{on:UncannyAutomator.i18n.status.liveRecipe,off:UncannyAutomator.i18n.status.draftRecipe},currentValue:UncannyAutomator.recipe.isLive});UncannyAutomator.recipe.publish.statusToggle=N;var q=N.getFormElement();this.recipeStatusToggle=N,this.elements.toggle=q,$.append(K),j.append(q),P.append($),P.append(j),n.append(P),e.append(t),e.append(n),this.elements.metabox.html(e),new r.Z,this.bind(),this.validateStatus()}},{key:"timesPerRecipe",value:function(){var e=i()("<div/>",{class:"publish-row"}),t=i()("<div/>",{class:"publish-row__visible"}),n=i()("<span/>",{class:"publish-row__icon"}),a=i()("<i/>",{class:"uo-icon uo-icon--stopwatch-20"}),r=i()("<span/>",{class:"publish-row__name"}).text(UncannyAutomator.i18n.publish.timesPerRecipe);UncannyAutomator.recipe.publish.timesPerRecipe=-1==UncannyAutomator.recipe.publish.timesPerRecipe?"":UncannyAutomator.recipe.publish.timesPerRecipe;var c=(0,o.xb)(UncannyAutomator.recipe.publish.timesPerRecipe)?UncannyAutomator.i18n.publish.unlimited:UncannyAutomator.recipe.publish.timesPerRecipe,l=i()("<span/>",{class:"publish-row__value"}).text(c),u=i()("<span/>",{class:"publish-row__edit"}).text(UncannyAutomator.i18n.edit),d=i()("<div/>",{class:"publish-row__hidden"}),p=i()("<div/>",{class:"publish-row__settings"});this.elements.timesPerRecipe.editLink=u,this.elements.timesPerRecipe.hiddenBox=d;var m=new s.Z("int",{currentValue:UncannyAutomator.recipe.publish.timesPerRecipe,description:UncannyAutomator.i18n.publish.leaveEmpty,placeholder:UncannyAutomator.i18n.publish.unlimited},!0,(function(e,t){var n={isValid:!1,message:""};return e>=1?n.isValid=!0:n.message=UncannyAutomator.i18n.publish.oneOrBigger,n}));this.timesRecipeField=m;var f=i()("<div/>",{class:"publish-row__buttons"}),h=i()("<div/>",{class:"uap-btn uap-btn--primary"}).text(UncannyAutomator.i18n.save),g=i()("<div/>",{class:"uap-btn uap-btn--secondary"}).text(UncannyAutomator.i18n.cancel);return this.elements.timesPerRecipe.saveButton=h,this.elements.timesPerRecipe.cancelButton=g,f.append(h),f.append(g),p.append(m.getFormElement()),p.append(f),d.append(p),n.append(a),t.append(n),t.append(r),t.append(l),t.append(u),e.append(t),e.append(d),e}},{key:"validateStatus",value:function(){UncannyAutomator.recipe.isLive&&!UncannyAutomator.recipe.isValid&&UncannyAutomator.recipe.publish.statusToggle.setValue(!1)}},{key:"validateTimesPerFields",value:function(t,n,a){t.editLink.on("click",(function(){t.hiddenBox.slideToggle(300)})),t.cancelButton.on("click",(function(){t.hiddenBox.slideToggle(300,(function(){new e}))})),t.saveButton.on("click",(function(){if(a.validate().isValid){t.saveButton.addClass("uap-btn--loading uap-btn--disabled");var i=a.getValue();(0,o.xb)(i)&&(i=-1),(0,o.L8)(t.endPoint,{post_ID:UncannyAutomator.recipe.id,recipe_completions_allowed:i},(function(){"recipe_completions_allowed"==t.endPoint?UncannyAutomator.recipe.publish.timesPerUser=i:UncannyAutomator.recipe.publish.timesPerRecipe=i,t.hiddenBox.slideToggle(300,(function(){new e}))}),(function(){console.log("‼️ ERROR-TODO. Couldn't save times per user"),a.setValue(n),t.saveButton.removeClass("uap-btn--loading uap-btn--disabled")}))}})),a.getField().on("keyup",(function(e){13==e.keyCode&&t.saveButton.trigger("click")}))}},{key:"bind",value:function(){var t=this;"anonymous"!=UncannyAutomator.recipe.type&&this.validateTimesPerFields(this.elements.timesPerUser,UncannyAutomator.recipe.publish.timesPerUser,this.timesField),this.validateTimesPerFields(this.elements.timesPerRecipe,UncannyAutomator.recipe.publish.timesPerRecipe,this.timesRecipeField),this.elements.toggle.on("automator:field:change",(function(){t.recipeStatusToggle.startLoadingAnimation();var n=t.recipeStatusToggle.getValue(),a=n?"publish":"draft";(0,o.Wr)("get",{filter:{itemType:"trigger"}}),!n||n&&UncannyAutomator.recipe.isValid?(0,o.L8)("change_post_status",{post_ID:UncannyAutomator.recipe.id,post_status:a},(function(){UncannyAutomator.recipe.isLive=n,new e}),(function(){console.log("‼️ ERROR-TODO. Couldn't set the recipe status"),setTimeout((function(){t.recipeStatusToggle.stopLoadingAnimation(),t.recipeStatusToggle.setValue(!1,!1)}),1e3)})):(UncannyAutomator.recipe.errorMode=!0,new r.Z,setTimeout((function(){t.recipeStatusToggle.stopLoadingAnimation(),t.recipeStatusToggle.setValue(!1,!1)}),1e3))}))}}])&&c(t.prototype,n),e}()},276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(609),i=n.n(a),o=n(179);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements={container:i()("#uo-uap-notices")},0==this.elements.container.length&&(this.createContainer(),this.elements.container=i()("#uo-uap-notices")),this.emptyContainer(),this.createWarning(),UncannyAutomator.recipe.errorMode&&this.createError()}var t,n;return t=e,(n=[{key:"emptyContainer",value:function(){this.elements.container.empty()}},{key:"createContainer",value:function(){var e=i()("<div/>",{id:"uo-uap-notices",class:"uap"});i()("#uap-publish-metabox").prepend(e)}},{key:"createError",value:function(){if(!(0,o.xb)(UncannyAutomator.recipe.message.error)){var e=i()("<div/>",{class:"uo-notice uo-notice--error"}).text(UncannyAutomator.recipe.message.error);this.elements.container.append(e)}}},{key:"createWarning",value:function(){if(!(0,o.xb)(UncannyAutomator.recipe.message.warning)){var e=i()("<div/>",{class:"uo-notice uo-notice--warning"}).text(UncannyAutomator.recipe.message.warning);this.elements.container.append(e)}}}])&&r(t.prototype,n),e}()},800:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(609),i=n.n(a),o=n(179);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.doWhenReady=t,this.render(),this.getElements(),this.listenSubmission()}var t,n;return t=e,(n=[{key:"render",value:function(){var e=i()('\n\t\t\t<div class="uap">\n\t\t\t\t<div id="uap-type-selector" class="uap-type-selector">\n\t\t\t\t\t<div class="uap-type-selector__box">\n\t\t\t\t\t\t<form id="uap-type-selector-form" class="uap-type-selector__form">\n\t\t\t\t\t\t\t<div class="uap-type-selector__title">\n\t\t\t\t\t\t\t\t'.concat(UncannyAutomator.i18n.recipeType.title,'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__content">\n\t\t\t\t\t\t\t\t<div class="uap-type-selector__types">\n\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type uap-type-selector-type--user">\n\t\t\t\t\t\t\t\t\t\t<input class="uap-type-selector-type__hidden-field" type="radio" name="uap-recipe-type" value="user" id="uap-recipe-type-user">\n\t\t\t\t\t\t\t\t\t\t<label class="uap-type-selector-type__label" for="uap-recipe-type-user">\n\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__container">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon-img uap-type-selector-type__icon-img--user"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__title">\n\t\t\t\t\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.recipeType.userRecipeName,'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__description">\n\t\t\t\t\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.recipeType.userRecipeDescription,'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type uap-type-selector-type--anonymous">\n\t\t\t\t\t\t\t\t\t\t<input class="uap-type-selector-type__hidden-field" type="radio" name="uap-recipe-type" value="anonymous" id="uap-recipe-type-anonymous">\n\t\t\t\t\t\t\t\t\t\t<label class="uap-type-selector-type__label" for="uap-recipe-type-anonymous">\n\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__container">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__icon-img uap-type-selector-type__icon-img--anonymous"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__title">\n\t\t\t\t\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.recipeType.everyoneRecipeName,'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="uap-type-selector-type__description">\n\t\t\t\t\t\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.recipeType.everyoneRecipeDescription,'\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__warning">\n\t\t\t\t\t\t\t\t').concat(UncannyAutomator.i18n.recipeType.cantChangeLaterNotice,'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="uap-type-selector__buttons">\n\t\t\t\t\t\t\t\t<button type="submit" id="uap-type-selector-submit-button" class="uap-btn uap-btn--primary">').concat(UncannyAutomator.i18n.confirm,"</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"));i()("body").append(e)}},{key:"getElements",value:function(){this.$elements={container:i()("#uap-type-selector"),form:i()("#uap-type-selector-form"),warning:i()("#uap-type-selector .uap-type-selector__warning"),submitButton:i()("#uap-type-selector-submit-button")}}},{key:"listenSubmission",value:function(){var e=this;this.$elements.form.on("submit",(function(t){t.preventDefault();var n=e.$elements.form.find('input[name="uap-recipe-type"]:checked').val();(0,o.xb)(n)?e.showError(UncannyAutomator.i18n.recipeType.errorDidNotSelectType):["user","anonymous"].includes(n)?e.saveRecipeType(n):e.showError(UncannyAutomator.i18n.recipeType.errorTryingToSaveOtherValue)}))}},{key:"saveRecipeType",value:function(e){var t=this,n={post_ID:UncannyAutomator.recipe.id,recipe_type:e};this.$elements.submitButton.addClass("uap-btn--loading uap-btn--disabled"),(0,o.L8)("change_post_recipe_type",n,(function(n){if(n.success){t.$elements.container.remove(),UncannyAutomator.recipe.type=e;var a=i()("#uo-recipe-triggers-meta-box-ui h2.hndle.ui-sortable-handle"),o=UncannyAutomator.i18n.trigger.userTriggers;"anonymous"==UncannyAutomator.recipe.type&&(o=UncannyAutomator.i18n.trigger.everyoneTrigger),a.text(o),t.doWhenReady(e)}else t.showError(UncannyAutomator.i18n.recipeType.errorSomethingWentWrong)}),(function(e){console.log("‼️ ERROR-TODO. Couldn't save the recipe type"),t.$elements.submitButton.removeClass("uap-btn--loading uap-btn--disabled"),t.showError(UncannyAutomator.i18n.recipeType.errorSomethingWentWrong)}))}},{key:"showError",value:function(e){var t=i()('\n\t\t\t<div class="uap-type-selector__error">\n\t\t\t\t'.concat(e,"\n\t\t\t</div>\n\t\t")),n=this.$elements.container.find(".uap-type-selector__error");n.length>0&&n.remove(),t.insertAfter(this.$elements.warning),setTimeout((function(){t.addClass("uap-type-selector__error--shake")}),10)}}])&&r(t.prototype,n),e}()},549:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c}),n(609);var a=n(179),i=n(156),o=n(849),r=n(234);function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,a.M0)("metabox",{type:"trigger"}).empty();var t=(0,a.Wr)("get",{filter:{itemType:"trigger"}});(0,a.xb)(t)?(new i.Z("trigger"),new r.Z("trigger")):(new o.Z("trigger",t),new r.Z("trigger"),this.isContinuingIntegrationConnection()&&new i.Z("trigger"))}var t,n;return t=e,(n=[{key:"isContinuingIntegrationConnection",value:function(){return 1==(0,a.Tb)(null,"ua_connecting_integration")&&"trigger"==(0,a.Tb)(null,"ua_connecting_integration_context")}}])&&s(t.prototype,n),e}()},179:(e,t,n)=>{"use strict";n.d(t,{bN:()=>x,hl:()=>J,A5:()=>$,Dh:()=>W,vQ:()=>ne,iK:()=>y,Ds:()=>te,r:()=>Y,IL:()=>A,p5:()=>oe,PT:()=>ie,q7:()=>E,M0:()=>O,rz:()=>D,ew:()=>L,Vx:()=>M,Y6:()=>I,eU:()=>w,Tb:()=>X,Ki:()=>G,C2:()=>ae,d3:()=>K,$K:()=>V,xb:()=>P,Kn:()=>B,HD:()=>q,Wr:()=>_,Lc:()=>F,YQ:()=>re,qh:()=>R,Tm:()=>v,R$:()=>S,hF:()=>H,L8:()=>T,yv:()=>k,P2:()=>ee,Cn:()=>C,qi:()=>N});var a=n(609),i=n.n(a),o=(n(867),n(800)),r=n(378);function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const c=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.setAttributes(t),this.createFields()}var t,n;return t=e,(n=[{key:"setAttributes",value:function(e){V(e.hasLabel)||(P(e.label)?e.hasLabel=!1:e.hasLabel=!0),V(e.hasDescription)||(P(e.description)?e.hasDescription=!1:e.hasDescription=!0),this.attributes=e}},{key:"createFields",value:function(){this.fields=this.attributes.fields.map((function(e){return new r.Z(e.fieldType,e)}))}},{key:"createFormElement",value:function(){var e=i()('<div class="form-group"></div>');if(this.attributes.hasLabel){var t=i()('<div class="form-group__label">'.concat(this.attributes.label,"</div>"));e.append(t)}var n=i()('<div class="form-group__fields"></div>');if(this.fields.forEach((function(e){var t=e.createFormElement();n.append(t)})),e.append(n),this.attributes.hasLabel){var a=i()('<div class="form-group__description">'.concat(this.attributes.description,"</div>"));e.append(a)}return this.formElement=e,e}},{key:"getValue",value:function(){var e={};return this.fields.forEach((function(t){e[t.getFieldID()]=t.getValue()})),e}},{key:"getFormElement",value:function(){return this.formElement}},{key:"getAttributes",value:function(){return this.attributes}},{key:"validate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={isValid:!0,message:""};return this.fields.forEach((function(n){t[n.getFieldID()]=n.validate(e),t.isValid=t.isValid&&t[n.getFieldID()].isValid})),t}}])&&s(t.prototype,n),e}();function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var u=n(771);const d=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.setAttributes(t),this.createFields()}var t,n;return t=e,(n=[{key:"setAttributes",value:function(e){V(e.hasLabel)||(P(e.label)?e.hasLabel=!1:e.hasLabel=!0),V(e.hasDescription)||(P(e.description)?e.hasDescription=!1:e.hasDescription=!0),this.attributes=e}},{key:"createFields",value:function(){var e=this.attributes.fields,t=[];if(Array.isArray(this.attributes.currentValue)&&this.attributes.currentValue.length>0)this.attributes.currentValue.forEach((function(n,a){var i=JSON.parse(JSON.stringify(e));i=i.map((function(e,t){return V(n[e.optionCode])?e.currentValue=n[e.optionCode]:e.currentValue="",e})),t.push(i)}));else if(this.attributes.isRequired){var n=JSON.parse(JSON.stringify(e));n.currentValue="",t.push(n)}t=t.map((function(e,t){return e.map((function(e,t){return e.label="",e.description="",new r.Z(e.fieldType,e)}))})),this.fieldRows=t}},{key:"createFormElement",value:function(){var e,t=i()('<div class="form-repeater"></div>');if(this.attributes.hasLabel){var n=i()('\n\t\t\t\t<div class="form-repeater__label">\n\t\t\t\t\t'.concat(this.attributes.label,"\n\t\t\t\t\t").concat(this.attributes.isRequired?'<span class="form-repeater__label-required"></span>':"","\n\t\t\t\t</div>\n\t\t\t"));t.append(n)}var a=this.getFieldsTable();if(t.append(a),a.append(i()('<div class="form-element__error"></div>')),this.attributes.hasDescription){var o=i()('<div class="form-repeater__description">'.concat(this.attributes.description,"</div>"));t.append(o)}return this.formElement=t,e=t,this.fieldRows.length>1&&this.makeRowsSortable(),this.listenSave(),e}},{key:"listenSave",value:function(){var e=this;this.formElement.on("saved",(function(t){e.updateAttributesFieldsFromRow()}))}},{key:"updateAttributesFieldsFromRow",value:function(){var e=[];this.fieldRows.forEach((function(t){var n=[];t.forEach((function(e){n.push(e.attributes)})),e.push(n)})),this.attributes.fields=e}},{key:"makeRowsSortable",value:function(){var e=this;u(this.formElement.find(".form-repeater-fields__table-rows"),{forcePlaceholderSize:!0,handle:".form-repeater-fields__table-rows-cell--number",placeholder:'<tr><td colspan="'.concat(this.fieldRows[0].length+2,'">&nbsp;</td></tr>'),itemSerializer:function(e,t){return{position:e.index,html:e.html}}}),this.formElement.find(".form-repeater-fields__table-rows").on("sortupdate",(function(t){var n=[];i().each(t.detail.destination.items,(function(e,t){n.push(i()(t).data("order"))}));var a=[];n.forEach((function(t){a.push(e.fieldRows[t])})),e.fieldRows=a,e.reRender()}))}},{key:"getFieldsTable",value:function(){var e=this,t=i()('\n\t\t\t<div class="form-repeater-fields">\n\t\t\t\t<table class="form-repeater-fields__table">\n\t\t\t\t\t<thead class="form-repeater-fields__table-heading"></thead>\n\t\t\t\t\t<tbody class="form-repeater-fields__table-rows"></tbody>\n\t\t\t\t</table>\n\t\t\t\t<div class="form-repeater-fields__actions"></div>\n\t\t\t</div>\n\t\t'),n=[];this.attributes.fields.forEach((function(e,t){var a=V(e.label)?e.label:"",i=!!V(e.isRequired)&&e.isRequired,o=V(e.description)?e.description:"";n.push({title:a,description:o,isRequired:i})}));var a=i()("<tr></tr>");a.append(i()('<th class="form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--number">#</th>')),n.forEach((function(e,t){var n=i()('<th class="form-repeater-fields__table-heading-cell"></th>');P(e.title)||n.append(i()('\n\t\t\t\t\t<div class="form-repeater-fields__table-heading-cell-title">\n\t\t\t\t\t\t'.concat(e.title,"\n\t\t\t\t\t\t").concat(e.isRequired?'<span class="form-repeater-fields__table-heading-cell-required"></span>':"","\n\t\t\t\t\t</div>\n\t\t\t\t"))),P(e.description)||n.append(i()('\n\t\t\t\t\t<div class="form-repeater-fields__table-heading-cell-description">\n\t\t\t\t\t\t'.concat(e.description,"\n\t\t\t\t\t</div>\n\t\t\t\t"))),a.append(n)})),a.append(i()('<th class="form-repeater-fields__table-heading-cell form-repeater-fields__table-heading-cell--actions"></th>')),t.find(".form-repeater-fields__table-heading").append(a);var o=t.find(".form-repeater-fields__table-rows"),r=this.fieldRows.length;if(this.fieldRows.forEach((function(t,n){var a=i()('<tr data-order="'.concat(n,'"></tr>'));a.append(i()('<td class="form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--number">'.concat(n+1,"</td>"))),t.forEach((function(e,t){var n=i()('<td class="form-repeater-fields__table-rows-cell"></td>'),o=e.getFormElement();e.initLibraries(),n.append(o),a.append(n)}));var s=i()('<td class="form-repeater-fields__table-rows-cell form-repeater-fields__table-rows-cell--actions"></td>');a.append(s);var c=e.getAttributes();if(0!=n||0==n&&(!e.attributes.isRequired||r>1)){var l=V(e.attributes.removeRowButtonLabel)?e.attributes.removeRowButtonLabel:UncannyAutomator.i18n.removeRow,u=i()('<div class="form-repeater-fields__table-rows-cell-remove" uap-tooltip="'.concat(l,'"><span></span></div>'));u.on("click",(function(){e.deleteRow(n)})),c.hideActions||s.append(u)}o.append(a)})),!this.getAttributes().hideActions){var s=i()('\n\t\t\t\t<div class="uap-btn uap-btn--primary uap-btn--small">\n\t\t\t\t\t'.concat(UncannyAutomator.i18n.addRow,"\n\t\t\t\t</div>\n\t\t\t"));V(this.attributes.addRowButtonLabel)&&s.text(this.attributes.addRowButtonLabel),s.on("click",(function(){s.addClass("uap-btn--loading"),e.addRow()})),t.find(".form-repeater-fields__actions").append(s)}return t}},{key:"getValue",value:function(){var e=[];return this.fieldRows.forEach((function(t,n){var a={};t.forEach((function(e,t){a[e.getFieldID()]=e.getValue()})),e.push(a)})),e}},{key:"addRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=JSON.parse(JSON.stringify(this.attributes.fields));n.currentValue="",n=n.map((function(t,n){return t.label="",t.description="",V(e[t.optionCode])&&(t.currentValue=e[t.optionCode]),new r.Z(t.fieldType,t)})),this.fieldRows.push(n),t&&this.reRender(!0)}},{key:"reRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyCodeMirror(),this.destroyTokenSelector();var t=this.formElement,n=this.createFormElement(!1);if(t.replaceWith(n),this.initTokenSelector(),this.initCodeMirror(),e){var a=this.fieldRows[this.fieldRows.length-1];if(V(a)){var i=a[0];V(i)&&i.focus()}}}},{key:"deleteRow",value:function(e){V(this.fieldRows[e])&&this.fieldRows.splice(e,1),this.formElement.replaceWith(this.createFormElement())}},{key:"getFormElement",value:function(){return this.formElement}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getFieldID",value:function(){return this.attributes.optionCode}},{key:"validate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={isValid:!0,message:""},n=[];return this.fieldRows.forEach((function(a,i){var o={};a.forEach((function(n,a){o[n.getFieldID()]=n.validate(e),t.isValid=t.isValid&&o[n.getFieldID()].isValid})),n.push(o)})),t}},{key:"initTokenSelector",value:function(){this.fieldRows.forEach((function(e){e.forEach((function(e){e.initTokenSelector()}))}))}},{key:"destroyTokenSelector",value:function(){this.fieldRows.forEach((function(e){e.forEach((function(e){e.destroyTokenSelector()}))}))}},{key:"initCodeMirror",value:function(){this.fieldRows.forEach((function(e){e.forEach((function(e){e.initCodeMirror()}))}))}},{key:"destroyCodeMirror",value:function(){this.fieldRows.forEach((function(e){e.forEach((function(e){e.destroyCodeMirror()}))}))}}])&&l(t.prototype,n),e}();var p=n(25),m=n(195);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var a,i,o=[],r=!0,s=!1;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);r=!0);}catch(e){s=!0,i=e}finally{try{r||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";W("Start creating the main object"),e=P(e)?function(){}:e;var t=function(){U(),b(),v("create",{allRecipes:UncannyAutomator.recipes_object}),delete UncannyAutomator.triggers,delete UncannyAutomator.actions,W("Ended creating the main object"),e()};P(UncannyAutomator.recipe.type)?new o.Z((function(){t()})):t()}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,a=["create","validate"];if(V(e)&&K(e,a))switch(e){case"create":var o=["allRecipes"];if(K(o,Object.keys(t))){var s,l=t.allRecipes;i().each(l,(function(e,t){t.ID==UncannyAutomator.recipe.id&&(s=t)})),i().each(s.triggers,(function(e,t){return t.itemType="trigger"})),i().each(s.actions,(function(e,t){return t.itemType="action"})),i().each(s.closures,(function(e,t){return t.itemType="closure"}));var u=[].concat.apply([],[s.triggers,s.actions,s.closures]);_("reset");var p="anonymous"==UncannyAutomator.recipe.type;if(i().each(u,(function(e,t){var n,a=M(t.meta.integration,t.itemType,t.meta.code),o=t.meta.code;if(V(a)){var s={};V(a.options)&&i().each(a.options,(function(e,t){s[t.option_code]=[t]})),V(a.options_group)&&i().extend(!0,s,a.options_group);var l={};i().each(s,(function(e,n){var o=[],s=n.length>1;i().each(n,(function(n,i){var l,u,p=function(n){var i={isGroup:s,itemId:t.ID,itemType:t.itemType,isRequired:!!V(n.required)&&n.required,isReadOnly:!!V(n.read_only)&&n.read_only,supportsTinyMCE:!!V(n.supports_tinymce)&&n.supports_tinymce,supportsCopyToClipboard:!!V(n.copy_to_clipboard)&&n.copy_to_clipboard,isAjax:!!V(n.is_ajax)&&n.is_ajax,groupId:e,optionCode:n.option_code,fieldType:n.input_type,label:n.label,description:n.description,placeholder:n.placeholder,isHidden:!!V(n.is_hidden)&&n.is_hidden,tokenName:V(n.token_name)?n.token_name:n.label,defaultValue:n.default_value,currentValue:V(t.meta[n.option_code])?t.meta[n.option_code]:n.default_value,customFieldTokens:!!V(n.relevant_tokens)&&n.relevant_tokens,relevant_tokens:!!V(n.relevant_tokens)&&n.relevant_tokens,maxLength:V(n.max_length)?n.max_length:null};return"date"==i.fieldType&&(i.dateFormat=V(n.date_format)?n.date_format:"Y-m-d",i.dateAltFormat=V(n.date_alt_format)?n.date_alt_format:UncannyAutomator.format.date,i.supportsRange=!!V(n.supports_range)&&n.supports_range,V(n.min_date)&&(i.minDate=n.min_date),V(n.max_date)&&(i.maxDate=n.max_date)),"time"==i.fieldType&&(i.timeFormat=V(n.time_format)?n.time_format:"h:i K",i.timeAltFormat=V(n.time_alt_format)?n.time_alt_format:"h:i K",V(n.min_time)&&(i.minTime=n.min_time),V(n.max_date)&&(i.maxTime=n.max_time)),["text","textarea","int","float","email","url","select","date","time"].includes(i.fieldType)&&["action","closure"].includes(i.itemType)&&!i.isReadOnly?i.supportsTokens=!V(n.supports_tokens)||n.supports_tokens:i.supportsTokens=!1,"select"==i.fieldType&&(i.supportsCustomValue=V(n.supports_custom_value)?n.supports_custom_value:!!["action","closure"].includes(i.itemType),i.supportsCustomValue&&(i.customValue=V(t.meta["".concat(i.optionCode,"_custom")])?t.meta["".concat(i.optionCode,"_custom")]:""),V(n.custom_value_description)&&(i.customValueDescription=n.custom_value_description),V(n.supports_multiple_values)&&(i.supportsMultipleValues=n.supports_multiple_values)),i.isAjax&&(i.targetField=V(n.fill_values_in)?n.fill_values_in:"",i.endpoint=V(n.endpoint)?n.endpoint:"",i.integrationId=a.integration,P(i.targetField)&&(i.targetField=n.option_code)),["select","radio"].includes(i.fieldType)&&(i.options=V(n.options)?n.options:[]),i};if("group"==i.input_type)l={groupId:e,optionCode:i.option_code,fieldType:i.input_type,isGroup:s,itemId:t.ID,itemType:t.itemType,label:i.label,description:i.description,tokenName:V(i.token_name)?i.token_name:i.label,isRequired:!!V(i.required)&&i.required,fields:i.fields.map((function(e){return p(e)}))},u=new c(l);else if("repeater"==i.input_type){try{t.meta[i.option_code]=JSON.parse(t.meta[i.option_code])}catch(e){}l={groupId:e,optionCode:i.option_code,fieldType:i.input_type,isGroup:s,itemId:t.ID,itemType:t.itemType,label:i.label,description:i.description,tokenName:V(i.token_name)?i.token_name:i.label,defaultValue:i.default_value,currentValue:V(t.meta[i.option_code])?t.meta[i.option_code]:i.default_value,isRequired:!!V(i.required)&&i.required,hideActions:!!V(i.hide_actions)&&i.hide_actions,fields:i.fields.map((function(e){return p(e)}))},V(i.add_row_button)&&(l.addRowButtonLabel=i.add_row_button),V(i.remove_row_button)&&(l.removeRowButtonLabel=i.remove_row_button),u=new d(l)}else l=p(i),u=new r.Z(l.fieldType,l,!1);o.push(u)}));var u=[];V(a.buttons)&&i().each(a.buttons,(function(t,n){n.show_in==e&&u.push(n)})),l[e]={fields:o,isValid:!1,buttons:u}})),n={id:t.ID,itemType:t.itemType,itemCode:o,integrationCode:a.integration,isLive:"publish"==t.post_status,options:l,meta:t.meta,isMissing:!1,tokens:V(t.tokens)?t.tokens:[],inlineCss:V(a.inline_css)?a.inline_css:"",filterTokens:V(a.filter_tokens)?a.filter_tokens:""},V(a.support)&&(n.support=a.support);var u={};i().each(l,(function(e,t){i().each(t.fields,(function(e,t){u[t.getAttributes().optionCode]=t}))})),i().each(u,(function(e,t){var a=t.getAttributes();V(n.meta[a.optionCode])&&!P(n.meta[a.optionCode])||P(a.currentValue)||(n.meta[a.optionCode]=a.currentValue)})),p&&(n.canLogNewUserIn=!V(a.can_log_in_new_user)||a.can_log_in_new_user)}else n={id:t.ID,itemType:t.itemType,itemCode:t.meta.code,integrationCode:t.meta.integration,integrationName:t.meta.integration_name,sentence:t.meta.sentence,isLive:"publish"==t.post_status,tokens:[],options:{},meta:t.meta,isMissing:!0},p&&(n.canLogNewUserIn=!V(t.meta.can_log_in_new_user)||"true"==t.meta.can_log_in_new_user);_("add",n)})),p){UncannyAutomator.recipe.canLogNewUserIn=!1;var m=_("get",{filter:{itemType:"trigger"}});Object.keys(m)>0&&(UncannyAutomator.recipe.canLogNewUserIn=!0,i().each(m,(function(e,t){UncannyAutomator.recipe.canLogNewUserIn=UncannyAutomator.recipe.canLogNewUserIn&&t.canLogNewUserIn})))}(!V(t.validate)||V(t.validate)&&t.validate)&&v("validate")}else{var f=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["recipeObject",f]))}break;case"validate":var h=!0;i().each(UncannyAutomator.recipe.hasLive,(function(e,t){UncannyAutomator.recipe.hasLive[e]=!1})),i().each(UncannyAutomator.recipe.items,(function(e,t){t.isLive&&(UncannyAutomator.recipe.hasLive[t.itemType]=!0)})),i().each(UncannyAutomator.recipe.items,(function(e,t){var n=!0;i().each(t.options,(function(t,a){var o=!0;i().each(a.fields,(function(e,t){t.validate(!1).isValid||(o=!1)})),UncannyAutomator.recipe.items[e].options[t].isValid=o,o||(n=!1)})),UncannyAutomator.recipe.items[e].isValid=n,t.isLive&&!n&&(h=!1)})),UncannyAutomator.recipe.hasLive.trigger?"anonymous"==UncannyAutomator.recipe.type&&UncannyAutomator.recipe.requiresUserData&&!UncannyAutomator.recipe.userSelector.isValid?(h=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.userSelector):UncannyAutomator.recipe.hasLive.action||UncannyAutomator.recipe.hasLive.closure?UncannyAutomator.recipe.hasLive.trigger||UncannyAutomator.recipe.hasLive.action||UncannyAutomator.recipe.hasLive.closure||(UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.liveItems):(h=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.oneAction):(h=!1,UncannyAutomator.recipe.message.error=UncannyAutomator.i18n.validation.recipe.oneTrigger),UncannyAutomator.recipe.isValid=h,h&&(UncannyAutomator.recipe.message.error=""),n=!0}else console.error(N('%s: The action "%s" isn\'t defined',["recipeObject",e]));return n}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,a=["add","delete","clean","reset","update","get"];if(V(e)&&K(e,a))switch(e){case"add":t=i().extend({isValid:!1,isLive:!1},t);var o=["id","itemType"];if(K(o,Object.keys(t)))V(UncannyAutomator.recipe.items[t.id])||(UncannyAutomator.recipe.items[t.id]=t,_("clean",{}),n=!0);else{var r=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",r]))}break;case"delete":P((t=i().extend({isValid:!1},t)).id)?console.error(N("%s: Invalid item ID",["itemsObject"])):V(UncannyAutomator.recipe.items[t.id])?(delete UncannyAutomator.recipe.items[t.id],n=!0):console.error(N("%s: We didn't find an item with this the ID %s",["itemsObject",t.id]));break;case"clean":var s={};i().each(UncannyAutomator.recipe.items,(function(e,t){V(t)&&(s[e]=t)})),UncannyAutomator.recipe.items=s,n=!0;break;case"update":P(t.id)?console.error(N("%s: Invalid item ID",["itemsObject"])):V(UncannyAutomator.recipe.items[t.id])?(UncannyAutomator.recipe.items[t.id]=i().extend({},UncannyAutomator.recipe.items[t.id],t),n=!0):console.error(N("%s: We didn't find an item with this the ID %s",["itemsObject",t.id]));break;case"reset":UncannyAutomator.recipe.items={},n=!0;break;case"get":if(P(t.filter))n=UncannyAutomator.recipe.items;else{var c={};i().each(UncannyAutomator.recipe.items,(function(e,n){var a=!0;i().each(t.filter,(function(e,t){n[e]!=t&&(a=!1)})),a&&(c[e]=n)})),n=c}}else console.error(N('%s: The action "%s" isn\'t defined',["itemsObject",e]));return n}function b(){Object.entries(UncannyAutomator.integrations).forEach((function(e){var t=h(e,2),n=t[0],a=(t[1],{available:k(UncannyAutomator.triggers.filter((function(e){return e.integration==n})),"select_option_name",(function(e){return H(e)})),unavailable:[]}),i={available:k(UncannyAutomator.actions.filter((function(e){return e.integration==n})),"select_option_name",(function(e){return H(e)})),unavailable:[]};if((!V(UncannyAutomator.wp)||!UncannyAutomator.wp)&&V(UncannyAutomator.proFeatures)&&V(UncannyAutomator.proFeatures[n])){var o=UncannyAutomator.recipe.type;o="user"==o?"logged-in":o,a.unavailable=k(UncannyAutomator.proFeatures[n].triggers.filter((function(e){return e.type==o})),"name",(function(e){return H(e)})),i.unavailable=k(UncannyAutomator.proFeatures[n].actions,"name",(function(e){return H(e)}))}a.allItemsArePro=a.available.every((function(e){return!!V(e.is_pro)&&e.is_pro})),i.allItemsArePro=i.available.every((function(e){return!!V(e.is_pro)&&e.is_pro})),a.hasAvailableItems=a.available.length>0,i.hasAvailableItems=i.available.length>0,a.hasUnavailableItems=a.unavailable.length>0,i.hasUnavailableItems=i.unavailable.length>0,a.hasTriggers=a.hasAvailableItems||a.unavailable.length>0,i.hasActions=i.hasAvailableItems||i.unavailable.length>0,UncannyAutomator.integrations[n].items={triggers:a,actions:i}}))}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return V(n)||(n=function(e){return e}),Array.isArray(e)&&!P(e)&&(e=e.sort((function(e,a){var i=0;if(V(e[t])&&V(a[t])){var o=n(e[t]),r=n(a[t]);i=(i=(i=o.localeCompare(r))>0?1:i)<0?-1:i}return i}))),e}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"triggers",n=arguments.length>2?arguments[2]:void 0;n=Object.assign({addDeprecatedItems:!1},n);var a={available:{},unavailable:{}};return["triggers","actions"].includes(t="action"==(t="trigger"==t?"triggers":t)?"actions":t)&&(P(e)||V(UncannyAutomator.integrations[e])&&(a=i().extend(!0,{},UncannyAutomator.integrations[e].items[t]),n.addDeprecatedItems||(a=A(a)))),a}function A(e){return e.available=e.available.filter((function(e){return!e.is_deprecated})),e.hasAvailableItems=e.available.length>0,V(e.hasTriggers)?e.hasTriggers=e.hasAvailableItems||e.unavailable.length>0:V(e.hasActions)&&(e.hasActions=e.hasAvailableItems||e.unavailable.length>0),e.allItemsArePro=e.available.every((function(e){return!!V(e.is_pro)&&e.is_pro})),e}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1,a=["set-step","get-step","set-source","update-fields","reset-fields"];if(UncannyAutomator.recipe.userSelector,V(e)&&K(e,a)){var o=[];switch(e){case"set-step":if(K(o=["step"],Object.keys(t)))UncannyAutomator.recipe.userSelector.step=t.step;else{var r=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["userSelectorObject",r]))}break;case"get-step":var s="select-source";V(UncannyAutomator.recipe.userSelector.step)?s=UncannyAutomator.recipe.userSelector.step:P(UncannyAutomator.recipe.userSelector.data[UncannyAutomator.recipe.userSelector.source])||(s="show-sentence",UncannyAutomator.recipe.userSelector.isValid=!0),n=s;break;case"set-source":if(K(o=["source"],Object.keys(t)))UncannyAutomator.recipe.userSelector.source=t.source;else{var c=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["userSelectorObject",c]))}break;case"update-fields":if(K(o=["source","data"],Object.keys(t)))["existingUser","newUser"].includes(t.source)?(P(UncannyAutomator.recipe.userSelector.data)&&(UncannyAutomator.recipe.userSelector.data={existingUser:{},newUser:{}}),UncannyAutomator.recipe.userSelector.data[t.source]=i().extend({},UncannyAutomator.recipe.userSelector.data[t.source],t.data)):console.error(N("%s: The source parameter is invalid. Valid values are: %s",["userSelectorObject",["existingUser","newUser"]]));else{var l=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["userSelectorObject",l]))}break;case"reset-fields":UncannyAutomator.recipe.userSelector.data={existingUser:{},newUser:{}}}}else console.error(N('%s: The action "%s" isn\'t defined',["userSelectorObject",e]));return n}function U(){["user","anonymous"].includes(UncannyAutomator.recipe.type)&&(UncannyAutomator.dev.debugMode&&(W("Filter Automator items",!0,{collapseGroup:!0}),console.log(N("Current recipe type: %s",[UncannyAutomator.recipe.type]))),UncannyAutomator.triggers=UncannyAutomator.triggers.filter((function(e){return UncannyAutomator.dev.debugMode&&(console.log(e),e.type==UncannyAutomator.recipe.type?Z("success","Keep"):Z("error","Remove")),e.type==UncannyAutomator.recipe.type})),UncannyAutomator.dev.debugMode&&console.groupEnd())}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=["add","delete","update","change_post_status","recipe_completions_allowed","recipe_max_completions_allowed","change_post_title","change_post_recipe_type","user-selector","set_recipe_terms","schedule_action","remove_schedule","set_recipe_requires_user"];o=i().extend({},{requiresRecipesObject:!0,renderUI:!0},o),K(e,r)?i().ajax({method:"POST",url:"".concat(UncannyAutomator.restURL,"/").concat(e,"/"),data:i().param(t)+"&"+i().param({doing_rest:1}),dataType:"json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",UncannyAutomator.nonce)},success:function(i){UncannyAutomator.dev.debugMode&&(W("REST call ✅",!0,{collapseGroup:!0}),console.log("Endpoint: ".concat(e)),console.log("Data:"),console.log(t),console.log("Response:"),console.log(i),console.groupEnd()),i.success?V(i.recipes_object)||!o.requiresRecipesObject?V(n)&&(o.renderUI&&v("create",{allRecipes:i.recipes_object}),n(i)):(console.error("The call was successful, but the new recipes_object is missing."),V(a)&&a(i)):(console.error("The call was successful, but there were errors."),V(a)&&a(i))},statusCode:{403:function(e){UncannyAutomator.dev.debugMode&&(W("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%c403: Access denied","color: red"),console.groupEnd()),V(a)&&a(e)}},error:function(e,n,i){UncannyAutomator.dev.debugMode&&(W("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),V(a)&&a({success:!1})},fail:function(e){UncannyAutomator.dev.debugMode&&(W("REST call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),V(a)&&a(e)}}):console.error(N("The %s endPoint does not exists. The valid endpoints are %s",[e,r.join(", ")]))}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;V(e)?(t=i().extend(!0,t,{action:e,nonce:UncannyAutomator.nonce}),i().ajax({method:"POST",dataType:"json",url:ajaxurl,data:t,success:function(e){UncannyAutomator.dev.debugMode&&(W("AJAX call ✅",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log(e),console.groupEnd()),V(e.status)&&"auth-failed"==e.status?location.reload():V(n)&&n(e,t)},statusCode:{403:function(){UncannyAutomator.dev.debugMode&&(W("AJAX call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),W("403: Access denied",!1,{bgColor:"#ff0000"}),console.groupEnd()),V(a)&&a(response),V(a)&&a(response)}},fail:function(e){UncannyAutomator.dev.debugMode&&(W("AJAX call 🔴",!0,{collapseGroup:!0}),console.log("Data:"),console.log(t),console.log("Response"),console.log("%cUnknown error","color: red"),console.groupEnd()),V(a)&&a(e)}})):console.error("We cannot do this AJAX request. {action} is not defined.")}function E(e){var t={};return i().each(UncannyAutomator.recipe.items[e].options,(function(e,n){i().each(n.fields,(function(e,n){var a=n.getFieldID(),i=n.getValue();V(i)||(i=n.getAttributes().currentValue),"select"==n.getAttributes().fieldType&&"automator_custom_value"==i&&(t["".concat(a,"_custom")]=n.getSelectCustomValue()),t[a]=i,P(i)||"select"!=n.getAttributes().fieldType||(t["".concat(a,"_readable")]=n.getReadableValue())}))})),t}function D(e,t){var n;return i().each(UncannyAutomator.recipe.items[e].options,(function(e,a){i().each(a.fields,(function(e,a){t==a.getFieldID()&&(n=a)}))})),n}function M(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!P(t)&&!P(n)&&!P(a)){var o={};if("trigger"==n||"action"==n){if(V(UncannyAutomator.integrations[t])){var r=UncannyAutomator.integrations[t];V(r.items)?o="trigger"==n?r.items.triggers.available:r.items.actions.available:console.log("%cNot ready, who is calling this?","background: red; color: #fff; font-weight: 500; padding: 2px 6px;")}}else"closure"==n&&(o=UncannyAutomator.closures);i().each(o,(function(t,n){if(n.code==a)return e=n,!1}))}return e}function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;T("set_recipe_requires_user",{recipePostID:UncannyAutomator.recipe.id,requiresUser:e},(function(n){n.success&&V(t)&&(UncannyAutomator.recipe.requiresUserData=e,O("user-selector").addClass("user-selector--show"),t(n))}),(function(e){console.log("ERROR-TODO. Couldn't set the recipe requires user status"),V(n)&&n(e)}))}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},a=["metabox","items","item","optionGroup","lastItem","user-selector"];if(V(e)&&K(e,a)){var o=[];switch(e){case"metabox":if(t=i().extend({},t),K(o=["type"],Object.keys(t))){t.cssSelector__metabox,"trigger"==t.type?t.cssSelector__metabox="#recipe-triggers-ui":"action"==t.type&&(t.cssSelector__metabox="#recipe-actions-ui");var r=i()(t.cssSelector__metabox);n=r}else{var s=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",s]))}break;case"items":if(t=i().extend({},t),K(o=["type"],Object.keys(t))){var c=O("metabox",{type:t.type}),l=c.find(".item:not(.item--user-selector):not(.item--start):not(.item--closure)");n=l}else{var u=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",u]))}break;case"item":if(t=i().extend({},t),K(o=["id"],Object.keys(t))){t.cssSelector='.uap .item[data-id="'+t.id+'"]';var d=i()(t.cssSelector),p=d.find(".item__content");n.item=d,n.contentContainer=p}else{var m=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",m]))}break;case"optionGroup":if(t=i().extend({},t),K(o=["itemID","groupID"],Object.keys(t))){var f=O("item",{id:t.itemID}).item;t.cssSelector__tokenInSentence='.item-title__token[data-token-id="'+t.groupID+'"]',t.cssSelector__fieldsContainer='.item-options__group[data-optiongroup="'+t.groupID+'"]';var h=f.find(t.cssSelector__tokenInSentence),g=f.find(t.cssSelector__fieldsContainer),y=f.find(".item-options");n.tokenInSentence=h,n.fieldsContainer=g,n.optionsContainer=y}else{var v=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",v]))}break;case"lastItem":if(t=i().extend({},t),K(o=["type"],Object.keys(t))){var _=O("metabox",{type:t.type}),b=_.find(".item:not(.item--user-selector):not(.item--start):not(.item--closure)").last();n=b}else{var k=JSON.stringify(j(t,o));console.error(N("%s: Some attributes are missing: %s",["itemsObject",k]))}break;case"user-selector":n=i()(".user-selector")}}else console.error(N('%s: The element "%s" isn\'t defined',["getDOMElements",e]));return n}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={url:"",node:null},n=UncannyAutomator.integrations[e];return V(n)&&(t.node=document.createElement("img"),V(n.icon_svg)?(t.url=n.icon_svg,t.node.setAttribute("src",n.icon_svg),t.node.setAttribute("alt",n.name)):V(n.icon_32)&&V(n.icon_64)&&(t.url={icon_16:n.icon_16,icon_32:n.icon_32,icon_64:n.icon_64},t.node.setAttribute("src",n.icon_32),t.node.setAttribute("srcset",N("%s 1x, %s 2x",[n.icon_32,n.icon_64])),t.node.setAttribute("alt",n.name))),t}function L(){return["select","textarea","text","url","email","int","float","checkbox","radio","group","date","time","repeater"]}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null;if(a={plain:"",brackets:"",html:i()("<div/>"),elements:{normal:[],token:[]},parts:[]},!P(t=t.trim())){var o,r=new RegExp(/\{\{(.*?)\}\}/gm),s=[],c=[],l=t,u=0,d=(t=t.replace(r,(function(t,a){var i,o=a.split(":"),r=o[0],s=o[1],d=V(o[2])?o[2]:s;return a={type:"token",id:s,text:r,optionsID:d,hasFields:V(e.options[d])},V(n[a.id])&&("automator_custom_value"==n[a.id]&&V(n[N("%s_custom",[a.id])])?i=n[N("%s_custom",[a.id])]:V(n[N("%s_readable",[a.id])])&&(i=n[N("%s_readable",[a.id])]),a.originalText=a.text,a.text=V(i)?i:n[a.id]),c.push(a),l=l.replace(t,"{{token:"+u+"}}"),u++,"{{v}}"}))).split("{{v}}"),p=0;for(i().each(d,(function(e,t){if(""!=t){var n={type:"normal",text:t};s.push(n),l=l.replace(t,"{{normal:"+p+"}}"),p++}}));null!==(o=r.exec(l));){var f=o[1].split(":");"normal"==(f={type:f[0],index:f[1]}).type?a.parts.push(s[f.index]):a.parts.push(c[f.index])}var h=null;i().each(a.parts,(function(t,n){if(a.plain+=n.text," "!=n.text){var o,s=n.text,c=!1,l=null;if(" "==s[0]&&(s=s.slice(1))," "==s[s.length-1]&&(s=s.slice(0,-1)),"normal"==n.type||"token"==n.type&&!n.hasFields&&!e.isMissing)o={class:"item-title__normal"},a.brackets+=n.text;else{if(o={class:"item-title__token","data-token-id":n.id,"data-options-id":n.optionsID},V(e.options[n.optionsID])&&e.options[n.optionsID].isValid&&(o.class+=" item-title__token--filled"),V(n.originalText)){if(r.test(s)){V(h)||(h=new m.Z(e.itemType,"text",{includeGroupName:!1}));var u=h.renderTextWithTokens(s);V(u)&&(c=!0,l=u)}if(!c){var d=z(s,30);d.isAbbreviated&&(o["uap-tooltip"]=s,s=d.text)}}a.brackets+="{{".concat(Q(s),"}}")}var p=i()("<span/>",o);c?p.append(l):p.text(Q(s)),a.elements[n.type].push(p),a.html.append(p)}else a.brackets+=n.text})),a.elements.normal=i()(a.elements.normal).map((function(){return this.get()})),a.elements.token=i()(a.elements.token).map((function(){return this.get()})).filter(":not(.item-title__normal)")}return UncannyAutomator.recipe.items[e.id].itemSentence=a,a}function F(e){var t=e.url,n=e.title,a=e.w,i=e.h,o=e.onClose,r=void 0!==window.screenLeft?window.screenLeft:window.screenX,s=void 0!==window.screenTop?window.screenTop:window.screenY,c=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,u=c/window.screen.availWidth,d=(c-a)/2/u+r,p=(l-i)/2/u+s,m=window.open(t,n,"\n        scrollbars=yes,\n        width=".concat(a/u,", \n        height=").concat(i/u,", \n        top=").concat(p,", \n        left=").concat(d,"\n        "));return window.focus&&m.focus(),V(o)&&function e(){m.closed?o():setTimeout((function(){e()}),500)}(),m}function V(e){return null!=e}function P(e){var t=!0;return V(e)&&(t=i().isArray(e)?0==e.length:B(e)?i().isEmptyObject(e):""==e),t}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{caseSensitive:!0};return n.caseSensitive?e.toString()==t.toString():e.toString().toLowerCase()==t.toString().toLowerCase()}function K(e,t){return Array.isArray(e)?0==j(e,t).length:-1!==i().inArray(e,t)}function j(e,t){return i()(e).not(t).get()}function N(e,t){return(0,n(975).vsprintf)(e,t)}function q(e){return"string"==typeof e}function B(e){return null!==e&&"object"===f(e)}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(e=e.replace(/{{/g,t)).replace(/}}/g,n)}function W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};V(n.bgColor)||(n.bgColor="#0790e8");var a="background: ".concat(n.bgColor,'; color: #fff; font-weight: 500; padding: 2px 6px; font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;');t?V(n.collapseGroup)&&n.collapseGroup?console.groupCollapsed("%c🤖Automator",a,e):console.group("%c🤖Automator",a,e):console.log("%c🤖Automator",a,e)}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n='color: #fff; padding: 2px 7px; font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; font-weight: normal';"error"==e&&(n="background: #f13c3c; ".concat(n)),"success"==e&&(n="background: #40b528; ".concat(n)),console.log("%c".concat(t),n)}function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={"&":"&amp;","<":"&lt;",">":"&gt;"},n=function(e){return t[e]||e};return e.replace(/[&<>]/g,n)}function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n={isAbbreviated:!1,text:e};if(e.length>t){var a=Math.floor(t/2),i={start:e.substring(0,a),end:e.slice(-a)};n.text="".concat(i.start," ... ").concat(i.end),n.isAbbreviated=!0}return n}function G(){return"_"+Math.random().toString(36).substr(2,9)}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};P(e)&&(e=window.location.href);try{e=new URL(e)}catch(t){return e}for(var a=e.search.substr(1).split("&"),o=0,r=Object.entries(t);o<r.length;o++){var s=h(r[o],2),c=s[0],l=s[1];c=encodeURI(c),l=encodeURI(l);for(var u=a.length,d=void 0;u--;)if((d=a[u].split("="))[0]==c){d[1]=l,a[u]=d.join("=");break}u<0&&(a[a.length]=[c,l].join("="))}if(a=a.filter((function(e){var t=e.split("=");return!(P(e)||P(t[1]))})),e.search=a.join("&"),(n=i().extend({},{setAsURL:!1,refresh:!1},n)).setAsURL)if(n.refresh)window.location.href=e.href;else{var p=document.title;window.history.pushState({},p,e.href)}return e.href}function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return P(e)&&(e=window.location.href),(e=new URL(e)).searchParams.get(t)}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("textarea");return t.innerHTML=e,t.value}function ee(e,t){var n=0;return function(){var a=Date.now();if(n+t<a)return n=a,e.apply(this,arguments)}}function te(e,t){var n=-1;return function(){clearTimeout(n);var a=arguments,i=this;n=setTimeout((function(){e.apply(i,a)}),t)}}function ne(e){var t=document.createElement("textarea");t.style.width="0px",t.style.height="0px",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=i().extend(!0,{title:UncannyAutomator.i18n.debugging.fatalErrorHandler.title,warning:"",content:UncannyAutomator.i18n.debugging.fatalErrorHandler.content,console:null,buttons:{confirm:{label:UncannyAutomator.i18n.debugging.learnMore,onClick:function(){window.open(UncannyAutomator.dev.debuggingURL,"_blank")}},cancel:{label:UncannyAutomator.i18n.debugging.buttonGoBack,onClick:function(){window.location.replace(UncannyAutomator.dev.recipesUrl)}}}},e);var t,n="";try{i().each(UncannyAutomator.recipes_object,(function(e,n){n.ID==UncannyAutomator.recipe.id&&(t=n)}))}catch(e){console.log(e)}try{var a="====== ".concat(UncannyAutomator.i18n.debugging.recipeTitle," ====== \n"),o="user"==t.recipe_type?UncannyAutomator.i18n.debugging.recipeTypeUser:"anonymous"==t.recipe_type?UncannyAutomator.i18n.debugging.recipeTypeAnonymous:"";a+="".concat(UncannyAutomator.i18n.debugging.recipeType,": ").concat(o);var r="draft"==t.post_status?UncannyAutomator.i18n.debugging.recipeStatusDraft:"publish"==t.post_status?UncannyAutomator.i18n.debugging.recipeStatusLive:"";n=a+="\n".concat(UncannyAutomator.i18n.debugging.recipeStatus,": ").concat(r)}catch(e){console.log(e)}try{var s="=== ".concat(UncannyAutomator.i18n.debugging.recipeItemsTitle," === \n"),c=function(e){var t="publish"==e.post_status?UncannyAutomator.i18n.debugging.itemStatusLive:UncannyAutomator.i18n.debugging.itemStatusDraft;return"> ".concat(e.meta.integration," - ").concat(e.meta.code," - ").concat(t,'\n  <span style="font-size: 13px; font-weight: 600">(').concat(e.meta.sentence.replace(/\{\{|\:[a-zA-Z0-9]*\}\}/g,""),')</span>\n  <span style="font-size: 10px">').concat(JSON.stringify(e).replaceAll("<","&lt;").replaceAll(">","&gt;"),"</span>\n")},l=t.triggers.map(c),u=l.length>0,d=t.actions.map(c),m=d.length>0,f=t.closures.map(c),h=f.length>0;u||m||h?(s+="".concat(UncannyAutomator.i18n.debugging.triggersTitle,"\n\n"),s+=u?l.join("\n"):"> ".concat(UncannyAutomator.i18n.debugging.noTriggers),s+="\n".concat(UncannyAutomator.i18n.debugging.actionsTitle,"\n\n"),s+=m?d.join("\n"):"> ".concat(UncannyAutomator.i18n.debugging.noActions),s+="\n".concat(UncannyAutomator.i18n.debugging.closuresTitle,"\n\n"),s+=h?f.join("\n"):"> ".concat(UncannyAutomator.i18n.debugging.noClosures)):s+="".concat(UncannyAutomator.i18n.debugging.noRecipeItemsFound),n=""!==n?"".concat(n,"\n\n").concat(s):n}catch(e){console.log(e)}try{if(V(e.console)){console.log(e.console);var g="====== ".concat(UncannyAutomator.i18n.debugging.jsConsole," ====== \n");g+="".concat(e.console.stack.replaceAll(UncannyAutomator.siteURL,"{site_url}")),n=""!==n?"".concat(n,"\n\n").concat(g):n}}catch(e){console.log(e)}var y=new p.Z({title:'<span class="modal__title-icon uo-icon uo-icon--exclamation-triangle"></span> '.concat(e.title),warning:"".concat(e.warning),content:"\n            <div>\n                ".concat(P(e.content)?"":e.content,'\n                <div class="modal__content-code">\n                    <pre id="uap-debugging">').concat(n,"</pre>\n                </div>\n            </div>\n        "),buttons:{cancel:UncannyAutomator.i18n.debugging.buttonGoBack,confirm:UncannyAutomator.i18n.debugging.learnMore}},{size:"extra-large",warningFirst:!0});y.setEvents({onConfirm:function(){e.buttons.confirm.onClick()},onCancel:function(){e.buttons.cancel.onClick()},afterSetEvents:function(){var e=i()("#uap-debugging");e.on("click",(function(){e.text();var t=document.createRange();t.selectNodeContents(e[0]),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)}))}})}function ie(e,t,n){var a={};return i().each(e,(function(e,i){i.meta[t]&&i.meta[t]==n&&(a[e]=i)})),a}function oe(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={};return i().each(e,(function(e,i){t in i.meta===n&&(a[e]=i)})),a}function re(e){Object.assign(document.createElement("a"),{target:"_blank",href:e}).click()}},867:(e,t,n)=>{"use strict";n.d(t,{RC:()=>c,R3:()=>l,OP:()=>u,oy:()=>f});var a,i=n(609),o=n.n(i),r=n(179),s=(n(413),n(195));function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={isValid:!1};if((0,r.$K)(e)){var a=UncannyAutomator.recipe.items[e];if(!a.isMissing&&!(0,r.xb)(a)&&(n.isValid=a.isValid,!a.isValid)){var i=(0,r.M0)("item",{id:e}).item;i.addClass("item--error"),o().each(a.options,(function(t,n){if(!n.isValid){var a=(0,r.M0)("optionGroup",{itemID:e,groupID:t});a.tokenInSentence.addClass("item-title__token--error item-title__token--error-shake"),a.fieldsContainer.addClass("item-options__group--error"),a.optionsContainer.addClass("item-options--error"),setTimeout((function(){a.tokenInSentence.removeClass("item-title__variable--error-shake")}),1e3),(0,r.$K)(a.optionsContainer)&&l(a.optionsContainer)}}))}}else n.isValid=!1,(0,r.xb)(t)&&console.error("Neither itemID nor the $item are defined. One of them must be defined.");return n}function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={isValid:!1},a=e.find('\n\t\tinput.form-element__input[data-is-child-field="'.concat(t?"true":"false",'"],\n\t\ttextarea.form-element__textarea[data-is-child-field="').concat(t?"true":"false",'"],\n\t\tselect.form-element__select[data-is-child-field="').concat(t?"true":"false",'"],\n\t\t.form-checkbox input,\n\t\t.form-radio')),i=!0;return a.each((function(){var t=o()(this),n=(t.data("type"),{});if(t.hasClass("form-radio")){var a=t.find("input").first(),r=t.find("input:checked");n={field_type:"radio",value:r.length>0?r.val():"",attributes:{supportsTokens:a.data("supportstokens"),required:a.data("required")}}}else n=t.hasClass("form-element__select")?{field_type:"select",value:t.val(),attributes:{supportsTokens:t.data("supportstokens"),required:t.data("required"),supportsCustomValue:t.data("supports-custom-value")}}:{field_type:t.data("type"),value:t.val(),attributes:{supportsTokens:t.data("supportstokens"),required:t.data("required")}};"checkbox"==n.field_type&&(n.value=t.is(":checked")),u(t,n.field_type,n.value,n.attributes).isValid||(i=!1,e.addClass("item-options--error"))})),n.isValid=i,n}function u(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{supportsTokens:!1,required:!1},i=arguments.length>4?arguments[4]:void 0,s={isValid:!1,message:""},c=(0,r.ew)(),u={select:{empty:UncannyAutomator.i18n.validation.field.select.empty,invalid:UncannyAutomator.i18n.validation.field.select.invalid},text:{empty:UncannyAutomator.i18n.validation.field.text.empty,invalid:UncannyAutomator.i18n.validation.field.text.invalid},textarea:{empty:UncannyAutomator.i18n.validation.field.textarea.empty,invalid:UncannyAutomator.i18n.validation.field.textarea.invalid},int:{empty:UncannyAutomator.i18n.validation.field.int.empty,invalid:UncannyAutomator.i18n.validation.field.int.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.int.multipleTokens},float:{empty:UncannyAutomator.i18n.validation.field.float.empty,invalid:UncannyAutomator.i18n.validation.field.float.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.float.multipleTokens},email:{empty:UncannyAutomator.i18n.validation.field.email.empty,single:{invalid:UncannyAutomator.i18n.validation.field.email.single.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.email.single.multipleTokens},multiple:{invalid:UncannyAutomator.i18n.validation.field.email.multiple.invalid,multipleTokens:UncannyAutomator.i18n.validation.field.email.multiple.multipleTokens}},url:{empty:UncannyAutomator.i18n.validation.field.url.empty,invalid:UncannyAutomator.i18n.validation.field.url.invalid},checkbox:{empty:UncannyAutomator.i18n.validation.field.checkbox.empty,invalid:UncannyAutomator.i18n.validation.field.checkbox.invalid},radio:{empty:UncannyAutomator.i18n.validation.field.radio.empty,invalid:UncannyAutomator.i18n.validation.field.radio.invalid},date:{empty:UncannyAutomator.i18n.validation.field.date.empty,invalid:UncannyAutomator.i18n.validation.field.date.invalid},time:{empty:UncannyAutomator.i18n.validation.field.time.empty,invalid:UncannyAutomator.i18n.validation.field.time.invalid},invalidType:UncannyAutomator.i18n.validation.field.invalidType};try{if("textarea"==t&&!(0,r.xb)(e)&&e.is(":not(:visible)")){var p=e.closest(".form-element");p.find(".switch-html").trigger("click"),n=e.val(),p.find(".switch-tmce").trigger("click")}}catch(e){console.log(e)}if((0,r.d3)(t,c)){if("checkbox"!=t||(0,r.xb)(n)||["true","false"].includes(n)&&(n="true"==n),a.required&&((0,r.xb)(n)||"checkbox"==t&&!1===n))s.message=u[t].empty;else if(!a.required&&(0,r.xb)(n))s.isValid=!0;else if(""!=n){var f;switch(t){case"select":if(s.isValid=!0,a.supportsCustomValue&&"automator_custom_value"==n){var h=e.closest(".form-element").find(".form-element-children");1==h.length&&(s.isValid=l(h,!0).isValid)}if(s.isValid&&(0,r.$K)(i)){var g=i(n);s.isValid=g.isValid,g.isValid||(s.message=g.message)}break;case"text":case"textarea":if(s.isValid=!0,(0,r.$K)(i)){var y=i(n);s.isValid=y.isValid,y.isValid||(s.message=y.message)}break;case"int":var v,_=new RegExp(/^([+-]?[1-9]\d*|0)$/gm);if(f=d(n),a.supportsTokens&&f.hasTokens?1==f.tokens.length?s.isValid=!0:s.message=u.int.multipleTokens:_.test(n)?s.isValid=!0:s.message=u.int.invalid,s.isValid&&(0,r.$K)(i)){var b=i(n,v);s.isValid=b.isValid,b.isValid||(s.message=b.message)}break;case"float":var k,w=new RegExp(/^[+-]?((\d+(\.|\,)?\d*)|(\.\d+))$/gm);if(f=d(n),a.supportsTokens&&f.hasTokens?1==f.tokens.length?s.isValid=!0:s.message=u.float.multipleTokens:w.test(n)?s.isValid=!0:s.message=u.float.invalid,s.isValid&&(0,r.$K)(i)){var A=i(n,k);s.isValid=A.isValid,A.isValid||(s.message=A.message)}break;case"email":var C,U=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),T=[];n.includes(",")?(T=n.split(","),o().each(T,(function(e,t){T[e]=t.trim()}))):T.push(n.trim()),f=d(n);var x=!0,E=T.length>1;if(a.supportsTokens&&f.hasTokens){var D=!1;o().each(T,(function(e,t){if(!((f=d(t)).tokens.length<=1))return D=!0,!1})),x&&!D?s.isValid=!0:s.message=D?E?u.email.multiple.multipleTokens:u.email.single.multipleTokens:E?u.email.multiple.invalid:u.email.single.invalid}else o().each(T,(function(e,t){U.test(t)||(x=!1)})),x?s.isValid=!0:s.message=E?u.email.multiple.invalid:u.email.single.invalid;if(s.isValid&&(0,r.$K)(i)){var M=i(n,C);s.isValid=M.isValid,M.isValid||(s.message=M.message)}break;case"url":var S=m(n,a);if(S.isValid?s.isValid=!0:s.message=u.invalidType,s.isValid&&(0,r.$K)(i)){var O=i(n,S.simulatedURL);s.isValid=O.isValid,O.isValid||(s.message=O.message)}break;case"checkbox":if(s.isValid=!0,(0,r.$K)(i)){var I=i(n);s.isValid=I.isValid,I.isValid||(s.message=I.message)}break;case"radio":if(s.isValid=!0,(0,r.$K)(i)){var L=i(n);s.isValid=L.isValid,L.isValid||(s.message=L.message)}break;case"date":if(s.isValid=!0,(0,r.$K)(i)){var R=i(n);s.isValid=R.isValid,R.isValid||(s.message=R.message)}break;case"time":if(s.isValid=!0,(0,r.$K)(i)){var F=i(n);s.isValid=F.isValid,F.isValid||(s.message=F.message)}break;default:s.isValid=!1,s.message=""}}}else s.message=u.invalidType;if(!(0,r.xb)(e)){var V=e.closest(".form-element"),P=V.find(".form-element__error").filter((function(){return o()(this).closest(".form-element").is(V)}));s.isValid?(V.removeClass("form-element--error"),V.addClass("form-element--success")):(V.removeClass("form-element--success"),V.addClass("form-element--error")),""!=s.message?(P.addClass("form-element__error--show"),P.text(s.message)):(P.removeClass("form-element__error--show"),P.text(""))}return s}function d(e){var t={hasTokens:!1,tokens:[]},n=new RegExp(/\{\{(.*?)\}\}/gm),a=new s.Z(null,null,{includeGroupName:!1,includeGroupIcon:!1}).tokens;return(0,r.$K)(e)?(0,r.xb)(e)||function(){(0,r.HD)(e)||(e=e.toString());for(var i,s=[],c=function(){var e=i[1];e.startsWith("USERMETA:")||e.startsWith("POSTMETA:")?s.push(e):o().each(a,(function(t,n){o().each(n.tokens,(function(t,n){e==n.id&&s.push(n)}))}))};null!==(i=n.exec(e));)c();t.tokens=s,t.tokens.length>0&&(t.hasTokens=!0)}():console.error("Undefined string attribute"),t}function p(e){var t=e,n=d(e);return n.hasTokens&&o().each(n.tokens,(function(e,n){var a=n.id.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");a=(0,r.qi)("{{%s}}",[a]);var i=new RegExp(a,"g");t=t.replace(i,(function(e,t){return function(e){var t="";switch(e){case"select":t="option";break;case"text":t="lorem-ipsum";break;case"textarea":t="<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum finibus eros nunc, et posuere libero posuere a. Nam viverra mattis finibus. Aenean purus lorem, mollis vel ullamcorper ac</p>";break;case"int":t=1;break;case"float":t=1.1;break;case"url":t="https://example.com";break;case"email":t="example@example.com";break;case"checkbox":t=!0;break;case"radio":t="option";break;case"date":t="2021-12-31";break;case"":t="01:00 PM"}return t}(n.type)}))})),t}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{supportsTokens:!1},n={changed:!1,isValid:!1,newURL:null,simulatedURL:null};e=e.replace(/ /g,"%20");var a=new RegExp("^(?:(?:https?|ftp)://)(?:S+(?::S*)?@)?(?:(?!(?:10|127)(?:.d{1,3}){3})(?!(?:169.254|192.168)(?:.d{1,3}){2})(?!172.(?:1[6-9]|2d|3[0-1])(?:.d{1,3}){2})(?:[1-9]d?|1dd|2[01]d|22[0-3])(?:.(?:1?d{1,2}|2[0-4]d|25[0-5])){2}(?:.(?:[1-9]d?|1dd|2[0-4]d|25[0-4]))|(?:(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)(?:.(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)*(?:.(?:[a-z¡-￿]{2,})).?)(?::d{2,5})?(?:[/?#]S*)?"),i=d(e),o=e;if(t.supportsTokens&&i.hasTokens){var r=p(e);n.simulatedURL=r,a.test(r)?n.isValid=!0:(o="/"==e[0]?UncannyAutomator.siteURL+e:UncannyAutomator.siteURL+"/"+e,a.test(o)&&(n.isValid=!0))}else a.test(e)?n.isValid=!0:(o="/"==e[0]?UncannyAutomator.siteURL+e:UncannyAutomator.siteURL+"/"+e,a.test(o)&&(n.isValid=!0));return n.newURL=o,n.newURL!=e&&(n.changed=!0),n}function f(e){e.checkURL()}(a=jQuery).fn.checkURL=function(e){return this.each((function(){var t=a(this),n=a.extend({preURL:"Final URL: "},e),i={container:t,input:t.find(".form-element__input")},o={required:i.input.data("required"),supportsTokens:i.input.data("supportstokens")},r=a("<div/>",{class:"form-input-url-notice"}),s=a("<div/>",{class:"form-input-url-notice__header"}),c=a("<div/>",{class:"form-input-url-notice__url"});function l(e){var t=m(e,o);""!=e&&t.isValid&&t.changed?(r.addClass("form-input-url-notice--show"),c.text(t.newURL)):r.removeClass("form-input-url-notice--show")}return s.text(n.preURL),s.appendTo(r),c.appendTo(r),r.appendTo(i.container),""!=i.input.val()&&l(i.input.val()),i.container.on("automator:field:change",(function(){l(i.input.val())})),this}))}},195:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>Tokens});var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(609),jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__),_Utilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179);function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var a,i,o=[],r=!0,s=!1;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);r=!0);}catch(e){s=!0,i=e}finally{try{r||null==n.return||n.return()}finally{if(s)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Tokens=function(){function Tokens(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,Tokens),this.saveData(e,t,n),this.getData()}return _createClass(Tokens,[{key:"saveData",value:function(e,t,n){this.itemType=e,this.fieldType=t,this.options=Object.assign({includeGroupName:!0,includeGroupIcon:!0,includeGroupTokens:!0},n),this.tokensRegEx=new RegExp(/\{\{(.*?)\}\}/gm),this.tokensThatRequireUser=[]}},{key:"getData",value:function(){this.tokens=this.getAllTokens()}},{key:"getAllTokens",value:function(){var e=[],t=this.getCommonTokens();t.tokens.length>0&&e.push(t);var n=this.getAdvancedTokens();n.tokens.length>0&&e.push(n);var a=this.getItemsTokens();return[].concat(_toConsumableArray(e),_toConsumableArray(a))}},{key:"getCommonTokens",value:function(){var e=this,t={id:"common"};return this.options.includeGroupName&&(t.name=UncannyAutomator.i18n.tokens.global.common),this.options.includeGroupIcon&&(t.icon=jquery__WEBPACK_IMPORTED_MODULE_0___default()('\n                <i class="uo-icon uo-icon--bolt"></i>\n            ')),this.options.includeGroupTokens&&(t.tokens=[{id:"site_name",type:"text",name:UncannyAutomator.i18n.tokens.global.siteName,cacheable:!0}],("anonymous"!=UncannyAutomator.recipe.type||"trigger"!=this.itemType&&"user-selector"!=this.itemType)&&t.tokens.push({id:"user_id",type:"int",name:UncannyAutomator.i18n.tokens.global.userID,cacheable:!0,requiresUser:!0},{id:"user_username",type:"text",name:UncannyAutomator.i18n.tokens.global.userUsername,cacheable:!0,requiresUser:!0},{id:"user_firstname",type:"text",name:UncannyAutomator.i18n.tokens.global.userFirstName,cacheable:!0,requiresUser:!0},{id:"user_lastname",type:"text",name:UncannyAutomator.i18n.tokens.global.userLastName,cacheable:!0,requiresUser:!0},{id:"user_email",type:"email",name:UncannyAutomator.i18n.tokens.global.userEmail,cacheable:!0,requiresUser:!0},{id:"user_displayname",type:"text",name:UncannyAutomator.i18n.tokens.global.userDisplay,cacheable:!0,requiresUser:!0},{id:"reset_pass_link",type:"url",name:UncannyAutomator.i18n.tokens.global.userResetPassLink,cacheable:!0,requiresUser:!0}),t.tokens.push({id:"admin_email",type:"email",name:UncannyAutomator.i18n.tokens.global.adminEmail,cacheable:!0},{id:"site_url",type:"url",name:UncannyAutomator.i18n.tokens.global.siteUrl,cacheable:!0},{id:"recipe_name",type:"text",name:UncannyAutomator.i18n.tokens.global.recipeName,cacheable:!0},{id:"current_date",type:"text",name:UncannyAutomator.i18n.tokens.global.currentDate,cacheable:!0},{id:"current_time",type:"text",name:UncannyAutomator.i18n.tokens.global.currentTime,cacheable:!0})),t.tokens.forEach((function(t){t.requiresUser&&e.tokensThatRequireUser.push(t.id)})),t}},{key:"getAdvancedTokens",value:function(){var e=this,t={id:"advanced",tokens:[]};return this.options.includeGroupName&&(t.name=UncannyAutomator.i18n.tokens.global.advanced),this.options.includeGroupIcon&&(t.icon=jquery__WEBPACK_IMPORTED_MODULE_0___default()('\n                <i class="uo-icon uo-icon--bolt"></i>\n            ')),this.options.includeGroupTokens&&("anonymous"!=UncannyAutomator.recipe.type||"trigger"!=this.itemType&&"user-selector"!=this.itemType)&&(t.tokens.push({id:"USERMETA:KEY",type:"text",name:UncannyAutomator.i18n.tokens.global.userMetaKey,cacheable:!1,requiresUser:!0}),(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(UncannyAutomator.wp)&&"1"===UncannyAutomator.wp&&t.tokens.push({id:"AUTOLOGINLINK",type:"text",name:UncannyAutomator.i18n.tokens.global.autoLoginLink,cacheable:!0,requiresUser:!0})),t.tokens.forEach((function(t){t.requiresUser&&e.tokensThatRequireUser.push(t.id)})),t}},{key:"getItemsTokens",value:function(){var e=this,t=[],n=UncannyAutomator.recipe.items;return(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(this.itemType)&&(n={},["action","closure","user-selector"].includes(this.itemType)&&(n=jquery__WEBPACK_IMPORTED_MODULE_0___default().extend({},n,(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.Wr)("get",{filter:{itemType:"trigger"}}))),"closure"==this.itemType&&(n=jquery__WEBPACK_IMPORTED_MODULE_0___default().extend({},n,(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.Wr)("get",{filter:{itemType:"action"}})))),Object.entries(n).forEach((function(n){var a=_slicedToArray(n,2),i=(a[0],a[1]),o=e.getItemTokens(i);(o.tokens.length>0||!e.options.includeGroupTokens)&&t.push(o)})),t}},{key:"getItemTokens",value:function getItemTokens(item){var tokensGroup={id:item.itemCode,integrationId:item.integrationCode};if(this.options.includeGroupName){var itemSentence=item.sentence;item.isMissing||(itemSentence=(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.Vx)(item.integrationCode,item.itemType,item.itemCode).sentence),tokensGroup.name=(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.qh)(item,itemSentence,UncannyAutomator.recipe.items[item.id].meta,!1).html}if(this.options.includeGroupIcon){var $icon;if((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(UncannyAutomator.integrations[item.integrationCode])){var integration=UncannyAutomator.integrations[item.integrationCode];(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(integration.icon_svg)?$icon=jquery__WEBPACK_IMPORTED_MODULE_0___default()('\n\t                    <img \n\t                        src="'.concat(integration.icon_svg,'" \n\t                        alt="').concat(integration.name,'"\n\t                    >\n\t                ')):(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(integration.icon_16)&&(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(integration.icon_32)&&($icon=jquery__WEBPACK_IMPORTED_MODULE_0___default()('\n\t                    <img \n\t                        src="'.concat(integration.icon_16,'" \n\t                        srcset="').concat((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.qi)("%s 1x, %s 2x",[integration.icon_16,integration.icon_32]),'"\n\t                        alt="').concat(integration.name,'"\n\t                    >\n\t                ')))}tokensGroup.icon=$icon}if(this.options.includeGroupTokens){var itemTokens=[];if(Object.entries(item.options).forEach((function(e){var t=_slicedToArray(e,2);t[0],t[1].fields.forEach((function(e){var t=e.getAttributes();"repeater"==t.fieldType?e.fieldRows.forEach((function(e,n){var a=n;e.forEach((function(e){itemTokens.push({id:"".concat(item.id,":").concat(item.itemCode,":").concat(t.optionCode,":").concat(a,":").concat(e.getAttributes().optionCode),name:"".concat(t.tokenName," - ").concat((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.qi)(UncannyAutomator.i18n.rowNumber,[a+1])," - ").concat(e.getAttributes().tokenName),type:"select"==e.getAttributes().fieldType||"textarea"==e.getAttributes().fieldType?"text":e.getAttributes().fieldType,value:e.getValue(),fieldId:e.getAttributes().optionCode,itemID:item.id,cacheable:!1})}))})):"group"==t.fieldType||((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(t.customFieldTokens)&&(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.Kn)(t.customFieldTokens)?Object.entries(t.customFieldTokens).forEach((function(n){var a=_slicedToArray(n,2),i=a[0],o=a[1];itemTokens.push({id:"".concat(item.id,":").concat(item.itemCode,":").concat(i),name:o,type:"select"==t.fieldType||"textarea"==t.fieldType?"text":t.fieldType,value:e.getValue(),fieldId:t.optionCode,itemID:item.id,cacheable:!0})})):itemTokens.push({id:"".concat(item.id,":").concat(item.itemCode,":").concat(t.optionCode),name:t.tokenName,type:"select"==t.fieldType||"textarea"==t.fieldType?"text":t.fieldType,value:e.getValue(),fieldId:t.optionCode,itemID:item.id,cacheable:!0}))}))})),item.tokens.forEach((function(e){itemTokens.push({id:"".concat(item.id,":").concat(e.tokenIdentifier,":").concat(e.tokenId),name:e.tokenName,type:(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(e.tokenType)?e.tokenType:"text",itemID:item.id,cacheable:!0})})),tokensGroup.tokens=itemTokens,!(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.xb)(item.filterTokens))try{var filterTokens=eval("(".concat(item.filterTokens.replace("<script>","").replace("<\/script>","").trim(),")"));itemTokens=filterTokens(tokensGroup,item)}catch(e){console.log(e),console.log(item.filterTokens)}}return tokensGroup}},{key:"filterTokensByType",value:function(e){var t=this;return(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(this.fieldType)&&(["text","textarea","url"].includes(this.fieldType)||(e=e.filter((function(e){var n=e.type;return"float"==t.fieldType&&"int"==n&&(n="float"),t.fieldType==n})))),e}},{key:"createTokenDOMNode",value:function(e){var t=null,n=this.getTokenDataByID(e);if((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(n)){if((0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(UncannyAutomator.cache.tokens[n.id]))t=UncannyAutomator.cache.tokens[n.id];else{(t=document.createElement("span")).classList.add("uap-token"),t.appendChild(n.group.icon[0].cloneNode());var a=document.createElement("span");a.classList.add("uap-token__name"),a.innerHTML=n.name,t.appendChild(a),n.cacheable&&(UncannyAutomator.cache.tokens[n.id]=t)}t=t.cloneNode(!0)}else{(t=document.createElement("span")).classList.add("uap-token","uap-token--invalid");var i=document.createElement("i");i.classList.add("uo-icon","uo-icon--exclamation"),t.appendChild(i);var o=document.createElement("span");o.classList.add("uap-token__name"),o.innerHTML=e,t.appendChild(o)}return t}},{key:"getTokenDataByID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e,n=null;if(e.startsWith("USERMETA:")&&(e="USERMETA:KEY"),(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.xb)(e)||this.tokens.some((function(t){if(n=t.tokens.reduce((function(t,n){return n.id==e?n:t}),null),(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(n))return n.group={id:t.id,name:t.name,icon:t.icon},!0})),(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.$K)(n)&&e.startsWith("USERMETA:")){n=jquery__WEBPACK_IMPORTED_MODULE_0___default().extend(!0,{},n);var a=t.replace("USERMETA:","");n.id=n.id.replace("KEY",a),n.name=(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.qi)(UncannyAutomator.i18n.tokens.global.userMetaKeyTemplate,[a])}return n}},{key:"renderTextWithTokens",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=Object.assign({template:""},n);var a=!(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.xb)(n.template),i=document.createElement("span");return e=e.replace(this.tokensRegEx,(function(e,i){var o=t.createTokenDOMNode(i).outerHTML;return a&&(o=(0,_Utilities__WEBPACK_IMPORTED_MODULE_1__.qi)(n.template,[o,i])),o})),i.innerHTML=e,i}}]),Tokens}()},895:()=>{"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,...t){if(!e)throw TypeError("Cannot convert undefined or null to object");for(const n of t)n&&Object.keys(n).forEach((t=>e[t]=n[t]));return e})},771:e=>{"use strict";function t(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var n=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter((function(e){return 1===e.nodeType&&e.matches(t)}))},a=new Map,i=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach((function(t,n){e[n]=t})),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),o=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return a.has(e)||a.set(e,new i),a.get(e)};function r(e,t,n){if(e instanceof Array)for(var a=0;a<e.length;++a)r(e[a],t,n);else e.addEventListener(t,n),o(e).setData("event"+t,n)}function s(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)s(e[n],t);else e.removeEventListener(t,o(e).getData("event"+t)),o(e).deleteData("event"+t)}function c(e,t,n){if(e instanceof Array)for(var a=0;a<e.length;++a)c(e[a],t,n);else e.setAttribute(t,n)}function l(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)l(e[n],t);else e.removeAttribute(t)}var u,d,p,m,f,h,g,y,v,_=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},b=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},k=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},w=function(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},A=function(e,t){return w(e,t,"after")},C=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},U=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},T=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter((function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement})).map((function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)}))},x=function(e){return e.composedPath&&e.composedPath()[0]||e.target},E=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},D=function(e,t){if(!0===e.isSortable){var n=o(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(e){return e.length>0&&t.matches(e)})).length>0;if(e===t)return!0;if(void 0!==o(e).getConfig("connectWith")&&null!==o(e).getConfig("connectWith"))return o(e).getConfig("connectWith")===o(t).getConfig("connectWith")}return!1},M={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"},S=function(e,t){if("string"==typeof o(e).getConfig("hoverClass")){var a=o(e).getConfig("hoverClass").split(" ");!0===t?(r(e,"mousemove",function(e,t){var n=this;if(void 0===t&&(t=250),"number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var a=null;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var r=Date.now();(null===a||r-a>=t)&&(a=r,e.apply(n,i))}}((function(t){0===t.buttons&&n(e.children,o(e).getConfig("items")).forEach((function(e){var n,i;e!==t.target?(n=e.classList).remove.apply(n,a):(i=e.classList).add.apply(i,a)}))}),o(e).getConfig("throttleTime"))),r(e,"mouseleave",(function(){n(e.children,o(e).getConfig("items")).forEach((function(e){var t;(t=e.classList).remove.apply(t,a)}))}))):(s(e,"mousemove"),s(e,"mouseleave"))}},O=function(e){s(e,"dragstart"),s(e,"dragend"),s(e,"dragover"),s(e,"dragenter"),s(e,"drop"),s(e,"mouseenter"),s(e,"mouseleave")},I=function(e,t){e&&s(e,"dragleave"),t&&t!==e&&s(t,"dragleave")},L=function(e){var t;(t=e).h5s&&delete t.h5s.data,l(e,"aria-dropeffect")},R=function(e){l(e,"aria-grabbed"),l(e,"aria-copied"),l(e,"draggable"),l(e,"role")};function F(e,t){if(t.composedPath)return t.composedPath().find((function(e){return e.isSortable}));for(;!0!==e.isSortable;)e=e.parentElement;return e}function V(e,a){var i=t(e,"opts"),o=n(e.children,i.items).filter((function(e){return e.contains(a)||e.shadowRoot&&e.shadowRoot.contains(a)}));return o.length>0?o[0]:a}var P=function(e){var a=t(e,"opts"),i=n(e.children,a.items),o=T(i,a.handle);c(e,"aria-dropeffect","move"),t(e,"_disabled","false"),c(o,"draggable","true"),S(e,!0),!1===a.disableIEFix&&"function"==typeof(document||window.document).createElement("span").dragDrop&&r(o,"mousedown",(function(){if(-1!==i.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===i.indexOf(e);)e=e.parentElement;e.dragDrop()}}))};function $(e,i){var l=String(i);return i=i||{},"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLElement&&(e=[e]),e=Array.prototype.slice.call(e),/serialize/.test(l)?e.map((function(e){var a=t(e,"opts");return function(e,a,i){if(void 0===a&&(a=function(e,t){return e}),void 0===i&&(i=function(e){return e}),!(e instanceof HTMLElement)||1==!e.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof a||"function"!=typeof i)throw new Error("You need to provide a valid serializer for items and the container.");var o=t(e,"opts").items,r=n(e.children,o),s=r.map((function(t){return{parent:e,node:t,html:t.outerHTML,index:b(t,r)}}));return{container:i({node:e,itemCount:s.length}),items:s.map((function(t){return a(t,e)}))}}(e,a.itemSerializer,a.containerSerializer)})):(e.forEach((function(e){if(/enable|disable|destroy/.test(l))return $[l](e);["connectWith","disableIEFix"].forEach((function(e){Object.prototype.hasOwnProperty.call(i,e)&&null!==i[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),i=Object.assign({},M,o(e).config,i),o(e).config=i,t(e,"opts",i),e.isSortable=!0,function(e){var a=t(e,"opts"),i=n(e.children,a.items),o=T(i,a.handle);t(e,"_disabled","false"),O(i),I(m,y),s(o,"mousedown"),s(e,"dragover"),s(e,"dragenter"),s(e,"drop")}(e);var S,L=n(e.children,i.items);if(null!==i.placeholder&&void 0!==i.placeholder){var R=document.createElement(e.tagName);i.placeholder instanceof HTMLElement?R.appendChild(i.placeholder):R.innerHTML=i.placeholder,S=R.children[0]}o(e).placeholder=function(e,t,n){var a;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(a=t.classList).add.apply(a,n.split(" ")),t}(e,S,i.placeholderClass),t(e,"items",i.items),i.acceptFrom?t(e,"acceptFrom",i.acceptFrom):i.connectWith&&t(e,"connectWith",i.connectWith),P(e),c(L,"role","option"),c(L,"aria-grabbed","false"),r(e,"dragstart",(function(e){var t=x(e);if(!0!==t.isSortable&&(e.stopImmediatePropagation(),(!i.handle||t.matches(i.handle))&&"false"!==t.getAttribute("draggable"))){var a=F(t,e),r=V(a,t);g=n(a.children,i.items),f=g.indexOf(r),h=b(r,a.children),m=a,function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=E),e.dataTransfer&&e.dataTransfer.setDragImage){var a=n(t,_(t),e);if(!(a.element instanceof HTMLElement)||"number"!=typeof a.posX||"number"!=typeof a.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",x(e).id),e.dataTransfer.setDragImage(a.element,a.posX,a.posY)}}(e,r,i.customDragImage),d=C(r),p=U(r),r.classList.add(i.draggingClass),u=function(e,t){var n=e;return!0===o(t).getConfig("copy")&&(c(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n}(r,a),c(u,"aria-grabbed","true"),a.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:h,index:f,container:m},item:u,originalTarget:t}}))}})),r(e,"dragenter",(function(a){var s=x(a),c=F(s,a);c&&c!==y&&(v=n(c.children,t(c,"items")).filter((function(t){return t!==o(e).placeholder})),i.dropTargetContainerClass&&c.classList.add(i.dropTargetContainerClass),c.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:h,index:f,container:m},destination:{container:c,itemsBeforeUpdate:v},item:u,originalTarget:s}})),r(c,"dragleave",(function(e){var t=e.relatedTarget||e.fromElement;e.currentTarget.contains(t)||(i.dropTargetContainerClass&&c.classList.remove(i.dropTargetContainerClass),c.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:h,index:f,container:c},item:u,originalTarget:s}})))}))),y=c})),r(e,"dragend",(function(n){if(u){u.classList.remove(i.draggingClass),c(u,"aria-grabbed","false"),"true"===u.getAttribute("aria-copied")&&"true"!==t(u,"dropped")&&u.remove(),u.style.display=u.oldDisplay,delete u.oldDisplay;var o=Array.from(a.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(k)[0];o&&o.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:h,index:f,container:m},item:u}})),y=null,u=null,d=null,p=null}})),r(e,"drop",(function(r){if(D(e,u.parentElement)){r.preventDefault(),r.stopPropagation(),t(u,"dropped","true");var s=Array.from(a.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(k)[0];A(s,u),s.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:h,index:f,container:m},item:u}}));var c=o(e).placeholder,l=n(m.children,i.items).filter((function(e){return e!==c})),d=!0===this.isSortable?this:this.parentElement,p=n(d.children,t(d,"items")).filter((function(e){return e!==c})),y=b(u,Array.from(u.parentElement.children).filter((function(e){return e!==c}))),_=b(u,p);i.dropTargetContainerClass&&d.classList.remove(i.dropTargetContainerClass),h===y&&m===d||e.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:h,index:f,container:m,itemsBeforeUpdate:g,items:l},destination:{index:_,elementIndex:y,container:d,itemsBeforeUpdate:v,items:p},item:u}}))}}));var K,j,N,q=(K=function(e,t,r,s){if(u)if(i.forcePlaceholderSize&&(o(e).placeholder.style.height=d+"px",o(e).placeholder.style.width=p+"px"),Array.from(e.children).indexOf(t)>-1){var c=C(t),l=U(t),m=b(o(e).placeholder,t.parentElement.children),f=b(t,t.parentElement.children);if(c>d||l>p){var h=c-d,g=l-p,y=_(t).top,v=_(t).left;if(m<f&&("vertical"===i.orientation&&s<y||"horizontal"===i.orientation&&r<v))return;if(m>f&&("vertical"===i.orientation&&s>y+c-h||"horizontal"===i.orientation&&r>v+l-g))return}void 0===u.oldDisplay&&(u.oldDisplay=u.style.display),"none"!==u.style.display&&(u.style.display="none");var k=!1;try{var T=_(t).top+t.offsetHeight/2,x=_(t).left+t.offsetWidth/2;k="vertical"===i.orientation&&s>=T||"horizontal"===i.orientation&&r>=x}catch(e){k=m<f}k?A(t,o(e).placeholder):function(e,t){w(e,t,"before")}(t,o(e).placeholder),Array.from(a.values()).filter((function(e){return void 0!==e.placeholder})).forEach((function(t){t.placeholder!==o(e).placeholder&&t.placeholder.remove()}))}else{var E=Array.from(a.values()).filter((function(e){return void 0!==e.placeholder})).map((function(e){return e.placeholder}));-1!==E.indexOf(t)||e!==t||n(t.children,i.items).length||(E.forEach((function(e){return e.remove()})),t.appendChild(o(e).placeholder))}},void 0===(j=i.debounce)&&(j=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(N),N=setTimeout((function(){K.apply(void 0,e)}),j)}),B=function(e){var a=e.target,i=!0===a.isSortable?a:F(a,e);if(a=V(i,a),u&&D(i,u.parentElement)&&"true"!==t(i,"_disabled")){var r=t(i,"opts");parseInt(r.maxItems)&&n(i.children,t(i,"items")).length>=parseInt(r.maxItems)&&u.parentElement!==i||(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=!0===o(i).getConfig("copy")?"copy":"move",q(i,a,e.pageX,e.pageY))}};r(L.concat(e),"dragover",B),r(L.concat(e),"dragenter",B)})),e)}$.destroy=function(e){!function(e){var a=t(e,"opts")||{},i=n(e.children,a.items),o=T(i,a.handle);S(e,!1),s(e,"dragover"),s(e,"dragenter"),s(e,"dragstart"),s(e,"dragend"),s(e,"drop"),L(e),s(o,"mousedown"),O(i),R(i),I(m,y),e.isSortable=!1}(e)},$.enable=function(e){P(e)},$.disable=function(e){!function(e){var a=t(e,"opts"),i=n(e.children,a.items),o=T(i,a.handle);c(e,"aria-dropeffect","none"),t(e,"_disabled","true"),c(o,"draggable","false"),s(o,"mousedown"),S(e,!1)}(e)},$.__testing={data:t,removeItemEvents:O,removeItemData:R,removeSortableData:L,removeContainerEvents:I},e.exports=$},975:(e,t,n)=>{var a;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return s(l(e),arguments)}function r(e,t){return o.apply(null,[e].concat(t||[]))}function s(e,t){var n,a,r,s,c,l,u,d,p,m=1,f=e.length,h="";for(a=0;a<f;a++)if("string"==typeof e[a])h+=e[a];else if("object"==typeof e[a]){if((s=e[a]).keys)for(n=t[m],r=0;r<s.keys.length;r++){if(null==n)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',s.keys[r],s.keys[r-1]));n=n[s.keys[r]]}else n=s.param_no?t[s.param_no]:t[m++];if(i.not_type.test(s.type)&&i.not_primitive.test(s.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(s.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(o("[sprintf] expecting number but found %T",n));switch(i.number.test(s.type)&&(d=n>=0),s.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,s.width?parseInt(s.width):0);break;case"e":n=s.precision?parseFloat(n).toExponential(s.precision):parseFloat(n).toExponential();break;case"f":n=s.precision?parseFloat(n).toFixed(s.precision):parseFloat(n);break;case"g":n=s.precision?String(Number(n.toPrecision(s.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=s.precision?n.substring(0,s.precision):n;break;case"t":n=String(!!n),n=s.precision?n.substring(0,s.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=s.precision?n.substring(0,s.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=s.precision?n.substring(0,s.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(s.type)?h+=n:(!i.number.test(s.type)||d&&!s.sign?p="":(p=d?"+":"-",n=n.toString().replace(i.sign,"")),l=s.pad_char?"0"===s.pad_char?"0":s.pad_char.charAt(1):" ",u=s.width-(p+n).length,c=s.width&&u>0?l.repeat(u):"",h+=s.align?p+n+c:"0"===l?p+c+n:c+p+n)}return h}var c=Object.create(null);function l(e){if(c[e])return c[e];for(var t,n=e,a=[],o=0;n;){if(null!==(t=i.text.exec(n)))a.push(t[0]);else if(null!==(t=i.modulo.exec(n)))a.push("%");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var r=[],s=t[2],l=[];if(null===(l=i.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(r.push(l[1]);""!==(s=s.substring(l[0].length));)if(null!==(l=i.key_access.exec(s)))r.push(l[1]);else{if(null===(l=i.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");r.push(l[1])}t[2]=r}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");a.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=a}t.sprintf=o,t.vsprintf=r,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=r,void 0===(a=function(){return{sprintf:o,vsprintf:r}}.call(t,n,t,e))||(e.exports=a))}()},609:e=>{"use strict";e.exports=jQuery}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(609),t=__webpack_require__.n(e),n=__webpack_require__(179),a=__webpack_require__(413),i=__webpack_require__(549),o=__webpack_require__(619);function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}const s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.build()}var a,i;return a=e,(i=[{key:"build",value:function(){var e,a,i=t()("<div/>",{class:"uap-report-bug"});(0,n.$K)(UncannyAutomator.wp)&&UncannyAutomator.wp?(e=(0,n.qi)("Uncanny Automator %s %s",["Pro",UncannyAutomator.version]),a=(0,n.qi)("uncanny_automator_%s",["pro"])):(e=(0,n.qi)("Uncanny Automator %s",[UncannyAutomator.version]),a="uncanny_automator");var o=t()("<a/>",{class:"uap-report-bug__btn","uap-tooltip":UncannyAutomator.i18n.sendFeedback.title,"uap-flow":"left",href:(0,n.qi)("https://automatorplugin.com/feedback/?version=%s&utm_source=%s&utm_medium=%s&utm_content=%s",[e,a,"send_feedback","bulb_icon"]),target:"_blank"}),r=t()("<span/>",{class:"uap-report-bug__icon"});o.append(r),o.appendTo(i),t()("body").append(i)}},{key:"bind",value:function(e,t,n,a){e.on("click",(function(){t.is(":checked")&&(localStorage.uapSendFeedbackWelcome="hide"),n.fadeOut(150),a.removeClass("uap-report-bug--open")}))}},{key:"showAgain",value:function(){return!1}}])&&r(a.prototype,i),e}();function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}__webpack_require__(800);const l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements={container:t()("#titlediv"),input:t()("#titlediv #title"),status:{}},this.publishedTitle=this.elements.input.val(),this.createStatus(),this.bindChanges(),this.notSavedAlert()}var a,i;return a=e,(i=[{key:"createStatus",value:function(){var e=t()("<div/>",{class:"uap-title-status"}),n=t()("<div/>",{class:"uap"}),a=t()("<div/>",{class:"uo-status uo-status--saving"}),i=t()("<span/>",{class:"uo-status-icon uo-icon uo-icon--loading uo-icon--rotate"}),o=t()("<span/>",{class:"uo-status__text"}).text(UncannyAutomator.i18n.title.saving);a.append(i),a.append(o),this.elements.status.saving=a;var r=t()("<div/>",{class:"uo-status uo-status--saved"}),s=t()("<span/>",{class:"uo-status-icon uo-icon uo-icon--check"}),c=t()("<span/>",{class:"uo-status__text"}).text(UncannyAutomator.i18n.title.saved);r.append(s),r.append(c),this.elements.status.saved=r,n.append(a),n.append(r),e.append(n),this.elements.container.append(e)}},{key:"setStatusSaving",value:function(){this.elements.status.saving.stop().fadeIn(150)}},{key:"setStatusSaved",value:function(){var e=this;this.elements.status.saving.stop().fadeOut(150),this.elements.status.saved.stop().fadeIn(150,(function(){setTimeout((function(){e.elements.status.saved.fadeOut(150)}),3e3)}))}},{key:"revertChanges",value:function(){this.elements.input.val(this.publishedTitle),this.elements.status.saving.stop().fadeOut(150)}},{key:"bindChanges",value:function(){var e,t=this;this.elements.input.on("input",(function(){clearTimeout(e),e=setTimeout((function(){t.setStatusSaving(),t.updateTitle()}),1500)}))}},{key:"getTitle",value:function(){return this.elements.input.val()}},{key:"updateTitle",value:function(){var e=this;(0,n.L8)("change_post_title",{post_ID:UncannyAutomator.recipe.id,post_title:this.getTitle()},(function(){e.setStatusSaved(),e.publishedTitle=e.getTitle()}),(function(){console.log("‼️ ERROR-TODO. Couldn't save the title"),e.revertChanges()}))}},{key:"notSavedAlert",value:function(){t()(document).ready((function(){t()(window).off("beforeunload.edit-post")}))}}])&&c(a.prototype,i),e}();function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m=function(){function e(){p(this,e),this.getElements(),1==this.$elements.allCategories.length&&this.listenCheckboxes()}return d(e,[{key:"getElements",value:function(){this.$elements={container:t()("#recipe_categorydiv"),allCategories:t()("#recipe_categorychecklist")}}},{key:"listenCheckboxes",value:function(){var e=this;this.$elements.container.on("change",'input[type="checkbox"][name="tax_input[recipe_category][]"], .popular-category input[type="checkbox"]',(function(n){var a=t()(n.currentTarget);e.saveCategory(a)})),new MutationObserver((function(n){n.forEach((function(n){n.addedNodes.forEach((function(n){var a=t()(n).find('input[type="checkbox"][name="tax_input[recipe_category][]"]');e.saveCategory(a)}))}))})).observe(this.$elements.allCategories[0],{childList:!0})}},{key:"getCheckboxData",value:function(e){return{id:e.val(),isChecked:e.is(":checked")}}},{key:"saveCategory",value:function(e){var t=this,a=this.getCheckboxData(e);this.setStatus("loading",!0,e),(0,n.L8)("set_recipe_terms",{term_id:"recipe_category",recipe_id:UncannyAutomator.recipe.id,category_id:a.id,set_category:a.isChecked},(function(n){n.success?(t.setStatus("success",!0,e),setTimeout((function(){t.setStatus("success",!1,e)}),2e3)):(console.log("‼️ ERROR-TODO. Couldn't change the status of the recipe category"),t.revertCheckboxValue(e),t.setStatus("error",!0,e),setTimeout((function(){t.setStatus("error",!1,e)}))),t.setStatus("loading",!1,e)}),(function(n){t.revertCheckboxValue(e),t.setStatus("loading",!1,e),t.setStatus("error",!0,e),setTimeout((function(){t.setStatus("error",!1,e)}))}),{requiresRecipesObject:!1,renderUI:!1})}},{key:"revertCheckboxValue",value:function(e){e.prop("checked",!e.is(":checked"))}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=n.closest(".selectit");"loading"==e?t?(a.addClass("uap-taxonomy-loading"),n.prop("disabled",!0)):(a.removeClass("uap-taxonomy-loading"),n.prop("disabled",!1)):"success"==e?t?a.addClass("uap-taxonomy-success"):a.removeClass("uap-taxonomy-success"):"error"==e&&(t?a.addClass("uap-taxonomy-error"):a.removeClass("uap-taxonomy-error"))}}]),e}(),f=function(){function e(){p(this,e),this.getElements(),1==this.$elements.tagsTextarea.length&&this.listenModificationsToTags()}return d(e,[{key:"getElements",value:function(){this.$elements={container:t()("#tagsdiv-recipe_tag"),tagsTextarea:t()("textarea#tax-input-recipe_tag"),tagsList:t()("#tagsdiv-recipe_tag .tagchecklist")}}},{key:"listenModificationsToTags",value:function(){var e=this;new MutationObserver((function(t){e.saveTags()})).observe(this.$elements.tagsList[0],{childList:!0})}},{key:"saveTags",value:function(){var e=this,t=this.getTags();this.setStatus("loading",!0),(0,n.L8)("set_recipe_terms",{term_id:"recipe_tag",recipe_id:UncannyAutomator.recipe.id,tags:t},(function(t){t.success&&(e.setStatus("success",!0),setTimeout((function(){e.setStatus("success",!1)}),2e3)),e.setStatus("loading",!1)}),(function(e){location.reload()}),{requiresRecipesObject:!1,renderUI:!1})}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"loading"==e?t?this.$elements.container.addClass("uap-tags-loading"):this.$elements.container.removeClass("uap-tags-loading"):"success"==e?t?this.$elements.container.addClass("uap-tags-success"):this.$elements.container.removeClass("uap-tags-success"):"error"==e&&(t?this.$elements.container.addClass("uap-tags-error"):this.$elements.container.removeClass("uap-tags-error"))}},{key:"getTags",value:function(){var e=this.$elements.tagsTextarea.val();return{asArray:e.split(","),commaSeparated:e}}}]),e}();const h=function e(){p(this,e),new m,new f};UncannyAutomator.cache={tokens:{}};try{(0,n.iK)((function(){(0,n.Dh)("Render the UI",!1,{bgColor:"#579f49"}),new i.Z,new o.Z,new a.Z,new s,new l,new h}))}catch(e){(0,n.C2)({title:UncannyAutomator.i18n.debugging.uiCantLoad.title,warning:UncannyAutomator.i18n.debugging.uiCantLoad.warning,content:UncannyAutomator.i18n.debugging.uiCantLoad.content,console:e})}})()})();
//# sourceMappingURL=bundle.min.js.map